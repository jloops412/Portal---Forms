function Log(t){if(window.DEBUG){if(Log2Box(t),top.console&&top.console.log?(arguments[1]&&top.console.trace&&top.console.trace(),top.console.log(t)):"undefined"!=typeof opera&&opera.postError&&opera.postError(t),arguments[1])throw t="string"==typeof t?t:"ABNORMAL PROGRAM TERMINATION!",new Error(t)}else window.EDIT_MODE&&Log2Box(t)}function Log2Box(t){if(window.MANAGER&&MANAGER.handler){var e=MANAGER.handler.GetActive();if(e=e&&e.GetSlideHandler&&e.GetSlideHandler(0)||null)return void e.Log(t)}try{"object"==typeof t&&(t=JSON.stringify(t))}catch(s){}var i=$("Log2Box");i||((i=$$("div")).id="Log2Box",i.style.position="fixed",i.style.width="500px",i.style.height="800px",i.style.bottom="2px",i.style.right="2px",i.style.overflow="auto",i.style.fontSize="12pt",i.style.fontFamily="Lucida Sans",i.style.border="1px solid #888888",i.style.backgroundColor="#eeeeee",i.style.cursor="pointer",i.style.opacity="0.95",document.body.appendChild(i),drg=$$("div"),drg.id="logdragger",drg.style.position="absolute",drg.style.top=0,drg.style.left=0,drg.style.width="100%",drg.style.height="20px",i.ondblclick=function(){var t=$("Log2Box");""!=t.innerHTML?t.innerHTML="":t.parentNode.removeChild(t)},i.onmousedown=function(t){t=t||event||window.event,window.drag_logbox=!0,WCT.event.Cancel(t)},i.onmousemove=function(t){if((t=t||event||window.event)&&window.drag_logbox){var e=$("Log2Box");e.style.left=t.clientX-150+"px",e.style.top=t.clientY-150+"px",WCT.event.Cancel(t)}},i.onmouseup=function(t){t=t||event||window.event,window.drag_logbox=!1,WCT.event.Cancel(t)}),i.firstChild?(i.insertBefore($$("br"),i.firstChild),i.insertBefore($$2("-- "+t),i.firstChild)):i.appendChild($$2("-- "+t))}function ClearLog(){var t=$("Log2Box");t&&(t.innerHTML="")}function Log2Win(t){var e=window.p_Log2Win_,i=null;e&&"unknown"==typeof e.document&&(e=null),e?i=e.document.body:(e=window.open("about:blank",WCT.uid.Generate(10)),(i=(window.p_Log2Win_=e).document.body).style.fontFamily="Lucida Sans"),i.innerHTML="-- "+t+"<br/>"+i.innerHTML}function $(t){return(arguments[1]||document).getElementById(t)}function $$(t){return BROWSER.IE&&BROWSER.VERSION<9&&0<=["article","header","footer"].indexOf(t.toLowerCase())&&(t="div"),(arguments[1]||document).createElement(t)}function $$2(t){return(arguments[1]||document).createTextNode(t)}!function(){var request_headers_={},before_=null,after_=null,error_=null,count_=0,track_=!1,store_={},_token=null;function execute_action_(t){"before"===t?1==++count_&&before_&&before_.f.call(before_.s):0==--count_&&after_&&after_.f.call(after_.s)}function generate_uid_(){for(var t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],e=t.length,i=[],s=12;0<s--;){var n=Math.floor(Math.random()*e);i.push(t[n])}return i.join("")}window.XHR={LastStatus:null,LastResponseText:null,LastResponseXML:null,Cleanup:function(){this.LastStatus=null,this.LastResponseText=null,this.LastResponseXML=null,store_={},_token=error_=after_=before_=null},HasActiveX:function(){try{if(new ActiveXObject("Msxml2.XMLHTTP.3.0"))return!0}catch(t){try{if(new ActiveXObject("Msxml2.XMLHTTP"))return!0}catch(t){try{if(new ActiveXObject("Microsoft.XMLHTTP"))return!0}catch(t){}}}return!1},Create:function(){if(!BROWSER.IE&&window.XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){if(window.XMLHttpRequest)return new XMLHttpRequest}}}return null},SetRequestHeaders:function(t){if(arguments[1]){var e=request_headers_;for(var i in e)t.setRequestHeader(i,e[i]);request_headers_={}}else request_headers_=t},Request:function(t,e){var i=arguments[2],s=arguments[3]||null,n="function"==typeof arguments[4]?arguments[4]:function(){},o=arguments[5],r=!1!==arguments[6],a=arguments[7]||null;"GET"===t&&(i=null),i&&"string"!=typeof i&&"{}"!==JSON.stringify(i)&&(i=JSON.stringify(i));var l=arguments[8]||this.Create();if(!l)return null;if("GET"===t?"JSON"===a&&-1===e.search(/\.txt$/)&&(request_headers_["X-CSRF-Token"]="Fetch"):_token&&(request_headers_["X-CSRF-Token"]=_token),r){var c;track_&&(c=generate_uid_(),store_[c]=l);try{l.open(t,e,!0),this.SetRequestHeaders(l,!0),l.onreadystatechange=function(){if(4===l.readyState){var t=l.getResponseHeader("X-CSRF-Token");t&&t!==_token&&(window.XHR2&&XHR2.SetToken(t),_token=t),l.onreadystatechange=function(){},track_&&delete store_[c],execute_action_("after"),XHR.Eval(l,s,n,o,a,e),c=a=o=n=s=l=null}},execute_action_("before"),l.send(i)}catch(d){}return l}try{execute_action_("before"),l.open(t,e,!1),this.SetRequestHeaders(l,!0),l.send(i);var _=l.getResponseHeader("X-CSRF-Token");_&&_!==_token&&(window.XHR2&&XHR2.SetToken(_),_token=_),execute_action_("after")}catch(d){}return this.Eval(l,s,n,o,a,e)},Eval:function(xhr,scope,success,error,type,url){var r=null,p=url.replace(/(.*?):.*$/,"$1");if(p=WCT.context.PROTOCOLS[p]?p:"file",XHR.LastStatus=xhr.status,XHR.LastResponseText=xhr.responseText,XHR.LastResponseXML=xhr.responseXML,200===xhr.status||"file"===p&&0===xhr.status){switch(type){case"JSON":try{r=xhr.responseText.replace(/\r|\n|\t/g,""),r=JSON.parse(r)}catch(e){r=null}break;case"XML":r=xhr.responseXML;break;case"eval":try{r=eval("("+xhr.responseText+")")}catch(e){r=null}break;case"string":try{r=eval("("+xhr.responseText+")")}catch(e){r=xhr.responseText}break;case"raw":default:r=xhr.responseText}success.call(scope,r)}else error?error.call(scope,xhr.status,xhr.statusText,xhr.responseText):error_&&error_.f.call(error_.s,xhr.status,xhr.statusText,xhr.responseText);return r},Abort:function(t){for(var e in t.onreadystatechange=function(){},4!=t.readyState&&execute_action_("after"),t.abort(),store_)if(store_[e]===t){delete store_[e];break}},AbortAll:function(){var t=store_;for(var e in store_={},t){var i=t[e];this.Abort(i)}},TrackAsyncRequests:function(t){(track_=t)||(store_={})},SetBeforeAction:function(t){before_=t?{f:t,s:arguments[1]}:null},SetAfterAction:function(t){after_=t?{f:t,s:arguments[1]}:null},SetDefaultErrorHandler:function(t){error_=t?{f:t,s:arguments[1]}:null},GetA:function(t){return this.Request("GET",WCT.GetEncodedURI(t),null,arguments[1],arguments[2],arguments[3],!0,arguments[4])},GetS:function(t){return this.Request("GET",WCT.GetEncodedURI(t),null,null,null,null,!1,arguments[1])},PostA:function(t,e){return this.Request("POST",t,e,arguments[2],arguments[3],arguments[4],!0,arguments[5])},PostAXMLHttpRequest:function(t){return this.Request("POST",t.url,t.data,t.scope,t.onSuccess,t.onError,!0,"JSON",t.requestObject)},PostS:function(t,e){return this.Request("POST",t,e,null,null,null,!1,arguments[2])},PutA:function(t,e){return this.Request("PUT",t,e,arguments[2],arguments[3],arguments[4],!0,arguments[5])},PutS:function(t,e){return this.Request("PUT",t,e,null,null,null,!1,arguments[2])},DelA:function(t,e){return this.Request("DELETE",t,e,arguments[2],arguments[3],arguments[4],!0,arguments[5])},DelS:function(t,e){return this.Request("DELETE",t,e,null,null,null,!1,arguments[2])},SetToken:function(t){_token=t},GetToken:function(){return _token},RequestToken:function(){this.SetToken("");var t=DATA.context.GetServerBase();this.GetS(t+"/!/about","JSON")}}}(),function(){var t=navigator.appVersion,e=navigator.platform,i=navigator.userAgent;if(window.BROWSER={},BROWSER.EDGE=0<t.indexOf("Edge")||"5.0 (Windows NT 10.0; Win64; x64)"===t,BROWSER.EDGECHR=0<t.indexOf("Edg/"),BROWSER.IE=!(BROWSER.EDGE||!document.all&&!window.MSStream),BROWSER.FIREFOX=!1,BROWSER.CHROME=!BROWSER.EDGE&&!BROWSER.EDGECHR&&0<t.indexOf("Chrome"),BROWSER.SAFARI=!BROWSER.CHROME&&!BROWSER.EDGECHR&&!BROWSER.EDGE&&0<t.indexOf("Safari"),BROWSER.IPAD=null!=i.match(/iPad/i),BROWSER.IPHONE=null!=i.match(/iPhone/i)||null!=i.match(/iPod/i),BROWSER.EDGE)/.*[Edge\/](\d\d)/.exec(t),BROWSER.VERSION=parseInt(RegExp.$1)||12;else if(BROWSER.IE){if(0<=t.indexOf("like Gecko")){var s=t.match(/rv:\d+/);(s=s&&Number(s[0].substr(3)))&&!isNaN(s)||(s=11),BROWSER.VERSION=s,BROWSER["IE"+s]=!0}else{var n=t.indexOf("MSIE "),o=0<=n?parseInt(t.substr(n+5)):9,r=document.documentMode||(document.compatMode&&"CSS1Compat"==document.compatMode?7:5);r&&o!=r&&(BROWSER.COMPAT_VIEW=!0,o=r),BROWSER.VERSION=o,BROWSER["IE"+o]=!0}BROWSER.ACTIVE_X=function c(){try{if(new ActiveXObject("Msxml2.XMLHTTP.3.0"))return!0}catch(t){try{if(new ActiveXObject("Msxml2.XMLHTTP"))return!0}catch(t){try{if(new ActiveXObject("Microsoft.XMLHTTP"))return!0}catch(t){}}}return!1}()}else BROWSER.SAFARI||BROWSER.CHROME||(BROWSER.FIREFOX=!0);if((BROWSER.FIREFOX||BROWSER.CHROME||BROWSER.SAFARI)&&!BROWSER.EDGE){var a=i.match(BROWSER.FIREFOX?/Firefox\//:BROWSER.CHROME?/Chrome\//:/Version\//),l=a?a.index+a[0].length:0;l&&(BROWSER.VERSION=parseInt(i.substr(l))||1)}if(window.PLATFORM={WINDOWS:0<=e.indexOf("Win"),WINTABLET:!(!navigator.msPointerEnabled||null==t.match(/Tablet PC/)),LINUX:0<=e.indexOf("Linux"),MAC:0<=e.indexOf("Mac"),WINCE:0<=e.indexOf("WinCE"),IOS:BROWSER.IPAD||BROWSER.IPHONE,ANDROID:null!=i.match(/android/i)},PLATFORM.IOS){o=t.match(/OS (\d+)_\d+/)[1];"number"==typeof(o=parseInt(o,10))&&0!=o&&(PLATFORM.VERSION=o)}if(PLATFORM.ANDROID){o=t.match(/Android\s([0-9\.]*)/)[1].replace(/\./g,"");"number"==typeof(o=parseInt(o,10))&&0!=o&&(PLATFORM.VERSION=o)}if(BROWSER.METRO=!1,BROWSER.IE&&9<BROWSER.VERSION)try{new ActiveXObject("htmlfile");null,PLATFORM.WINTABLET=!1}catch(_){BROWSER.METRO=!0}PLATFORM.MOBILE=PLATFORM.IOS||PLATFORM.ANDROID||PLATFORM.WINTABLET,BROWSER.MOBILE=PLATFORM.MOBILE,BROWSER.PHONE=BROWSER.IPHONE,BROWSER.TABLET=BROWSER.IPAD||PLATFORM.WINTABLET}(),Array.prototype.top||(Array.prototype.top=function(){var t=this.length;return t?this[t-1]:undefined}),Array.prototype.max||(Array.prototype.max=function(){return Math.max.apply(Math,this)}),Array.prototype.min||(Array.prototype.min=function(){return Math.min.apply(Math,this)}),Array.prototype.sum||(Array.prototype.sum=function(){if("function"==typeof this.reduce)return this.reduce(function(t,e){return t+e},0);for(var t=0,e=this.length;e--;)t+=this[e];return t}),Array.prototype.shuffle||(Array.prototype.shuffle=function(){for(var t=[],e=this.length;e--;){var i=Math.round(Math.random()*e),s=this.splice(i,1)[0];t.push(s)}return t.reverse()}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=this.length,i=Number(arguments[1]);for(isNaN(i)?i=0:i<0?(i=Math.ceil(i),i+=e):i=Math.floor(i);i<e;i++)if(this[i]===t)return i;return-1}),Array.prototype.indexOfAtt=function(t,e){var i=this.length,s=Number(arguments[2]),n=arguments[3]||null;for(isNaN(s)?s=0:s<0?(s=Math.ceil(s),s+=i):s=Math.floor(s);s<i;s++){var o=null,r=Array.prototype.slice.call(arguments,3);if(n)for(var a=0,l=null;(l=r[a++])&&!(o=this[s][l]););else o=this[s];if(o[e]===t)return s}return-1},Array.prototype.indexOfAttCase=function(t,e){var i=this.length,s=Number(arguments[2]);for(isNaN(s)?s=0:s<0?(s=Math.ceil(s),s+=i):s=Math.floor(s);s<i;s++){var n=this[s][e];if(n&&n.toUpperCase()==t.toUpperCase())return s}return-1},Array.prototype.toRangedString=function(){var t=this.length;if(!t)return"";if(1==t)return this[0];for(var e=arguments[0]||"~",i=arguments[1]||";",s=[],n=0;n<t;n++){if("number"!=typeof this[n])return"";s[n]=this[n]}s.sort(function(t,e){return t-e});var o=[],r=s[0],a=[r];for(n=1;n<t;n++){var l=s[n];l!=r&&(l==r+1?a[1]=l:a.length&&(o.push(a.join(e)),a=[l]),r=l)}return a.length&&o.push(a.join(e)),o.join(i)},Array.prototype.unique=function(){for(var t=this.length,e={},i=[],s=0;s<t;s++){var n=this[s];e[n]||(e[n]=1,i.push(n))}return i},Array.prototype.toMap=function(){for(var t=arguments[0]||{},e=t.delimiter,i=t.multi_map_delimiter,s=t.fallback_value,n=t.trim_keys||!1,o=t.trim_values||!1,r={},a=this.length-1;0<=a;a--){var l="string"==typeof e?this[a].split(e):[this[a]],c="undefined"==typeof l[1]&&void 0!==s?s:l[1],_=l[0];n&&(_=_.trim()),o&&"string"==typeof c&&(c=c.trim()),r[_]="string"==typeof r[_]&&"string"==typeof i?r[_]+i+c:c}return r},Array.prototype.isArray=!0,Array.prototype.move||(Array.prototype.move=function(t,e){this.splice(e,0,this.splice(t,1)[0])}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),String.prototype.toMaxLength||(String.prototype.toMaxLength=function(t){if(this.length>t){var e=arguments[1]||"";return t-=e.length,this.substr(0,t)+e}return this}),String.prototype.isPrefix||(String.prototype.isPrefix=function(t){return t.length<=this.length&&this.substr(0,t.length)===t}),String.prototype.toFirstUpperCase||(String.prototype.toFirstUpperCase=function(){return this.charAt(0).toUpperCase()+this.substr(1).toLowerCase()}),String.prototype.rangedToArray=function(){if(""==this)return[];del1=arguments[0]||"~",del2=arguments[1]||";";for(var t=[],e=this.split(del2),i=0,s=e.length;i<s;i++){var n=e[i].split(del1);if(1==n.length)t.push(Number(n[0]));else for(var o=Number(n[0]),r=Number(n[1]);o<=r;)t.push(o++)}return t},String.prototype.html2txt=function(){return this.replace(/\n/g," ").replace(/<br>/gi,"\n").replace(/<li>/gi,"\n").replace(/<\/p>/gi,"\n").replace(/<\/h[0-9]>/gi,"\n").replace(/<[^>]*>/g,"").replace(/&nbsp;/gi," ").replace(/&lt;/gi,"<").replace(/&gt;/gi,">")},String.prototype.html2txtSimple=function(){return this.replace(/\n/g," ").replace(/<br>/gi,"\n").replace(/<li>/gi,"\n").replace(/<\/p>/gi,"\n").replace(/<\/h[0-9]>/gi,"\n").replace(/&nbsp;/gi," ")},String.prototype.decodeHTMLEntities=function(){return(new DOMParser).parseFromString("<!doctype html><body>"+this,"text/html").body.textContent},Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");function e(){}function i(){return n.apply(this instanceof e&&t?this:t,s.concat(Array.prototype.slice.call(arguments)))}var s=Array.prototype.slice.call(arguments,1),n=this;return e.prototype=this.prototype,i.prototype=new e,i}),window.JSON||(JSON={}),"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){var t=this.getUTCFullYear(),e=this.getUTCMonth()+1,i=this.getUTCDate(),s=this.getUTCHours(),n=this.getUTCMinutes(),o=this.getUTCSeconds();return e<10&&(e="0"+e),i<10&&(i="0"+i),s<10&&(s="0"+s),n<10&&(n="0"+n),o<10&&(o="0"+o),t+"-"+e+"-"+i+"T"+s+":"+n+":"+o+"Z"},String.prototype.toJSON=function(){return this.valueOf()},Number.prototype.toJSON=function(){return this.valueOf()},Boolean.prototype.toJSON=function(){return this.valueOf()}),"function"!=typeof JSON.stringify&&(JSON.stringify=function(t){function c(t){var e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return e.lastIndex=0,'"'+(e.test(t)?t.replace(e,function(t){return"string"==typeof i[t]?i[t]:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}):t)+'"'}var _=function(t,e){var i=e[t];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(t)),typeof i){case"string":return c(i);case"number":return isFinite(i)?i+"":"null";case"boolean":return i.toString();case"object":if(!i)return"null";var s=[],n="{",o="}";if("[object Array]"==Object.prototype.toString.apply(i)){n="[",o="]";for(var r=0,a=i.length;r<a;r++)s.push(_(r,i)||"null")}else for(var t in i)if(Object.hasOwnProperty.call(i,t)){var l=_(t,i);l&&s.push(c(t)+":"+l)}return n+s.join(",")+o;case"undefined":case"unknown":return}};return _("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text){return eval("("+text+")")}),window.PLATFORM&&PLATFORM.WINCE||'"null"'!==JSON.stringify(document.createElement("input").value)||function(){var e=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value").get;Object.defineProperty(HTMLInputElement.prototype,"value",{get:function(){var t=e.call(this);return""===t?"":t}})}();var WCT={Cleanup:function(){WCT.timeout&&WCT.timeout.Cleanup(),WCT.image_watcher&&WCT.image_watcher.Cleanup(),WCT.event&&(WCT.event.hotkey&&WCT.event.hotkey.Cleanup(),WCT.event.touches&&WCT.event.touches.Cleanup()),WCT.dnd&&WCT.dnd.Cleanup(),WCT.transition&&WCT.transition.Cleanup(),WCT.iframe&&WCT.iframe.Cleanup(),WCT.Fader&&WCT.Fader.Cleanup(),WCT.QrCode&&WCT.QrCode.Cleanup(),WCT.Tree&&WCT.Tree.Cleanup(),WCT.Select&&WCT.Select.Cleanup(),WCT.PicView&&WCT.PicView.Cleanup(),WCT.Propsheet&&WCT.Propsheet.Cleanup(),WCT.SplitterButton&&WCT.SplitterButton.Cleanup(),WCT.AdaptableClasses&&WCT.AdaptableClasses.Cleanup(),WCT.XHR&&WCT.XHR.Cleanup(),window.XHR&&XHR.Cleanup(),WCT.Controls&&WCT.Controls.Cleanup()},ExtendObject:function(t,e){for(var i in e)t[i]=e[i];return t}};WCT.ExtendObject(WCT,{$:window.$,$$:window.$$,$$2:window.$$2,BROWSER:window.BROWSER,PLATFORM:window.PLATFORM,GetEncodedURI:function(t){var e=t.match(/\?(.*)/);return e?t.replace(e[1],encodeURI(e[1])):t},GetEncodedSearchString:function(t){return t.replace(/#/g,"%23")},SetNodeText:function(t,e){t.innerHTML="",doc=arguments[2]||document,t.appendChild(doc.createTextNode(e))},IsImage:function(t){return!!t.match(/\.(gif|jpg|png|bmp|jpeg)$/i)},IsPng:function(t){return!!t.match(/\.(png)$/i)},IsHtml5VideoFormat:function(t){return!!t.match(/\.(mp4|ogg|webm)$/i)},IsHtml5AudioFormat:function(t){return!!t.match(/\.(mp3|ogg|wav)$/i)},IsArchive:function(t){return!!t.match(/\.(dkp)$/i)},isContent:function(t){var e=new RegExp((!!arguments[1]?"^":".")+"(pdf|html|htm|doc|docx|xls|xlsx|ppt|pptx)$","i");return!!t.match(e)},ClampBoolean:function(t){return"boolean"==typeof t?t:"number"==typeof t?1===t:"true"===t||"1"===t||"yes"===t||!(!arguments[1]||"false"===t||"0"===t||"no"===t)&&null},ReverseBoolean:function(t,e){return"BOOL_0_1"===e?t=t?"1":"0":"BOOL_YES_NO"===e?t=t?"yes":"no":"BOOL_TRUE_FALSE"===e&&(t=t?"true":"false"),t},CleanupObject:function(t){if("object"==typeof t&&t)if(t.isArray)for(var e=t.length-1;0<=e;e--)this.CleanupObject(t[e]),t[e]=null;else for(var e in t)this.CleanupObject(t[e]),delete t[e]},ReverseObject:function(t){var e={};for(var i in t)e[t[i]]=i;return e},ObjectToArray:function(t,e){var i=[];if((arguments[2]||{}).not_null)for(var s in t)null!=t[s]&&i.push(s+e+t[s]);else for(var s in t)i.push(s+e+t[s]);return i},DeepEquals:function(t,e){if(t===e)return!0;var i="object"==typeof t,s="object"==typeof e;if(!i&&!s||!t||!e)return t==e;if(i&&s){if(t.isArray!=e.isArray)return!1;if(t.isArray){var n=t.length;if(n!==e.length)return!1;for(var o=n-1;0<=o;o--)if(r=t[o],a=e[o],"object"!=typeof r&&"object"!=typeof a||!r||!a){if(r!=a)return!1}else if(!this.DeepEquals(r,a))return!1}else{var r,a;for(var o in t)if(r=t[o],a=e[o],"object"!=typeof r&&"object"!=typeof a||!r||!a){if(r!=a)return!1}else if(!this.DeepEquals(r,a))return!1;for(var o in e)if(!t.hasOwnProperty(o))return!1}return!0}return!1},GetEntityList:function(t,e){var i={group:null,book:null,project:null,cdoc:null,slide:null},s=".tree_path";if("undefined"!=typeof WEB_EDITOR&&WEB_EDITOR){var n="project",o=e.Get(n);o||(n="slide",o=e.Get(n)),s=n+"!"+o+":"+s}var r=t.GetS(s,null,e);if(r.response&&(r=r.response),!(r=(r=r&&r.paths||[])[0]||null))return i;for(var a=0,l=null,c=0;(l=r[a++])&&(null!=i[l.type]||(i[l.type]=l.uid,5!=++c)););return i},ExtendHeadByJS:function(t,e){var i=arguments[2]||window.top,s=arguments[3]||null,n=i.document,o=n.getElementsByTagName("head")[0],r=null;if(o){if((r=$$("script",n)).setAttribute("type","text/javascript"),s&&r.setAttribute("name",s),t)r.setAttribute("src",t),r.async=!0,r.defer=!0;else if(e)try{r.innerHTML=e}catch(a){r.text=e}o.appendChild(r)}return r},ExtendHeadByJSList:function(t,e){if(t.length){var i=e.document,s=i.getElementsByTagName("head")[0],n=$$("script",i);n.setAttribute("type","text/javascript"),n.setAttribute("src",t.shift()),n.async=!0,n.defer=!0,n.onload=function(){WCT.ExtendHeadByJSList(t,e)},s.appendChild(n)}},ExtendHeadByCSS:function(t,e){var i=arguments[2]||window.top,s=arguments[3]||null,n=i.document,o=n.getElementsByTagName("head")[0],r=null;if(o)if(t)n.createStyleSheet?(r=WCT.dom.CreateElementMSIE("style","text/css",null,n),o.appendChild(r),(a=n.styleSheets[n.styleSheets.length-1]).addImport(t)):((r=n.createElement("link")).type="text/css",r.rel="stylesheet",r.href=t,s&&r.setAttribute("name",s),o.appendChild(r));else if(e&&e.length){var a;if((r=n.createElement("style")).setAttribute("type","text/css"),s&&r.setAttribute("name",s),o.appendChild(r),(a=n.styleSheets[n.styleSheets.length-1]).insertRule)for(var l=e.length-1;0<=l;l--){var c=e[l].selector+"{"+e[l].rule+"}";a.insertRule(c,0)}else if(a.addRule)for(l=e.length-1;0<=l;l--)a.addRule(e[l].selector,e[l].rule,0)}return r},ArabicToRoman:function(t){if(0<t&&t<8e3){var e=Math.floor(t/1e3);t%=1e3;var i=Math.floor(t/100);t%=100;var s=Math.floor(t/10);return["","M","MM","MMM","MMMM","MMMMM","MMMMMM","MMMMMMM"][e]+["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM"][i]+["","X","XX","XXX","XL","L","LX","LXX","LXXX","XC"][s]+["","I","II","III","IV","V","VI","VII","VIII","IX"][t%=10]}return t+""},ArabicToLetters:function(t){for(var e="";27<=t;){var i=Math.floor(t/27);e+=String.fromCharCode(i+64),t%=26}return e+=String.fromCharCode(t+64)},GetTimeZoneOffset:function(){var t=(new Date).getTimezoneOffset().toString();return arguments[0]?t:"-"===t.substr(0,1)?t.substr(1):"-"+t},ConvertUTCToLocal:function(t){var e=WCT.GetTimeZoneOffset(arguments[1]),i=new Date("July 05, 2017 "+t.time),s=i.getDay();i.setMinutes(i.getMinutes()+parseInt(e));var n=i.getDay()-s,o=t.date,r=!1;if(n&&o){o.isArray||(r=!0,o=[o]);for(var a=0,l=o.length;a<l;a++){var c,_,d=o[a];if(~d.search("/")){var u=d.split("/");if(isNaN(parseInt(u[1])))continue;c=u[0],d=u[1],_=u[2]}else if(isNaN(parseInt(d)))continue;switch(t.pattern){case"weekly":0===(d=parseInt(d)+n)&&(d=7),8===d&&(d=1);break;case"monthly":d=parseInt(d)+n,c&&(0===d&&(d=7),8===d&&(d=1));break;case"yearly":if(_)d=parseInt(d)+n;else{var h=(new Date).getFullYear(),p=new Date(h,parseInt(c)-1,parseInt(d)+n);c=p.getMonth()+1,d=p.getDate()}}if(t.learnerCert){var f=new Date(c+" "+d+", "+_+" "+t.time);f.setMinutes(f.getMinutes()+parseInt(e));function m(t){return(t.toString().length<2?"0":"")+t}return t.date=[f.getFullYear(),m(f.getMonth()+1),m(f.getDate())].join("-"),void(t.time=[m(f.getHours()),m(f.getMinutes()),m(f.getSeconds())].join(":"))}o[a]=(c?c+"/":"")+d,_&&(o[a]+="/"+_)}}var b=i.getHours(),v=i.getMinutes();b<10&&(b="0"+b),v<10&&(v="0"+v),t.time=b+":"+v,o&&(t.date=r?o[0]:o)},ConvertLocalToUTC:function(t){WCT.ConvertUTCToLocal(t,!0)},TimestampToTimeString:function(t){var e=new Date(t),i=arguments[1];e=e[i?"toLocaleTimeString":"toGMTString"]().split(" "),i||(e=e.splice(4,1));var s=t%1e3;return e[0]+"."+s},IsLanguageRTL:function(t){if(!t)return!1;var e=t.substr(0,2);return"ar"==e||"he"==e},IsEmptyObject:function(t){if("object"!=typeof t||!t)return!0;if(window.Object&&Object.keys)return 0===Object.keys(t).length;for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},DecToHex:function(t){if("number"!=typeof t)return t;for(var e={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},i="";t;){var s=t%16;i+=e[s]||s,t=Math.floor(t/16)}return"#"+i.split("").reverse().join("")},ToRGBColor:function(t){return"number"!=typeof t?t:"rgb("+(255&t)+", "+((65280&t)>>8)+", "+((16711680&t)>>16)+")"},RgbToHex:function(t){if(t.match(/^rgb\(.+,.+,.+\)$/)){for(var e=t.substring(4,t.length-1).split(","),i=[],s=0,n=e.length;s<n;s++){var o=Number(e[s].trim());if(isNaN(o))return t;var r=o.toString(16);r=1==r.length?"0"+r:r,i.push(r)}return"#"+i.join("")}return t.match(/^#[0-9A-Fa-f]+/)?t.toUpperCase():t},HexToRgb:function(t){var e=[];3==(t=t.substr(1).split("")).length?e.push(t[0]+t[0],t[1]+t[1],t[2]+t[2]):6==t.length&&e.push(t[0]+t[1],t[2]+t[3],t[4]+t[5]);var i=3==e.length?{r:parseInt(e[0],16),g:parseInt(e[1],16),b:parseInt(e[2],16),a:1}:{r:0,g:0,b:0,a:1},s=arguments[1];return"number"==typeof s&&0<=s&&s<=1?"rgba("+i.r+","+i.g+","+i.b+","+s+")":"rgb("+i.r+","+i.g+","+i.b+")"},RemoveHTMLTags:function(t){return t.replace(/(<([^>]+)>)/gi,"")},HTML_WHITELIST:{caption:1,categories:1,content_categories:1,keywords:1,context_id:1,roles:1,foreign_uid:1,da_context_id:1,description:1,shortdesc:1,g_linktextpraxis:1,bubbletext:1,explanation_d:1,explanation_p:1,bookdescription:1,slidetitle:1,slidedescription:1,chaptertitle:1,chapterdescription:1,quiz_correct_answers:1,da_info_desc:1},REGEX_JS_PROTOCOL:/("|')\s*?javascript\s*?:.*?\1/gi,REGEX_JS_PROTOCOL_SIMPLE:/(javascript\s*?:)/gi,REPLACEMAP:[{reg:/&/g,rep:"&amp;"},{reg:/</g,rep:"&lt;"},{reg:/>/g,rep:"&gt;"},{reg:/"/g,rep:"&quot;"},{reg:/'/g,rep:"&#x27;"},{reg:/\//g,rep:"&#x2F;"}],EncodeTagBrackets:function(t){if(!t||"string"!=typeof t)return t;for(var e=WCT.REPLACEMAP.slice(1,3),i=0,s=null;s=e[i++];)t=t.replace(s.reg,s.rep);return t},CleanupHTMLString:function(t){if(!t||"string"!=typeof t)return t;var e=arguments[1]||"";if(e&&0<=e.indexOf(".")&&(e=e.split(".")[1]),!WCT.HTML_WHITELIST[e])for(var i=WCT.REPLACEMAP,s=0,n=null;n=i[s++];)t=t.replace(n.reg,n.rep);return t},PreventXSS:function(t){return t?(t=this.RemoveEventHandler(t,arguments[1]),t=this.RemoveJavascriptCalls(t),t=this.RemoveIFrameJavascriptProtocol(t)):t},RemoveJavascriptCalls:function(t){function d(t){if(!(t=t.trim()))return"";var e="",i=0,s=!1,n=t.indexOf("(");if(-1===n)return"";for(t=t.substr(n);!s;){var o=t.charAt(0);if(!o)break;"("===o?(i++,e+=o):")"===o?(e+=o,0===--i&&(s=!0)):e+=o,t=t.substr(1)}return e}var u=t.match(this.REGEX_JS_PROTOCOL),h=this.REGEX_JS_PROTOCOL_SIMPLE;return t.replace(/<[^>]+/g,function(t){if(u)for(c=0;c<u.length;c++){var e=u[c],i=e.charAt(0),s=e.substr(0,e.length-1).substr(1);s.search(h);var n=RegExp.$1,o=(s=s.substr(n.length)).indexOf("ctx.cfg_show");if(-1===o)s="javascript:void(0);";else{0!==o&&(s=s.substr(o));var r=s.match(/\(.*\)/),a=r?d(r[0]):null;s=a?"javascript:ctx.cfg_show"+a+";":""}t=t.replace(e,i+s+i)}else{var l=t.match(h);if(l)for(var c=0,_=null;_=l[c++];)t=t.replace(_,'""')}return t})},RemoveEventHandler:function(t){for(var e=new RegExp(arguments[1]?"son[error|load]\\w+=('[^']*'|\"[^\"]*\"|\\S*)":"son\\w+=('[^']*'|\"[^\"]*\"|\\S*)","gi");0<=t.search(e);)t=t.slice(0,t.search(e)+2)+"&#8205;"+t.slice(t.search(e)+2);return t.replace(/<[^>]+/g,function(t){return t.replace(e,"")})},RemoveIFrameJavascriptProtocol:function(t){var e=new RegExp(/javascript:/gi);return t.replace(/<iframe[^>]+/gi,function(t){return t.replace(e,"")})}}),function(){function o(t){for(var e,i=t.length,s=new Array(i),n=i-1;0<=n;n--)e=t[n],s[n]="object"==typeof e&&e?e.isArray?o(e):r(e):e;return s}function r(t){var e,i={};for(var s in t)e=t[s],i[s]="object"==typeof e&&e?e.isArray?o(e):r(e):e;return i}WCT.DeepCopy=function(t){if("object"!=typeof t||!t)return t;var e,i=arguments[1];return"object"!=typeof i&&(i=null),t.isArray?(e=o(t),i&&i.isArray&&(e=e.concat(i))):(e=r(t),i&&!i.isArray&&WCT.ExtendObject(e,i)),e},WCT.FullDeepCopy=function(t){var e=arguments[1]||(t.isArray?[]:{});for(var i in t)"object"==typeof t[i]&&null!==t[i]?(e[i]=e[i]||(t[i].isArray?[]:{}),WCT.FullDeepCopy(t[i],e[i])):e[i]=t[i];return e},WCT.indexOfAtt=function(t,e,i){for(var s=0,n=t.length;s<n;s++)if(t[s][e]===i)return s;return-1},WCT.indexOfAttCase=function(t,e,i){if(!i)return-1;for(var s=0,n=t.length;s<n;s++){var o=t[s][e];if(o&&o.toLowerCase()===i.toLowerCase())return s}return-1}}(),function(){var u="WCT_HL_N_ID";function h(t){for(var e=t.childNodes,i=[],s=0,n=null;n=e[s++];)n.nodeType==WCT.dom.ELEMENT_NODE?i.push(h(n)):n.nodeType==WCT.dom.TEXT_NODE&&i.push(n.nodeValue);return i.join("")}function i(t){var e=t.getAttribute(u);return null!=e?Number(e):-1}function d(t){var e=i(t);return 0<=e&&t.childNodes[e]||null}function p(t){var e=i(t);return t.setAttribute(u,++e),t.childNodes[e]}function f(t){do{for(var e=p(t);e;){if(e.nodeType==WCT.dom.TEXT_NODE)return t;var i=f(e);if(i)return i;e=p(t)}t=t.parentNode}while(t);return null}function m(t,e){var i=e.length;do{if(!(t=f(t)))return null;var s=d(t).nodeValue.length;if(i<s)return{d:t,o:i};i-=s}while(i);return(t=f(t))?{d:t,o:0}:null}function b(t,e,i,s){var n=d(t),o=null,r=n.nodeValue;if(e){var a=$$2(r.substr(0,e));return o=$$2(r.substr(e)),t.replaceChild(o,n),t.insertBefore(a,o),p(t),b(t,0,i,s)}var l=$$("span");l.className=s;var c=r.length,_=i.length;if(c<=_){if(l.appendChild($$2(r)),t.replaceChild(l,n),c<_)return(t=f(t))?b(t,0,i.substr(c),s):null}else o=$$2(r.substr(_)),l.appendChild($$2(r.substr(0,_))),t.replaceChild(o,n),t.insertBefore(l,o);return t}WCT.HighlightHtmlString=function(t,e,i){if(!t)return t;var s=$$("div");s.innerHTML=t;for(var n=new RegExp(e,"i"),o=h(s),r=o.search(n),a=e.length,l=[];0<=r;)l.push(o.substr(0,r)),l.push(o.substr(r,a)),r=(o=o.substr(r+a)).search(n);if(!l.length)return t;var c=s;do{var _=m(c,l.shift());if(!_)return t;if(!(c=b(_.d,_.o,l.shift(),i)))return t}while(l.length);return function d(t){for(var e=0,i=t.childNodes,s=null;s=i[e++];)s.nodeType==WCT.dom.ELEMENT_NODE&&(s.removeAttribute(u),d(s))}(s),s.innerHTML},WCT.HasHtmlString=function(t,e){var i=$$("div");i.innerHTML=t;var s=new RegExp(e,"i");return 0<=h(i).search(s)}}(),function(){var d={Duration:"number",IconID:"number",BOOL_0_1:"boolean",BOOL_YES_NO:"boolean",BOOL_TRUE_FALSE:"boolean",INTEGER:"number",IMAGE_WH:"image_wh",RELPOS:"relpos",RELPOS_ELEMREF:"relpos",RELPOS_RECT:"relpos",SIZE:"size",POSSIZE:"possize",POSITION:"position"};WCT.ReverseTypedValue=function(t,e){switch(d[e]||e){case"boolean":return WCT.ReverseBoolean(t,e);case"relpos":case"relpos_rect":case"relpos_elemref":if(!t)return t;var i={};return t.frame&&(i.frame=WCT.DeepCopy(t.frame)),t.element&&(i.element=WCT.DeepCopy(t.element)),t.XY&&(i.posElement=WCT.DeepCopy(t.XY)),t.XY2&&(i.rectElement=WCT.DeepCopy(t.XY2)),t.DocXY&&(i.posDocument=WCT.DeepCopy(t.DocXY)),t.DocXY2&&(i.rectDocument=WCT.DeepCopy(t.DocXY2)),t.offsetX&&(i.offsetX=t.offsetX),t.offsetY&&(i.offsetY=t.offsetY),i;default:return t}},WCT.ClampTypedValue=function(t,e){var i=Context.Get("macroset"),s=e&&(d[e]||e).toLowerCase();switch(s){case"boolean":return WCT.ClampBoolean(t);case"duration":case"number":var n=parseFloat(t);return isNaN(n)?null:"duration"===s?Math.abs(n):n;case"image_wh":return{id:(t=t||{}).id||"",w:Number(t.w)||0,h:Number(t.h)||0};case"size":return null!=(t=t||{}).x||null!=t.y?{x:Number(t.x)||0,y:Number(t.y)||0}:{width:Number(t.width)||0,height:Number(t.height)||0};case"possize":return null!=(t=t||{}).x||null!=t.y||null!=t.cx||null!=t.cy?{x:Number(t.x)||0,y:Number(t.y)||0,cx:Number(t.cx)||0,cy:Number(t.cy)||0}:"standard"===i?{left:Number(t.left)||0,top:Number(t.top)||0,width:Number(t.width)||0,height:Number(t.height)||0}:{left:Number(t.left)||0,top:Number(t.top)||0,bottom:Number(t.bottom)||0,right:Number(t.right)||0};case"position":return null!=(t=t||{}).x||null!=t.y?{x:Number(t.x)||0,y:Number(t.y)||0}:{left:Number(t.left)||0,top:Number(t.top)||0};case"relpos":case"relpos_rect":case"relpos_elemref":var o={};(t=t?WCT.DeepCopy(t):{}).elem||(t.elem={id:""}),t.XY||(t.XY={x:0,y:0}),t.XY2||(t.XY2={x:0,y:0}),t.DocXY||(t.DocXY={x:0,y:0});var r="string"==typeof t.FP?t.FP:"";o.FP=r,(r=t.elem||null)?((r=WCT.DeepCopy(r)).idx=Number(r.idx)||0,r.subidx=Number(r.subidx)||0,o.elem=r):o.elem="";for(var a="RELPOS"!==e.toUpperCase()?["XY","XY2"]:["XY","DocXY"],l=0;l<2;l++){var c=a[l],_="XY2"===c?1:0;(r=t[c]||null)&&(o[c]={x:Number(r.x)||_,y:Number(r.y)||_})}return(r=t.Off||null)&&(o.Off={x:Number(r.x)||0,y:Number(r.y)||0}),t.frame&&(o.frame=WCT.DeepCopy(t.frame),o.FP=o.frame.path),(r=t.element)&&((r=WCT.DeepCopy(r)).elementIndex=Number(r.elementIndex)||0,r.subElementIndex=Number(r.subElementIndex)||0,o.element=r),t.posDocument&&(o.DocXY=WCT.DeepCopy(t.posDocument)),t.posElement&&(o.XY=WCT.DeepCopy(t.posElement)),t.rectElement&&(o.XY2=WCT.DeepCopy(t.rectElement)),t.rectDocument&&(o.DocXY2=WCT.DeepCopy(t.rectDocument)),"undefined"!=typeof t.offsetX&&(o.offsetX=Number(t.offsetX)||0),"undefined"!=typeof t.offsetY&&(o.offsetY=Number(t.offsetY)||0),o;case"debug":Log("WCT.ClampTypedValue: "+e)}return t}}(),function(){WCT.uid={Generate:function u(){for(var t="number"==typeof arguments[0]?arguments[0]:l,e="string"==typeof arguments[1]?arguments[1]:c,i=arguments[3]?_:d,s=i.length,n=[],o=t;0<o--;){var r=Math.floor(Math.random()*s);n.push(i[r])}var a=e+n.join("");return arguments[2]?a.toUpperCase():a},CreateUniqueStringMap:function b(t){var e={},i=0,s={},n=null;for(var o in t)s[n=o]=o.length-1,i++;if(1==i)return e[n]=n.charAt(0),e;var r=0;for(;i;){var a={},l={},c=!0;for(var o in t){var _=o.charAt(r);s[o]==r&&(c=!1),a[_]||(a[_]=0),l[_]||(l[_]=[]),a[_]++,l[_].push(o)}r++;var d=!0;for(var _ in a){if(d&&c&&a[_]==i){0;break}if(1==a[_]){o=l[_][0];e[o]=""!=_?_:o,delete t[o],i--,d=!1}else{var u={},h={},p=0;for(o=null;o=l[_][p];p++){""==(f=o.substr(r))?(e[o]=_,delete t[o],i--):(u[f]=o,h[f]=1)}for(var f in h=this.CreateUniqueStringMap(h)){o=u[f];var m=_+h[f];e[o]=m,delete t[o],i--}d=!1}}}return e}};var l=16,c="",_=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","a","b","c","d","e","f"],d=_.concat(["G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"])}(),WCT.timeout={d_:[],i_:null,n_:null,f_:[],r_:!0,ios_scroll_callback_:!1,Cleanup:function(){this.i_&&clearTimeout(this.i_),this.i_=null,this.n_=null,this.ios_scroll_callback_&&(this.ios_scroll_callback_=!1,window.removeEventListener("scroll",WCT.timeout.callback_)),this.d_=[],this.f_=[],this.r_=!0},Set:function(t,e){var i=WCT.uid.Generate(24,"TIME_"),s=(new Date).getTime();return this.d_.push({id:i,cb:t,scope:arguments[2],args:arguments[3],start:s,end:s+e,dur:e,r:arguments[4]}),this.start_(s,e),i},Clear:function(t){var e=this.d_.indexOfAtt(t,"id");0<=e&&this.d_.splice(e,1)},start_:function(t,e){e<=0&&(e=1),PLATFORM.IOS&&!this.ios_scroll_callback_&&(this.ios_scroll_callback_=!0,window.addEventListener("scroll",WCT.timeout.ios_scoll_));var i=t+e;this.i_?i<this.n_&&(clearTimeout(this.i_),this.i_=setTimeout(WCT.timeout.callback_,e),this.n_=i):(this.i_=setTimeout(WCT.timeout.callback_,e),this.n_=i)},callback_:function(){WCT.timeout.i_=null;for(var t=(new Date).getTime(),e=null,i=WCT.timeout.f_,s=0,n=null;n=WCT.timeout.d_[s];s++)n.end<=t?(n.r?(n.end+=n.dur,(!e||n.end<e)&&(e=n.end)):WCT.timeout.d_.splice(s--,1),i.push(n)):(!e||n.end<e)&&(e=n.end);WCT.timeout.r_&&i.length&&(WCT.timeout.r_=!1,setTimeout(WCT.timeout.fire_,1)),e&&(t=(new Date).getTime(),WCT.timeout.start_(t,e-t))},fire_:function(){var t=WCT.timeout.f_;if(t.length){for(;t.length;){var e=t.shift();if(e&&"function"==typeof e.cb&&e.cb){var i=typeof e.scope,s="object"!=i&&"function"!=i||!e.scope?null:e.scope;e.cb.apply(s,e.args||[])}}WCT.timeout.r_=!0}else WCT.timeout.r_=!0},ios_scroll_:function(){WCT.timeout.i_&&clearTimeout(WCT.timeout.i_),WCT.timeout.g_&&clearTimeout(WCT.timeout.g_),WCT.timeout.i_=null,WCT.timeout.g_=null,WCT.timeout.r_=!0,WCT.timeout.callback_()}},WCT.SetTimeout=function(t,e){return WCT.timeout.Set(t,e,arguments[2],arguments[3],!1)},WCT.SetInterval=function(t,e){return WCT.timeout.Set(t,e,arguments[2],arguments[3],!0)},WCT.ClearTimeout=function(t){WCT.timeout.Clear(t)},WCT.ClearInterval=function(t){WCT.timeout.Clear(t)},WCT.language={LANGUAGES:["","ar-SA","bg","ca","zh-TW","cs","da","de-DE","el","en-US","es-ES","fi","fr-FR","he","hu","is","it-IT","ja","ko","nl-NL","nb","pl","pt-BR","ro","ru","hr-HR","sk","sq","sv-SE","th","tr","ur","id","uk","be","sl","et","lv","lt","fa","vi","hy","az-AZ","eu","mk","tn","xh","zu","af","ka","fo","hi","mt","se-NO","ms-MY","kk","ky","sw","uz-UZ","tt","bn","pa","gu","ta","te","kn","ml","mr","sa","mn","cy","gl","kok","syr","div","qu-BO","ns","mi","ar-IQ","zh-CN","de-CH","en-GB","es-MX","fr-BE","it-CH","nl-BE","nn","pt-PT","sr-SP","sv-FI","az-AZ","se-SE","ms-BN","uz-UZ","qu-EC","ar-EG","zh-HK","de-AT","en-AU","es-ES","fr-CA","sr-SP","se-FI","qu-PE","ar-LY","zh-SG","de-LU","en-CA","es-GT","fr-CH","hr-BA","se-NO","ar-DZ","zh-MO","de-LI","en-NZ","es-CR","fr-LU","bs","se-SE","ar-MA","en-IE","es-PA","fr-MC","sr-BA","se-NO","ar-TN","en-ZA","es-DO","sr-BA","se-SE","ar-OM","en-JM","es-VE","se-FI","ar-YE","en-CB","es-CO","se-FI","ar-SY","en-BZ","es-PE","ar-JO","en-TT","es-AR","ar-LB","en-ZW","es-EC","ar-KW","en-PH","es-CL","ar-AE","es-UY","ar-BH","es-PY","ar-QA","es-BO","es-SV","es-HN","es-NI","es-PR","mul"],DEFAULT:"en-US",MANAGER_DEFAULT_DATE_FORMAT:"yyyy/MM/dd HH:mm:ss",FromBrowser:function(){var t=arguments[0],e=navigator.language||navigator.browserLanguage||t,i=e.indexOf("-");0<=i&&(e=e.substr(0,i)+"-"+e.substr(i+1).toUpperCase());for(var s=this.LANGUAGES,n=0,o=s.length;n<o;n++){if(s[n]==e)return e;if(s[n].isPrefix(e))return s[n]}return this.DEFAULT},getLangCodeForFormat:function(t){for(var e in LANGUAGES)if(LANGUAGES.hasOwnProperty(e)){var i=LANGUAGES[e];if(i.format.date+" "+i.format.time===t)return e}return null}},WCT.geometry={IntersectRect:function(t,e){return e.x<=t.x+t.w&&e.x+e.w>=t.x&&e.y<=t.y+t.h&&e.y+e.h>=t.y},IncludesRect:function(t,e){return t.x<=e.x&&t.x+t.w>=e.x+e.w&&t.y<=e.y&&t.y+t.h>=e.y+e.h},ExciseRect:function(t,e){if(!this.IntersectRect(t,e))return[t];var i={x:Math.max(t.x,e.x),y:Math.max(t.y,e.y)};i.w=Math.min(t.x+t.w,e.x+e.w)-i.x,i.h=Math.min(t.y+t.h,e.y+e.h)-i.y;var s={x:t.x,y:t.y,w:t.w,h:i.y-t.y},n={x:t.x,y:i.y,w:i.x-t.x,h:i.h},o={x:i.x+i.w,y:i.y,w:t.x+t.w-i.x-i.w,h:i.h},r={x:t.x,y:i.y+i.h,w:t.w,h:t.y+t.h-i.y-i.h},a=n.w*n.h,l=o.w*o.h,c=r.w*r.h,_=[];return 0<s.w*s.h&&_.push(s),0<a&&_.push(n),0<l&&_.push(o),0<c&&_.push(r),_},ExciseRects:function(t,e){for(var i=[t];e.length&&i.length;){for(var s=e.shift(),n=[],o=i.length-1;0<=o;o--)n=n.concat(this.ExciseRect(i[o],s));i=n}return i},GetBiggestRect:function(t){for(var e=[],i=0,s=null;s=t[i];i++)e.push(s.w*s.h);if(e.length){var n=e.max();return t[e.indexOf(n)]}return null},CombineRects:function(t){for(var e=[],i=[],s=[],n=[],o=0,r=null;r=t[o++];)e.push(r.x),i.push(r.y),s.push(r.x+r.w),n.push(r.y+r.h);return e.length?{x:e=Math.min.apply(null,e),y:i=Math.min.apply(null,i),w:(s=Math.max.apply(null,s))-e,h:(n=Math.max.apply(null,n))-i}:null}},WCT.geometry.Point=function(t,e){this.x=t,this.y=e},WCT.geometry.Point.CreatePoints=function(){for(var t=[],e=0,i=arguments.length;e<i;)t.push(new WCT.geometry.Point(arguments[e++],arguments[e++]));return t},WCT.geometry.Point.prototype={Copy:function(){return new WCT.geometry.Point(this.x,this.y)},SubstractPoint:function(t){return new WCT.geometry.Point(this.x-t.x,this.y-t.y)},Round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},Len:function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},Move:function(t,e){return this.x+=t,this.y+=e,this},Scale:function(t,e){return this.x*=t,this.y*=e,this},Rotate:function(t,e){var i=this.x;return this.x=t*i-e*this.y,this.y=e*i+t*this.y,this},ToLen:function(t){if(0==t)this.x=0,this.y=0;else{var e=t/this.Len();this.x*=e,this.y*=e}return this},Draw:function(t){t.lineTo(this.x,this.y)}},WCT.geometry.Edge=function(t,e,i,s,n){this.x1=t,this.y1=e,this.x2=i,this.y2=s,this.r=n},WCT.geometry.Edge.FromPoints=function(t,e,i){return new WCT.geometry.Edge(t.x,t.y,e.x,e.y,i)},WCT.geometry.Edge.prototype={Copy:function(){return new WCT.geometry.Edge(this.x1,this.y1,this.x2,this.y2,this.r)},GetPoints:function(){return{x:[this.x1,this.x2],y:[this.y1,this.y2]}},Move:function(t,e){return this.x1+=t,this.y1+=e,this.x2+=t,this.y2+=e,this},Round:function(){return this.x1=Math.round(this.x1),this.y1=Math.round(this.y1),this.x2=Math.round(this.x2),this.y2=Math.round(this.y2),this.r=Math.round(this.r),this},Rotate:function(t,e){var i=this.x1,s=this.x2;return this.x1=t*i-e*this.y1,this.y1=e*i+t*this.y1,this.x2=t*s-e*this.y2,this.y2=e*s+t*this.y2,this},Scale:function(t,e,i){return this.x1*=t,this.y1*=e,this.x2*=t,this.y2*=e,this.r*=i,this},Draw:function(t){BROWSER.IE&&BROWSER.VERSION<9||arguments[2]?"quadratic"==arguments[1]?t.quadraticCurveTo(this.x1,this.y1,this.x2,this.y2):t.bezierCurveTo(this.x1,this.y1,this.x1,this.y1,this.x2,this.y2):t.arcTo(this.x1,this.y1,this.x2,this.y2,this.r)}},WCT.geometry.Circle=function(t,e,i){this.x=t,this.y=e,this.r=i},WCT.geometry.Circle.FromObject=function(t){return new WCT.geometry.Circle(t.x,t.y,t.r)},WCT.geometry.Circle.prototype={Move:function(t,e){return this.x+=t,this.y+=e,this},HasPoint:function(t,e){return Math.pow(t-this.x,2)+Math.pow(e-this.y,2)<=Math.pow(this.r,2)}},WCT.geometry.Ellipse=function(t,e,i,s){this.x=t,this.y=e,this.rx=i,this.ry=s;var n=Math.max(0,Math.min(i,s)),o=i/n,r=s/n;o==r&&BROWSER.IE&&BROWSER.VERSION<=9&&(o-=.02,r-=.02),this.r=n,this.sx=o,this.sy=r},WCT.geometry.Ellipse.prototype={Copy:function(){return new WCT.geometry.Ellipse(this.x,this.y,this.rx,this.ry)},Move:function(t,e){return this.x+=t,this.y+=e,this},HasPoint:function(t,e){return Math.pow((t-this.x)/this.rx,2)+Math.pow((e-this.y)/this.ry,2)<=1},CalcPaths:function(){var t=arguments[0]||this.sx,e=arguments[1]||this.sy,i=this.r,s=new WCT.geometry.Point(this.x/t,this.y/e),n=s.Copy().Move(-i,-i),o=s.Copy().Move(i,-i),r=s.Copy().Move(i,i),a=s.Copy().Move(-i,i),l=s.Copy().Move(-i,0),c=s.Copy().Move(0,-i),_=s.Copy().Move(i,0),d=s.Copy().Move(0,i),u=WCT.geometry.Edge;return{lt:u.FromPoints(n,c,i),rt:u.FromPoints(o,_,i),rb:u.FromPoints(r,d,i),lb:u.FromPoints(a,l,i),ilb:u.FromPoints(a,d,i),irb:u.FromPoints(r,_,i),irt:u.FromPoints(o,c,i),ilt:u.FromPoints(n,l,i)}},Draw:function(t,e){var i=arguments[3];t.save(),t.scale(this.sx,this.sy),t.beginPath(),i&&(t[e+"Style"]=i);var s=this.CalcPaths();t.moveTo(s.lb.x2,s.lb.y2),s.lt.Draw(t,"quadratic"),s.rt.Draw(t,"quadratic"),s.rb.Draw(t,"quadratic"),s.lb.Draw(t,"quadratic");var n=arguments[2];n&&(s=n.CalcPaths(this.sx,this.sy),t.moveTo(s.ilt.x2,s.ilt.y2),s.ilb.Draw(t,"quadratic"),s.irb.Draw(t,"quadratic"),s.irt.Draw(t,"quadratic"),s.ilt.Draw(t,"quadratic")),t[e](),t.closePath(),t.restore()}},WCT.geometry.Vector=function(t,e){this.o=t,this.r=e},WCT.geometry.Vector.FromPoints=function(t,e){var i=new WCT.geometry.Point(e.x-t.x,e.y-t.y);return i.ToLen(1),new WCT.geometry.Vector(t,i)},WCT.geometry.Vector.prototype={Intersect:function(t){var e=this.Cross(t);return this.Coordinates(e.t)},Normal:function(t){if(0==t)return this;var e=-1,i=1,s=this.r.Len();0!=s&&(e=-this.r.y/s,i=this.r.x/s);var n=new WCT.geometry.Point(this.o.x+e*t,this.o.y+i*t),o=this.r.Copy();return new WCT.geometry.Vector(n,o)},Cross:function(t){var e=this.o,i=this.r,s=t.o,n=t.r,o=0,r=0;return i.y*n.x!=0||i.x*n.y!=0?o=(e.x*n.y+s.y*n.x-s.x*n.y-e.y*n.x)/(i.y*n.x-i.x*n.y):0!=n.x&&(r=(e.x-s.x+o*i.x)/n.x),!isFinite(o)||isNaN(o)?o=0:isFinite(r)&&!isNaN(r)||(r=0),{t:o,s:r}},Coordinates:function(t){var e=this.o.x+this.r.x*t,i=this.o.y+this.r.y*t;return new WCT.geometry.Point(e,i)}},WCT.geometry.RoundedRect=function(t,e,i,s,n,o,r,a){this.p1=t,this.e1=e,this.p2=i,this.e2=s,this.p3=n,this.e3=o,this.p4=r,this.e4=a},WCT.ExtendObject(WCT.geometry.RoundedRect,{FromRect:function(t,e,i){var s,n;n=5==arguments.length?(s=arguments[3],arguments[4]):s=i;var o=WCT.geometry,r=new o.Point(e.x-s,t.y),a=new o.Edge(e.x,t.y,e.x,t.y+n,i),l=new o.Point(e.x,e.y-n),c=new o.Edge(e.x,e.y,e.x-s,e.y,i),_=new o.Point(t.x+s,e.y),d=new o.Edge(t.x,e.y,t.x,e.y-n,i),u=new o.Point(t.x,t.y+n),h=new o.Edge(t.x,t.y,t.x+s,t.y,i);return new o.RoundedRect(r,a,l,c,_,d,u,h)},FromInvertedRect:function(t,e,i){var s,n;n=5==arguments.length?(s=arguments[3],arguments[4]):s=i;var o=WCT.geometry,r=new o.Point(t.x+s,t.y),a=new o.Edge(t.x,t.y,t.x,t.y+n,i),l=new o.Point(t.x,e.y-n),c=new o.Edge(t.x,e.y,t.x+s,e.y,i),_=new o.Point(e.x-s,e.y),d=new o.Edge(e.x,e.y,e.x,e.y-n,i),u=new o.Point(e.x,t.y+n),h=new o.Edge(e.x,t.y,e.x-s,t.y,i);return new o.RoundedRect(r,a,l,c,_,d,u,h)}}),WCT.geometry.RoundedRect.prototype={Copy:function(){return new WCT.geometry.RoundedRect(this.p1.Copy(),this.e1.Copy(),this.p2.Copy(),this.e2.Copy(),this.p3.Copy(),this.e3.Copy(),this.p4.Copy(),this.e4.Copy())},GetPoints:function(){var t=this.e1.GetPoints(),e=this.e2.GetPoints(),i=this.e3.GetPoints(),s=this.e4.GetPoints(),n=t.x.concat(e.x.concat(i.x.concat(s.x)));n.push(this.p1.x,this.p2.x,this.p3.x,this.p4.x);var o=t.y.concat(e.y.concat(i.y.concat(s.y)));return o.push(this.p1.y,this.p2.y,this.p3.y,this.p4.y),{x:n,y:o}},GetEdges:function(){return{lt:{x:this.e4.x1,y:this.e4.y1,r:this.e4.r},rt:{x:this.e1.x1,y:this.e1.y1,r:this.e1.r},rb:{x:this.e2.x1,y:this.e2.y1,r:this.e2.r},lb:{x:this.e3.x1,y:this.e3.y1,r:this.e3.r}}},Move:function(t,e){return this.p1.Move(t,e),this.p2.Move(t,e),this.p3.Move(t,e),this.p4.Move(t,e),this.e1.Move(t,e),this.e2.Move(t,e),this.e3.Move(t,e),this.e4.Move(t,e),this},Scale:function(t,e,i){return this.p1.Scale(t,e),this.p2.Scale(t,e),this.p3.Scale(t,e),this.p4.Scale(t,e),this.e1.Scale(t,e,i),this.e2.Scale(t,e,i),this.e3.Scale(t,e,i),this.e4.Scale(t,e,i),this},Rotate:function(t,e){return this.p1.Rotate(t,e),this.p2.Rotate(t,e),this.p3.Rotate(t,e),this.p4.Rotate(t,e),this.e1.Rotate(t,e),this.e2.Rotate(t,e),this.e3.Rotate(t,e),this.e4.Rotate(t,e),this},Draw:function(t,e){var i=arguments[3];t.save(),t.beginPath(),i&&(t[e+"Style"]=i);for(var s=[this,arguments[2]],n=0,o=null;o=s[n++];){var r=o.p1.Copy().Round();t.moveTo(r.x,r.y),r.Draw(t),o.e1.Copy().Round().Draw(t,"quadratic",!0),o.p2.Copy().Round().Draw(t),o.e2.Copy().Round().Draw(t,"quadratic",!0),o.p3.Copy().Round().Draw(t),o.e3.Copy().Round().Draw(t,"quadratic",!0),o.p4.Copy().Round().Draw(t),o.e4.Copy().Round().Draw(t,"quadratic",!0)}t[e](),t.closePath(),t.restore()}},WCT.cookie={Get:function(t){for(var e=arguments[1]||window,i=t+"=",s=i.length,n=e.document.cookie.split(";"),o=n.length-1;0<=o;o--){var r=n[o].trim();if(r.substr(0,s)==i)return decodeURIComponent(r.substr(s))}return null},Set:function(t,e){var i=Number(arguments[2]),s=arguments[3]||window,n="; name=dgo; path=/; ";if(isNaN(i)&&(i=365),-1==i)n+="expires=Thu, 01-Jan-70 00:00:01 GMT; ";else{var o=new Date;o.setTime(o.getTime()+864e5*i),n+="expires="+o.toGMTString()+"; "}s.document.cookie=t+"="+encodeURIComponent(e)+n},Remove:function(t){this.Set(t,"",-1,arguments[1])}},WCT.address=function(t){this.is_external=!1,this.is_file=!1,this.src="",this.class_id=null,this.local_id=null,this.sub_class_id=null,this.sub_local_id=null,this.sub_path=null,"string"==typeof t?this.FromString(t):t&&"object"==typeof t&&this.CopyObject(t)},WCT.address.IsExternal=function(t){return!("/"!=t.charAt(0)&&!t.match(/^\\\\/)&&!t.match(/^(.|https?|ftps?|notes|file|tel|adt|mailto|javascript):/))},WCT.address.IsFile=function(t){return 0<=t.split(":").top().indexOf(".")},WCT.address.AddDownloadFlag=function(t){var e=t.split("."),i=1<e.length?e.top().toLowerCase():"";return-1===["html","htm","pdf"].indexOf(i)},WCT.address.prototype={CopyObject:function(t){this.is_external=t.is_external||!1,this.is_file=t.is_file||!1,this.src=t.src||"",this.class_id=t.class_id||null,this.local_id=t.local_id||null,this.sub_class_id=t.sub_class_id||null,this.sub_local_id=t.sub_local_id||null,this.sub_path=t.sub_path||null},FromString:function(t){if(this.src=t,WCT.address.IsExternal(t))this.is_external=!0;else{var e=t.split(":"),i=e.length,s=e.top();if(this.is_file=0<=s.indexOf("."),this.sub_path=s,1==i)2==(e=s.split("!")).length&&(this.class_id=e[0],this.local_id=e[1],this.sub_path=null);else if(2<=i){var n=e[0].split("!"),o=n.length;if(1==o){var r=WCT.context.TCLASS_SHORTCUTS,a=e[0];for(var l in this.class_id=a,r)if(a.isPrefix(r[l])){this.class_id=l,this.local_id=a;break}}else 2==o&&(this.class_id=n[0],this.local_id=n[1]);if(3==i){var c=e[1].split("!"),_=c.length;0<_&&(this.sub_class_id=c[0],2==_&&(this.sub_local_id=c[1]))}}if("macro"==this.class_id)this.class_id="project",this.sub_class_id="macro",this.sub_local_id=this.local_id,this.local_id=null;else if("book"===this.class_id&&this.sub_path&&0===this.sub_path.search("slide!"))this.sub_class_id="slide",this.sub_local_id=this.sub_path.replace("slide!",""),this.sub_path=null;else if("project"===this.class_id&&this.sub_path&&-1!==this.sub_path.search("#")){var d=this.sub_path.split("#");this.sub_path=d[0],this.sub_local_id=d[1]}}},AsUrl:function(){if(this.is_external)return this.src;var t=[];return this.class_id&&(t.push(this.class_id),this.local_id&&t.push(this.local_id)),this.sub_class_id&&(t.push(this.sub_class_id),this.sub_local_id&&t.push(this.sub_local_id)),this.sub_path&&t.push(this.sub_path),"/"+t.join("/")},AsString:function(){if(this.is_external)return this.src;var t="";return this.class_id&&(t+=this.class_id,this.local_id&&(t+="!"+this.local_id)),this.sub_class_id&&(t.length&&(t+=":"),t+=this.sub_class_id,this.sub_local_id&&(t+="!"+this.sub_local_id)),this.sub_path&&(t.length&&(t+=":"),t+=this.sub_path),!this.sub_class_id&&"project"===this.class_id&&this.sub_local_id&&(t+="#"+this.sub_local_id),t},AsObject:function(){if(this.is_external)return null;var t={tclass:this.class_id,uid:this.local_id};return arguments[0]&&arguments[0][this.sub_path]?t.mode=this.sub_path:this.sub_path&&(t.fileName=this.sub_path),t}},WCT.context=function(){this.atts_={},this.sbase_="",this.base_="",this.protocol_="file",this.this_="",this.st_="/",this.features_=null;var t=arguments[0];if(t&&"object"==typeof t){for(var e in t.atts_)this.atts_[e]=t.atts_[e];this.sbase_=t.sbase_,this.base_=t.base_,this.protocol_=t.protocol_,this.this_=t.this_}else{var i=document.getElementsByTagName("BASE");i&&i[0]&&(this.base_=i[0].href,this.check_base_(),this.sbase_=this.base_)}},WCT.ExtendObject(WCT.context,{PROTOCOLS:{http:!0,https:!0,res:!0,file:!0},TCLASS_SHORTCUTS:{slide:"SL_",project:"PR_",group:"GR_",book:"BO_",cdoc:"CD_",da:"DA_",media:"M_"},RemoveImgIds:function(t){var e=$$("div");e.style.display="none",e.style.visibility="hidden",e.innerHTML=t.replace(/<img([^>]*) src=/gi,"<img$1 data-dgo-src=");for(var i=e.getElementsByTagName("img"),s=0,n=null;n=i[s++];)n.id="";return e.innerHTML.replace(/<img([^>]*)  data-dgo-src=/gi,"<img$1 src=")}}),WCT.context.prototype={Destructor:function(){return this.atts_=null},Stringify:function(){return JSON.stringify({atts:this.atts_,sbase:this.sbase_,base:this.base_,proto:this.protocol_,scope:this.this_,st:this.st_})},Parse:function(t){t=JSON.parse(t),this.atts_=t.atts,this.sbase_=t.sbase,this.base_=t.base,this.protocol_=t.proto,this.this_=t.scope,this.st_=t.st},SetBase:function(t){var e=t.split(":")[0];this.protocol_=WCT.context.PROTOCOLS[e]?e:"file",t=t.replace(/\/$/,""),this.base_=t;var i=WCT.context.TCLASS_SHORTCUTS;for(var s in i)if(i.hasOwnProperty(s)){var n=new RegExp("[/|\\\\]+"+s+"[/|\\\\]+"+i[s]),o=t.search(n);if(0<o){this.base_=t.substr(0,o),this.this_=s,n=new RegExp("[/|\\\\]+.*$"),t=t.substr(o+2+s.length).replace(n,""),this.atts_[s]=t;break}}this.check_base_(),this.sbase_=this.base_},SetServerBase:function(t){var e=this.base_;e&&(t=t.replace(/\/$/,"").replace(/[\/\\]/g,this.st_),e.indexOf(t)||(this.sbase_=t))},SetSlashType:function(t){this.st_=t},GetSlashType:function(){return this.st_},Get:function(t){return this.atts_?this.atts_[t]:null},GetScope:function(){return this.this_},GetBase:function(){return this.base_},GetServerBase:function(){return this.sbase_},GetProtocol:function(){return this.protocol_},SetScope:function(t){this.this_=t},Set:function(t,e){this.atts_[t]=e},SetFeature:function(t){this.features_=t},HasFeature:function(t){return-1<this.features_.indexOf(t)},Resolve:function(t){if(!t)return t;var e=this.atts_;for(var i in e){var s=new RegExp("^"+i+":","g"),n=0<=e[i].indexOf("!")?e[i]:i+"!"+e[i];t=t.replace(s,n+":")}return t},Expand:function(t){var e=new WCT.address(t);if(e.is_external)return e;e.class_id||("macro"==this.this_||"tourstop"==this.this_?(e.class_id="project",e.sub_class_id||(e.sub_class_id=this.this_)):e.class_id=this.this_);var i=this.atts_;if(!e.local_id&&i[e.class_id])if(0<=i[e.class_id].indexOf("!")){var s=i[e.class_id].split("!");e.class_id=s[0],e.local_id=s[1]}else e.local_id=i[e.class_id];return!e.sub_local_id&&i[e.sub_class_id]&&(e.sub_local_id=i[e.sub_class_id]),e},ToEntityPath:function(){var t=this.Expand("");t.sub_path=arguments[0]||"";var e=this;return t.sub_class_id&&(e=new WCT.context(this)).SetScope(t.class_id),t.class_id="",{entity_path:e.ToAbsPath(""),sub_path:e.ToRelPath(t.AsString())}},ToRelPath:function(t){t=t.replace(/:\//g,"**/"),t=this.Resolve(t).replace(/:\/([^\/]+)/g,"/$1").replace(/:\\([^\\]+)/g,"/$1").replace(/:([^\/]+)/g,"/$1").replace(/:([^\\]+)/g,"/$1").replace(/!/g,"/");var e=this.st_;return-1!=t.indexOf(":")&&(t=".."+e+".."+e+t),t=t.replace(/\*\*\//g,":/").replace(/[\/\\]/g,e)},ToAbsPath:function(t){var e=!1;t.indexOf("mgr:")||(t=t.substr(4),e=!0);var i=new WCT.address(t.replace(/\\/g,"/"));if(!e&&i.is_external)return t;var s=i;if(!e)if(arguments[1]){var n=WCT.DeepCopy(arguments[1]),o=this.atts_;for(var r in o)null==n.Get(r)&&n.Set(r,o[r]);s=n.Expand(i)}else s=this.Expand(i);var a=this.st_,l=s.AsUrl().replace(/[\/\\]/g,a);return e?(new RegExp("^"+a+"(ou|group|user)").exec(l)&&(l=a+"!"+l),this.sbase_+l):this.base_+this.escape_(l)},ResolveHtmlString:function(t,e){if(!t)return t;var i=$$("div");i.style.display="none",i.style.visibility="hidden";var s=this.ToAbsPath("trainer:1.gif"),n=t.match(/background-image: *url\(.*?\)/gi),o=[];if(n){for(var r=0,a=null;a=n[r];r++){var l=/url\((.*?)\)/.exec(a)[1]||"",c=l.charAt(0);'"'!=c&&"'"!=c||(l=l.substr(1,l.length-2)),o.push(this.ToAbsPath(unescape(l),e))}t=t.replace(/background-image: *url\((.*?)\)/gi,"background-image:url("+s+")")}i.innerHTML=t.replace(/<(img|video)([^>]*) src=/gi,"<$1$2 data-dgo-src=").replace(/<video([^>]*) poster=/gi,"<video$1 data-dgo-poster=");for(var _=i.getElementsByTagName("img"),d=(r=0,null);d=_[r++];){var u=d.getAttribute("data-dgo-src")||"";WCT.address.IsExternal(u)||d.setAttribute("data-dgo-src",this.ToAbsPath(unescape(u),e)),d.id||(d.id="img_"+Math.random().toString().substr(2,10))}for(var h=i.getElementsByTagName("video"),p=(r=0,null);p=h[r++];){u=p.getAttribute("data-dgo-src")||"";WCT.address.IsExternal(u)||p.setAttribute("data-dgo-src",this.ToAbsPath(unescape(u),e));var f=p.getAttribute("data-dgo-poster")||"";f&&!WCT.address.IsExternal(f)&&p.setAttribute("data-dgo-poster",this.ToAbsPath(unescape(f),e))}for(var m=i.getElementsByTagName("a"),b=(r=0,null);b=m[r++];){var v=b.getAttribute("href")||b.getAttribute("data-dgo-href")||"";if(v){if(v.indexOf("javascript:void(0)")<0){if(v.indexOf("ctx.cfg_show")<0)if(0<=v.indexOf("mailto:"))v='javascript:ctx.cfg_show("'+unescape(v)+'", null, null);';else{if(WCT.address.IsExternal(v)){b.setAttribute(b.getAttribute("href")?"href":"data-dgo-href",unescape(v));continue}v='javascript:ctx.cfg_show("'+this.ToAbsPath(unescape(v),e)+'", null, null);'}else{var g=v.lastIndexOf(")"),y=v.substring(24,g);g=y.indexOf(y.charAt(0),1);var C=(y=y.substring(1,g)).length;v='javascript:ctx.cfg_show("'+(y=WCT.address.IsExternal(y)?unescape(y):e?e.Expand(unescape(y)).AsString():this.Expand(unescape(y)).AsString())+'"'+v.substr(C+26)}v=(v=v.replace(/\[/g,"%5B").replace(/\]/g,"%5D")).replace(/ctx\.cfg_show\(\'trigger!/,"Page.RTFireTrigger('"),b.setAttribute("href","javascript:void(0);"),b.setAttribute("onclick",v)}}else b.setAttribute("href","javascript:void(0);")}for(var T=i.getElementsByTagName("span"),x=(r=0,null);x=T[r++];){var A=x.getAttribute("gloss_id");if(A){var S='ctx.cfg_show("action!glossref:#1", null, null, event);'.replace(/#1/,A),k="onclick";PLATFORM.IOS&&(k="ontouchend",S+="event.preventDefault();"),x.setAttribute(k,S),x.style.cursor="help"}}var E=(E=i.innerHTML).replace(/<img([^>]*) data-dgo-src=/gi,"<img$1 src=").replace(/<video([^>]*) data-dgo-src=/gi,"<video$1 src=").replace(/<video([^>]*) data-dgo-poster=/gi,"<video$1 poster="),w=new RegExp("background-image: *url\\(.?"+s+".?\\)","i");for(r=0,a=null;a=o[r];r++)E=E.replace(w,"background-image:url("+a+")");return E},ExpandHtmlString:function(t){var e=document.createElement("DIV");e.style.display="none",e.style.visibility="hidden",e.innerHTML=t.replace(/<(img|video)([^>]*) src=/gi,"<$1$2 data-dgo-src=").replace(/<video([^>]*) poster=/gi,"<video$1 data-dgo-poster=").replace(/<a([^>]*) href=/gi,"<a$1 data-dgo-href=");for(var i=e.getElementsByTagName("img"),s=0,n=null;n=i[s];s++){var o=n.getAttribute("data-dgo-src");o&&!WCT.address.IsExternal(o)&&n.setAttribute("data-dgo-src",this.Expand(o).AsString())}for(var r=e.getElementsByTagName("a"),a=(s=0,null);a=r[s];s++){var l=a.getAttribute("data-dgo-href");l&&a.setAttribute("data-dgo-href",this.Expand(l).AsString())}return e.innerHTML.replace(/<(img|video)([^>]*) src=/gi,"<$1$2 data-dgo-src=").replace(/<video([^>]*) data-dgo-poster=/gi,"<video$1 poster=").replace(/<a([^>]*) data-dgo-href=/gi,"<a$1 href=")},OpenFile:function(t){var e=window.location.href;-1<e.indexOf("#")&&(e=e.substring(0,e.indexOf("#")));var i=e.lastIndexOf("/"),s=t.split("?"),n=WCT.address.AddDownloadFlag(s[0]);if(t=s[0]+(n?"?download=1":"")+(s[1]?(n?"&":"?")+s[1]:""),0<=i){var o=WCT.uid.Generate(16),r=this.sbase_;window[o]=[(arguments[1]?r:this.base_)+"/"+t.replace(/^\//,""),Env.Localize("openFileLinkMessageTitle"),Env.Localize("openFileLinkMessage"),Env.Localize("openFileLinkHeadline")].join(";;;");var a=r+"/resources/open_file.html?id="+o;window.open(a)}else window.open(t)},ExpandSlideControl:function(t){t.image&&t.image.id?(t.image.id=this.Expand(t.image.id).AsString(),t.image_mouseover&&t.image_mouseover.id&&(t.image_mouseover.id=this.Expand(t.image_mouseover.id).AsString()),t.image_mousedown&&t.image_mousedown.id&&(t.image_mousedown.id=this.Expand(t.image_mousedown.id).AsString())):t.background_image&&t.background_image.id?t.background_image.id=this.Expand(t.background_image.id).AsString():t.src?t.src=this.Expand(t.src).AsString():t.text?t.text=this.ExpandHtmlString(t.text):t.pagesound&&(t.pagesound=this.Expand(t.pagesound).AsString())},escape_:function(t){if(-1==(t=escape(t)).search("%u"))return t;for(var e=t.split("%"),i=1,s=e.length;i<s;i++)"u"==e[i].charAt(0)?e[i]=unescape("%"+e[i]):e[i]="%"+e[i];return e.join("")},check_base_:function(){this.base_=this.escape_(this.base_.replace(/\\/g,"/")).replace(/%3A/g,":"),"file"==this.protocol_&&(":"==this.base_.charAt(1)?this.base_="file:///"+this.base_:"//"==this.base_.substr(0,2)&&(this.base_="file:"+this.base_)),this.base_=this.base_.replace(/[\/\\]/g,this.st_)}},WCT.Placeholder=function(){this.context_=arguments[0]||new WCT.context,this.env_=arguments[1]||{};var t=arguments[2]||{};this.config_={edit_mode:!!t.edit_mode},this.data_={}},function(){function h(t,e,i,s){t[e]="string"==typeof i?i:s}WCT.Placeholder.GetParamList=function(t,e,i){for(var s=["group","book","slide","cdoc","project","da","media"],n=t.GetEntityList?t.GetEntityList(e):{},o=!!i.edit_mode,r={},a=0,l=null;l=s[a++];){var c=n[l]||null,_={};if(c){var d=l+"!"+c;_=(_=t.GetS(d+":entity.txt"))||{}}var u=o?null:"";h(r,l+":.uid",c,u),h(r,l+":.tclass",_.tclass,u),h(r,l+":.caption",_.caption,u),h(r,l+":.shortdesc",_.shortdesc,u),h(r,l+":.description",_.description,u)}return r}}(),WCT.Placeholder.Resolve=function(t){if(!t)return t;var e,i=new WCT.context(arguments[1]),s=arguments[2]||{},n=arguments[3]||{},o=WCT.Placeholder.GetParamList(s,i,n);WCT.ExtendObject(o,n.param_list||{});for(var r=["group","book","cdoc","project","chapter","da","media"];e=r.shift();){var a=o[e+":.uid"],l="chapter"==e?o["chapter:.tclass"]||"group":e;if(a&&l){i.Set(l,a),i.SetScope(l);var c=e+":.shortdesc";o[c]&&(o[c]=i.ExpandHtmlString(o[c])),o[c=e+":.description"]&&(o[c]=i.ExpandHtmlString(o[c])),"chapter"==e&&o.chapterdescription?o.chapterdescription=i.ExpandHtmlString(o.chapterdescription):"book"==e&&o.bookdescription&&(o.bookdescription=i.ExpandHtmlString(o.bookdescription))}}var _=new WCT.Placeholder(arguments[1],s,n);return _.SetList(o),t=_.Resolve(t,i),i.Destructor(),_.Destructor(),t},WCT.Placeholder.prototype=function(){function resolve_(key,ctx,skip){var cfg=this.config_,env=this.env_,rex=/(\w+)(!(\w+))?:\.(\w+)$/;rex.exec(key);var tclass=RegExp.$1,uid=RegExp.$2,att=RegExp.$4;"!"===uid.charAt(0)&&(uid=uid.substr(1));var ret="";if(!att||this.data_[key])ret=this.data_[key];else if(env.GetS||XHR.GetS){var addr=key.replace(/:\.(\w+)$/,":entity.txt");addr=ctx.Expand(addr),addr=addr.class_id&&addr.local_id?addr.AsString():null;var data=addr?env.GetS?env.GetS(addr):XHR.GetS(ctx.ToAbsPath(addr)):null;if(data&&"string"==typeof data)try{data=eval("("+data+")")}catch(e){data=null}ret=data&&data[att]||""}return"string"!=typeof ret&&(ret=cfg.edit_mode?null:""),uid&&ctx.Get(tclass)!==uid&&(ret=resolve_image_(ret,tclass,uid)),skip[key]={txt:ret},this.Resolve(ret,ctx,skip)}function resolve_image_(t,e,i){for(var s=/<img([^<>]+?)src=("|')(.+?)\2/gi,n=t.match(s)||[],o=0,r=n.length;o<r;o++){var a=n[o];-1===a.search(/\w+[:!]/)&&(t=t.replace(a,a.replace(s,"<img$1src=$2"+e+"!"+i+":$3$2")))}return t}return{Destructor:function(){this.context_=null,this.env_=null,this.config_=null,this.data_=null},SetList:function(t){var e=this.data_;for(var i in t)t[i]&&(e[i]=t[i]+"")},Resolve:function(t){if(!t)return t;for(var e=arguments[1]||this.context_,i=arguments[2]||{},s=[{x:"\\$%\\{([^\\}]*?)\\}"},{x:"\\$#\\{([^\\}]*?)\\}",t:"text"},{x:"\\$L[%]?\\{([^\\}]*?)\\}",t:"text"},{x:"\\$I\\{([^\\}]*?)\\}",t:"img"},{x:"\\$\\{([^\\}]*?)\\}"},{x:"\\$([a-zA-Z_]*?)\\$"}],n=0,o=null;o=s[n++];){var r=new RegExp(o.x,"g"),a=t.match(r);if(a)for(r=new RegExp(o.x),a=a.unique();a.length;){var l=a.shift(),c=r.exec(l)[1],_=i[c];if(_)_.txt&&(t=_replaceTxt(t,_.txt,l,o));else{var d=resolve_.call(this,c,e,i);null!==d&&(t=_replaceTxt(t,d,l,o))}}}return t}};function _replaceTxt(t,e,i,s){for(;0<=e.indexOf(i);)e=e.replace(i,"");e&&"img"===s.t&&(e='<img src="'+e+'" />');do{var n=t;0<=t.indexOf(i)&&(e=e.replace(/\$/g,"$$$$"),t=t.replace(i,"text"===s.t?WCT.CleanupHTMLString(e):e))}while(n!==t);return t}}(),WCT.event={Element:function(t){var e=t.target||t.srcElement;return e&&3==e.nodeType&&(e=e.parentNode),e},Button:function(t){if(null!=t.which)return t.which;if(null!=t.button)switch(t.button){case 1:return 1;case 4:return 2;case 2:return 3}return null},Cancel:function(t){if(!t&&!(t=window.event))return!1;if(t._orig_&&(t=t._orig_),BROWSER.IE&&("keydown"==t.type||"keyup"==t.type||"keypress"==t.type))try{t.keyCode=0}catch(e){}return t.cancelBubble=!0,t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),!1},Standardize:function(t){var e=arguments[1]||window;if(!(t=t||e.event))return null;var i=this.Element(t),s=this.Button(t);return{button:BROWSER.MOBILE||PLATFORM.WINCE?1:s,altKey:t.altKey||!1,clientX:t.clientX||0,clientY:t.clientY||0,ctrlKey:t.ctrlKey||!1,keyCode:t.which||t.keyCode||null,modifiers:t.modifiers,screenX:t.screenX,screenY:t.screenY,shiftKey:t.shiftKey||!1,target:i||null,targetName:WCT.dom.GetNodeName(i),targetType:i?i.nodeType:null,type:t.type||null,_orig_:t}},Observe:function(t,e){var i=arguments[2]||null,s=i||window,n=arguments[3]?s:i?i.nodeType==WCT.dom.ELEMENT_NODE?i:i.document||i:window.document||window,o=arguments[4]||!1;"function"==typeof s.addEventListener?s.addEventListener(t,e,o):"function"!=typeof n.attachEvent&&"object"!=typeof n.attachEvent||(n.attachEvent("on"+t,e),o&&n.setCapture())},StopObserving:function(t,e){var i=arguments[2]||null,s=i||window,n=arguments[3]||!1;try{var o=i?i.nodeType==WCT.dom.ELEMENT_NODE?i:i.document||i:window.document||window;"function"==typeof s.removeEventListener?s.removeEventListener(t,e,n):"function"!=typeof o.detachEvent&&"object"!=typeof o.detachEvent||(o.detachEvent("on"+t,e),n&&o.releaseCapture())}catch(r){}},CreateAndDispatchEvent:function(t,e,i){if(i){var s=null;if(window[t]&&!BROWSER.IE)s=new window[t](e,{view:window,bubbles:!0,cancelable:!0});else{var n="TouchEvent"==t?"initTouchEvent":"initMouseEvent";s=document.createEvent(t),"initMouseEvent"==n?s[n](e,!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null):s[n](e,!0,!0)}i.dispatchEvent(s)}},GetWheelDirection:function(t){return BROWSER.FIREFOX?0<t.detail?"down":"up":t.wheelDelta<0?"down":"up"}},WCT.event.touches=function(){var o=null,r=null,a=!1,i=!1,l=0,c={touchstart:[],touchend:[],touchmove:[],swipeleft:[],swiperight:[],swipeup:[],swipedown:[]};function _(t,e){for(var i=c&&c[t]||[],s=0,n=null;n=i[s];s++)n.f.call(n.s,e)}function s(t){if(_("touchstart",t),1<t.touches.length)o=null;else if(1==t.changedTouches.length){var e=t.changedTouches[0];o=e.identifier,r={x:e.clientX,y:e.clientY},a=!1}}function n(t){if(_("touchend",t),o)for(var e=0,i=null;i=t.changedTouches[e];e++)if(i.identifier==o&&a){var s=i.clientX-r.x,n=i.clientY-r.y;return void(Math.abs(s)>Math.abs(n)?0<s?_("swiperight",t):s<0&&_("swipeleft",t):Math.abs(s)<Math.abs(n)&&(0<n?_("swipedown",t):n<0&&_("swipeup",t)))}}function d(t){if(_("touchmove",t),o)for(var e=0,i=null;i=t.changedTouches[e];e++)if(i.identifier==o)return void(a=!0)}function u(t){if(!i&&l){i=!0;var e=(t||window).document.body;WCT.event.Observe("touchstart",s,e),WCT.event.Observe("touchend",n,e),WCT.event.Observe("touchmove",d,e)}else if(i&&!l){i=!1;e=(t||window).document.body;WCT.event.StopObserving("touchstart",s,e),WCT.event.StopObserving("touchend",n,e),WCT.event.StopObserving("touchmove",d,e)}}return{Cleanup:function(){for(var t in c){for(var e=0,i=null;i=c[t][e++];)i.f=null,i.s=null;c[t]=[]}l=0,u()},RegisterCallback:function(t,e,i){var s=(c[t].id_||0)+1;return c[t].push({f:e,s:i,i:s}),c[t].id_=s,l++,u(),t+"#"+s},UnregisterCallback:function(t){for(var e=t.split("#"),i=e[0],s=0,n=null;n=c[i][s];s++)if(n.i==e[1]){n.f=null,n.s=null,c[i].splice(s,1),l--,u();break}}}}(),WCT.event.hotkey={NATIONAL_KEY_CODES:{es_ES:{"Ñ":192,"Ç":191,"¡":221,"¿":221},nb:{"Ø":192,"Æ":222,"Å":221}},KEYS:{3:["break","rollen-feststell","pause_break"],8:["back"],9:["tab"],13:["enter"],16:["shift"],17:["ctrl"],18:["alt"],19:["pause"],20:["capslock"],27:["esc"],32:["space","blank"],33:["pgup"],34:["pgdown"],35:["end"],36:["home"],37:["left"],38:["up"],39:["right"],40:["down"],45:["ins"],46:["del"],48:["0"],49:["1"],50:["2"],51:["3"],52:["4"],53:["5"],54:["6"],55:["7"],56:["8"],57:["9"],59:[";"],61:[],63:[],65:["a"],66:["b"],67:["c"],68:["d"],69:["e"],70:["f"],71:["g"],72:["h"],73:["i"],74:["j"],75:["k"],76:["l"],77:["m"],78:["n"],79:["o"],80:["p"],81:["q"],82:["r"],83:["s"],84:["t"],85:["u"],86:["v"],87:["w"],88:["x"],89:["y"],90:["z"],91:["win","cmd"],92:["rwin"],93:["start","cmd"],96:["num0"],97:["num1"],98:["num2"],99:["num3"],100:["num4"],101:["num5"],102:["num6"],103:["num7"],104:["num8"],105:["num9"],106:["numx","*"],107:["numplus"],109:["numminus"],110:["numcomma"],111:["numdiv"],112:["f1"],113:["f2"],114:["f3"],115:["f4"],116:["f5"],117:["f6"],118:["f7"],119:["f8"],120:["f9"],121:["f10"],122:["f11"],123:["f12"],144:["numlock"],145:["roll"],171:[],173:[],186:[],187:["=","+"],188:[","],189:["-"],190:["."],191:["/"],192:["`"],219:["["],220:["\\","^"],221:["'","]","�"],222:[],226:["<"]},NONE_INPUT_KEYS:{pause:!0,esc:!0,f1:!0,f2:!0,f3:!0,f4:!0,f5:!0,f6:!0,f7:!0,f8:!0,f9:!0,f10:!0,f11:!0,f12:!0,numlock:!0}},function(){var t=WCT.event.hotkey.KEYS;t[186].push("_252"),t[191].push("_35"),t[192].push("_246"),t[219].push("_223"),t[222].push("_228"),t[222].push("_222"),BROWSER.IE||(t[59].push("_252"),t[61].push("+"),t[63].push("_223"),t[109].push("-"),t[171].push("+"),t[173].push("-"));var _={},r=!1,n={},o=!1,a=!1,l=t=null;function e(t){t=WCT.event.Standardize(t),WCT.event.hotkey.CancelBrowserHotkey(t);var e=WCT.event.hotkey.IsBackKey(t);return!(!WCT.event.hotkey.Fired(t)||e)||WCT.event.Cancel(t)}function c(){if(l){try{l.close()}catch(t){}l=null}}function d(t,e){var i=t||!1,s=e||!1;try{var n="left="+3*screen.availWidth+",top="+3*screen.availHeight+",width=10,height=10,fullscreen=false,location=false,menubar=false,titlebar=false",o=window.open("about:blank","_blank",s?n:"");o.focus(),setTimeout("try {top.focus()} catch(e) {}",100),setTimeout("try {top.focus()} catch(e) {}",250),setTimeout("try {top.focus()} catch(e) {}",500),setTimeout("try {top.focus()} catch(e) {}",750),i||o.close()}catch(r){}i&&(l=o,WCT.SetTimeout(c,750,this))}WCT.ExtendObject(WCT.event.hotkey,{SetIgnoreHotkey:function(t){a=t},CancelBrowserHotkey:function(t){if(!(!a||16<=t.keyCode&&t.keyCode<=18||!t.ctrlKey&&!t.altKey&&(t.keyCode<112||123<t.keyCode))){if(BROWSER.IE){if(!o){o=!0;for(var e=this.KEYS,i=65;i<=90;i++){var s=e[i],n=$$("A");n.id="access_key_"+s,n.href="#",n.accessKey=s,document.body.appendChild(n)}}36==t.keyCode&&t.altKey&&d(!0,!0),115==t.keyCode&&t.altKey&&d(BROWSER.IE8,!0),115==t.keyCode&&t.ctrlKey&&d(!BROWSER.IE8,BROWSER.IE8)}WCT.event.Cancel(t)}},Cleanup:function(){for(var t in _){for(var e=_[t].length-1;0<=e;e--)_[t][e].callback=null,_[t][e].scope=null;delete _[t].id_,delete _[t]}var i=this.KEYS;for(e=65;e<=90;e++){var s=$("access_key_"+i[e]);s&&s.parentNode.removeChild(s)}o=!1,c(),r=a=!1,n={}},Start:function(){WCT.event.Observe("keydown",e,arguments[0]),WCT.event.Observe("keyup",e,arguments[0])},Stop:function(){WCT.event.StopObserving("keydown",e,arguments[0]),WCT.event.StopObserving("keyup",e,arguments[0])},Observe:function(t,e,i,s){var n=0<=t.indexOf("shift_"),o=0<=t.indexOf("ctrl_"),r=0<=t.indexOf("cmd_"),a=0<=t.indexOf("alt_");t=t.replace(/shift_|alt_|ctrl_|cmd_/g,""),_[t]||(_[t]=[]),_[t].id_||(_[t].id_=0);var l="";n&&(l+="shift_"),o&&(l+="ctrl_"),r&&(l+="cmd_"),a&&(l+="alt_"),l+=t;var c=++_[t].id_;return _[t].push({id:c,type:e,callback:i,scope:s,shift:n,ctrl:o,alt:a,full:l}),c},StopObserving:function(t,e){t=t.replace(/shift_|alt_|ctrl_|cmd_/g,"");var i=_[t]||null;if(i){var s=i.indexOfAtt(e,"id");0<=s&&(i[s].callback=null,i[s].scope=null,i.splice(s,1)),i.length||(delete i.id_,delete _[t])}},Fired:function(t){var e=t.type.substr(3);if(!r){for(var i in _)if("ALL"!=i)for(var s=0,n=null;n=_[i][s++];)n.type==e&&this.IsKey(t,n.full)&&n.callback.call(n.scope,n.full,e,t,n.id);var o=_.ALL||null;if(o)for(s=0,n=null;n=o[s++];)n.type==e&&n.callback.call(n.scope,e,t,n.id)}return!t.hasToBeCancelled},GetKey:function(t){var e,i="";t.shiftKey&&(i+="shift_"),t.ctrlKey&&(i+="ctrl_"),t.cmdKey&&(i+="cmd_"),t.altKey&&(i+="alt_");var s=this.KEYS[t.keyCode];return e=s&&s.length?"_"==s[0].charAt(0)?String.fromCharCode(s[0].substr(1)-0):s[0]:String.fromCharCode(t.keyCode).toLowerCase(),(e=(i=i.split(e+"_").join(""))+e).replace(/shift|ctrl|cmd|alt/g,"").replace(/_{2,}/g,"").replace(/^_/,"")&&e},IsKey:function(t,e){var i="";t.shiftKey&&(i+="shift_"),t.ctrlKey&&(i+="ctrl_"),t.cmdKey&&(i+="cmd_"),t.altKey&&(i+="alt_");var s=this.KEYS[t.keyCode];if(!s||!s.length)return(r=String.fromCharCode(t.keyCode).toLowerCase())+"_"==i&&r==e||i+r==e;for(var n=0,o=null;o=s[n++];){var r;if((r="_"==o.charAt(0)?String.fromCharCode(o.substr(1)-0):o)+"_"==i&&r==e||i+r==e)return!0}return!1},IsBackKey:function(t){if(!this.IsKey(t,"back"))return!1;var e=t.targetName,i={text:1,password:1}[t.target.type];return"textarea"!==e&&("input"!==e||!i)},Suspend:function(t,e){if(e)n[t]=1,r=!0;else{delete n[t];var i=!0;for(var t in n){i=!1;break}i&&(r=!1)}}})}(),WCT.skin=function(){function i(t,e,i,s){"number"!=typeof e?"-0"==e?t.style[s]="0":"string"==typeof e&&(t.style[i]=e):0<=e?t.style[i]=e+"px":t.style[s]=-e+"px"}function s(t,e,i){"number"==typeof e?t.style[i]=e+"px":"string"==typeof e&&(t.style[i]=e)}function n(t,e,i,s){var n=s||"",o=e.split("_");e=o[0];for(var r=1,a=o.length;r<a;r++)e+=o[r].toFirstUpperCase();t.style[e]=i+n}function e(t,e,i){if("number"==typeof t[e])return 2*t[e];for(var s=0,n=i.length-1;0<=n;n--){var o=Number(t[i[n]]);isNaN(o)||(s+=o)}return s}return{ConvertXToRtl:function(t){return"number"==typeof t?t?-t:"-0":"-0"==t?0:t},ApplyBgImage:function(t,e){var i=!e.repeat||"x"!=e.repeat&&"y"!=e.repeat?"no-repeat":"repeat-"+e.repeat;e.id&&(t.style.backgroundImage='url("'+e.id+'")'),t.style.backgroundPosition=(e.x||0)+"px "+(e.y||0)+"px",t.style.backgroundRepeat=i},ApplyPosition:function(t,e){"undefined"==typeof e.x&&"undefined"==typeof e.y&&"undefined"==typeof e.w&&"undefined"==typeof e.h||(t.style.position=e.pos||"absolute",i(t,e.x,"left","right"),i(t,e.y,"top","bottom"),s(t,e.w,"width"),s(t,e.h,"height"),arguments[2]||(t.style.fontSize="1px")),"undefined"!=typeof e.max_w&&s(t,e.max_w,"maxWidth"),"undefined"!=typeof e.min_w&&s(t,e.min_w,"minWidth"),"undefined"!=typeof e.max_h&&s(t,e.max_h,"maxHeight"),"undefined"!=typeof e.min_h&&s(t,e.min_h,"minHeight")},ApplyBorder:function(t,e){for(var i in e)switch(i){case"border":t.style.border=e[i];break;case"border_color":case"border_style":case"border_left":case"border_right":case"border_top":case"border_bottom":case"box_shadow":n(t,i,e[i]);break;case"border_width":case"border_radius":case"border_top_left_radius":case"border_top_right_radius":case"border_bottom_left_radius":case"border_bottom_right_radius":n(t,i,e[i],"px")}},ApplyPadding:function(t,e){for(var i in e)switch(i){case"padding":t.style.padding=e[i]+"px";break;case"padding_left":case"padding_top":case"padding_right":case"padding_bottom":n(t,i,e[i],"px")}},ApplyMargin:function(t,e){for(var i in e)switch(i){case"margin":t.style.margin=e[i]+"px";break;case"margin_left":case"margin_top":case"margin_right":case"margin_bottom":n(t,i,e[i],"px")}},ApplyTextFormats:function(t,e){for(var i in e)switch(i){case"font_family":case"font_variant":case"font_weight":case"text_align":case"background_color":case"white_space":case"text_overflow":case"text_decoration":case"overflow_x":case"overflow_y":n(t,i,e[i]);break;case"line_height":case"font_size":n(t,i,e[i],"px");break;case"text_color":t.style.color=e[i];break;case"overflow":t.style[i]=e[i]}},Apply:function(t,e){var i=arguments[2]||"image";this.ApplyPosition(t,e),e[i]&&this.ApplyBgImage(t,e[i]),this.ApplyBorder(t,e),this.ApplyPadding(t,e),this.ApplyMargin(t,e),this.ApplyTextFormats(t,e),e.cursor&&(t.style.cursor=e.cursor)},GetPaddingWidth:function(t){return e(t,"padding",["padding_left","padding_right"])},GetPaddingHeight:function(t){return e(t,"padding",["padding_top","padding_bottom"])},GetMarginWidth:function(t){return e(t,"margin",["margin_left","margin_right"])},GetMarginHeight:function(t){return e(t,"margin",["margin_top","margin_bottom"])},GetPaddingMargin:function(t){var e=arguments[1]||"",i=e+"padding",s=e+"margin",n=0,o=0;"number"==typeof t[i]?n=t[i]:"number"==typeof t.padding&&(n=t.padding),"number"==typeof t[s]?o=t[s]:"number"==typeof t.margin&&(o=t.margin);var r={padding:{l:n,r:n,t:n,b:n},margin:{l:o,r:o,t:o,b:o}},a=r.padding,l=r.margin,c={left:"l",right:"r",top:"t",bottom:"b",l:"l",r:"r",t:"t",b:"b"};for(var _ in c){var d=c[_],u="padding_"+_,h=e+u,p="margin_"+_,f=e+p;"number"==typeof t[h]?a[d]=t[h]:"number"==typeof t[u]&&(a[d]=t[u]),"number"==typeof t[f]?l[d]=t[f]:"number"==typeof t[p]&&(l[d]=t[p])}return a.w=a.l+a.r,a.h=a.t+a.b,l.w=l.l+l.r,l.h=l.t+l.b,a.s=[a.t,a.r,a.b,a.l].join("px ")+"px",l.s=[l.t,l.r,l.b,l.l].join("px ")+"px",r},GetSpacingWidth:function(t){return e(t,"outer_spacing",["outer_spacing_l","outer_spacing_r"])},GetSpacingHeight:function(t){return e(t,"outer_spacing",["outer_spacing_t","outer_spacing_b"])},GetBorderWidth:function(t){if(t.border_style&&"none"!=t.border_style&&"number"==typeof t.border_width)return 2*t.border_width;if(t.border&&(3==(n=t.border.split(" ")).length&&"none"!=n[1]&&"number"==typeof(n=parseInt(n[0]))))return 2*n;for(var e=0,i=["left","right"],s=i.length-1;0<=s;s--){var n,o=t["border_"+i[s]];if(o)3==(n=o.split(" ")).length&&"none"!=n[1]&&"number"==typeof(n=parseInt(n[0]))&&(e+=n)}return e},GetBorderHeight:function(t){if(t.border_style&&"none"!=t.border_style&&"number"==typeof t.border_width)return 2*t.border_width;if(t.border&&(3==(n=t.border.split(" ")).length&&"none"!=n[1]&&"number"==typeof(n=parseInt(n[0]))))return 2*n;for(var e=0,i=["top","bottom"],s=i.length-1;0<=s;s--){var n,o=t["border_"+i[s]];if(o)3==(n=o.split(" ")).length&&"none"!=n[1]&&"number"==typeof(n=parseInt(n[0]))&&(e+=n)}return e},GetBorder:function(t){for(var e=t.border_w||0,i=t.border_color||"",s={l_w:e,l_c:i,r_w:e,r_c:i,t_w:e,t_c:i,b_w:e,b_c:i},n=["l","r","t","b"],o=0,r=null;r=n[o++];){var a="border_"+r+"_w",l="border_"+r+"_color";"number"==typeof t[a]&&(s[r+"_w"]=t[a]),"string"==typeof t[l]&&(s[r+"_c"]=t[l])}return s.w=s.l_w+s.r_w,s.h=s.t_w+s.b_w,s.ws=[s.t_w,s.r_w,s.b_w,s.l_w].join("px ")+"px",s.cs=[s.t_c,s.r_c,s.b_c,s.l_c].join(" "),s},Merge:function(t){var e=arguments[2]?t:WCT.DeepCopy(t),i=arguments[3]||!1,s=arguments[1],n=arguments[4]||!1;if(!s)return e;for(var o in s)"undefined"!=typeof e[o]?"object"==typeof s[o]?!s[o]||s[o].isArray?e[o]=s[o]:this.Merge(e[o],s[o],!0,i):e[o]=n?s[o]||e[o]:s[o]:i&&(e[o]=WCT.DeepCopy(s[o]));return e},ExtendUrls:function(t,e){var i=arguments[2];for(var s in t)t[s]&&"object"==typeof t[s]?this.ExtendUrls(t[s],e,i):"string"!=typeof t[s]||!t[s].match(/\.gif$/)&&!t[s].match(/\.png$/)||WCT.address.IsExternal(t[s])||(i&&(0<=t[s].indexOf("!")||0<=t[s].indexOf(":"))?t[s]=i.ToAbsPath(t[s]):t[s]=e+t[s])}}}(),WCT.dnd=function(t){var e=arguments[1]||null,i=e||t,s=WCT.uid.Generate(16,"DND_");i.setAttribute("dnd_id",s),i.style.cursor="move",i.onselectstart=function(){return!1},i.ondragstart=function(){return!1},this.o_=t,this.a_=e,this.e_=i,this.u_=s,this.x_=null,this.y_=null,this.f_=null,this.px_=null,this.py_=null,this.mx_=null,this.my_=null,this.dragging_=!1,this.auto_clamp_=!0,this.restrict_={x:!1,y:!1},this.min_={x:null,y:null},this.max_={x:null,y:null},this.touch_id_=null,this.ignore_=null,this._pause=!1,this.onbegin_=null,this.onmove_=null,this.onend_=null,this._tid=null,this.dragging_class_=null,WCT.dnd.CONTAINER[s]=this,!1!==arguments[2]&&1==++WCT.dnd.COUNT&&(WCT.event.Observe("mousedown",WCT.dnd.mousedown),WCT.event.Observe("touchstart",WCT.dnd.touchstart,document.body))},WCT.ExtendObject(WCT.dnd,function(){function s(t,e){if(!0===e){var i=WCT.dnd.CONTAINER;for(var s in i)if(i[s].IsDragging())return i[s];return null}var n=t.target;if(n.id&&n.id===this.ignore_)return null;for(;n&&!n.getAttribute("dnd_id");)(n=n.parentElement)&&n.id&&n.id===this.ignore_&&(n=null);if(!n)return null;var o=n.getAttribute("dnd_id");return WCT.dnd.CONTAINER[o]||null}function n(){var t=WCT.dnd.CONTAINER;for(var e in t)t[e].IsDragging()&&t[e].End()}return{CONTAINER:{},COUNT:0,Cleanup:function(){var t=WCT.dnd.CONTAINER;for(var e in t)t[e].Destructor&&t[e].Destructor(),t[e]=null;WCT.dnd.CONTAINER={},WCT.dnd.COUNT=0},mousedown:function(t){var e=s(t=WCT.event.Standardize(t));if(e){var i=WCT.timeout.Set(function(){e.Begin(t)},20);e.setTimeout(i)}},mousemove:function(t){t.preventDefault&&t.preventDefault();var e=s(t=WCT.event.Standardize(t),!0);e&&e.Move(t)},mouseup:function(t){var e=s(t=WCT.event.Standardize(t),!0);e&&(e.setTimeout(null),e.End(t))},touchstart:function(t){if(1<t.touches.length)n();else{var e=1==t.changedTouches.length?t.changedTouches[0]:null,i=e&&s(e)||null;i&&i.Begin(e,!0)}},touchmove:function(t){if(t.preventDefault&&t.preventDefault(),1<t.touches.length)n();else{var e=1==t.changedTouches.length?t.changedTouches[0]:null,i=e&&s(e,!0);i&&i.touch_id_==e.identifier&&i.Move(e)}},touchend:function(t){var e=1==t.changedTouches.length?t.changedTouches[0]:null,i=e&&s(e,!0);i&&i.touch_id_==e.identifier&&i.End(e,!0)}}}()),WCT.dnd.prototype={Destructor:function(){return this.dragging_&&this.End(),document.onselectstart=this.f_,this.f_=null,this.u_&&(delete WCT.dnd.CONTAINER[this.u_],this.u_=null,0==--WCT.dnd.COUNT&&(WCT.event.StopObserving("mousedown",WCT.dnd.mousedown),WCT.event.StopObserving("touchstart",WCT.dnd.mousedown,document.body))),this.e_&&(this.e_.onselectstart=null,this.e_.ondragstart=null,this.e_.style.cursor="default",this.e_=null),this.o_=null,this.a_=null,this.restrict_=null,this.min_=null,this.max_=null,this.touch_id_=null,this.onbegin_&&(this.onbegin_.callback=null,this.onbegin_.scope=null,this.onbegin_=null),this.onmove_&&(this.onmove_.callback=null,this.onmove_.scope=null,this.onmove_=null),this.onend_&&(this.onend_.callback=null,this.onend_.scope=null,this.onend_=null),null},Ignore:function(t){this.ignore_=t},Restrict:function(t,e){var i=this.restrict_;i[t]=e,"number"==typeof arguments[2]&&(this.min_[t]=arguments[2]),"number"==typeof arguments[3]&&(this.max_[t]=arguments[3]);var s=this.e_.style;i.x&&i.y?s.cursor="default":i.x?s.cursor="n-resize":i.y?s.cursor="e-resize":s.cursor="move"},SetStartPos:function(t,e){this.x_=t,this.y_=e},SetParOffset:function(t,e){this.px_=t,this.py_=e},SetAutoClamp:function(t){this.auto_clamp_=t},SetCallback:function(t,e,i){"function"!=typeof e||"onbegin"!=t&&"onmove"!=t&&"onend"!=t||(this[t+"_"]={callback:e,scope:i})},SetDraggingClass:function(t){this.dragging_class_=t},Begin:function(t){if(!this._pause&&this.o_&&t.target.id!=this.ignore_){t.preventDefault&&t.preventDefault();var e=WCT.dom.GetPosition(this.o_,!0),i=null!=this.px_?this.px_:e.left,s=null!=this.py_?this.py_:e.top;this.x_=t.clientX-i,this.y_=t.clientY-s,this.mx_=WCT.dom.GetWindowWidth()-this.o_.offsetWidth,this.my_=WCT.dom.GetWindowHeight()-this.o_.offsetHeight,this.onbegin_&&this.onbegin_.callback.call(this.onbegin_.scope,this.o_),arguments[1]?(this.touch_id_=t.identifier,WCT.event.Observe("touchmove",WCT.dnd.touchmove,document.body),WCT.event.Observe("touchend",WCT.dnd.touchend,document.body)):(this.f_=document.onselectstart,document.onselectstart=function(){return!1},document.body.setCapture&&document.body.setCapture(),WCT.event.Observe("mousemove",WCT.dnd.mousemove),WCT.event.Observe("mouseup",WCT.dnd.mouseup)),WCT.event.Cancel(t),this.dragging_=!0}},Move:function(t){if(this.dragging_){var e=t.clientX-this.x_,i=t.clientY-this.y_;"number"==typeof this.min_.x&&(e=Math.max(this.min_.x,e)),"number"==typeof this.min_.y&&(i=Math.max(this.min_.y,i)),"number"==typeof this.max_.x&&(e=Math.min(this.max_.x,e)),"number"==typeof this.max_.y&&(i=Math.min(this.max_.y,i)),this.auto_clamp_&&(e=Math.max(0,Math.min(this.mx_,e)),i=Math.max(0,Math.min(this.my_,i))),this.restrict_.x||(this.o_.style.left=e+"px"),this.restrict_.y||(this.o_.style.top=i+"px"),this.onmove_&&(this.dragging_class_&&WCT.dom.AddClass(this.o_,this.dragging_class_),this.onmove_.callback.call(this.onmove_.scope,this.o_,e,i))}},End:function(t){WCT.event.StopObserving("mousemove",WCT.dnd.mousemove),WCT.event.StopObserving("mouseup",WCT.dnd.mouseup),WCT.event.StopObserving("touchmove",WCT.dnd.touchmove,document.body),WCT.event.StopObserving("touchend",WCT.dnd.touchend,document.body),document.body.releaseCapture&&document.body.releaseCapture(),this.touch_id_=null,this.dragging_=!1,document.onselectstart=this.f_,this.f_=null,this.onend_&&(this.dragging_class_&&WCT.dom.RemoveClass(this.o_,this.dragging_class_),this.onend_.callback.call(this.onend_.scope,this.o_))},IsDragging:function(){return this.dragging_},pause:function(t){this._pause=!!t},setTimeout:function(t){this._tid&&WCT.timeout.Clear(this._tid),t||(this.dragging_=!1),this._tid=t}},WCT.localization={Parse:function(t){for(var e=(t=t.replace(/\r\n/g,"\n")).split("\n"),i={},s=0,n=e.length;s<n;s++){var o=e[s];if(o.length&&"#"!=o.charAt(0)){var r=o.indexOf("\t"),a=o.indexOf(" "),l=null;if(0<=r&&(a<0||r<a))l=r;else{if(!(0<=a))continue;l=a}var c=o.substr(0,l).trim(),_=o.substr(l+1).trim();";"==c.charAt(c.length-1)&&(c=c.substr(0,c.length-1)),'"'==_.charAt(0)&&'"'==_.charAt(_.length-1)&&(_=_.substr(1,_.length-2)),i[c]=_}}for(var c in i){for(var d=(_=i[c]).indexOf("@{");0<=d;){var u=_.indexOf("}",d);u<0&&(u=_.length-1);var h=_.substr(0,d),p=_.substring(d+2,u),f=_.substr(u+1);d=(_=h+(i[p]||"["+p+"]")+f).indexOf("@{")}i[c]=_}return i}},WCT.dom={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,DOCUMENT_NODE:9,SCROLLBAR_W:null,SCROLLBAR_H:null,isLink:function(t){for(;t;){if("a"===this.GetNodeName(t))return!0;t=t.parentNode}return!1},GetNodeName:function(t){return t&&t.nodeName?t.nodeName.toLowerCase():""},isNodeName:function(t,e){if(!t||!e)return!1;var i=this.GetNodeName(t);return e.isArray&&(e=e.map(function(t){return t.toLowerCase()})),e.isArray?0<=e.indexOf(i):i===e.toLowerCase()},CreateElementMSIE:function(t){var e=arguments[1]||null,i=arguments[2]||null,s=arguments[3]||document,n=null;if(BROWSER.IE&&BROWSER.VERSION<11){var o=null!=e?' type="'+e+'"':"",r=null!=i?' name="'+i+'"':"";try{n=$$("<"+t+o+r+">",s)}catch(a){try{n=$$(t,s),null!=e&&(n.type=e),null!=i&&(n.name=i)}catch(a){}}}else n=$$(t,s),null!=e&&(n.type=e),null!=i&&(n.name=i);return n},PreviousSibling:function(t){if(BROWSER.IE&&BROWSER.VERSION<9){for(var e=0,i=t.parentNode.childNodes,s=0,n=null;n=i[s];s++)if(t===n){e=s-1;break}return i[e]}return t.previousSibling},NextSibling:function(t){if(BROWSER.IE&&BROWSER.VERSION<9){for(var e=0,i=t.parentNode.childNodes,s=0,n=null;n=i[s];s++)if(t===n){e=s+1;break}return i[e]}return t.nextSibling},CreateInputElement:function(){var t=arguments[0]||"text",e=this.CreateElementMSIE("input",t,arguments[1],arguments[2]);return e||"text"==t||(e=this.CreateElementMSIE("input","text",arguments[1],arguments[2])),e},GetPosition:function(t){var e;if(PLATFORM.IOS&&"none"==t.style.display){var i=t.style.visibility;t.style.visibility="hidden",t.style.display="block",e=t.getBoundingClientRect(),t.style.display="none",t.style.visibility=i}else e=t.getBoundingClientRect();var s=t.ownerDocument,n=s.documentElement,o=n.clientLeft||s.body.clientLeft||0,r=n.clientTop||s.body.clientTop||0,a=e.left-o,l=e.top-r;if(arguments[1]){var c=s.defaultView||s.parentWindow;a+=c.pageXOffset||n.scrollLeft,l+=c.pageYOffset||n.scrollTop}if(arguments[2]){var _=this.GetPosition(arguments[2],arguments[1]);a-=_.left,l-=_.top}return{left:a,top:l}},RemoveCssTransition:function(t){this.CssTransition(t,"","0s"),arguments[1]&&(t.removeEventListener("webkitTransitionEnd",arguments[1],!1),t.removeEventListener("transitionend",arguments[1],!1),t.removeEventListener("oTransitionEnd",arguments[1],!1))},CssTransition:function(t){var e=arguments[1]||"",i=arguments[2]||"1s",s=arguments[3]||"ease",n=arguments[4]||"0s",o=arguments[5]||null;t.style.transitionProperty=e,t.style.transitionDuration=i,t.style.transitionTimingFunction=s,t.style.transitionDelay=n,t.style.MozTransitionProperty="transform"==e?"-moz-transform":e,t.style.MozTransitionDuration=i,t.style.MozTransitionTimingFunction=s,t.style.MozTransitionDelay=n,t.style.WebkitTransitionProperty="transform"==e?"-webkit-transform":e,t.style.WebkitTransitionDuration=i,t.style.WebkitTransitionTimingFunction=s,t.style.WebkitTransitionDelay=n,t.style.OTransitionProperty=e,t.style.OTransitionDuration=i,t.style.OTransitionTimingFunction=s,t.style.OTransitionDelay=n,o&&(t.addEventListener("webkitTransitionEnd",o,!1),t.addEventListener("transitionend",o,!1),t.addEventListener("oTransitionEnd",o,!1))},CssZoom:function(t,e){t.style.zoom=e},CssTransform:function(t,e,i,s,n){var o=e+"("+i+"px,"+s+"px,"+n+"px)";t.style.transform=o,t.style.msTransform=o,t.style.MozTransform=o,t.style.WebkitTransform=o,t.style.OTransform=o},CssTransformScale:function(t,e){var i="scale("+e+")";t.style.Transform=i,t.style.msTransform=i,t.style.MozTransform=i,t.style.WebkitTransform=i,t.style.OTransform=i;var s=(null!=arguments[2]?arguments[2]:"50%")+" "+(null!=arguments[3]?arguments[3]:"50%");t.style.TransformOrigin=s,t.style.msTransformOrigin=s,t.style.MozTransformOrigin=s,t.style.WebkitTransformOrigin=s,t.style.OTransformOrigin=s},CssTransformScaleString:function(t){var e="scale("+t+")",i=[];i.push("Transform:"+e),i.push("msTransform:"+e),i.push("MozTransform:"+e),i.push("WebkitTransform:"+e),i.push("OTransform:"+e);var s=(null!=arguments[2]?arguments[2]:"50%")+" "+(null!=arguments[3]?arguments[3]:"50%");return i.push("TransformOrigin:"+s),i.push("msTransformOrigin:"+s),i.push("MozTransformOrigin:"+s),i.push("WebkitTransformOrigin:"+s),i.push("OTransformOrigin:"+s),i.join(";")},ApplyBackgroundStyle:function(t,e){var i=e.gradient||"";switch(BROWSER.IE&&BROWSER.VERSION<9&&(i=""),i){case"gradient_0":case"gradient_45":case"gradient_90":case"gradient_135":case"gradient_180":case"gradient_225":case"gradient_270":case"gradient_315":case"gradient_1":var s=i.substr(9),n=180<=s?s-180:s+180,o=BROWSER.SAFARI?"-webkit-linear-gradient("+n+"deg, ":"linear-gradient("+s+"deg, ",r=e.background_color+", "+e.background_color2+")",a=arguments[2]||"";PLATFORM.IOS&&"select"===a||(t.style.background=o+r),t.style.backgroundColor=e.background_color;break;case"gradient_flat":default:t.style.backgroundColor=e.background_color||""}},ApplyShadowStyle:function(t,e){if(e.shadow_show){var i=e.shadow_h||0,s=e.shadow_v||0,n=e.shadow_blur||0,o=e.shadow_spread||0,r="number"==typeof e.shadow_trans?e.shadow_trans:100,a=WCT.HexToRgb(e.shadow_color||"#888888",r/100);t.style.boxShadow=i+"px "+s+"px "+n+"px "+o+"px "+a}},NotSelectable:function(t){var e=arguments[1]||!1,i=e?"text":"none",s=e?"off":"on";t.style.MozUserSelect=i,t.style.WebkitTouchCallout=i,t.style.WebkitUserSelect=i,t.style.KhtmlUserSelect=i,t.style.msUserSelect=i,t.style.OUserSelect=i,t.style.userSelect=i,t.setAttribute("unselectable",s),t.unselectable=!e},GetWindowHeight:function(){var t=arguments[0]||window;return t.innerHeight?t.innerHeight:t.document.documentElement.clientHeight||t.document.body.offsetHeight},GetWindowWidth:function(){var t=arguments[0]||window;return t.innerWidth?t.innerWidth:t.document.documentElement.clientWidth||t.document.body.offsetWidth},GetScrollbarWidth:function(){if(null==this.SCROLLBAR_W){var t=$$("div");arguments[0]&&(t.className=arguments[0]),t.style.height="100px",t.style.width="100px",t.style.overflow="scroll",t.style.visibility="hidden",t.style.position="absolute",t.style.top="0",t.style.left="0",document.body.appendChild(t),this.SCROLLBAR_W=100-t.clientWidth,this.SCROLLBAR_H=100-t.clientHeight,document.body.removeChild(t)}return this.SCROLLBAR_W},GetScrollbarHeight:function(){if(null==this.SCROLLBAR_H){var t=$$("div");arguments[0]&&(t.className=arguments[0]),t.style.height="100px",t.style.width="100px",t.style.overflow="scroll",t.style.visibility="hidden",t.style.position="absolute",t.style.top="0",t.style.left="0",document.body.appendChild(t),this.SCROLLBAR_W=100-t.clientWidth,this.SCROLLBAR_H=100-t.clientHeight,document.body.removeChild(t)}return this.SCROLLBAR_H},HasVerticalScrollbar:function(t){return t.offsetHeight<t.scrollHeight},HasHorizontalScrollbar:function(t){return t.offsetWidth<t.scrollWidth},SwapNode:function(t,e){if(t.swapNode)t.swapNode(e);else{var i=$$("div");t.parentNode.replaceChild(i,t),e.parentNode.replaceChild(t,e),i.parentNode.replaceChild(e,i)}},IOSOpacitySwitch:function(t){if(PLATFORM.IOS&&t){var e=t.style.opacity;t.style.opacity=1==e?"0.999":"1",t.style.WebkitOverflowScrolling="touch"}},AndroidOpacitySwitch:function(t){if(PLATFORM.ANDROID&&t){t.style.opacity="0.999";t.offsetHeight;t.style.opacity="1"}},GetZoomLevel:function(){if(BROWSER.IE){if(BROWSER.VERSION<=7){var t=document.body,e=t.getBoundingClientRect();return Math.round((e.right-e.left)/t.clientWidth*100)}return Math.round(screen.deviceXDPI/screen.logicalXDPI*100)}if(null!=document.body.style.webkitTextSizeAdjust){if(null!=window.ontouchstart)return Math.round(document.documentElement.clientWidth/window.innerWidth*100);var i=$$("div");i.style.position="absolute",i.style.visibility="hidden",i.style.overflow="hidden",i.style.width=0,i.style.height=0,document.body.appendChild(i);var s=$$("div");s.style.overflow="visible",s.style.padding=0,s.style.width="1em",s.style.height="auto",s.style.WebkitTextSizeAdjust="none",s.style.font="100px/1em sans-serif",s.innerHTML="1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>0",i.appendChild(s);var n=Math.round(1e3/s.clientHeight*100);return document.body.removeChild(i),n}if(BROWSER.FIREFOX)return Math.ceil(100*window.devicePixelRatio);if(BROWSER.CHROME){var o=document.width,r=document.documentElement.clientWidth;return Math.round(100*(1+(o-r)/r))}return 100},SupportsHtml5Video:function(){if(document.createElement("video").canPlayType){var t=document.createElement("video"),e=t.canPlayType('video/ogg; codecs="theora, vorbis"');if(e)return"probably"==e?1:2;for(var i=["42E01E","58A01E","4D401E"],s=null,n=0,o=i.length;n<o;n++)if(s=t.canPlayType('video/mp4; codecs="avc1.'+i[n]+', mp4a.40.2"'))return"probably"==s?1:2}return 0},GetLatestTextNode:function(t){for(var e=t.childNodes,i=e.length-1;0<=i;i--){var s=e[i];if(s.nodeType==this.TEXT_NODE)return s;var n=this.GetLatestTextNode(s);if(n)return n}return null},GetFirstTextNode:function(t){for(var e=0,i=null,s=t.childNodes;i=s[e];e++){if(i.nodeType==this.TEXT_NODE)return i;var n=this.GetLatestTextNode(i);if(n)return n}return null},Empty:function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},TextContent:function(t){if(t.nodeType==this.TEXT_NODE)return t.textContent||t.nodeValue||"";if(t.textContent)return t.textContent;if(t.childNodes.length){for(var e="",i=t.childNodes,s=0,n=null;n=i[s];s++)e+=this.TextContent(n);return e}return""},GetNodeName:function(t){return t&&t.nodeName?t.nodeName.toLowerCase():""},GetComputedStyle:function(t,e,i){var s="";return e.getComputedStyle?(t.nodeType==WCT.dom.TEXT_NODE&&(t=t.parentNode),s=e.getComputedStyle(t,null).getPropertyValue(i)):t.currentStyle?s=t.currentStyle[i]:t.parentNode&&t.parentNode.currentStyle&&(s=t.parentNode.currentStyle[i]),s},IndexInParent:function(t){for(var e=t.parentNode.childNodes,i=0,s=null;s=e[i];i++)if(s==t)return i},InsertAfter:function(t,e){e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t)},AddClass:function(t,e){for(var i=1,s=null;i<arguments.length;i++)s=arguments[i],this.HasClass(t,s)||(t.className+=" "+s)},RemoveClass:function(t,e){var i=new RegExp("\\b"+e+"\\b","g");t.className=t.className.replace(i,"").replace(/\s\s/g," ").replace(/\s$/g,"")},HasClass:function(t,e){var i=["^","$|^"," | ","$| "," "].join(e);return new RegExp(i).test(t.className)},ToggleClass:function(t,e){this.HasClass(t,e)?this.RemoveClass(t,e):this.AddClass(t,e)},GetStyles:function(t){var e=t.getAttribute("style"),i={};if(e&&"object"==typeof e&&(e=e.cssText||null),"string"==typeof e)for(var s=(e=e.split(";")).length-1;0<=s;s--){var n=e[s].split(":"),o=n[0],r=n[1];"string"==typeof o&&"string"==typeof r&&(i[o.trim()]=r.trim())}return i},GetAttributes:function(t){for(var e=t.attributes,i={},s=!1,n=0,o=null;o=e[n];n++){var r=o.nodeValue;null!=r&&""!=r&&("style"==this.GetNodeName(o)&&(s=!0),i[o.nodeName.toLowerCase()]=r)}if(!s){var a=t.getAttribute("style");(a=a&&(a.cssText||null))&&(i.style=a)}return i},CreateFromHtml:function(t){var e=$$("div");return e.innerHTML=t,e.firstChild},RemoveFromDom:function(t){var e=t&&t.parentNode;return t&&e?(e.removeChild(t),null):t}},WCT.Transform={ConvertFontSizeToPx:function(t){switch(t){case"xx-small":case"1":return"11px";case"x-small":case"2":return"13px";case"small":case"3":return"16px";case"medium":case"4":return"19px";case"large":case"5":return"24px";case"x-large":case"6":return"32px";case"xx-large":case"7":return"48px";default:return null}},ConvertFontSizeToPt:function(t){switch(t){case"xx-small":case"1":return"8pt";case"x-small":case"2":return"10pt";case"small":case"3":return"12pt";case"medium":case"4":return"14pt";case"large":case"5":return"18pt";case"x-large":case"6":return"24pt";case"xx-large":case"7":return"36pt";default:return null}},ConvertPxToFontSize:function(t){return(t=parseInt(t))<12?"1":t<15?"2":t<18?"3":t<22?"4":t<28?"5":t<40?"6":40<=t?"7":null},IsValidSize:function(t){return!isNaN(parseInt(t))},IsWebkitSize:function(t){switch(t){case"xx-small":case"x-small":case"small":case"medium":case"large":case"x-large":case"xx-large":return!0;default:return!1}},ConvertPtToPx:function(t){return Math.min(80,Math.max(6,Math.ceil(1.3333333*parseInt(t))))+"px"}},WCT.fullscreen={Supported:function(t){return!!(t.requestFullScreen||t.mozRequestFullScreen||t.webkitRequestFullScreen)},Active:function(){return!!(document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen)},Enable:function(t){t.requestFullScreen?t.requestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen&&(BROWSER.CHROME?t.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):t.webkitRequestFullScreen())},Disable:function(t){document.exitFullScreen?document.exitFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()}},WCT.Ease={None:function(t){return t},SineInOut:function(t){return-.5*(Math.cos(Math.PI*t)-1)},SineIn:function(t){return 1-Math.cos(t*Math.PI/2)},SineOut:function(t){return Math.sin(t*Math.PI/2)},QuadInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},QuadIn:function(t){return t*t},QuadOut:function(t){return-t*(t-2)},CubeIn:function(t){return t*t*t},CubeOut:function(t){return(t-=1)*t*t+1},CubeInOut:function(t){return(t*=2)<1?t*t*t/2:((t-=2)*t*t+2)/2},Bounce:function(t){for(var e=0,i=1;;){if((7-4*e)/11<=t)return-Math.pow((11-6*e-11*t)/4,2)+Math.pow(i,2);e+=i,i/=2}}},WCT.POI=function(){var u={};return{Focus:{Simple:function(t,e){var i=null;t.x>e.w+e.x?i=t.x+t.w-e.w+WCT.dom.GetScrollbarWidth():t.x<e.x&&(i=t.x-t.w);var s=null;return t.y>e.h+e.y?s=t.y+t.h-e.h+WCT.dom.GetScrollbarHeight():t.y<e.y&&(s=t.y-t.h),{x:i,y:s}},Centered:function(t,e){return{x:t.x-(e.w>>1),y:t.y-(e.h>>1)}}},Animate:function(t,e,i,s,n){var o=arguments[5]||50,r=arguments[6]||function(){},a=arguments[7],l=arguments[8]||!1,c=i.x-e.x,_=i.y-e.y;if(c||_){if(PLATFORM.WINCE)return l?(t.style.left=i.x+"px",t.style.top=i.y+"px"):(t.scrollLeft=i.x,t.scrollTop=i.y),void r.call(a);var d=WCT.uid.Generate();return u[d]={uid:d,dom:t,start_x:e.x,start_y:e.y,end_x:i.x,end_y:i.y,delta_x:c/n,delta_y:_/n,type:s,time:n,interval:o,callback:r,scope:a,by_css:l,cur_time:0},WCT.SetTimeout(WCT.POI.animate_,o,WCT.POI,[d]),d}r.call(a)},StopAnimation:function(t){delete u[t]},animate_:function(t){var e=u[t];if(e)if((e.cur_time+=e.interval)>=e.time||arguments[1])delete u[t],e.by_css?(e.dom.style.left=e.end_x+"px",e.dom.style.top=e.end_y+"px"):(e.dom.scrollLeft=e.end_x,e.dom.scrollTop=e.end_y),e.callback.call(e.scope);else{var i=WCT.Ease[e.type](e.cur_time/e.time)*e.time,s=Math.round(e.delta_x*i),n=Math.round(e.delta_y*i),o=e.start_x+s,r=e.start_y+n;isNaN(o)||isNaN(r)?WCT.POI.animate_.call(WCT.POI,t,!0):(e.by_css?(e.dom.style.left=o+"px",e.dom.style.top=r+"px"):(e.dom.scrollLeft=o,e.dom.scrollTop=r),WCT.SetTimeout(WCT.POI.animate_,e.interval,WCT.POI,[t]))}}}}(),WCT.iframe={IFRAME_ID:"WCT_IFR",STORE:{},Cleanup:function(){if(arguments[0])(e=this.STORE[arguments[0]])&&(e.d=null,e.f=null,e.s=null,e.a=null,delete this.STORE[arguments[0]]);else for(var t in this.STORE){var e;(e=this.STORE[t]).d=null,e.f=null,e.s=null,e.a=null,delete this.STORE[t]}},Create:function(){var t=null,e=!!arguments[1],i=arguments[2]||"";if(BROWSER.IE&&(e||i)){var s=e?'allowTransparency="true"':"",n=i?[' id="','" name="','"'].join(i):"";if(BROWSER.VERSION<11)try{t=$$("<iframe "+s+n+">")}catch(o){t=$$("iframe"),e&&t.setAttribute("allowTransparency","true"),i&&(t.id=i,t.name=i)}}return t||(t=$$("iframe"),e&&t.setAttribute("allowTransparency","true"),i&&(t.id=i,t.name=i)),t.frameBorder="0",t.style.borderWidth="0",t.style.width="100%",t.style.height="100%",t.style.overflow="hidden",t.style.position="absolute",t.style.backgroundColor="transparent",arguments[0]&&(t.src=arguments[0]),t},Load:function(t,e,i){var s=WCT.uid.Generate(12,this.IFRAME_ID);this.STORE[s]={d:t,f:e,s:i,a:arguments[4]||[]},t.setAttribute(this.IFRAME_ID,s);var n=arguments[3]||document.body;BROWSER.IE&&BROWSER.VERSION<11?(n.appendChild(t),t.onreadystatechange=this.iframe_ready_):(t.onload=this.iframe_ready_,n.appendChild(t))},Eval:function(t,e){!e.eval&&e.execScript&&e.execScript("null"),e.eval&&e.eval(t)},iframe_ready_:function(){var t=this.getAttribute(WCT.iframe.IFRAME_ID),e=WCT.iframe.STORE[t];if(BROWSER.IE&&BROWSER.VERSION<11){try{if("complete"!=this.readyState)return;this.onreadystatechange=null,this.removeAttribute(WCT.iframe.IFRAME_ID)}catch(i){try{this.onreadystatechange=null,this.removeAttribute(WCT.iframe.IFRAME_ID)}catch(i){}}}else try{this.onload=null,this.removeAttribute(WCT.iframe.IFRAME_ID)}catch(i){}e&&e.f&&e.f.apply(e.s,e.a),WCT.iframe.Cleanup[t]}},function(){var r="",s=null,o=null,n=null,a=null;function l(){var t=WCT.bookmark.Get();if(o){var e=WCT.bookmark.Get(!0);t!=r?(c(r=t),n.call(a,t)):e!=r&&(r=e,location.hash=e,n.call(a,e))}else t!=r&&(r=t,n.call(a,r))}function c(t){var e=o?o.contentWindow.document:null,i=WCT.bookmark.Get(!0);e&&i!=t&&(e.open(),e.close(),e.location.hash=t)}WCT.bookmark={Observe:function(t,e){if(n=t,a=e,r=this.Get(),"onhashchange"in window||8==document.documentMode)WCT.event.Observe("hashchange",l,window,!0);else{(o=$$("iframe")).src="javascript:false;",o.style.display="none";var i=document.body;i.parentNode.insertBefore(o,i),c(r),s=setInterval(l,100)}},StopObserving:function(){WCT.event.StopObserving("hashchange",l),s&&(clearInterval(s),s=null),a=n=null},Set:function(t){"#"==(t=t.toString()).charAt(0)&&(t=t.substr(1)),c(t);for(var e=location.hash.substr(1).split("&"),i=[],s=0,n=e.length;s<n;s++){var o=e[s].split("=");1<o.length&&"hash"!==o[0]&&i.push(e[s])}i.length&&(t+="&"+i.join("&")),location.hash=t,arguments[1]||(r=t)},Get:function(){for(var t=arguments[0]?o?o.contentWindow.location.hash:"":location.hash,e=(t=t.substr(1)).split("&"),i=0,s=e.length;i<s;i++){var n=e[i].split("=");if(1===n.length||"hash"===n[0])return n[1]||n[0]}return t}}}(),WCT.store={KEYS:{lib_favorites:"lib_f",lib_recent:"lib_r",lib_search:"lib_s",lib_settings:"lib_set",lib_context_info:"lib_ctx",panel_ori:{lesson:"pori_l",book:"pori_b",slide:"pori_s",library:"pori_lib",file:"pori_f",cdoc:"pori_c"},backend_cookie:"T2T",scorm_api:"SCAPI"},Get:function(t){return window.localStorage&&localStorage.getItem?localStorage.getItem(t):WCT.cookie.Get(t)},Set:function(t,e){window.localStorage&&localStorage.setItem?localStorage.setItem(t,e):WCT.cookie.Set(t,e)},Remove:function(t){WCT.cookie.Remove(t),window.localStorage&&localStorage.removeItem&&localStorage.removeItem(t)}},WCT.TREE_ICONS={w:16,h:16,id:"tree_icons.png",audio:{x:0,y:-288},doc:{x:0,y:-240},doc_doc:{x:0,y:-160},doc_docx:{x:0,y:-160},doc_html:{x:0,y:-192},doc_pdf:{x:0,y:-176},doc_ppt:{x:0,y:-208},doc_pptx:{x:0,y:-208},doc_unknown:{x:0,y:-240},doc_word:{x:0,y:-160},doc_xlf:{x:0,y:-256},doc_xls:{x:0,y:-224},doc_xlsx:{x:0,y:-224},docu_doc:{x:0,y:-160},docu_doc_bpp:{x:-96,y:-160},docu_doc_business_script:{x:-80,y:-160},docu_doc_fda:{x:-112,y:-160},docu_doc_hands_on:{x:-144,y:-160},docu_doc_hpqc:{x:-128,y:-160},docu_doc_jobhelp:{x:-16,y:-160},docu_doc_standard:{x:0,y:-160},docu_doc_testsheet:{x:-48,y:-160},docu_doc_training:{x:-32,y:-160},docu_doc_work:{x:-64,y:-160},docu_html_bpp:{x:-96,y:-192},docu_html_business_script:{x:-80,y:-192},docu_html_fda:{x:-112,y:-192},docu_html_hands_on:{x:-144,y:-192},docu_html_html:{x:0,y:-192},docu_html_jobhelp:{x:-16,y:-192},docu_html_standard:{x:0,y:-192},docu_html_testsheet:{x:-48,y:-192},docu_html_training:{x:-32,y:-192},docu_html_work:{x:-64,y:-192},docu_pdf_bpp:{x:-96,y:-176},docu_pdf_business_script:{x:-80,y:-176},docu_pdf_fda:{x:-112,y:-176},docu_pdf_hands_on:{x:-144,y:-176},docu_pdf_jobhelp:{x:-16,y:-176},docu_pdf_standard:{x:0,y:-176},docu_pdf_testsheet:{x:-48,y:-176},docu_pdf_training:{x:-32,y:-176},docu_pdf_work:{x:-64,y:-176},docu_ppt_ppt:{x:0,y:-208},img:{x:0,y:-272},ref_book:{x:-32,y:-32},ref_group:{x:-16,y:-32},ref_group_translation_package:{x:-64,y:-32},ref_group_content_package:{x:-64,y:-48},ref_group_solman_folder:{x:-0,y:-448},ref_group_solman_iface:{x:-64,y:-448},ref_group_solman_mada:{x:-48,y:-448},ref_group_solman_others:{x:-96,y:-448},ref_group_solman_proc:{x:-32,y:-448},ref_group_solman_procstep:{x:-80,y:-448},ref_group_solman_root:{x:-112,y:-448},ref_group_solman_scn:{x:-16,y:-448},ref_group_aris_default:{x:-128,y:-448},ref_group_aris_folder:{x:0,y:-448},ref_group_aris_process:{x:-32,y:-448},ref_group_aris_process_step:{x:-80,y:-448},ref_group_aris_scenario:{x:-16,y:-448},ref_group_additional_elements:{x:0,y:-112},ref_group_process_link:{x:-144,y:-448},ref_media:{x:-16,y:-240},ref_media_file:{x:-16,y:-240},ref_media_audio:{x:-16,y:-288},ref_media_doc:{x:-160,y:-160},ref_media_pdf:{x:-160,y:-176},ref_media_image:{x:-16,y:-272},ref_media_video:{x:-16,y:-304},ref_orphans:{x:0,y:-336},ref_orphans_my:{x:-16,y:-336},ref_project:{x:-48,y:-64},ref_project_context_assistant:{x:-16,y:-64},ref_project_context_help:{x:-16,y:-64},ref_project_process_support:{x:-32,y:-64},ref_project_xray_help:{x:-96,y:-64},ref_project_xray_tour:{x:-80,y:-64},ref_project_standard:{x:0,y:-64},ref_project_undefined:{x:-48,y:-64},ref_project_quiz:{x:-64,y:-64},ref_cdoc:{x:0,y:-112},ref_cdoc_general:{x:0,y:-112},ref_cdoc_concept:{x:-16,y:-112},ref_cdoc_task:{x:-32,y:-112},ref_cdoc_reference:{x:-48,y:-112},ref_cdoc_problem:{x:0,y:-128},ref_cdoc_todo:{x:-16,y:-128},ref_cdoc_defect:{x:-32,y:-128},ref_cdoc_requirement:{x:-48,y:-128},ref_cdoc_subsystem:{x:0,y:-144},ref_cdoc_component:{x:-16,y:-144},ref_cdoc_function:{x:-32,y:-144},ref_cdoc_glossary_entry:{x:-64,y:-128},ref_cdoc_translation_info:{x:-80,y:-128},ref_slide:{x:-64,y:-96},ref_slide_template:{x:-48,y:-32},ref_trash:{x:0,y:-352},res_adaptable:{x:0,y:-320},res_book_style:{x:-16,y:-368},res_bubble:{x:-64,y:-368},res_doc_settings:{x:-32,y:-320},res_glossary:{x:-80,y:-368},res_help:{x:0,y:-384},res_library:{x:-16,y:-368},res_macroset:{x:-96,y:-368},res_mouse:{x:-48,y:-368},res_panel:{x:-16,y:-368},res_popup:{x:-16,y:-368},res_quiz_style:{x:-16,y:-368},res_recognize:{x:-128,y:-368},res_rtprofile:{x:-144,y:-368},res_record_glossary:{x:-80,y:-368},res_resource:{x:-16,y:-320},res_root:{x:0,y:-368},res_script:{x:-112,y:-368},res_style:{x:-32,y:-368},res_task_style:{x:-16,y:-368},res_trainer:{x:-16,y:-368},res_wa_filters:{x:-16,y:-384},tour_context_assistant:{x:-96,y:-96},tour_context_help:{x:-96,y:-96},tour_demo:{x:0,y:-96},tour_pres:{x:-144,y:-96},tour_guided:{x:-160,y:-96},tour_dnt:{x:-128,y:-96},tour_epo:{x:-112,y:-96},tour_praxis:{x:-48,y:-96},tour_process_support:{x:-80,y:-96},tour_test:{x:-32,y:-96},tour_uebung:{x:-16,y:-96},unknown:{x:0,y:-240},video:{x:0,y:-304},workarea_root:{x:0,y:-32}},WCT.QrCode=function(){this.mods_=null,this.cache_=null,this.bit_=null,this.byte_=null,this.math_=null,this.mod_count_=0,this.type_id_=1},WCT.QrCode.LEN_INIT_MAP={1:10,2:20,3:40,4:60,5:80,6:100,7:120,8:150,9:180,10:210,11:250,12:280,13:330,14:360,15:410,16:450,17:500,18:560,19:620,20:660,21:710,22:770,23:850,24:910,25:990,26:1050},WCT.QrCode.Cleanup=function(){WCT.QrCode.math.EXP_TABLE=null,WCT.QrCode.math.LOG_TABLE=null},WCT.QrCode.GenerateHtml=function(t){var e=new WCT.QrCode,i=e.GenerateHtml(t,arguments[1],arguments[2],arguments[3])||"";return e.Destructor(),i},WCT.QrCode.prototype=function(){var d=236,u=17,p=1335,a=7973,f=21522,m=[[1,26,16],[1,44,28],[1,70,44],[2,50,32],[2,67,43],[4,43,27],[4,49,31],[2,60,38,2,61,39],[3,58,36,2,59,37],[4,69,43,1,70,44],[1,80,50,4,81,51],[6,58,36,2,59,37],[8,59,37,1,60,38],[4,64,40,5,65,41],[5,65,41,5,66,42],[7,73,45,3,74,46],[10,74,46,1,75,47],[9,69,43,4,70,44],[3,70,44,11,71,45],[3,67,41,13,68,42],[17,68,42],[17,74,46],[4,75,47,14,76,48],[6,73,45,14,74,46],[8,75,47,13,76,48],[19,74,46,4,75,47],[22,73,45,3,74,46],[3,73,45,23,74,46],[21,73,45,7,74,46],[19,75,47,10,76,48],[2,74,46,29,75,47],[10,74,46,23,75,47],[14,74,46,21,75,47],[14,74,46,23,75,47],[12,75,47,26,76,48],[6,75,47,34,76,48],[29,74,46,14,75,47],[13,74,46,32,75,47],[40,75,47,7,76,48],[18,75,47,31,76,48]],b=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]];function o(t,e){var i=4*this.type_id_+17;this.mod_count_=i,this.mods_=function o(t){for(var e=new Array(t),i=t-1,s=i;0<=s;s--){e[s]=new Array(t);for(var n=i;0<=n;n--)e[s][n]=null}return e}(i),s.call(this,0,0),s.call(this,i-7,0),s.call(this,0,i-7),function _(){for(var t=b[this.type_id_-1],e=this.mods_,i=t.length,s=0;s<i;s++)for(var n=0;n<i;n++){var o=t[s],r=t[n];if(null==e[o][r])for(var a=-2;a<=2;a++)for(var l=2==Math.abs(a),c=-2;c<=2;c++)e[o+a][r+c]=!a&&!c||l||2==Math.abs(c)}}.call(this),function n(){for(var t=this.mods_,e=this.mod_count_-8,i=8;i<e;i++)null==t[i][6]&&(t[i][6]=i%2==0);for(var s=8;s<e;s++)null==t[6][s]&&(t[6][s]=s%2==0)}.call(this),function l(t,e){for(var i=function a(t){var e=t<<10,i=v(p);for(;0<=v(e)-i;)e^=p<<v(e)-i;return(t<<10|e)^f}(e),s=this.mod_count_,n=this.mods_,o=0;o<15;o++){var r=!t&&1==(i>>o&1);o<6?n[o][8]=r:o<8?n[o+1][8]=r:n[s-15+o][8]=r}for(o=0;o<15;o++){r=!t&&1==(i>>o&1);o<8?n[8][s-o-1]=r:8==o?n[8][15-o]=r:n[8][15-o-1]=r}n[s-8][8]=!t}.call(this,t,e),6<this.type_id_&&function r(t){for(var e=function o(t){var e=t<<12,i=v(a);for(;0<=v(e)-i;)e^=a<<v(e)-i;return t<<12|e}(this.type_id_),i=this.mod_count_-8-3,s=this.mods_,n=0;n<18;n++)s[Math.floor(n/3)][n%3+i]=!t&&1==(e>>n&1),s[n%3+i][Math.floor(n/3)]=!t&&1==(e>>n&1)}.call(this,t),null==this.cache_&&(this.cache_=function c(){var t=this.byte_,e=new WCT.QrCode.bit;e.Put(4,4),e.Put(t.GetLength(),function a(){var t=this.type_id_;{if(1<=t&&t<10)return 8;if(t<41)return 16;throw new Error("type:"+t)}}.call(this)),t.Write(e);for(var i=0,s=function l(){for(var t=m[this.type_id_-1],e=t.length/3,i=[],s=0;s<e;s++)for(var n=0,o=t[3*s];n<o;n++)i.push({total_count:t[3*s+1],data_count:t[3*s+2]});return i}.call(this),n=0,o=s.length;n<o;n++)i+=s[n].data_count;var r=e.GetLength();if(8*i<r)throw new Error("code length overflow. ("+r+">"+8*i+")");r+4<=8*i&&e.Put(0,4);for(;e.GetLength()%8!=0;)e.PutBit(!1);for(;!(e.GetLength()>=8*i||(e.Put(d,8),e.GetLength()>=8*i));)e.Put(u,8);this.bit_&&this.bit_.Destructor();return this.bit_=e,function x(t){for(var e=0,i=t.length,s=new Array(i),n=new Array(i),o=new Array(i),r=new Array(i),a=this.bit_.GetBuffer(),l=this.math_,c=0,_=0;_<i;_++){var d=t[_].data_count,u=t[_].total_count-d;c+=t[_].total_count,s[_]=d,n[_]=u,o[_]=new Array(d);for(var h=0;h<d;h++)o[_][h]=255&a[h+e];e+=d;var p=A.call(this,u),f=p.GetLength()-1,m=new WCT.QrCode.polynomial(o[_],f),b=m.Mod(p,l),v=b.GetLength();r[_]=new Array(f);for(h=0;h<r[_].length;h++){var g=h+v-r[_].length;r[_][h]=0<=g?b.Get(g):0}p.Destructor(),m.Destructor(),b.Destructor()}s.push(0),n.push(0),s=Math.max.apply(null,s),n=Math.max.apply(null,n);var y=new Array(c),C=0;for(_=0;_<s;_++)for(var T=0;T<i;T++)_<o[T].length&&(y[C++]=o[T][_]);for(_=0;_<n;_++)for(T=0;T<i;T++)_<r[T].length&&(y[C++]=r[T][_]);return y}.call(this,s)}.call(this)),function h(t,e){for(var i=-1,s=this.mod_count_,n=this.mods_,o=s-1,r=7,a=0,l=s-1;0<l;l-=2)for(6==l&&l--;;){for(var c=0;c<2;c++)if(null==n[o][l-c]){var _=!1;a<t.length&&(_=1==(t[a]>>>r&1));var d=null,u=l-c;switch(e){case 0:d=(o+u)%2==0;break;case 1:d=o%2==0;break;case 2:d=u%3==0;break;case 3:d=(o+u)%3==0;break;case 4:d=(Math.floor(o/2)+Math.floor(u/3))%2==0;break;case 5:d=o*u%2+o*u%3==0;break;case 6:d=(o*u%2+o*u%3)%2==0;break;case 7:d=(o*u%3+(o+u)%2)%2==0;break;default:throw new Error("Bad mask pattern: "+e)}d&&(_=!_),n[o][l-c]=_,-1==--r&&(a++,r=7)}if((o+=i)<0||s<=o){o-=i,i=-i;break}}}.call(this,this.cache_,e)}function r(){for(var t=0,e=0,i=0;i<8;i++){o.call(this,!0,i);var s=n.call(this);(!i||s<t)&&(t=s,e=i)}return e}function n(){for(var t=this.mod_count_,e=this.mods_,i=0,s=0,n=0;n<t;n++)for(var o=0;o<t;o++){var r=0,a=e[n][o];a&&i++;for(var l=-1;l<=1;l++)if(!(n+l<0||t<=n+l))for(var c=-1;c<=1;c++)!l&&!c||o+c<0||t<=o+c||a==e[n+l][o+c]&&r++;5<r&&(s+=r-2)}for(n=0;n<t-1;n++)for(o=0;o<t-1;o++){var _=0;e[n][o]&&_++,e[n+1][o]&&_++,e[n][o+1]&&_++,e[n+1][o+1]&&_++,_&&4!=_||(s+=3)}for(n=0;n<t;n++)for(o=0;o<t-6;o++)e[n][o]&&!e[n][o+1]&&e[n][o+2]&&e[n][o+3]&&e[n][o+4]&&!e[n][o+5]&&e[n][o+6]&&(s+=40);for(o=0;o<t;o++)for(n=0;n<t-6;n++)e[n][o]&&!e[n+1][o]&&e[n+2][o]&&e[n+3][o]&&e[n+4][o]&&!e[n+5][o]&&e[n+6][o]&&(s+=40);return s+Math.abs(100*i/t/t-50)/5*10}function s(t,e){for(var i=this.mod_count_,s=this.mods_,n=-1;n<=7;n++)if(!(t+n<=-1||i<=t+n))for(var o=-1;o<=7;o++)e+o<=-1||i<=e+o||(s[t+n][e+o]=0<=n&&n<=6&&o%6==0||0<=o&&o<=6&&n%6==0||2<=n&&n<=4&&2<=o&&o<=4)}function v(t){for(var e=0;0!=t;)e++,t>>>=1;return e}function A(t){for(var e=new WCT.QrCode.polynomial([1],0),i=this.math_,s=0;s<t;s++){var n=new WCT.QrCode.polynomial([1,i.GetExp(s)],0),o=e.Multiply(n,i);n.Destructor(),e.Destructor(),e=o}return e}function l(){var t=arguments[0]||"",e=arguments[1]||0,i=arguments[2]||{},s=arguments[3]||["#000","#fff"],n=[];for(var o in i)n.push(o+":"+i[o]+";");var r=['<table role="figure" ','aria-label="QR Code: '+t+'" ','summary="QR Code: '+t+'" style="',n," border:0;"," border-collapse:collapse;"," padding:0;direction:ltr;",'">',"<tbody>"],a=this.mod_count_,l=this.mods_;if(!(e=0<e?Math.floor(e/a):8))return"";for(var c=0;c<a;c++){r.push("<tr>");for(var _=0;_<a;_++)r.push('<td style="'," border:0;"," border-collapse:collapse;"," padding:0;margin:0;"," width:"+e+"px;"," height:"+e+"px;"," background:",l[c][_]?s[0]:s[1],';">',"</td>");r.push("</tr>")}return r.push("</tbody>","</table>"),r.join("")}return{Destructor:function(){this.mods_=null,this.cache_=null,this.bit_&&(this.bit_.Destructor(),this.bit_=null),this.byte_&&(this.byte_.Destructor(),this.byte_=null),this.math_&&(this.math_.Destructor(),this.math_=null)},GenerateHtml:function(t){var e=WCT.QrCode.LEN_INIT_MAP,i=t.length;for(var s in i=10*Math.round(i/10),e){if(!(e[s]<=i))break;this.type_id_=s}for(;;)try{return this.byte_&&this.byte_.Destructor(),this.byte_=new WCT.QrCode["byte"](t),this.math_&&this.math_.Destructor(),this.math_=new WCT.QrCode.math,this.cache_=null,o.call(this,!1,r.call(this)),l.apply(this,arguments)}catch(n){if(!(this.type_id_++<40))return"";this.mod_count_=0,this.mods_=null}}}}(),WCT.QrCode.bit=function(){this.b_=[],this.l_=0},WCT.QrCode.bit.prototype={Destructor:function(){this.b_=null},GetBuffer:function(){return this.b_},Get:function(t){var e=Math.floor(t/8);return 1==(this.b_[e]>>>7-t%8&1)},Put:function(t,e){for(var i=0;i<e;i++)this.PutBit(1==(t>>>e-i-1&1))},GetLength:function(){return this.l_},PutBit:function(t){var e=Math.floor(this.l_/8);this.b_.length<=e&&this.b_.push(0),t&&(this.b_[e]|=128>>>this.l_%8),this.l_++}},WCT.QrCode["byte"]=function(t){for(var e=t.length,i=new Array(e),s=0;s<e;s++)i[s]=255&t.charCodeAt(s);this.b_=i},WCT.QrCode["byte"].prototype={Destructor:function(){this.b_=null},GetLength:function(){return this.b_.length},Write:function(t){for(var e=0,i=this.b_,s=i.length;e<s;e++)t.Put(i[e],8)}},WCT.QrCode.polynomial=function(t,e){if("undefined"==typeof t.length)throw new Error(t.length+" / "+e);for(var i=t.length,s=0;s<i&&0==t[s];)s++;i-=s;for(var n=new Array(i+e),o=0;o<i;o++)n[o]=t[o+s];this.n_=n},WCT.QrCode.polynomial.prototype={Destructor:function(){this.n_=null},Get:function(t){return this.n_[t]},GetLength:function(){return this.n_.length},Multiply:function(t,e){for(var i=this.n_,s=t.n_,n=i.length,o=s.length,r=new Array(n+o-1),a=0;a<n;a++)for(var l=0;l<o;l++){var c=e.GetLog(i[a]),_=e.GetLog(s[l]);r[a+l]^=e.GetExp(c+_)}return new WCT.QrCode.polynomial(r,0)},Mod:function(t,e){var i=this.n_,s=t.n_,n=i.length,o=s.length;if(n-o<0)return this;for(var r=e.GetLog(i[0])-e.GetLog(s[0]),a=new Array(n),l=0;l<n;l++)a[l]=i[l];for(l=0;l<o;l++)a[l]^=e.GetExp(e.GetLog(s[l])+r);return new WCT.QrCode.polynomial(a,0).Mod(t,e)}},WCT.QrCode.math=function(){var t=WCT.QrCode.math;if(!t.EXP_TABLE){for(var e=new Array(256),i=new Array(256),s=0;s<8;s++)e[s]=1<<s;for(s=8;s<256;s++)e[s]=e[s-4]^e[s-5]^e[s-6]^e[s-8];for(s=0;s<255;s++)i[e[s]]=s;t.EXP_TABLE=e,t.LOG_TABLE=i}this.e_=WCT.DeepCopy(t.EXP_TABLE),this.l_=WCT.DeepCopy(t.LOG_TABLE)},WCT.QrCode.math.EXP_TABLE=null,WCT.QrCode.math.LOG_TABLE=null,WCT.QrCode.math.prototype={Destructor:function(){this.e_=null,this.l_=null},GetExp:function(t){for(;t<0;)t+=255;for(;256<=t;)t-=255;return this.e_[t]},GetLog:function(t){if(t<1)throw new Error("GetLog("+t+")");return this.l_[t]}},WCT.Tree=function(t,e,i,s){this.uid_=t,this.context_=e,this.env_=i,this.callbacks_=s,this.tree_={},this.id_map_={},this.nbr_=0,this.sel_=null,this.limit_={},this.expanded_={},this.gif_1_="1.png";var n=this.config_||{};n.root=null,n.as_list=!1,n.auto_select_root=!0,n.expand_on_select=!1,n.collapse_on_select=!1,n.rtl=!1,n.tabindex=0;var o=arguments[4];if(o)for(var r in o.src_1_gif&&(this.gif_1_=o.src_1_gif),o)"undefined"!=typeof n[r]&&(n[r]=o[r]);this.config_=n,this.skin_=WCT.skin.Merge(WCT.Tree.SKIN,arguments[5]),this.ncss_=' style="',this.nhtml_=[],this.set_skin_(),WCT.Tree.STORE[t]=this},WCT.Tree.LESSON_MODE=window.DATA?window.DATA.LESSON_MODE:{demo:!0,uebung:!0,praxis:!0,test:!0},WCT.ExtendObject(WCT.Tree,{STORE:{},EXPANDABLE:{Ref:!0,Res:!0,OU:!0},SKIN:{image_closed:{id:"s.png",x:-293,y:-73,w:16,h:16},image_closed_rtl:{id:"s.png",x:-293,y:-92,w:16,h:16},image_open:{id:"s.png",x:-312,y:-73},image_opening:{id:"o.gif"},text_color:"#000000",text_color_h:"#F0AB00",text_color_a:"#FFFFFF",selected_text_color_h:"#FFFFFF",font_weight_a:"bold",background_color:"#FFFFFF",background_color_a:"#F0AB00",background_color_h:"#FFFFFF",node:{img_text_spacing:2,list_border_bottom:"1px solid #EFEFEF",list_margin:4,tree_margin:4}},Cleanup:function(){for(var t in WCT.Tree.STORE)WCT.Tree.STORE[t].Destructor();WCT.Tree.STORE={}},GetIconImage:function(t){var e=WCT.TREE_ICONS||{},i="",s="";switch(t.type){case"Res":i="resources"==t.tclass?"res_resource":"res_"+t.tclass;break;case undefined:case"Ref":var n=t.tclass,o=t.sub_type;if(i="wa"===n?"workarea_root":"ref_"+n,o)if("media"===n)"-"!==o&&(i+="_"+o);else if("template"===o)i+="_template";else if("project"===n){if((c={pa:"_process_support",ca:"_context_assistant",quiz_project:"_quiz",tour:"_xray_tour",help:"_xray_help"})[o]){i+=c[o];break}}else if("group"===n&&"desktop_assistant"===o);else if("group"!==n||"process_link"!==o&&"desktop_assistant"!==o&&"additional_elements"!==o&&"aris"!==o.substring(0,4)&&"solman"!==o.substring(0,6)){var r=arguments[3]||this.context_,a=WCT.AdaptableClasses&&r&&WCT.AdaptableClasses.GetIcon(t,r);if(a)return a}else i+="_"+o;s=i;var l={project:"macroset",cdoc:"doc_type"}[n];l&&(i+="_"+t[l]);break;case"Tour":i="tour_"+t.mode;break;case"Docu":var c;if(t.mode&&t.mode.indexOf("compound_doc")&&t.mode.indexOf("master/")&&"ppt"!=t.mode)(c=t.mode.split("_")).top()==t.doc_type&&(c.pop(),(t=WCT.DeepCopy(t)).mode=c.join("_")),i="docu_"+t.doc_type+"_"+t.mode;else i="doc_"+t.doc_type;break;case"Doc":i="doc_"+t.doc_type;break;default:i="string"==typeof t.type?t.type.toLowerCase():"unknown"}var _=arguments[1]||"",d=arguments[2]||"";return _&&(_+="_"),i=e[_+i+(d=d&&"_"+d)]||e[_+i]||e[i+d]||e[i]||e[s]||e.unknown||null,(i=WCT.DeepCopy(i))&&(i.id=e.id||"",!i.w&&e.w&&(i.w=e.w),!i.h&&e.h&&(i.h=e.h)),i}}),WCT.Tree.prototype=function(){function o(t){var e=(t=WCT.event.Standardize(t)).target,i=t.targetName,s="img"==i||"span"==i?e.parentNode:e,n=s.id.split("#"),o=Number(n.pop()),r=WCT.Tree.STORE[n.join("#")];if(r&&!isNaN(o)){var a="img"===i&&1==e.getAttribute("i"),l="img"===i&&2==e.getAttribute("i")||"span"===i||"div"===i&&0<=e.id.search(/#tree#/);if(!a&&!l&&r.config_.as_list){var c=WCT.dom.GetPosition(e.lastChild,!0),_=WCT.dom.GetPosition(e.childNodes[1],!0);r.config_.rtl?t.clientX<c.left?l=!0:t.clientX>=_.left&&(a=!0):t.clientX>=c.left?l=!0:t.clientX<_.left&&(a=!0)}switch(t.type){case"click":a?r[r.expanded_[o]?"Collapse":"Expand"](o):l&&(r.sel_===o&&r.expanded_[o]&&r.config_.collapse_on_select?r.Collapse(o):!r.expanded_[o]&&r.config_.expand_on_select&&r.Expand(o),r.Select(o));break;case"mouseover":case"mouseout":if(!l)break;var d=r.skin_,u=null,h=null;h="mouseover"==t.type?(u=o==r.sel_&&d.selected_text_color_h?d.selected_text_color_h:d.text_color_h,o!=r.sel_&&d.background_color_h?d.background_color_h:null):(u=o==r.sel_&&d.text_color_a?d.text_color_a:d.text_color,o!=r.sel_&&d.background_color),r.config_.as_list||(s=s.childNodes[2]),u&&(s.style.color=u),h&&(s.style.backgroundColor=h)}}}return{Destructor:function(){delete WCT.Tree.STORE[this.uid_];var t=$(this.uid_);t&&(t.onclick=null,t.onmouseover=null,t.onmouseout=null,t.parentNode.removeChild(t)),(t=$(this.uid_+"#opening"))&&t.parentNode.removeChild(t),this.tree_=null,this.id_map_=null,this.limit_=null,this.expanded_=null,this.context_=null,this.env_=null,this.callbacks_=null,this.config_=null,this.skin_=null,this.nhtml_=null},SetLimit:function(t,e){this.limit_[t]=e},Create:function(t){var e=this.skin_;if(!e||!e.image_open||!e.image_closed)return null;if(e.image_opening){var i=$$("img");i.id=this.uid_+"#opening",i.src=e.image_opening.id,i.style.position="absolute",i.style.visibility="hidden",t.appendChild(i)}var s=this.config_,n=$$("div");return n.id=this.uid_,n.setAttribute("role","tree"),n.className="wct-controls-tree",s.as_list?WCT.skin.Apply(n,e):WCT.skin.ApplyTextFormats(n,e),e.font_size&&(n.style.lineHeight=e.font_size+4+"px"),s.rtl&&(n.style.direction="rtl"),n.style.overflow="auto",n.style.whiteSpace="nowrap",t.appendChild(n),n.onclick=o,n.onmouseover=o,n.onmouseout=o,n},Select:function(t){var e="string"==typeof t?this.select_(t):this.get_node_info_(t);if(!e)return!1;var i=this.skin_;if(i.background_color_a||i.text_color_a){var s=this.config_,n=s.as_list;if(null!=this.sel_){var o=this.get_node_info_(this.sel_);if(o){var r=o.dom;r.className="node",r.setAttribute("aria-selected","false"),n||(r=r.childNodes[2]),r.style.backgroundColor=i.background_color||"#fff",r.style.color=i.text_color||"#000",r.style.fontWeight=i.font_weight||"normal"}}var a=e.dom;a.className="node active",a.setAttribute("aria-selected","true"),n||(a=a.childNodes[2]),i.background_color_a&&(a.style.backgroundColor=i.background_color_a),i.text_color_a&&(a.style.color=i.text_color_a),i.font_weight_a&&(a.style.fontWeight=i.font_weight_a);var l=this.env_;BROWSER.IE10&&s.rtl&&l.RefreshIE&&WCT.SetTimeout(l.RefreshIE,100,l);var c=n?a:a.parentNode,_=$(this.uid_);if(_)if(_.getBoundingClientRect){var d=_.getBoundingClientRect(),u=c.getBoundingClientRect(),h=i.font_size?i.font_size+4:i.image_closed.h,p=WCT.dom.GetScrollbarHeight(),f={x:0,y:d.top,w:10,h:_.offsetHeight-p},m={x:0,y:u.top,w:5,h:h};WCT.geometry.IncludesRect(f,m)||(_.scrollTop=m.y+_.scrollTop+m.h+p-f.y-f.h)}else{var b=_.scrollLeft;c.scrollIntoView(!0),_.scrollLeft=b}}return this.sel_=e.id,this.send_notification_("select",e),e.dom.childNodes[2].focus(),!0},Expand:function(t){var e=this.get_node_info_(t);if(!e||!WCT.Tree.EXPANDABLE[e.type]||!1===e.expandable||this.expanded_[e.id])return!1;e.dom.setAttribute("aria-expanded","true");var i=this.skin_;i.image_opening&&this.set_opener_icon_(e,"opening",i.image_opening);var s=this.config_;if(s.as_list){var n={};if(n[s.rtl?"padding-right":"padding-left"]=16*(e.lvl+1)+"px",!(a=this.create_subtree_(e.id,n)))return this.set_not_expandable_(e);for(var o=$(this.uid_),r=e.dom.nextSibling;a.firstChild;)o.insertBefore(a.firstChild,r)}else{var a;if(!(a=this.create_subtree_(e.id)))return this.set_not_expandable_(e);a.className="subtree",a.style[s.rtl?"marginRight":"marginLeft"]="16px",e.dom.appendChild(a)}return this.set_opener_icon_(e,"open",i.image_open),this.expanded_[e.id]=!0,this.send_notification_("expand",e),!0},Collapse:function(t){var e=this.get_node_info_(t);if(!e||!this.expanded_[e.id])return!1;e.dom.setAttribute("aria-expanded","false");var i=e.children,s=this.expanded_,n=this.config_;if(n.as_list)for(var o=i.length-1;0<=o;o--){s[i[o]]&&this.Collapse(i[o]),(r=this.get_node_info_(i[o])).dom.parentNode.removeChild(r.dom),this.remove_id_(r,e)}else if(3<e.dom.childNodes.length){for(o=i.length-1;0<=o;o--){s[i[o]]&&this.Collapse(i[o]);var r=this.get_node_info_(i[o]);this.remove_id_(r,e)}e.dom.removeChild(e.dom.lastChild)}var a=this.skin_;return this.set_opener_icon_(e,"closed",a[n.rtl?"image_closed_rtl":"image_closed"]||a.image_closed),delete this.expanded_[e.id],this.send_notification_("collapse",e),!0},GetPath:function(t){var e=this.get_node_info_(t);if(!e)return null;for(var i=[];null!=e.parent;)e=this.get_node_info_(e.parent),i.unshift({type:e.type,tclass:e.tclass,uid:e.uid,caption:e.caption});return i},GetDom:function(){return $(this.uid_)},GetRootNode:function(){return this.config_.root},Contains:function(t){var e="boolean"!=typeof arguments[1]||arguments[1],i=this.get_node_info_(t);return!i&&e&&"string"==typeof t&&(i=this.search_(t)),null!=i},SearchSelectionBottomUp:function(t){var e=this.get_node_info_(this.sel_);if(!e)return null;do{if(e.tclass==t)return e.uid;e=null!=e.parent?this.get_node_info_(e.parent):null}while(e);return null},Reselect:function(){return null!=this.sel_&&this.Select(this.sel_)},SelectPrev:function(){var t=this.get_node_info_(this.sel_),e=t?this.get_node_info_(t.parent):null;if(!e)return!1;var i=e.children.indexOf(t.id);if(--i<0)return this.Select(e.id);for(;;){var s=this.get_node_info_(e.children[i]);if(this.Expand(s.id),!(i=s.children.length))return this.Select(s.id);e=s,i--}},SelectNext:function(){var t=this.get_node_info_(this.sel_);if(!t)return!1;if(!1!==t.expandable&&(this.Expand(this.sel_),t.children.length))return this.Select(t.children[0]);for(;;){var e=this.get_node_info_(t.parent);if(!e)return!1;var i=e.children.indexOf(t.id);if(++i<e.children.length)return this.Select(e.children[i]);t=e}},set_skin_:function(){var t=this.skin_,e=this.config_,i=e.as_list;i&&(t.list_border_top&&(t.border_top=t.list_border_top,delete t.list_border_top),t.list_border_bottom&&(t.border_bottom=t.list_border_bottom,delete t.list_border_bottom));var s=t.node||{},n=s.list_margin||"",o=s.tree_margin||"";("number"!=typeof n||n<0)&&(n=null),("number"!=typeof o||o<0)&&(o=null);var r=["-webkit-touch-callout:none","-webkit-user-select:none","-khtml-user-select:none","-moz-user-select:none","-ms-user-select:none","-o-user-select:none","user-select:none"];i?(r.push("overflow:hidden","text-overflow:ellipsis","cursor:pointer"),n&&r.push("padding:"+n+"px 0"),s.list_border_top&&r.push("border-top:"+s.list_border_top),s.list_border_bottom&&r.push("border-bottom:"+s.list_border_bottom)):o&&r.push("margin:"+o+"px 0"),this.ncss_=' style="'+r.join(";")+";";var a=(e.rtl?"margin-left:":"margin-right:")+(s.img_text_spacing||2)+"px";this.nhtml_=['<div class="node" onselectstart="this.blur(); return false;" onclick="javascript:void(0);" id="'+this.uid_+"#",'"','><img role="button" i="1" src="'+this.gif_1_+'" ',' style="',";vertical-align:middle",'" /><img role="presentation" class="icon" i="2" src="'+this.gif_1_+'" ',' style="',";vertical-align:middle;cursor:pointer;"+a+'" /><span role="link" tabindex="'+e.tabindex+'" class="text','" style="vertical-align:middle;padding:0 2px;cursor:pointer;" title="','">',"</span></div>"]},create_tree_item_:function(t,e){var i=this.tree_;i[t]?(i[t].caption=e.caption||e.name||"",i[t].expandable=e.expandable,i[t].isHidden=e.hidden,i[t].img=arguments[2]||WCT.Tree.GetIconImage(e,null,null,this.context_)):i[t]={addr:t,id:[],lvl:[],parent:[],children:[],type:e.type||"Ref",tclass:e.tclass,uid:e.uid||null,caption:e.caption||e.name||"",expandable:e.expandable,isHidden:e.hidden,img:arguments[2]||WCT.Tree.GetIconImage(e,null,null,this.context_),inherited:e.inherited||!1}},create_id_:function(t,e,i){var s=this.nbr_++,n=this.tree_[t];return n.id.push(s),n.lvl.push(e),n.parent.push(i),n.children.push([]),this.id_map_[s]=t,s},remove_id_:function(t,e){t.id==this.sel_&&(this.sel_=null)!=t.parent&&this.Select(t.parent);var i=this.tree_[t.addr],s=i.id.indexOf(t.id);i.id.splice(s,1),i.lvl.splice(s,1),i.parent.splice(s,1),i.children.splice(s,1);var n=this.id_map_;delete n[t.id];var o=[];for(var r in n)o.push(Number(r));o=Math.max.apply(null,o),this.nbr_=o+1;var a=e.children.indexOf(t.id);e.children.splice(a,1)},get_node_info_:function(t){var e=t,i=null,s=0;if("number"==typeof t)t=this.id_map_[e],s=(i=this.tree_[t]).id.indexOf(e);else{if("string"!=typeof t)return null;e=(i=this.tree_[t])?i.id[s]:null}if(arguments[1])return i;var n=$(this.uid_+"#"+e);return i&&n?{addr:t,id:e,lvl:i.lvl[s],parent:i.parent[s],children:i.children[s],type:i.type,tclass:i.tclass,uid:i.uid,caption:i.caption,expandable:i.expandable,img:i.img,dom:n}:null},create_node_:function(t,e,i,s,n){var o=this.get_node_info_(t,!0);if(!o)return null;var r=this.create_id_(t,e,i),a='width="'+s.w+'" height="'+s.h+'"',l="background:transparent url() no-repeat 0 0",c="",_='" class="indent',d=' role="treeitem"';WCT.Tree.EXPANDABLE[o.type]&&!1!==o.expandable&&(l="background:transparent url("+s.id+") no-repeat "+s.x+"px "+s.y+"px",c=";cursor:pointer",_='" tabindex="'+this.config_.tabindex+'" class="indent close',d=' role="group" aria-expanded="false"');var u="background:transparent url() no-repeat 0 0",h=0,p=0;o.img&&(u="background:transparent url("+o.img.id+") scroll no-repeat "+(o.img.x||0)+"px "+(o.img.y||0)+"px",h=o.img.w||0,p=o.img.h||0);var f='width="'+h+'" height="'+p+'"',m=this.nhtml_,b=o.caption.replace(/</g,"&lt;").replace(/>/g,"&gt;"),v=o.isHidden?"; opacity:0.33;":"",g=o.inherited?" wa-fallback":"";return{dom:[m[0],r,m[1],n,d,m[2],a,m[3],l,m[4],c,_,m[5],f,m[6],u,v,m[7],g,m[8],b,m[9],b,m[10]].join(""),id:r}},get_node_css_:function(){var t=[],e=arguments[0]||{};for(var i in e)t.push(i+":"+e[i]);return this.ncss_+t.join(";")+'" '},create_subtree_:function(t){var e=this.get_node_info_(t),i=this.get_subtree_(e.addr);if(!i.length)return null;for(var s=this.skin_,n=s[this.config_.rtl?"image_closed_rtl":"image_closed"]||s.image_closed,o=this.get_node_css_(arguments[1]),r=e.lvl+1,a=this.expanded_,l=[],c=0,_=null;_=i[c++];){var d=this.create_node_(_,r,t,n,o);d&&(l.push(d.dom),e.children.push(d.id),delete a[d.id])}var u=$$("div");return u.innerHTML=l.join(""),u},set_not_expandable_:function(t){return t.expandable=!1,this.set_opener_icon_(t,"none"),!1},set_opener_icon_:function(t,e){var i=t.dom.firstChild,s=arguments[2],n="transparent url() no-repeat 0 0";switch(e){case"open":case"closed":var o="transparent url("+s.id+") no-repeat "+s.x+"px "+s.y+"px";i.src=this.gif_1_,i.style.background=o,i.style.cursor="pointer",i.className="open"===e?"indent open":"indent close";break;case"opening":i.src=s.id,i.style.background=n,i.style.cursor="default";break;case"none":i.src=this.gif_1_,i.style.background=n,i.style.cursor="default"}},search_:function(t){var e=arguments[1],i=e||this.config_.root,s=this.load_(i);if(!s)return null;if(t==e)return[e];if(s.assets)for(var n=0,o=null;o=s.assets[n++];)if(o.tclass&&o.uid){var r=this.search_(t,o.tclass+"!"+o.uid);if(r)return r.unshift(i),r}return null},select_:function(t){var e=this.get_node_info_(t);if(e)return e;var i=this.search_(t);if(!i)return null;for(var s=0,n=null;n=i[s++];)this.Expand(n);return this.get_node_info_(i.top())}}}(),WCT.EntityTree=function(t,e,i,s){this.config_={language:"1033",filter:null,show_nonref:!0,show_orphans:!1,show_orphans_my:!1,show_resources:!1,show_trash:!1,expand_slides:!0,expand_projects:!0,expand_cdocs:!0,expand_books:!0,expand_groups:!0,full_expand_check:!0},WCT.Tree.apply(this,arguments)},WCT.EntityTree.prototype=new WCT.Tree,WCT.EntityTree.RESOURCE_TYPES={adaptable:!0,book_style:!0,bubble:!0,deployments:!0,doc_settings:!0,glossary:!0,help:!0,library:!0,macroset:!0,mouse:!0,panel:!0,popup:!0,quiz_style:!0,recognize:!0,record_glossary:!0,script:!0,style:!0,task_style:!0,trainer:!0,wa_filters:!0},WCT.EntityTree.CalcNonRefAddr=function(t,e){var i="Docu"===e.type?"_"+e.doc_type:"";return t+":"+(e.mode||e.filename||e.fileName)+i},WCT.ExtendObject(WCT.EntityTree.prototype,{Create:function(t){var e=this.config_,i=e.root;if(!i)return null;var s=WCT.Tree.prototype.Create.apply(this,arguments);if(!s)return null;var n=this.skin_,o=n[e.rtl?"image_closed_rtl":"image_closed"]||n.image_closed,r=this.get_node_css_();if(this.load_(i),e.show_orphans||e.show_orphans_my||e.show_resources||e.show_trash){this.load_("wa");var a=this.create_node_("wa",0,null,o,r);s.innerHTML=a.dom,e.auto_select_root&&this.Select("wa"),this.Expand("wa")}else{var l=this.create_node_(i,0,null,o,r);l&&(s.innerHTML=l.dom),e.auto_select_root&&this.Select(i)}return s},translate_res_:function(t,e,i){var s=this.env_,n=s.Localize(t),o=s.Localize(e);return n.search(/^\[.*?\]$/)?n:o.search(/^\[.*?\]$/)?o:i},load_res_:function(t){var e=this.env_.GetS(t+":");if(!(e=e&&e.resource||null))return!1;for(var i=t.split("_"),s="IDS_WAPI_",n=0,o=i.length;n<o;n++)s+=i[n].toFirstUpperCase();var r={type:"Res",tclass:t,uid:null,caption:this.translate_res_(s,"entity."+t,t),expandable:!!e.length&&null};return this.create_tree_item_(t,r),!1!==r.expandable},load_:function(t){var e="",i=null,s=!1,n=this.config_;switch(t){case"wa":i={tclass:"wa",caption:"wa"},s=!0;break;case"resources":i={type:"Res",tclass:"resources",caption:e=this.translate_res_("IDS_WAPI_RESOURCES","entity.res","resources")},s=!0;break;case"orphans":case"orphans_my":case"trash":e=this.translate_res_("IDS_WAPI_"+t.toUpperCase(),"entity."+t,t),i={tclass:t,caption:e};var o=this.env_.GetS("."+t+":");i.assets=o&&(o.response&&o.response.assets||o.assets)||[];break;default:var r=window.WEB_EDITOR?"":":entity.txt";i=arguments[1]||this.env_.GetS(t+r),!r&&i&&(i=i.response),i=i&&WCT.DeepCopy(i)}if(!i)return null;if(i.expandable=!1!==n["expand_"+i.tclass+"s"]&&null,this.create_tree_item_(t,i),i.assets&&i.assets.length){for(var a=0,l=null;l=i.assets[a++];)if(l.type&&!WCT.Tree.EXPANDABLE[l.type]){var c=WCT.EntityTree.CalcNonRefAddr(t,l);(l=WCT.DeepCopy(l)).expandable=!1,this.create_tree_item_(c,l)}}else s||(this.tree_[t].expandable=!1,i.expandable=!1);return i},get_res_language_:function(t,e){var i=ev.GetS(t+":entity.xml","string");if("string"!=typeof i)return e;var s=(i=i.replace(/\r|\n/g,"")).indexOf('<Language name="'+this.config_.language+'"');if(s<0&&(s=i.indexOf('<Language name="1033"')),s<0)return e;for(var n=i.indexOf("</Language>",s),o=(i=i.substring(s,n)).match(/<Text name="(.*?)">(.*?)<\/Text>/),r={};o&&3==o.length;)r[o[1]]=o[2],o=(i=i.replace(/<Text name="(.*?)">(.*?)<\/Text>/,"")).match(/<Text name="(.*?)">(.*?)<\/Text>/);return r[e]||e},get_res_subtree_:function(t){var e=this.env_.GetS(t+":");if(!(e=e&&e.resource||null))return[];for(var i=[],s=0,n=null;n=e[s++];){var o=t+"!"+n.uid;n={addr:o,type:"Res",tclass:t,uid:n.uid,caption:this.get_res_language_(o,n.caption)},this.create_tree_item_(o,n),i.push(o)}return i},get_subtree_:function(t){var e={},i=function h(t){var e=[];switch(t){case"wa":var i=this.config_;if(i.show_resources&&(this.load_("resources"),e.push("resources")),i.show_orphans_my){var s=this.load_("orphans_my");s&&!1!==s.expandable&&e.push("orphans_my")}if(e.push(this.config_.root),i.show_orphans){var n=this.load_("orphans");n&&!1!==n.expandable&&e.push("orphans")}if(i.show_trash){var o=this.load_("trash");o&&!1!==o.expandable&&e.push("trash")}break;case"resources":for(var r in WCT.EntityTree.RESOURCE_TYPES)this.load_res_(r)&&e.push(r);break;default:e=WCT.EntityTree.RESOURCE_TYPES[t]?this.get_res_subtree_(t):null}return e}.call(this,t);if(null!=i)return i;if(!(i=this.load_(t)))return[];e=function p(t){var e=this.env_;if(!e.GetSM)return{};for(var i=[],s=0,n=this.config_,o=this.limit_,r=null;r=t[s++];){var a=r.tclass+"!"+r.uid;!r.tclass||!r.uid||null!=n.filter&&r.filter&&r.filter.indexOf(n.filter)<0||o[a]&&!1===o[a].self||i.push(a+":entity.txt")}var l={};if(i.length){var c=e.GetSM(i)||[];for(s=0,r=null;r=c[s++];)l[r.tclass+"!"+r.uid]=r}return l}.call(this,i.assets);var s=this.limit_,n=s[i.tclass+"!"+i.uid],o=this.tree_,r=null;i.autostart&&(r="slide"!=(r=new WCT.address(i.autostart).AsObject(WCT.Tree.LESSON_MODE)).tclass||r.fileName?null:r.uid);for(var a=[],l=this.config_,c=0,_=null;_=i.assets[c++];)if(!(null!=l.filter&&_.filter&&_.filter.indexOf(l.filter)<0)){var d;if(_.tclass&&_.uid){var u=WCT.ClampBoolean(_.autostart);if("slide"==_.tclass&&(u||_.uid==r))continue;if("da"===_.tclass)continue;if(s[d=_.tclass+"!"+_.uid]&&!1===s[d].self)continue;if(n){if(!1===n[(_=this.load_(d,e[d])).tclass]||null!=n.language&&"mul"!=_.language&&_.language!=n.language)continue;s[d]=n,delete s[d].self}!1!==arguments[1]&&(this.load_(d,e[d]),l.full_expand_check)&&!(e[d]?0<e[d].assets.length:0<this.get_subtree_(d,!1).length)&&o[d]&&(o[d].expandable=!1)}else{if(!l.show_nonref)continue;d=WCT.EntityTree.CalcNonRefAddr(t,_)}a.push(d)}return a},send_notification_:function(t,e){var i=this.callbacks_;if(i.callback_f){var s;if("Res"==e.type)s={type:"Res",tclass:e.tclass,caption:e.caption};else if("Ref"==e.type){switch(e.addr){case"wa":case"orphans":case"orphans_my":case"resources":case"trash":s={tclass:e.tclass,caption:e.caption};break;default:s=this.env_.GetS(e.addr+":entity.txt"),s=WCT.DeepCopy(s)}if(!s)return;s.type="Ref"}else{var n=this.get_node_info_(e.parent);if(!(s=n?this.env_.GetS(n.addr+":entity.txt"):null)||!s.assets)return;for(var o=0,r=null;r=s.assets[o++];)if(WCT.EntityTree.CalcNonRefAddr(n.addr,r)==e.addr){s=r;break}if(s.assets)return}"select"==(s.event=t)&&(s.path=this.GetPath(e.id)),WCT.SetTimeout(i.callback_f,100,i.callback_s,[s])}}}),WCT.IdentityTree=function(t,e,i,s){this.config_={src_icons:"",expand_ous:!0,expand_groups:!0,expand_users:!1,show_ous:!0,show_groups:!0,show_users:!0,show_active_only:!0},WCT.Tree.apply(this,arguments)},WCT.IdentityTree.prototype=new WCT.Tree,WCT.ExtendObject(WCT.IdentityTree.prototype,function(){function n(t){var e=this.env_.GetS("mgr:"+t);if(!(e=e||null))return null;if(t.search(/^ou!/i))if(t.search(/^group!/i)){if(t.search(/^user/i))return null;(e=WCT.DeepCopy(e.user)).type="User"}else(e=WCT.DeepCopy(e.group)).type="Group";else{var i=e.ou;(e=WCT.DeepCopy(e.self)).assets=i}return e}function u(t){var e=t.split("!")[0].toLowerCase();return{id:this.config_.src_icons+"/"+e+".png",w:16,h:16}}return{Create:function(){var t=this.config_,e=t.root;if(!e)return null;var i=WCT.Tree.prototype.Create.apply(this,arguments);if(!i)return i;var s=this.skin_,n=s[t.rtl?"image_closed_rtl":"image_closed"]||s.image_closed,o=this.get_node_css_();this.load_(e);var r=this.create_node_(e,0,null,n,o);return r&&(i.innerHTML=r.dom),t.auto_select_root&&this.Select(e),i},load_:function(t){var e=n.call(this,t);if(!e)return null;var i=this.config_,s=u.call(this,t);return e.expandable=!1!==i["expand_"+e.type.toLowerCase()+"s"]&&null,this.create_tree_item_(t,e,s),e.assets&&e.assets.length||(this.tree_[t].expandable=!1,e.expandable=!1),e},get_subtree_:function(t){var e=this.load_(t),i=e&&e.assets;if(!i)return[];for(var s=this.tree_,n=this.config_,o=[],r=0,a=null;a=i[r++];){var l=a.type.toLowerCase(),c=l+"!"+a.uid,_=WCT.ClampBoolean(a.active,!0);if(n["show_"+l+"s"]&&(!n.show_active_only||!1!==_)){if(WCT.Tree.EXPANDABLE[a.type]&&!1!==arguments[1]){this.load_(c),0<this.get_subtree_(c,!1).length||!s[c]||(s[c].expandable=!1)}else{var d=u.call(this,c);this.create_tree_item_(c,a,d)}o.push(c)}}return o},send_notification_:function(t,e){var i=this.callbacks_;if(i.callback_f){var s=n.call(this,e.addr);if(!s)return null;"select"==(s.event=t)&&(s.path=this.GetPath(e.id)),WCT.SetTimeout(i.callback_f,100,i.callback_s,[s])}}}}()),WCT.ResourceSelectorTree=function(t,e,i,s){this.entity_list_=arguments[4]&&(arguments[4].entity_list||null),this.cbox_map_={},this.config_={language:"1033",filter:null,show_nonref:!0,show_orphans:!1,show_orphans_my:!1,show_resources:!1,show_trash:!1,expand_slides:!0,expand_projects:!0,expand_cdocs:!0,expand_books:!0,expand_groups:!0,full_expand_check:!0},WCT.Tree.apply(this,arguments)},WCT.ResourceSelectorTree.prototype=new WCT.Tree,WCT.ResourceSelectorTree.RESOURCE_TYPES={adaptable:!0,rtprofile:!0,book_style:!0,bubble:!0,deployments:!0,doc_settings:!0,glossary:!0,help:!0,library:!0,macroset:!0,mouse:!0,panel:!0,popup:!0,quiz_style:!0,recognize:!0,record_glossary:!0,script:!0,style:!0,task_style:!0,trainer:!0,wa_filters:!0},WCT.ResourceSelectorTree.CalcNonRefAddr=function(t,e){return t+":"+(e.mode||e.filename||e.fileName)},WCT.ResourceSelectorTree.UPLOAD_MAP={equal:{on_server:!1,available:!1,not_available:!1},missing:{on_server:!0,available:!0,not_available:!0},modified:{on_server:!1,available:!0,not_available:!1}},WCT.ExtendObject(WCT.ResourceSelectorTree.prototype,function(){function l(t){var e={},i={orphans:t,resources:"root",All:"group"}[t];return"resources"===t?e={type:"Res",tclass:i,caption:this.translate_res_("IDS_WAPI_RESOURCES","entity.res","resources")}:"orphans"!==t&&"All"!==t||(e={type:"Ref",tclass:i,caption:this.translate_res_(t,"entity."+t,t)}),{uid:WCT.uid.Generate(8),caption:e.caption,assets:[],tclass:e.tclass,type:e.type,phony:!0}}function p(){var t=l.call(this,"All"),e=[],i=this.entity_list_,s=function c(t){for(var e={},i=0;i<t.length;i++){var s=t[i];if(WCT.ResourceSelectorTree.RESOURCE_TYPES[s.tclass])if(s.type||(s.type="Res"),e[s.tclass])e[s.tclass].push(s.uid);else e[s.tclass]=[s.uid]}var n=[];for(var i in e)if(e.hasOwnProperty(i)){for(var o=this.translate_res_("IDS_WAPI_"+i.toUpperCase(),"entity."+i,i),r={uid:WCT.uid.Generate(8),assets:[],tclass:i,caption:o,type:"Res",phony:!0},a=e[i],l=0;l<a.length;l++)r.assets.push({uid:a[l]});n.push(r)}return n}.call(this,i),n=null;if(0<s.length){n=l.call(this,"resources");for(var o=0;o<s.length;o++)i.push(s[o]),n.assets.push({uid:s[o].uid})}n&&(i.push(n),e.push({uid:n.uid}));var r=function _(t){for(var e=[],i=0;i<t.length;i++){var s=t[i];if(!WCT.ResourceSelectorTree.RESOURCE_TYPES[s.tclass]&&!s.phony){for(var n=s.uid,o=!0,r=0;r<t.length;r++){var a=t[r];if(a.assets&&!WCT.ResourceSelectorTree.RESOURCE_TYPES[a.tclass]&&!a.phony)for(var l=0;l<a.assets.length;l++)n===a.assets[l].uid&&(o=!1)}o&&e.push({uid:n})}}return e}.call(this,i),a=null;if(0<r.length){a=l.call(this,"orphans");for(o=0;o<r.length;o++)a.assets.push({uid:r[o].uid})}a&&(i.push(a),e.push({uid:a.uid}));for(o=0;o<e.length;o++)t.assets.push({uid:e[o].uid});return i.push(t),t.uid}return this.entity_list_=null,{Create:function(t){this.cbox_map_={};var e=p.call(this);if(!e)return null;var i=WCT.Tree.prototype.Create.apply(this,arguments);if(!i)return null;i.className="wct-controls-tree selection";var s=this.config_,n=this.skin_,o=n[s.rtl?"image_closed_rtl":"image_closed"]||n.image_closed,r=this.get_node_css_();if(this.load_(),s.show_orphans||s.show_orphans_my||s.show_resources||s.show_trash){this.load_("wa");var a=this.create_node_("wa",0,null,o,r);a&&(i.innerHTML=a.dom),s.auto_select_root&&this.Select("wa"),this.Expand("wa")}else{var l=this.create_node_(e,0,null,o,r);l&&(i.innerHTML=l.dom),this.expand_all_(e)}var c=this.checkbox_cb_.bind(this);for(var _ in this.cbox_map_)for(var d=this.get_cbox_array_(_),u=0,h=d.length;u<h;u++)WCT.event.Observe("click",c,document.getElementById(d[u].cid));return i},Expand:function(t){WCT.Tree.prototype.Expand.call(this,t);for(var e=this.get_node_info_(t),i=this.get_entity_by_id_(e.uid).assets||[],s=this.checkbox_cb_.bind(this),n=0,o=i.length;n<o;n++)for(var r=this.get_cbox_array_(i[n].uid),a=0,l=r.length;a<l;a++)WCT.event.Observe("click",s,document.getElementById(r[a].cid));return!0},expand_all_:function(t){if(this.tree_[t]&&this.tree_[t].expandable){this.Expand(t);for(var e=this.get_subtree_(t),i=0,s=e.length;i<s;i++)this.expand_all_(e[i])}},translate_res_:function(t,e,i){var s=this.env_,n=s.Localize(t),o=s.Localize(e);return n.search(/^\[.*?\]$/)?n:o.search(/^\[.*?\]$/)?o:i},create_node_:function(t,e,i,s,n){var o=this.get_node_info_(t,!0);if(!o)return null;var r=this.create_id_(t,e,i),a='width="'+s.w+'" height="'+s.h+'"',l="background:transparent url() scroll no-repeat 0px 0px",c="",_='" class="indent';WCT.Tree.EXPANDABLE[o.type]&&!1!==o.expandable&&(l="background:transparent url("+s.id+") scroll no-repeat "+s.x+"px "+s.y+"px",c=";cursor:pointer",_='" class="indent close');var d="background:transparent url() no-repeat 0 0",u=0,h=0;o.img&&(d="background:transparent url("+o.img.id+") no-repeat "+(o.img.x||0)+"px "+(o.img.y||0)+"px",u=o.img.w||0,h=o.img.h||0);var p='width="'+u+'" height="'+h+'"',f=WCT.uid.Generate(8),m=this.get_checkbox_state_(o.uid),b="<input type='checkbox' id='"+f+"'"+(m?" checked":"")+" class='wct-checkbox'></input>";this.add_to_cbox_map_(o.uid,{cid:f,state:m});var v=this.nhtml_,g=v[5];g=g.slice(0,4)+b+g.slice(4);var y=o.caption.replace(/</g,"&lt;").replace(/>/g,"&gt;"),C=o.isHidden?" ;opacity:0.33;":"",T=o.inherited?" wa-fallback":"";return{dom:[v[0],r,v[1],n,v[2],a,v[3],l,v[4],c,_,g,p,v[6],d,C,v[7],T,v[8],v[9],y,v[10]].join(""),id:r}},get_entity_by_id_:function(t){for(var e=this.entity_list_,i=e.length-1;0<=i&&t!==e[i].uid;i--);return-1!==i?e[i]:[]},get_checkbox_state_:function(t){var e=this.cbox_map_[t]||null;if(e)return e[0].state;var i=this.get_entity_by_id_(t);return i.phony||WCT.ResourceSelectorTree.UPLOAD_MAP[i.sync][i.token]},get_parents_by_child_:function(t){for(var e=[],i=this.entity_list_,s=0,n=i.length;s<n;s++){var o=i[s];if(o.assets)for(var r=o.assets,a=0,l=r.length;a<l;a++)r[a].uid===t&&e.push(o)}return e},add_to_cbox_map_:function(t,e){var i=this.cbox_map_[t]||null;if(i){for(var s=[],n=0,o=i.length;n<o;n++){var r=i[n];document.getElementById(r.cid)&&(r.state=e.state,s.push(r))}s.push(e),this.cbox_map_[t]=s}else this.cbox_map_[t]=[e]},get_assets_by_entity_id_:function(t){for(var e=this.entity_list_,i=e.length-1;0<=i&&t!==e[i].uid;i--);return-1!==i&&e[i].assets||[]},get_cbox_array_:function(t){return this.cbox_map_[t]||[]},get_cbox_state_:function(t){var e=this.cbox_map_[t]||null;return e?e[0].state:null},updt_cbox_dom_:function(t,e){var i=document.getElementById(t);i&&(i.checked=e)},updt_parent_cbox_:function(t,e){for(var i=this.cbox_map_[t],s=0,n=i.length;s<n;s++){var o=i[s];o.state=e,this.updt_cbox_dom_(o.cid,e);var r=this.get_parents_by_child_(t);if(!r.length)return;for(var a=0,l=r.length;a<l;a++)this.updt_parent_cbox_(r[a].uid,e)}},updt_child_cbox_:function(t,e,i){var s=this.cbox_map_[t];if(s)for(var n=0;n<s.length;n++){var o=s[n];if(o.state=e,this.updt_cbox_dom_(o.cid,e),i)return;for(var r=this.get_assets_by_entity_id_(t),a=0,l=r.length;a<l;a++)this.updt_child_cbox_(r[a].uid,e,i)}},get_uid_by_cid_:function(t){var e=this.cbox_map_;for(var i in e){for(var s=e[i],n=s.length-1;0<=n&&t!==s[n].cid;n--);if(-1!==n)return i}return null},updt_own_cbox_:function(t,e){for(var i=this.cbox_map_[t],s=0,n=i.length;s<n;s++)i[s].state=e,this.updt_cbox_dom_(i[s].cid,e)},updt_cbox_state_:function(t,e,i){var s=this.get_uid_by_cid_.call(this,t);this.updt_own_cbox_.call(this,s,e,i),this.updt_child_cbox_(s,e,i),!i&&e&&this.updt_parent_cbox_(s,e)},checkbox_cb_:function(t){var e=(t=WCT.event.Standardize(t)).target,i=e.id,s=e.checked;this.updt_cbox_state_(i,s,t.ctrlKey)},load_:function(t){for(var e=null,i=0,s=this.entity_list_.length;i<s;i++)(e=this.entity_list_[i]).expandable=!!(e.assets&&0<e.assets.length),this.create_tree_item_(e.uid,e);return e},get_subtree_:function(t){for(var e=this.entity_list_,i=null,s=e.length-1;0<=s&&t!==e[s].uid;s--);-1!==s&&(i=e[s]);var n=[];if(i&&i.assets){s=0;for(var o=i.assets.length;s<o;s++)n[s]=i.assets[s].uid}return n},send_notification_:function(t,e){}}}()),WCT.SplitterButton=function(t){this.uid_=t,this.connectors_=arguments[2]||{},this.skin_=WCT.skin.Merge(WCT.SplitterButton.SKIN,arguments[3]);var e=arguments[1]||{};this.config_={rtl:e.rtl||!1,image_id:e.image_id||"image",tabindex:e.tabindex||0,title:e.title||""},this.visible_=!0,this.enabled_=!0,this.active_=!1,WCT.SplitterButton.STORE[t]=this},WCT.ExtendObject(WCT.SplitterButton,{STORE:{},SKIN:{align:"center",vertical_align:"middle",image:{id:"",x:0,y:0},image_h:{id:"",x:0,y:0},image_a:{id:"",x:0,y:0},w:0,h:0},Cleanup:function(){for(var t in WCT.SplitterButton.STORE)WCT.SplitterButton.STORE[t].Destructor();WCT.SplitterButton.STORE={}}}),WCT.SplitterButton.prototype=function(){function a(t){if("dblclick"==(t=WCT.event.Standardize(t)).type)return null;var e=t.target;if(!e||!e.id)return!0;var i=WCT.SplitterButton.STORE[e.id];if(!i)return!0;if(i.visible_&&i.enabled_&&!i.active_){var s=i.skin_,n=i.config_,o=i.connectors_;if("click"==t.type)BROWSER.MOBILE||WCT.skin.ApplyBgImage(e,s[n.image_id]),o.callback_f&&o.callback_f.call(o.callback_s,e.id,t);else{if(!BROWSER.MOBILE){var r={mouseover:"_h",mouseout:"",mousedown:"_a",mouseup:"_h"}[t.type];WCT.skin.ApplyBgImage(e,s[n.image_id+r]||s[n.image_id]||{id:""})}o.callback_f&&o.callback_f.call(o.callback_s,e.id,t)}return!(t.cancelBubble=!0)}return!0}function l(t){t=WCT.event.Standardize(t)}return{Destructor:function(){var t=$(this.uid_);t&&(t.ondblclick=null,t.onclick=null,t.onmouseover=null,t.onmouseout=null,t.onmousedown=null,t.onmouseup=null,t.ontouchstart=null,t.ontouchend=null,t.onselectstart=null,t.ondragstart=null,t.parentNode.removeChild(t)),this.connectors_=null,this.skin_=null},Create:function(t){var e=this.skin_,i=this.config_,s=t.ownerDocument||document,n=i.rtl?WCT.skin.ConvertXToRtl(e.x):e.x,o=this.config_.rtl,r=s.createElement("div");r.id=this.uid_,r.title=i.title,r.tabIndex=i.tabindex,r.style.cursor="pointer",r.style.outlineOffset="-3px",r.setAttribute("role","Button"),r.setAttribute("aria-label",i.title),r.setAttribute("aria-controls",this.uid_.split("splitter")[0]+(o?"right":"left")),WCT.skin.ApplyPosition(r,{x:n,y:e.y,w:e.w,h:e.h}),e.image&&WCT.skin.ApplyBgImage(r,e.image),t.appendChild(r),r.ondblclick=a,r.onclick=a,r.onmouseover=a,r.onmouseout=a,r.onmousedown=a,r.onmouseup=a,r.ontouchstart=l,r.ontouchend=l,r.onselectstart=function(){return!1},r.ondragstart=function(){return!1}},SetXY:function(t,e){var i=$(this.uid_);i&&("number"==typeof t&&(i.style.left=t+"px"),"number"==typeof e&&(i.style.top=e+"px"))},SetTitle:function(t){this._title=t||"";var e=$(this.uid_);e&&(e.title=t||"")},Visible:function(){var t=arguments[0];if(void 0===t)return this.visible_;this.visible_=t;var e=$(this.uid_);return e&&(e.style.visibility=t?"":"hidden"),t},Enabled:function(){var t=arguments[0];return void 0!==t&&(this.enabled_=t),this.enabled_},Active:function(){var t=arguments[0];return void 0!==t&&(this.active_=t),this.active_}}}(),WCT.Splitter=function(t,e,i,s){if(this.type_){this.id_=t,this.context_=new WCT.context(e),this.env_=i,this.callbacks_=s;var n=arguments[4]||{};this.config_={cover_iframe:!!n.cover_iframe,cover_src:n.cover_src||"",cover_x:n.cover_x||0,cover_y:n.cover_y||0,cover_w:n.cover_w||"100%",cover_h:n.cover_h||"100%",cover_z:n.cover_z||2,disabled:!!n.disabled,title:n.title||""},this.skin_=WCT.skin.Merge(WCT.Splitter.SKIN[this.type_],arguments[5]),WCT.skin.ExtendUrls(this.skin_,"",this.context_),this.dnd_=null,this.icon_=null,this.fader_=null,this.in_drag_=!1,this.valid_click_=!1}},WCT.Splitter.SKIN={h:{background_color:"#777777",h:9,border_right:"1px solid #999999",image:{id:"mgr:resources!skin:sh.png",x:0,y:-667,repeat:"x"},icon:{image:{id:"mgr:resources!skin:s.png",x:-204,y:-120},image_h:{id:"mgr:resources!skin:s.png",x:-247,y:-120},image_a:{id:"mgr:resources!skin:s.png",x:-288,y:-120},w:37,h:9,align:"center"}},v:{background_color:"#777777",w:9,border_bottom:"1px solid #999999",image:{id:"mgr:resources!skin:sv.png",x:-160,y:0,repeat:"y"},icon:{image:{id:"mgr:resources!skin:s.png",x:-204,y:-73},image_h:{id:"mgr:resources!skin:s.png",x:-224,y:-73},image_a:{id:"mgr:resources!skin:s.png",x:-244,y:-73},w:9,h:37,vertical_align:"middle"}}},WCT.Splitter.prototype=function(){function r(){var t=$(this.id_);if(t){var e=this.config_;if(!e.disabled){t.style.zIndex=e.cover_z+1;var i=new WCT.Fader(this.id_+"#c",{cursor:"h"==this.type_?"n-resize":"e-resize",opacity:.01,iframe:e.cover_iframe,src:e.cover_src,x:e.cover_x,y:e.cover_y,w:e.cover_w,h:e.cover_h,z:e.cover_z});i.Create(t.parentNode),this.fader_=i,this.in_drag_=!0,this.valid_click_=!0;var s=this.callbacks_;s.callback_f&&s.callback_f.call(s.callback_s,this.id_,"begin")}}}function a(){if(!this.config_.disabled){this.fader_&&(this.fader_.Destructor(),this.fader_=null);var t=$(this.id_);t&&(t.style.zIndex=""),this.in_drag_=!1;var e=this.callbacks_;e.callback_f&&e.callback_f.call(e.callback_s,this.id_,"end")}}function l(t,e,i){if(!this.config_.disabled){var s=this.callbacks_;s.callback_f&&s.callback_f.call(s.callback_s,this.id_,"move",e,i),this.in_drag_&&(this.valid_click_=!1)}}function c(t,e){if(!this.config_.disabled&&(e._orig_&&!e._orig_.isTrusted&&(this.valid_click_=!0),"click"==e.type&&(this.valid_click_||BROWSER.IPAD))){var i=this.callbacks_;i.callback_f&&i.callback_f.call(i.callback_s,this.id_,"click"),this.valid_click_=!1}}return{Destructor:function(){this.icon_&&(this.icon_.Destructor(),this.icon_=null),this.dnd_&&(this.dnd_.Destructor(),this.dnd_=null),this.context_&&(this.context_.Destructor(),this.context_=null);var t=$(this.id_);t&&t.parentNode.removeChild(t),this.env_=null,this.callbacks_=null,this.config_=null,this.skin_=null},Create:function(t){var e=this.id_,i=this.skin_,s=$$("div");if(s.id=e,WCT.dom.AddClass(s,"wct-controls-splitter ","h"===this.type_?"hor":"ver"),WCT.skin.Apply(s,i),t.appendChild(s),(i=i.icon)&&i.image&&i.image.id){var n=new WCT.SplitterButton(e+"#ico",{title:this.config_.title},{callback_f:c,callback_s:this},i);n.Create(s),this.icon_=n}if(!BROWSER.IPAD){var o=new WCT.dnd(s);o.SetCallback("onbegin",r,this),o.SetCallback("onend",a,this),o.SetCallback("onmove",l,this),o.Restrict("h"==this.type_?"x":"y",!0),this.dnd_=o}return s},SetPosition:function(t){var e=$(this.id_);if(e){e.style.left=t.x+"px",e.style.top=t.y+"px";var i=this.skin_;if("v"==this.type_){if(e.style.width=i.w+"px",e.style.height=t.h+"px",this.icon_){var s=0,n=i.icon.vertical_align;"middle"==n?s=t.h-i.icon.h>>1:"bottom"==n&&(s=t.h-i.icon.h),this.icon_.SetXY(null,s)}}else if(e.style.width=t.w+"px",e.style.height=i.h+"px",this.icon_){var o=0,r=i.icon.align;"center"==r?o=t.w-i.icon.w>>1:"right"==r&&(o=t.w-i.icon.w),this.icon_.SetXY(o)}}},SetRange:function(t,e){var i="h"==this.type_;this.dnd_&&this.dnd_.Restrict(i?"y":"x",!0,t,e),this.config_.disabled||($(this.id_).style.cursor=i?"n-resize":"e-resize")},GetSize:function(){return this.skin_[{v:"w",h:"h"}[this.type_]]},SetVisible:function(t){var e=$(this.id_);if(e){var i=t?"RemoveClass":"AddClass";WCT.dom[i](e,"hide")}}}}(),WCT.Splitter.Hor=function(){this.type_="h",WCT.Splitter.apply(this,arguments)},WCT.Splitter.Hor.prototype=new WCT.Splitter,WCT.Splitter.Vert=function(){this.type_="v",WCT.Splitter.apply(this,arguments)},WCT.Splitter.Vert.prototype=new WCT.Splitter,WCT.Fader=function(t){this.uid_=t;var e=arguments[1]||{};this.config_={opacity:e.opacity||.3,bgcolor:e.bgcolor||"#000000",src:null!=e.src?e.src:"about:blank",cursor:e.cursor||"default",use_iframe:"boolean"!=typeof e.iframe||e.iframe,x:e.x||0,y:e.y||0,w:e.w||"",h:e.h||"",z:"number"==typeof e.z?e.z:1},this.connectors_=arguments[2]||{},WCT.Fader.STORE[t]=this},WCT.Fader.STORE={},WCT.Fader.Cleanup=function(){for(var t in WCT.Fader.STORE)WCT.Fader.STORE[t].Destructor()},WCT.Fader.prototype=function(){function o(t){var e=this.id.replace(/#cover$/,""),i=WCT.Fader.STORE[e];if(i){var s=i.connectors_;s.callback_f&&s.callback_f.call(s.callback_s)}}function r(t){var e=null;try{e=t.contentWindow.document.body}catch(i){}e&&(e.style.backgroundColor=this.config_.bgcolor)}return{Destructor:function(){delete WCT.Fader.STORE[this.uid_];var t=$(this.uid_);t&&t.parentNode.removeChild(t);var e=$(this.uid_+"#cover");e&&(e.onclick=null,e.ontouchend=null,e.parentNode.removeChild(e)),this.config_=null,this.connectors_=null},Create:function(t){if(!$(this.uid_)){var e=this.config_;"number"==typeof e.w&&(e.w+="px"),"number"==typeof e.h&&(e.h+="px");var i=PLATFORM.ANDROID&&!BROWSER.CHROME;if(e.use_iframe){var s=WCT.iframe.Create(e.src);s.id=this.uid_,s.tabIndex=-1,s.setAttribute("role","presentation"),s.className="wct-controls-fader frame",e.w&&(s.style.width=e.w||"100%"),e.h&&(s.style.height=e.h||"100%"),s.style.left=e.x+"px",s.style.top=e.y+"px",s.style.backgroundColor="#fff",s.style.opacity=e.opacity,s.style.zIndex=e.z,i||WCT.iframe.Load(s,r,this,t,[s])}var n=$$("div");n.id=this.uid_+"#cover",WCT.dom.AddClass(n,"wct-controls-fader","cover",arguments[1]||""),n.style.left=e.x+"px",n.style.top=e.y+"px",n.style.width=e.w||"100%",n.style.height=e.h||"100%",n.style.overflow="hidden",n.style.position="absolute",i||(n.style.backgroundColor="#fff"),n.style.opacity=e.opacity,n.style.cursor=e.cursor,n.style.zIndex=e.z,t.appendChild(n),this.connectors_.callback_f&&(BROWSER.MOBILE?(n.onclick=function(){},n.ontouchend=o):n.onclick=o)}},GetDim:function(){var t=$(this.uid_)||$(this.uid_+"#cover");return t?{w:t.offsetWidth,h:t.offsetHeight}:null},SetZIndex:function(t){var e=this.uid_,i=$(e);i&&(i.style.zIndex=t);var s=$(e+"#cover");s&&(s.style.zIndex=t)},Resize:function(t){var e=this.uid_,i=$(e);i&&(i.style.left=t.x+"px",i.style.top=t.y+"px",i.style.width=t.w+"px",i.style.height=t.h+"px");var s=$(e+"#cover");s&&(s.style.left=t.x+"px",s.style.top=t.y+"px",s.style.width=t.w+"px",s.style.height=t.h+"px")}}}(),WCT.map=function(){this.data_=arguments[0]||{},this.sid_=arguments[1]||null},WCT.map.prototype={Destructor:function(){this.data_=null},Copy:function(){return new WCT.map(WCT.DeepCopy(this.data_),this.sid_)},Set:function(){if(2==arguments.length)if(null===arguments[0]){var t=this.data_,e=arguments[1];for(var i in t)t[i]=e}else this.data_[arguments[0]+""]=arguments[1];else this.data_=arguments[0]},Get:function(){var t=arguments[0];return"string"==typeof t?this.data_[t]:this.data_},HasKey:function(t){return"undefined"!=typeof this.data_[t]},HasValue:function(t){var e=this.data_;for(var i in e)if(e[i]===t)return!0;return!1},Del:function(){var t=arguments[0];"string"==typeof t?delete this.data_[t]:null==t&&(this.data_={})},FromArray:function(t){var e=arguments[1],i=arguments[2],s=void 0!==i,n={};if(void 0!==e)for(var o=t.length-1;0<=o;o--){var r=t[o].split(e);n[r[0]]=s?"undefined"!=typeof r[1]?r[1]:i:r[1]}else for(o=t.length-1;0<=o;o--)n[t[o]]=s?i:null;this.data_=n},InStore:function(){var t=WCT.store.KEYS[this.sid_];return!!t&&null!=WCT.store.Get(t)},ToStore:function(){var t=WCT.store.KEYS[this.sid_];if(t){var e=[],i=this.data_;for(var s in i){var n=i[s],o=(typeof n).charAt(0);switch(o){case"b":n=n?1:0;break;case"o":n=""}e.push(s+"="+o+"="+n)}WCT.store.Set(t,e.join(","))}},FromStore:function(){arguments[0]||(this.data_={});var t=WCT.store.KEYS[this.sid_];if(t){var e=WCT.store.Get(t);e=e?e.split(","):[];for(var i=this.data_,s=e.length-1;0<=s;s--){var n=e[s].split("="),o=n[2];switch(n[1]){case"b":o=WCT.ClampBoolean(o);break;case"n":o=Number(o);break;case"o":o=null}i[n[0]]=o}}},RemoveStore:function(){var t=WCT.store.KEYS[this.sid_];t&&WCT.store.Remove(t)}},WCT.Popup=function(t,e,i,s){this.uid_=t,this.context_=e,this.env_=i,this.callbacks_=s||{};var n=arguments[4]||{},o=this.config_||{};(this.config_=o).resource_path=o.resource_path||"",o.rtl=!!o.rtl;var r=Number(o.z);for(var a in o.z=isNaN(r)?1:r,o.close_on_cover_click=!!o.close_on_cover_click,o.keyevents=o.keyevents||!1,n)"undefined"!=typeof o[a]&&(o[a]=n[a]);if(e){var l=e.ToAbsPath("mgr:"+(o.resource_path||""));this.skin_=WCT.skin.Merge(this.default_skin_||WCT.Popup.SKIN,arguments[5]),WCT.skin.ExtendUrls(this.skin_,l),this.default_skin_=null}this.dnd_=null,this.fader_=null,this.moved_=!1,this.buttons_=[],this.b_skins_={}},WCT.ExtendObject(WCT.Popup,{SKIN:{background_color:"#FFFFFF",w:390,h:415,frame:{w_w:130,e_w:20,n_h:36,s_h:36,nw:{image:{id:"s.png",x:-204,y:-387}},n:{image:{id:"sh.png",x:0,y:-160,repeat:"x"}},ne:{image:{id:"s.png",x:-344,y:-387}},w:{background_color:"#999999",w:2},e:{background_color:"#999999",w:2},sw:{image:{id:"s.png",x:-204,y:-433}},s:{image:{id:"sh.png",x:0,y:-206,repeat:"x"}},se:{image:{id:"s.png",x:-344,y:-433}}},title:{text_color:"#333333",font_family:"Arial,Helvetica,sans-serif",font_size:15,font_weight:"bold",x:10,y:10},text:{background_color:"#FFFFFF",text_color:"#000000",font_family:"Arial,Helvetica,sans-serif",font_size:12,line_height:34,outer_spacing_l:20,outer_spacing_r:5},button:{background_color:"#EEEEEE",background_color_h:"#FBE5AE",background_color_a:"#F0AB00",background_color_d:"#EEEEEE",text_color:"#333333",text_color_h:"#333333",text_color_a:"#333333",text_color_d:"#333333",border_width:1,border_color:"#B4B4B4",border_color_h:"#B4B4B4",border_color_a:"#B4B4B4",border_color_d:"#B4B4B4",padding_left:2,padding_right:2,font_weight:"bold",font_size:12,font_family:"Arial,Helvetica,sans-serif",h:20}},GetContentDim:function(t){var e={l:0,r:0,t:0,b:0,w:0,h:0};return e.l=[t.w_w||0],t.nw&&t.nw.w&&e.l.push(t.nw.w),t.w&&t.w.w&&e.l.push(t.w.w),t.sw&&t.sw.w&&e.l.push(t.sw.w),e.l=e.l.min(),e.r=[t.e_w||0],t.ne&&t.ne.w&&e.r.push(t.ne.w),t.e&&t.e.w&&e.r.push(t.e.w),t.se&&t.se.w&&e.r.push(t.se.w),e.r=e.r.min(),e.t=[t.n_h||0],t.nw&&t.nw.h&&e.t.push(t.nw.h),t.n&&t.n.h&&e.t.push(t.n.h),t.ne&&t.ne.h&&e.t.push(t.ne.h),e.t=e.t.min(),e.b=[t.s_h||0],t.sw&&t.sw.h&&e.b.push(t.sw.h),t.s&&t.s.h&&e.b.push(t.s.h),t.se&&t.se.h&&e.b.push(t.se.h),e.b=e.b.min(),e.w=e.l+e.r,e.h=e.t+e.b,e},CreateFrame:function(t,e,i){null==(e=WCT.DeepCopy(e)).w_w&&(e.w_w=0),null==e.e_w&&(e.e_w=0),null==e.n_h&&(e.n_h=0),null==e.s_h&&(e.s_h=0),null==i.w&&(i.w=0),null==i.h&&(i.h=0);for(var s={},n=["nw","n","ne","w","e","sw","s","se"],o=0,r=0,a=0,l=null;l=n[o++];){var c=e[l];if(c){switch(l){case"nw":c.p={x:0,y:0,w:e.w_w,h:e.n_h};break;case"n":r=e.nw?e.nw.p.w:0,c.p={x:r,y:a,w:i.w-e.w_w-e.e_w,h:e.n_h};break;case"ne":r+=e.n?e.n.p.w:0,c.p={x:r,y:a,w:e.e_w,h:e.n_h};break;case"w":r=0,a=e.ne?e.ne.p.h:0,c.p={x:r,y:a,w:c.w||e.w_w,h:i.h-e.n_h-e.s_h};break;case"e":var _=c.w||e.e_w;r+=i.w-_,c.p={x:r,y:a,w:_,h:e.w?e.w.p.h:0};break;case"sw":r=0,a+=e.e?e.e.p.h:0,c.p={x:r,y:a,w:e.w_w,h:e.s_h};break;case"s":r+=e.sw?e.sw.p.w:0,c.p={x:r,y:a,w:e.n?e.n.p.w:0,h:e.s_h};break;case"se":r+=e.s?e.s.p.w:0,c.p={x:r,y:a,w:e.e_w,h:e.s_h}}var d=$(i.id+l)||$$("div",i.doc);d.className="area-"+l,i.resizable&&!i.mini&&(d.style.cursor=l+"-resize",d.onmousedown=i.onmousedown||null,i.controls&&i.controls.push(d)),c.p.w<0&&(c.p.w=0),c.p.h<0&&(c.p.h=0),WCT.skin.ApplyPosition(d,c.p),c.image&&WCT.skin.ApplyBgImage(d,c.image),c.background_color&&(d.style.backgroundColor=c.background_color),d.id||(d.id=i.id+l,t.appendChild(d)),s[l]=d}}return s},CreateTitle:function(t,e,i){(e=WCT.DeepCopy(e)).w=i.w,e.tooltip=i.title||"",e.x&&(e.w-=2*e.x),i.rtl&&(e.x=WCT.skin.ConvertXToRtl(e.x)),e.padding&&delete e.padding,e.padding_top&&delete e.padding_top,e.padding_bottom&&delete e.padding_bottom;var s=$$("div",i.doc);return s.id=i.id+"title",s.className="header",WCT.skin.ApplyPosition(s,e),WCT.skin.ApplyTextFormats(s,e),WCT.skin.ApplyPadding(s,e),WCT.dom.NotSelectable(s),s.style.overflow="hidden",s.style.textOverflow="ellipsis",s.style.whiteSpace="nowrap",e.h&&(s.style.lineHeight=e.h+"px"),i.rtl&&(s.style.direction="rtl"),WCT.SetNodeText(s,i.title||"",i.doc),t.appendChild(s),i.movable&&i.onmousedown&&(s.style.cursor="pointer",s.onmousedown=i.onmousedown,i.controls&&i.controls.push(s)),s},OnDnd:function(){this.moved_=!0}}),WCT.Popup.prototype=function(){function u(t){var e=WCT.dom.GetPosition(t);return e.x=e.left,e.y=e.top,delete e.left,delete e.top,"body"==WCT.dom.GetNodeName(t)?(e.w=WCT.dom.GetWindowWidth(),e.h=WCT.dom.GetWindowHeight()):(e.w=t.offsetWidth,e.h=t.offsetHeight),e}function h(t){var e=arguments[1]||this.skin_,i={w:e.w||0,h:e.h||0};return i.x=Math.max(0,t.w-i.w>>1),i.y=Math.max(0,t.h-i.h>>1),i}function p(t){var e=arguments[1]||this.skin_,i=WCT.Popup.GetContentDim(e.frame);return i.x=i.l,i.y=i.t,i.w=Math.max(0,t.w-i.w),i.h=Math.max(0,t.h-i.h),i}return{Destructor:function(){if(this.context_=null,this.env_=null,this.callbacks_=null,this.config_=null,this.skin_=null,this.default_skin_=null,this.dnd_&&(this.dnd_.Destructor(),this.dnd_=null),this.buttons_){for(var t=this.buttons_,e=this.uid_+"#m#buttons#",i=t.length,s=null;s=t[--i];){var n=$(e+s.id);n&&(n.onclick=null,n.onmouseover=null,n.onmouseout=null,n.onmousedown=null,n.onmouseup=null)}this.buttons_=null}this.b_skins_=null,this.fader_&&(this.fader_.Destructor(),this.fader_=null);var o=$(this.uid_+"#m");o&&o.parentNode.removeChild(o)},Resize:function(t){var e=this.fader_;if(e&&e.Resize(t),!this.moved_){var i=$(this.uid_+"#m");if(i){var s=this.skin_,n=Math.max(0,t.w-(s.w||0)>>1),o=Math.max(0,t.h-(s.h||0)>>1);i.style.left=n+"px",i.style.top=o+"px"}}},SetWH:function(t,e){var i=WCT.DeepCopy(this.skin_),s=$(this.uid_+"#m"),n=u.call(this,s.parentNode);i.w=t,i.h=e;var o=h.call(this,n,i),r=p.call(this,o,i),a=$(this.uid_+"#m#content");WCT.skin.ApplyPosition(a,r,!0);var l=$(this.uid_+"#m#buttons"),c=i.button,_=r.b-(c.h||0)>>1,d={x:-r.r,y:r.t+r.h+_,w:r.w,h:Math.max(0,r.b-_)};WCT.skin.ApplyPosition(l,d,!0),WCT.Popup.CreateFrame(s,i.frame,{id:this.uid_+"#m#",w:t,h:e})},Create:function(){var t=arguments[0]||document.body,e=u.call(this,t),i=h.call(this,e),s=p.call(this,i);(function a(t,e){var i=this.uid_+"#",s=this.skin_,n=this.config_,o=n.close_on_cover_click?{callback_f:this.close,callback_s:this}:null,r=new WCT.Fader(i,{src:"",opacity:.5,iframe:!0,bgcolor:s.background_color,x:e.x,y:e.y,w:e.w,h:e.h,z:n.z},o,s);r.Create(t),this.fader_=r}).call(this,t,e);var n=function c(t,e){var i=this.config_,s=this.uid_+"#",n=this.skin_,o=i.z,r=$$("div");r.id=s+"m",r.tabIndex=i.tabindex,r.setAttribute("role","dialog"),r.setAttribute("aria-labelledby",r.id+"#title"),r.className="wct-controls-popup",WCT.skin.ApplyPosition(r,e),o&&(r.style.zIndex=o),WCT.event.Observe("keydown",function(t){!i.keyevents&&t.stopPropagation&&t.stopPropagation()},r),t.appendChild(r),s+="m#",WCT.Popup.CreateFrame(r,n.frame,{id:s,w:e.w,h:e.h});var a=WCT.Popup.CreateTitle(r,n.title,{id:s,w:e.w,rtl:i.rtl}),l=new WCT.dnd(r,a);return l.SetCallback("onbegin",WCT.Popup.OnDnd,this),this.dnd_=l,r}.call(this,t,i),o=function r(t,e){var i=this.skin_,s=$$("article");return s.id=this.uid_+"#m#content",s.className="content",this.config_.rtl&&(s.style.direction="rtl"),WCT.skin.ApplyPosition(s,e),WCT.skin.ApplyTextFormats(s,i.text),t.appendChild(s),s}.call(this,n,s);(function _(t,e){var i=this.uid_+"#m#",s=this.skin_.button,n=e.b-(s.h||0)>>1,o={x:-e.r,y:e.t+e.h+n,w:e.w,h:Math.max(0,e.b-n)},r=$$("div");r.id=i+"buttons",r.className="buttons",WCT.skin.ApplyPosition(r,o),t.appendChild(r);for(var a=this.buttons_,l=a.length,c=null;c=a[--l];)this.create_button_(r,c)}).call(this,n,s),this.create_content_(o,s),n.focus()},SetTitle:function(t){var e=$(this.uid_+"#m#title");e&&(WCT.SetNodeText(e,t),e.setAttribute("title",t))},SetClass:function(t){var e=$(this.uid_+"#m");e&&(e.className+=" "+t)},SetZIndex:function(t){if(this.config_.z!=t){this.config_.z=t;var e=this.fader_;e&&e.SetZIndex(t);var i=$(this.uid_+"#m");i&&(i.style.zIndex=t)}},close:function(){var t=this.callbacks_;this.Destructor(),t.callback_f&&t.callback_f.call(t.callback_s,"close")},create_content_:function(t,e){},create_button_:function(t,e){var i=this.uid_+"#m#buttons#"+e.id,s=this.skin_.button;arguments[2]&&(s=arguments[2],this.b_skins_[e.id]=s);var n=WCT.dom.CreateInputElement("button",i);if(n.id=i,"number"==typeof s.x||"number"==typeof s.y)n.style.position="absolute",n.style.left=(s.x||0)+"px",n.style.top=(s.y||0)+"px";else{var o="right",r="marginRight";this.config_.rtl&&(o="left",r="marginLeft"),n.style.cssFloat=o,n.style.styleFloat=o,n.style[r]="3px"}WCT.skin.ApplyTextFormats(n,s),WCT.skin.ApplyBorder(n,s),WCT.skin.ApplyPadding(n,s);var a=this.env_;s.h&&(n.style.height=s.h+"px"),n.value=a.Localize(e.textkey),t.appendChild(n);var l=this.on_button_.bind(this);return n.onclick=l,n.onmouseover=l,n.onmouseout=l,n.onmousedown=l,n.onmouseup=l,n},on_button_:function(t){var e=(t=WCT.event.Standardize(t)).target,i=e.id.match(/#m#buttons#(.+?)$/);if(i=i?i[1]:null){var s="";switch(t.type){case"mousedown":s="_a";break;case"mouseup":case"mouseover":s="_h"}var n=this.b_skins_[i]||this.skin_.button,o=n["text_color"+s]||n.text_color,r=n["background_color"+s]||n.background_color,a=n["border_color"+s]||n.border_color;o&&(e.style.color=o),r&&(e.style.backgroundColor=r),a&&(e.style.borderColor=a),"click"==t.type&&this.on_button_click_(i)}},on_button_click_:function(t){if("close"==t)this.close();else{var e=this.callbacks_;e.callback_f&&e.callback_f.call(e.callback_s,t)}}}}(),WCT.SharePopup=function(t,e,i,s){this.config_={sel:null,url:null},this.default_skin_=WCT.skin.Merge(WCT.Popup.SKIN,WCT.SharePopup.SKIN,null,!0),WCT.Popup.apply(this,arguments);var n=arguments[5]||{};n.button&&(this.skin_.button=WCT.DeepCopy(n.button)),this.buttons_=[{id:"close",textkey:"CLOSE"}],this.first_=!0},WCT.SharePopup.prototype=new WCT.Popup,WCT.SharePopup.SKIN={input:{font_family:"Arial,Helvetica,sans-serif",font_size:12,text_color:"#000000",line_height:14,h:70}},WCT.ExtendObject(WCT.SharePopup.prototype,function(){function T(){var t=this.env_,e=this.config_,i=e.url,s=DATA.GetS(e.sel+":entity.txt"),n=t.Localize("SEND_CONTENT_SUBJECT"),o=t.Localize("SEND_CONTENT_TEMPLATE").replace(/\[SEND_CAPTION\]/,s.caption).replace(/\[SEND_LINK\]/,i);o=encodeURIComponent(o).replace(/%5Cn/g,"%0D%0A"),a.call(this);var r=WCT.iframe.Create("mailto:?subject="+encodeURIComponent(n)+"&body="+o);r.id=this.id_+"#iframe",r.style.width="10px",r.style.height="10px",document.body.appendChild(r),WCT.SetTimeout(a,10,this)}function a(){var t=$(this.id_+"#iframe");t&&t.parentNode.removeChild(t)}return{Destructor:function(){a.call(this),SKIN.textcontrol.Cleanup(this.id_+"#m#buttons#mailto"),SKIN.textcontrol.Cleanup(this.id_+"#m#buttons#close"),WCT.Popup.prototype.Destructor.call(this)},Create:function(t){WCT.Popup.prototype.Create.call(this),this.SetTitle(t)},create_content_:function(t,e){var i=this.env_,s=this.skin_,n=10,o=5,r=20,a=s.input.h||70,l=10,c=5,_=this.config_.rtl,d=(_?s.text.outer_spacing_r:s.text.outer_spacing_l)||0,u=(_?s.text.outer_spacing_l:s.text.outer_spacing_r)||0,h=i.Localize("URL_OF_CURRENT_PAGE"),p=$$("div");p.style.margin=n+"px "+u+"px "+o+"px "+d+"px",p.style.height=r+"px",p.style.lineHeight=r+"px",p.appendChild($$2(h+":")),t.appendChild(p);var f=$$("textarea");f.setAttribute("aria-label",h),f.style.lineHeight="",WCT.skin.ApplyTextFormats(f,s.input),PLATFORM.IOS||f.setAttribute("readOnly","readOnly"),f.style.position="relative",f.style[_?"right":"left"]=(_?u:d)+"px",f.style.width=e.w-d-u-3+"px",f.style.height=a+"px",f.value=this.config_.url,f.onclick=function(){PLATFORM.IOS?this.setSelectionRange(0,9999):this.select()},f.onkeydown=function(){if(this.select(),PLATFORM.IOS)return!1},f.onkeyup=function(){if(this.select(),PLATFORM.IOS)return!1},t.appendChild(f);var m=n+o+r+a+l,b=e.h-m-c;b=Math.min(Math.floor(e.w/4*3),b);var v=function C(t){var e=this.config_.url,i=WCT.QrCode.GenerateHtml(e,t);if(!i){for(var s={show:1},n=(e=(e=e.split("#"))[0].split("?"))[1].split("&"),o=[],r=n.length-1;0<=r;r--){s[n[r].split("=")[0]]&&o.push(n[r])}e=e[0]+"?"+o.join("&"),i=WCT.QrCode.GenerateHtml(e,t)}return i}.call(this,b)||i.Localize("QR_URL_TOO_BIG"),g=$$("div");g.style.position="absolute",g.style[_?"right":"left"]=(_?u:d)+"px",g.style.top=m+"px",g.style.width=b+"px",g.style.height=b+"px",g.innerHTML=v,t.appendChild(g);var y=SKIN.textcontrol.Add({id:this.uid_+"#m#buttons#mailto",skin:s.button,dom:t,onexec:T,scope:this,text:i.Localize("SHARE_BY_MAIL"),tabindex:0});y.style[_?"right":"left"]=(_?u:d)+b+5+"px",y.style.top=m+"px"},create_button_:function(t,e){var i=this.env_,s=this.skin_.button,n=SKIN.textcontrol.Add({id:this.id_+"#m#buttons#"+e.id,skin:s,dom:t,onexec:function(){var t=this.callbacks_;this.Destructor(),t.callback_f&&t.callback_f.call(t.callback_s,"close")},scope:this,text:i.Localize(e.textkey),tabindex:0}),o=this.config_.rtl,r=o?"left":"right";n.style.position="relative",n.style.cssFloat=r,"undefined"!=typeof s.inner_spacing_r&&(n.style["margin"+(o?"Right":"Left")]=s.inner_spacing_r+"px"),this.first_&&"undefined"!=typeof s.outer_spacing_r&&(n.style["margin"+(o?"Left":"Right")]=s.outer_spacing_r+"px",this.first_=!1)}}}()),WCT.AdaptableClasses=function(t){this.xml_=null,this.init_(t)},WCT.ExtendObject(WCT.AdaptableClasses,{CACHE:{},CACHE_THRESHOLD:3e3,Cleanup:function(){this.CACHE={}},GetIcon:function(t,e){var i=WCT.AdaptableClasses,s=(new Date).getTime(),n=i.CACHE[t.tclass],o=null;if(n&&s-n.t<=i.CACHE_THRESHOLD)o=n.x,n.t=s;else{var r=e.ToAbsPath("adaptable!classes:"+t.tclass+".xml"),a=new WCT.AdaptableClasses(r);o=a.GetXML(t),i.CACHE[t.tclass]={t:s,x:o},a.Destructor()}return(o=o&&o[t.sub_type]||null)&&o.id?WCT.DeepCopy(o,{id:e.ToAbsPath(o.id)}):null}}),WCT.AdaptableClasses.prototype={Destructor:function(){this.xml_=null},GetXML:function(){return this.xml_},init_:function(t){var e=XHR.GetS(t,"XML");if(e=e?e.childNodes[BROWSER.IE?1:0]:null){var i=null;try{i=e.getElementsByTagName("Specialization")}catch(a){}if(!i||!i.length)return null;e={};for(var s=0,n=null;n=i[s++];){var o=n.getAttribute("name"),r=Number(n.getAttribute("icon"));isNaN(r)||(e[o]={id:"adaptable!classes:icons.png",x:16*-r,y:0,w:16,h:16})}this.xml_=e}}};var TRACKING={DELIMITER:{lesson_id:":",master:",",objectives:"#",objective_parts:"|",visited_slides:"-",visited_tourstop_ranges:"~",visited_tourstop_groups:";",scorm_short_id:"_"},AGENT_UID_PREFIX:"TZA_",SCORABLE_LESSONS:{uebung:!0,test:!0},FN_COLL_REFRESH:null,Cleanup:function(){this.FN_COLL_REFRESH=null},PagesetCompleted:function(t){for(var e in t)if(!t[e])return!1;return!0},PagesetCountVisited:function(t){var e=0;for(var i in t)t[i]&&e++;return e},Init:function(t,e,i,s){var n=null;switch(t.type){case HANDLER.MODE.lesson:n=DATA.GetConfig(t.tclass,t.uid,t.mode);break;case HANDLER.MODE.book:case HANDLER.MODE.library:n=DATA.GetConfig(t.tclass,t.uid)}if(n){var o=this.central,r=n.tracking_backend,a="auto"==r,l="scorm_12"==r,c="scorm_2004"==r,_=a||"scorm_auto"==r||l||c,d=a||"aicc"==r,u=a||"collaborator"==r,h=this.backend,p=d?h.aicc.FindAPI():null,f=!p&&_?h.scorm.FindAPI(window):null,m=p||f||!u?null:h.collaborator.Available();if(t.type!=HANDLER.MODE.library||!p&&!f){o.AddAgent(e),MANAGER.SetCentralTracker(o);var b={T2_version:n.version,debug_mode:n.tracking_debug_mode,cookie_backend:"cookie"==r||a&&!p&&!f&&!m,scorm_objective_tracking:n.scorm_objective_tracking,scorm_only_one_commit:n.scorm_only_one_commit,scorm_decide_passed:n.scorm_decide_passed,scorm_completed_restart_warning:"warn"==n.scorm_suspend_resume,scorm_ignore_bookmark:"disabled"==n.scorm_suspend_resume,scorm_safe_mode:n.scorm_safe_mode,scorm_location:n.scorm_location,scorm_use_original_max:"scoring_points"==n.scorm_scoring,scorm_score_percentage100:"scoring_percentage"==n.scorm_scoring,scorm_score_precision:n.scorm_score_precision,scorm_nav_request:n.scorm_nav_request,aicc_objective_tracking:n.aicc_objective_tracking,aicc_decide_passed:n.aicc_decide_passed,aicc_completed_restart_warning:"warn"==n.aicc_suspend_resume,aicc_ignore_bookmark:"disabled"==n.aicc_suspend_resume,aicc_score_precision:n.aicc_score_precision,aicc_crossdomain:n.aicc_crossdomain,restart:"continue"!=n.startMode,assignment_id:n.assignmentId||null,detail_tracking:n.tracking_collaborator_detail},v={};if(m){var g=h.collaborator.GetCollaboratorBackendName(m);o.SetBackend(g),this.SetCollRefresh(),v.sco={}}else if(p||f||b.cookie_backend){var y="scorm";switch(p?(y="aicc",o.SetBackend("aicc"),DATA.OmitRequest(".server")):f&&(f[2004]&&!l?o.SetBackend("scorm2004",f):f[12]&&!c&&o.SetBackend("scorm12",f),DATA.OmitRequest(".server")),t.type){case HANDLER.MODE.lesson:v=this.InitLessonSco(t,y);break;case HANDLER.MODE.book:v=this.InitBookSco(t,n,y);break;case HANDLER.MODE.library:b.objectives_standalone=!0}}o.Init(v.sco||t,v.obj||[],b,i,s)}else i.call(s)}else i.call(s)},InitBook:function(t,e){var i=t.pageset.length;if(0<i){for(var s=DATA.GetConfig("book",t.uid),n={},o=i-1;0<=o;o--)n[t.pageset[o]]=!1;var r=0;for(var a in n)r++;return{tclass:"book",uid:t.uid,title:s.caption,description:s.description,pages:n,total_pages:r,track_completion:"none"!=s[e+"_tracking"]}}return null},InitLesson:function(t,e){var i=DATA.GetConfig("project",t.uid,t.mode),s=i[e+"_tracking"];return{tclass:"project",uid:t.uid,mode:t.mode,title:i.caption,description:i.description,track_completion:"none"!=s,track_score:"score"==s||"incomplete_instead_failed"==s,track_completion_as_score:"completion_as_score"==s,track_incomplete_instead_failed:"incomplete_instead_failed"==s}},InitLessonSco:function(t,e){var i=this.InitLesson(t,e);return{sco:{tclass:"project",uid:t.uid,mode:t.mode},obj:[i]}},InitBookSco:function(t,e,i){var s={sco:{tclass:"book",uid:t.uid},obj:[]},n={book_group:e.book_show_book_group,cdoc:e.book_show_cdoc,project:e.book_show_project,media:{video:e.book_show_media_video,audio:e.book_show_media_audio,image:e.book_show_media_image,doc:e.book_show_media_doc,file:e.book_show_media_file}},o=new Toc(t.tclass,t.uid,n),r=o.GetBooks();if(e.trackable)for(var a,l=e.trackable.split(","),c=0;a=l[c++];){var _=a.split(/!|:/),d=_[0],u=_[1],h=null;if("project"===d)h=this.InitLesson({uid:u,mode:_[2]},i);else if("book"===d){var p=r[u];if(!p)p=new Toc(t.tclass,u,n).GetBooks()[u];p&&(h=this.InitBook(p,i))}h&&s.obj.push(h)}else{var f=o.GetProjects();for(var u in r){var m=this.InitBook(r[u],i);m&&s.obj.push(m)}for(var u in f)for(var b=f[u],v=(c=0,null);v=b.assets[c];c++)if(v.type==DATA.LESSON_TOUR_KEY&&DATA.LESSON_MODE[v.mode]){var g=this.InitLesson({uid:u,mode:v.mode},i);s.obj.push(g)}window.BOOK_SCO_TOC=o}return s},GetCollRefresh:function(){var t="trainer_learner_view_refresh",e=null;try{top[t]?e=top[t]:window.opener&&window.opener[t]&&(e=window.opener[t])}catch(i){}return e},SetCollRefresh:function(){if(window.COLL_REFRESH)this.FN_COLL_REFRESH=window.COLL_REFRESH,window.COLL_REFRESH=null;else{var t="trainer_learner_view_refresh",e=null;try{top[t]?e=top[t]:window.opener&&window.opener[t]&&(e=window.opener[t])}catch(i){}this.FN_COLL_REFRESH=e}},RefreshCollaborator:function(){try{this.FN_COLL_REFRESH&&this.FN_COLL_REFRESH()}catch(t){}}};!function(){function u(t){if(this.initialized_)for(var e=this.objectives_,i=0,s=null;s=e[i++];)if(s.central_id_string==t)return s;return null}function h(){var t=this.sco_;if(t){for(var e=this.objectives_,i=null,s={passed:0,completed:0,total:0},n="scorm"==this.backend_type_||"aicc"==this.backend_type_,o=0,r={progress:0,total:0},a=0,l=null;l=e[a++];)n&&!1===l.track_completion||(!1===l.completed?i=!1:l.completed&&(!1!==i&&(i=!0),o++)),"project"!=l.tclass||n&&!1===l.track_score&&!l.track_completion_as_score||(s.total++,l.passed&&s.passed++,l.completed&&s.completed++),"number"==typeof l.progress&&(r.total++,r.progress+=l.progress);s=i&&0<s.total&&s.completed==s.total?s.passed==s.total:null;var c=e.length;r=0<c?r.total==c?r.progress/c:o/c:0,t.completed=i,t.passed=s,t.progress=r}}function p(){var t=this.sco_;if(t){delete t.min;for(var e=this.objectives_,i="scorm"==this.backend_type_||"aicc"==this.backend_type_,s=[],n=[],o=[],r=0,a=0,l=null;l=e[a++];)if("project"==l.tclass)if(i&&l.track_completion_as_score)null!=l.progress&&(s.push(l.progress),o.push(1),n.push(0)),r++;else if((!i||!1!==l.track_score)&&l.is_scorable){if("number"==typeof l.cur&&"number"==typeof l.cum&&"number"==typeof l.max){var c,_=null;l.completed?(c=l.cum,"number"==typeof l.min&&(_=l.min)):c=Math.max(l.cum,l.max),s.push(l.cur),o.push(c),n.push(_)}r++}if(1==(t.scored_objects=r))t.cur=s[0],null!=n[0]&&(t.min=n[0]),t.max=o[0];else if(1<r){var d=0;for(_=0,a=r-1;0<=a;a--)0<o[a]?(d+=s[a]/o[a],null==n[a]?_=null:null!=_&&(_+=n[a]/o[a])):null==n[a]&&(_=null);t.cur=d/r*100,null!=_&&(t.min=_/r*100),t.max=100}}}function c(t){t.active=!1,t.completed=TRACKING.PagesetCompleted(t.pages),t.progress=0<t.total_pages?TRACKING.PagesetCountVisited(t.pages)/t.total_pages:0}function _(t){if(t.active=!1,t.completed||(t.completed=!1),t.progress||(t.progress=0),t.cumulated_steps=0,t.visited)for(var e in t.visited)t.cumulated_steps++;else if(t.visited={},"collaborator"==this.backend_type_&&"number"==typeof t.bookmark)for(e=0;e<t.bookmark;e++)t.visited[e]=!0;t.is_scorable=TRACKING.SCORABLE_LESSONS[t.mode]||!1,"boolean"!=typeof t.passed&&(t.passed=null);var i=this.backend_type_;t.track_completion_as_score&&t.completed&&("scorm"==i||"aicc"==i)&&(t.passed=!0)}function o(){this.sco_.agents=WCT.DeepCopy(this.agents_);for(var t=this.objectives_,e=this.backend_type_,i=0,s=0,n={},o=0,r=null;r=t[o++];)"book"==r.tclass?(i++,c.call(this,r)):(s++,n[r.mode]||(n[r.mode]=0),n[r.mode]++,_.call(this,r));h.call(this),p.call(this);var a=WCT.DeepCopy(this.config_);for(var l in WCT.ExtendObject(a,{source:"CT.Init",pagesets:i,lessons:s,backend_name:this.backend_name_||"",backend_type:e||""}),n)a[l]=n[l];TRACKING.debug.Status(this.sco_,this.objectives_),TRACKING.debug.Track(a),this.initialized_=!0,this.finished_=!1,this.callback_.call(this.scope_,this),this.callback_=null,this.scope_=null}TRACKING.central={backend_:null,backend_name_:null,backend_type_:null,backend_info_:null,shortcut_map_:null,objectives_:[],config_:{},sco_:null,initialized_:!1,finished_:!1,scorm_location_log_:null,agents_:{},callback_:null,scope_:null,Cleanup:function(){this.finished_&&(this.UnsetBackend(),TRACKING.debug.Track({source:"CT.Cleanup"}),TRACKING.debug.Cleanup())},SetBackend:function(t){if(this.backend_name_!=t)switch(this.UnsetBackend(),this.backend_name_=t){case"collaborator84":case"collaborator":return this.backend_=new TRACKING.backend[t],this.backend_type_="collaborator",!0;case"scorm12":case"scorm2004":var e=arguments[1]||null;return this.backend_=new TRACKING.backend.scorm(t,e),this.backend_type_="scorm",this.backend_info_=e,!0;case"cookie":return this.backend_=new TRACKING.backend.cookie,this.backend_type_="cookie",!0;case"aicc":return this.backend_=new TRACKING.backend.aicc,this.backend_type_="aicc",!0}return!1},UnsetBackend:function(){this.backend_&&this.backend_.Destructor(),this.backend_=null,this.backend_name_=null,this.backend_type_=null,this.backend_info_=null},GetBackendType:function(){return this.backend_type_},GetBackend:function(){return this.backend_},Init:function(t,e,i,s,n){!this.backend_&&i.cookie_backend&&this.SetBackend("cookie"),TRACKING.debug.Init(i.debug_mode,this.backend_name_,this.backend_type_),this.config_=WCT.DeepCopy(i),this.sco_=WCT.DeepCopy(t),this.objectives_=WCT.DeepCopy(e),this.shortcut_map_=function l(t){for(var e={},i=TRACKING.DELIMITER.lesson_id,s=0,n=null;n=t[s++];){var o=n.uid+(n.mode?i+n.mode:"");if(e[o]=1,n.central_id=o,n.central_id_string=n.tclass+"!"+n.uid+(n.mode?":"+n.mode:""),"book"==n.tclass&&n.pages)for(var r in n.pages)e[r]=1}var a=WCT.uid.CreateUniqueStringMap(e);for(s=0,n=null;n=t[s++];)n.central_short_id=a[n.central_id];return{uid:a,shortcut:WCT.ReverseObject(a)}}(this.objectives_),this.scorm_location_log_=null,this.callback_=s,this.scope_=n,this.backend_?this.backend_.Init(this.sco_,this.objectives_,this.config_,o,this):o.call(this)},Fini:function(){if(this.initialized_&&!this.finished_){this.finished_=!0;for(var t=this.objectives_,e=0,i=0,s=0,n=null;n=t[s++];)n.active&&("book"==n.tclass?(e++,this.Track(n.central_id_string,{id:"pageset_close",end_time:(new Date).getTime()})):(i++,this.Track(n.central_id_string,{id:"lesson_end",end_time:(new Date).getTime(),completed:!1,min:0})));var o;(o=this.sco_)&&!o.end_time&&(o.end_time=(new Date).getTime()),this.still_active_p_=e,this.still_active_l_=i,this.backend_&&this.backend_.Fini(),(o=this.sco_)&&!o.completed&&this.scorm_location_log_&&alert(MANAGER.Trans("SCORM_LOCATION_ERROR")),WCT.CleanupObject(this.objectives_),WCT.CleanupObject(this.shortcut_map_),WCT.CleanupObject(this.config_),WCT.CleanupObject(this.sco_),WCT.CleanupObject(this.scorm_location_log_),this.used_=!1,this.objectives_=[],this.shortcut_map_=null,this.config_={},this.sco_=null,this.scorm_location_log_=null,this.initialized_=!1,this.callback_=null,this.scope_=null,TRACKING.debug.Track({source:"CT.Fini",forced_pageset_ends:this.still_active_p_,forced_lesson_ends:this.still_active_l_}),delete this.still_active_p_,delete this.still_active_l_}},ActivatePageset:function(t,e){var i=u.call(this,t),s=!1;if(i||"collaborator"!=this.backend_type_||((i=WCT.DeepCopy(e)).central_id=i.uid,i.central_id_string="book!"+i.uid,this.objectives_.push(i),this.backend_.InitObjective(i),c.call(this,i)),i){for(var n in i.pages)e.pages[n]=i.pages[n];e.completed=i.completed,""!=i.bookmark&&(e.bookmark=i.bookmark),s=!0}return TRACKING.debug.Status(this.sco_,this.objectives_),TRACKING.debug.Track({source:"CT.ActivatePageset",uid:i?i.uid:"",total_pages:e?e.total_pages:"",completed:e?e.completed:"",bookmark:e&&e.bookmark||"",success:s}),s},ActivateLesson:function(t,e){var i=this.backend_type_,s=u.call(this,t),n=!1,o=this.config_;if(!s&&"collaborator"==i){var r=TRACKING.DELIMITER.lesson_id;(s={tclass:"project",uid:e.uid,mode:e.mode,title:e.title,description:e.description,track_completion:e.track_completion,track_completion_as_score:e.track_completion_as_score,track_score:e.track_score}).central_id=s.uid+r+s.mode,s.central_id_string="project!"+s.uid+":"+s.mode,this.objectives_.push(s),this.backend_.InitObjective(s),_.call(this,s)}if(s){if(!s.title&&e.title&&(s.title=e.title),s.restarted=!1,s.completed||s.passed||e.track_incomplete_instead_failed)if("scorm"==i||"cookie"==i||"aicc"==i){var a=("aicc"==i?"aicc":"scorm")+"_completed_restart_warning";if(s.is_scorable&&o[a]&&!this.ConfirmRestart())return TRACKING.debug.Track({source:"CT.ActivateLesson",uid:s.uid,mode:s.mode,aborted:!0}),"abort";s.restarted=!0}else"collaborator"==i&&(s.restarted=!0,this.backend_.ForceNewSession(s));s.restarted?(s.bookmark="",s.completed=!1,s.passed=null,s.progress=0,s.cumulated_steps=0,s.visited={},delete s.min,s.is_scorable&&(s.cur=0,s.cum=0,s.max=0),h.call(this),p.call(this),this.backend_.StoreLessonObjective(s)):("number"==typeof s.bookmark&&(e.bookmark=s.bookmark),"number"==typeof s.cur&&(e.cur=s.cur),"number"==typeof s.cum&&(e.cum=s.cum)),n=!0}return TRACKING.debug.Status(this.sco_,this.objectives_),TRACKING.debug.Track({source:"CT.ActivateLesson",uid:s?s.uid:"-",title:s?s.title:"-",mode:s?s.mode:"-",current_score:e?e.cur:"",cumulated_max_score:e?e.cum:"",bookmark:e&&e.bookmark||"",success:n}),n},Track:function(t,e){var i=u.call(this,t),s=!1;if(i&&this.backend_){var n=e.id,o=this.sco_,r=this.backend_;switch(TRACKING.debug.Track({source:"CT.Track (start)",id:n},i),n){case"pageset_open":i.active||(s=!0,i.active=!0,i.start_time=e.start_time,"book"==o.tclass&&(o.bookmark=i.central_id),o.start_time||(o.start_time=(new Date).getTime()),r.Track(n,i,e));break;case"pageset_progress":var a=e.slide_id;if("undefined"!=typeof i.pages[a]){if(!i.pages[a]){i.pages[a]=!0,i.completed=TRACKING.PagesetCompleted(i.pages);var l=TRACKING.PagesetCountVisited(i.pages);i.progress=l/i.total_pages,h.call(this)}"book"==o.tclass&&(o.bookmark=i.central_id),i.bookmark=a,r.Track(n,i,e),s=!0}break;case"pageset_close":i.active&&(s=!0,i.active=!1,i.end_time=e.end_time,o.end_time=(new Date).getTime(),r.Track(n,i,e));break;case"lesson_start":i.active||(s=!0,i.active=!0,i.start_time=e.start_time,i.total_steps=e.total_steps,"project"==o.tclass&&(o.bookmark=i.central_id),o.start_time||(o.start_time=(new Date).getTime()),i.completed?i.progress=1:0<i.total_steps?i.progress=i.cumulated_steps/i.total_steps:i.progress=0,h.call(this),p.call(this),r.Track(n,i,e));break;case"lesson_progress":if(c=e.uid)delete(_=WCT.DeepCopy(e)).id,i.tourstops||(i.tourstops={order_:[]}),i.tourstops[c]||(i.tourstops[c]=_),i.tourstops.order_.push(c),_.start_time=(new Date).getTime(),i.bookmark="number"==typeof _.idx?_.idx:"","project"==o.tclass&&(o.bookmark=i.central_id),r.Track(n,i,e),s=!0;break;case"lesson_commit":var c;if(c=e.uid){var _,d=(_=i.tourstops[c]||null)?_.idx:null;"number"!=typeof d||i.visited[d]?_.committed_=2:(i.visited[d]=!0,i.cumulated_steps++,i.progress=Math.min(0<i.total_steps?i.cumulated_steps/i.total_steps:0,1),_.committed_=1,_.macros=e.macros,_.timestamp=e.timestamp,i.is_scorable&&(_.cur=e.cur,_.cum=e.cum,i.cur||(i.cur=0),i.cum||(i.cum=0),i.cur+=_.cur,i.cum+=_.cum),h.call(this),p.call(this)),"project"==o.tclass&&(o.bookmark=i.central_id),r.Track(n,i,e),s=!0}break;case"lesson_end":i.active&&(s=!0,i.active=!1,i.completed=e.completed,i.passed=null,i.completed&&(i.progress=1,!i.track_completion_as_score||"scorm"!=this.backend_type_&&"aicc"!=this.backend_type_?i.is_scorable&&(i.passed=i.cur>=i.min,!i.passed&&i.track_incomplete_instead_failed&&(i.completed=!1,i.passed=null)):i.passed=!0),h.call(this),p.call(this),i.end_time=e.end_time,o.end_time=(new Date).getTime(),"project"==o.tclass&&(o.bookmark=i.central_id),r.Track(n,i,e));break;case"lesson_score":i.is_scorable&&(s=!0,i.min=e.min,i.max=e.max)}}s&&(e.source="CT.Track (end)",TRACKING.debug.Status(this.sco_,this.objectives_),TRACKING.debug.Track(e,i))},GetShortcutMap:function(){return this.shortcut_map_},ScormLocationError:function(t){this.scorm_location_log_=!1===t?{data:arguments[1],timestamp:(new Date).getTime()}:null},ScormSafeModeError:function(t,e,i){TRACKING.debug.Track({source:"CT.ScormSafeModeError",cmd:t,v1:e,v2:i})},AddAgent:function(t){this.agents_[t]=!0,this.sco_&&(this.sco_.agents_||(this.sco_.agents={}),this.sco_.agents[t]=!0,TRACKING.debug.Status(this.sco_,this.objectives_))},RemoveAgent:function(t){delete this.agents_[t];var e=this.sco_;e&&e.agents&&(delete e.agents[t],TRACKING.debug.Status(e,this.objectives_)),this.Agents()||(this.Fini(),this.Cleanup())},Agents:function(){var t=TRACKING.AGENT_UID_PREFIX,e=t.length,i=this.agents_,s=0;for(var n in i)n.substr(0,e)==t&&s++;return s},IsCollaborator:function(){return"collaborator"==this.backend_type_},GetBookmark:function(){var t=arguments[0]||null;if(t){for(var e=this.objectives_,i=0,s=null;s=e[i++];)if(s.central_id==t)return s.bookmark||"";return""}return this.sco_&&this.sco_.bookmark||""},ConfirmRestart:function(){var t=MANAGER.Trans("RESTART_COMPLETED_LMS_LESSON").replace(/\\r\\n/g,"\n");return confirm(t)}}}(),TRACKING.local=function(t,e){e&&(e.string=e.tclass+"!"+e.uid,e.mode&&(e.string+=":"+e.mode)),this.ct_=t||null,this.id_=e||null,this.initialized_=!1,this.data_={}},TRACKING.local.prototype=function(){function e(t,e){var i=this.ct_;try{if(i&&"undefined"!=typeof i[t])return i[t](this.id_.string,e)}catch(s){Log(s,!0)}return null}return{Destructor:function(){this.ct_=null,this.id_=null,this.initialized_=!1,WCT.CleanupObject(this.data_),this.data_=null},Track:function(t){},activate_:function(){var t="book"==this.id_.tclass?"ActivatePageset":"ActivateLesson";this.initialized_=e.call(this,t,this.data_)},track_:function(t){this.initialized_&&e.call(this,"Track",t)}}}(),TRACKING.local.lesson=function(t,e,i,s){TRACKING.local.call(this,t,{tclass:"project",uid:e.uid,mode:e.mode}),this.data_=WCT.DeepCopy(e),this.meta_=WCT.DeepCopy(i),this.tourstops_=WCT.DeepCopy(s),this.macros_=null,this.tourstop_idx_=null,this.completed_=!1,this.fixate_=!1,this.started_=!1,this.aborted_=!1;var n=this.data_;n.cur=0,n.cum=0,n.max=0,n.pass=0,n.title=i.title,n.tourstops={},n.order_=[],this.ClearQuizTrackingData(),this.activate_(),this.aborted_="abort"==this.initialized_},TRACKING.local.lesson.prototype=new TRACKING.local,WCT.ExtendObject(TRACKING.local.lesson.prototype,function(){function e(){var t=this.data_,e=this.meta_,i=this.quiz_;return"number"==typeof arguments[0]?Math.ceil(arguments[0]*i.cum/100):"number"==typeof e.mastery_percent?Math.ceil(e.mastery_percent*i.cum/100):0<t.max?i.cum*t.pass/t.max:.8*t.max}return{Destructor:function(){this.End(),WCT.CleanupObject(this.meta_),WCT.CleanupObject(this.tourstops_),WCT.CleanupObject(this.quiz_),this.meta_=null,this.tourstops_=null,this.quiz_=null,TRACKING.local.prototype.Destructor.call(this)},Aborted:function(){return this.aborted_},GetBookmark:function(){var t=this.data_.bookmark,e=null;return"number"==typeof t&&(e=this.tourstops_.indexOfAtt(t,"index"))<0&&(e=null),e},SetScores:function(t,e){this.data_.max=t,this.data_.pass=e},Start:function(){this.started_||(this.started_=!0,this.track_({id:"lesson_start",start_time:(new Date).getTime(),total_steps:this.tourstops_.length}))},End:function(){if(this.started_){this.started_=!1;var t=this.meta_.mastery_percent,e=this.data_,i=this.completed_?e.cum:e.max,s="number"==typeof t?Math.ceil(t*i/100):e.pass;this.track_({id:"lesson_score",min:s,max:i}),this.track_({id:"lesson_end",completed:this.completed_,end_time:(new Date).getTime()})}},Progress:function(t){var e=this.tourstops_.indexOfAtt(t,"index");this.tourstop_idx_=e,this.macros_={order_:[]};var i=this.tourstops_[e];i&&i.uid&&(i.start_time=(new Date).getTime(),this.track_({id:"lesson_progress",uid:i.uid,idx:t,title:i.title||""}))},Commit:function(){var t=this.data_,e=this.tourstops_[this.tourstop_idx_];if(e&&e.uid){var i=this.macros_;this.macros_=null;var s={cur:0,cum:0};if(i)for(var n=0,o=null;o=i.order_[n++];)s.cur+=i[o].cur||0,s.cum+=i[o].cum||0;if(!t.tourstops[e.uid]){t.tourstops[e.uid]={title:e.title,macros:i,scores:s,start_time:e.start_time,end_time:(new Date).getTime(),index:e.index};var r=t.order_.indexOf(e.uid);0<=r&&t.order_.splice(r,1),t.order_.push(e.uid),t.cur+=s.cur,t.cum+=s.cum;for(var a=[],l=WCT.DeepCopy(i),c=(n=0,null);c=l.order_[n++];)if("order_"!=c)if(l[c].caption){a.push(c);for(var _=0,d=null;d=l[c].events[_];_++)d.ct_ignore_&&l[c].events.splice(_--,1)}else delete l[c];l.order_=a,this.track_({id:"lesson_commit",uid:e.uid,timestamp:(new Date).getTime(),macros:l,cur:s.cur,cum:s.cum})}}},Completed:function(t){!t&&this.fixate_||(this.completed_=t),this.fixate_=arguments[1]},Track:function(t){var e=this.macros_;if(e&&t.uid){e[t.uid]||(e[t.uid]={uid:t.uid,cur:0,cum:0,events:[]},e.order_.push(t.uid));var i=e[t.uid];t.caption&&(i.caption=t.caption),t.description&&(i.description=WCT.context.RemoveImgIds(t.description));var s=(new Date).getTime();switch(i.timestamp=s,t.id){case"simple_macro":if("branch_off"==t.caption)for(var n=0,o=null;o=e.order_[n++];){if(e[o].uid!=i.uid)if(0<(e[o].cum||0)){delete i.cur,delete i.cum;break}}else delete i.cur,delete i.cum;break;case"quiz_information":t.correct_responses=t.correct_responses.join(",,,"),t.student_responses=t.student_responses.join(",,,"),t.max=t.weighting,t.cur="correct"==t.result?t.max:0,(r=WCT.DeepCopy(t)).time=s,r.timestamp=s,function a(t){var e=this.quiz_,i=this.tourstops_[this.tourstop_idx_];if(i&&i.uid){var s=e.tourstops[i.uid];s||(e.tourstops[i.uid]={title:i.title,macros:{order_:[]},scores:{cur:0,cum:0},start_time:i.start_time,index:i.index},s=e.tourstops[i.uid]);var n=e.order_.indexOf(i.uid);0<=n&&e.order_.splice(n,1),e.order_.push(i.uid);var o=(new Date).getTime();if(s.end_time=o,!s.macros[t.uid]){var r={caption:t.caption||"",uid:t.uid,cur:0,cum:0,events:[]};t.description&&(r.description=WCT.context.RemoveImgIds(t.description)),r.timestamp=o,r.cur=t.cur,r.cum=t.max,s.scores.cur+=r.cur,s.scores.cum+=r.cum,e.cur+=r.cur,e.cum+=r.cum,t=WCT.DeepCopy(t),s.macros[t.uid]=r,s.macros.order_.push(t.uid),r.events.push(t),delete t.caption,delete t.macro_uid,delete t.uid,delete t.cur,delete t.max}}}.call(this,r),delete r.caption,delete r.macro_uid,delete r.uid,delete r.cur,delete r.max,i.events.push(r);break;case"tour_start":case"tour_end":case"tour_next":case"tour_prev":case"tour_jump":(r=WCT.DeepCopy(t)).timestamp=s,r.ct_ignore_=!0,delete r.caption,delete r.description,delete r.uid,i.events.push(r);break;default:var r;(r=WCT.DeepCopy(t)).action_score=r.cur,r.max_score=r.max,r.timestamp=s,delete r.caption,delete r.description,delete r.uid,delete r.cur,delete r.max,i.events.push(r)}"user_action_correct_action"==t.id||"user_action_goon"==t.id||"quiz_information"==t.id?(i.cur=t.cur||0,i.cum=t.max||0):"user_action_wrong_action"==t.id&&(i.cum=t.max||0)}},GetCurrentScore:function(){return this.data_.cur},GetCumulatedScore:function(){return this.data_.cum},GetPassScore:function(){return this.data_.pass},GetCurTsIndex:function(){var t=this.tourstops_[this.tourstop_idx_];return t?t.index:-1},GetTrackingData:function(){var t=WCT.DeepCopy(this.data_);if(t.completed=arguments[0]||this.completed_,t.completed){var e=this.meta_.mastery_percent,i="number"==typeof e?Math.ceil(e*t.cum/100):t.pass;t.passed=t.cur>=i}else t.passed=!1;return t},GetQuizTrackingData:function(){var t=this.quiz_;return t.pass=e.call(this,arguments[0]),t.max=t.cum,t},GetQuizScore:function(){var t=this.quiz_;return{cur:t.cur,max:t.cum,pass:e.call(this)}},ClearQuizTrackingData:function(){var t=this.data_;this.quiz_={cur:0,cum:0,description:t.description,max:0,pass:0,tclass:t.tclass,title:t.title,tourstops:{},order_:[],uid:t.uid}}}}()),TRACKING.local.pageset=function(t,e){TRACKING.local.call(this,t,{tclass:"book",uid:e.uid}),WCT.ExtendObject(this.data_,e),this.open_=!1,this.activate_()},TRACKING.local.pageset.prototype=new TRACKING.local,WCT.ExtendObject(TRACKING.local.pageset.prototype,{Destructor:function(){this.Close(),TRACKING.local.prototype.Destructor.call(this)},Open:function(){this.open_||(this.open_=!0,this.track_({id:"pageset_open",start_time:(new Date).getTime()}))},Close:function(){this.open_&&(this.open_=!1,this.track_({id:"pageset_close",end_time:(new Date).getTime()}))},Progress:function(t){this.open_&&this.track_({id:"pageset_progress",slide_id:t})},GetVisited:function(){var t=this.data_.pages,e={};for(var i in t)t[i]&&(e[i]=!0);return e}}),TRACKING.SCORM={COMPLETION_UNKNOWN:"unknown",COMPLETION_COMPLETED:"completed",COMPLETION_INCOMPLETE:"incomplete",COMPLETION_NOTATTEMPTED:"not attempted",SUCCESS_UNKNOWN:"unknown",SUCCESS_PASSED:"passed",SUCCESS_FAILED:"failed",LESSON_BROWSED:"browsed",EXIT_EMPTYSTRING:"",EXIT_NORMAL:"normal",EXIT_LOGOUT:"logout",EXIT_SUSPEND:"suspend",EXIT_TIMEOUT:"time-out",EXIT_NAV_ALL:"exitAll",EXIT_NAV_SUSPEND:"suspendAll",ENTRY_EMPTYSTRING:"",ENTRY_ABINITIO:"ab-initio",ENTRY_RESUME:"resume",MODE_NORMAL:"normal",MODE_BROWSE:"browse",MODE_REVIEW:"review",PASSED_ONSCORED:"on_scored",PASSED_ONCOMPLETION:"on_completion",PASSED_NEVER:"never"},TRACKING.connector={},TRACKING.connector.scorm2004=function(t){this.my_=TRACKING.connector.scorm2004,this.scorm_=t,this.api_=null,this.loc_type_="location",this.cache_={},this.safe_mode_=!1,this.verify_location_=!0,this.changed_=!1},TRACKING.connector.scorm2004.SCORM_VERSION="2004",TRACKING.connector.scorm2004.SCORM_FUNCTION_MAP={init:"Initialize",get_value:"GetValue",set_value:"SetValue",commit:"Commit",terminate:"Terminate"},TRACKING.connector.scorm2004.SCORM_COMMAND_MAP={completion:"cmi.completion_status",entry:"cmi.entry",exit:"cmi.exit",location:"cmi.location",mode:"cmi.mode",time:"cmi.session_time",success:"cmi.success_status",suspend:"cmi.suspend_data",progress:"cmi.progress_measure",lms_nav:"adl.nav.request",score_scaled:"cmi.score.scaled",score_raw:"cmi.score.raw",score_min:"cmi.score.min",score_max:"cmi.score.max",obj_count:"cmi.objectives._count",obj_base:"cmi.objectives",obj_id:"id",obj_success:"success_status",obj_completion:"completion_status",obj_description:"description",obj_progress:"progress_measure",obj_score_scaled:"score.scaled",obj_score_raw:"score.raw",obj_score_min:"score.min",obj_score_max:"score.max",int_count:"cmi.interactions._count",int_base:"cmi.interactions",int_id:"id",int_type:"type",int_timestamp:"timestamp",int_weighting:"weighting",int_response:"learner_response",int_result:"result",int_latency:"latency",int_description:"description",int_correct_base:"correct_responses",int_correct_count:"_count",int_correct_pattern:"pattern",int_obj_count:"objectives._count",int_obj_base:"objectives",int_obj_id:"id",pref_language:"cmi.learner_preference.language"},TRACKING.connector.scorm2004.WRITE_ONLY_MAP={exit:!0,time:!0},TRACKING.connector.scorm2004.INTERACTION_TYPE_MAP={true_false:"true-false",choice:"multiple-choice",fill_in:"fill-in",matching:"matching",performance:"performance",sequencing:"sequencing",likert:"likert",numeric:"numeric"},TRACKING.connector.scorm2004.prototype=function(){var n=function(t){return"string"==typeof t&&""==t},o=function(t){return"string"!=typeof t&&(t+=""),!!t.match(/[0-9\.{1}\-]+/)};return{Destructor:function(){this.my_=null,this.scorm_=null,this.api_=null,WCT.CleanupObject(this.cache_),this.cache_=null},Init:function(t,e){var i=this.scorm_,s=this.my_.SCORM_VERSION;if(this.api_=null,this.safe_mode_=t,"auto"==e?(this.verify_location_=!0,this.loc_type_="location"):(this.verify_location_=!1,this.loc_type_=e),i)try{i[s]&&(this.api_=i[s])}catch(n){Log(n)}return this.api_call_("init",""),null!=this.api_},Fini:function(){this.api_call_("terminate","")},GetLocation:function(t){var e=this.my_.SCORM_COMMAND_MAP,i="",s="";return this.verify_location_?(s="suspend","string"==typeof(i=this.get_value_(e.suspend))&&""!=i||(i=this.get_value_(e.location),s="location"),this.loc_type_=s):(s=this.loc_type_,i=this.get_value_(e[s])),TRACKING.debug.Track({source:"SCORM.GetLocation (method: "+s+")",result:i}),i},SetLocation:function(t,e){var i=this.loc_type_,s=this.my_.SCORM_COMMAND_MAP;if(this.cache_[s[i]]!=e&&(this.set_value_(s[i],e),this.verify_location_)){var n=this.get_value_(s[i]);if("string"==typeof n&&n==e)return!0;var o="string"==typeof n?n.length:"undefined";return this.set_value_(s[i],""),TRACKING.debug.Track({source:"SCORM.SetLocation (method: "+i+")",len_compare:e.length+" / "+o,success:!1}),"suspend"!=i&&(this.loc_type_="suspend",this.SetLocation(t,e))}},GetLanguage:function(){return this.get_value_(this.my_.SCORM_COMMAND_MAP.pref_language)},SetExit:function(t,e){var i=this.my_.SCORM_COMMAND_MAP,s=TRACKING.SCORM,n=t?s.EXIT_NORMAL:s.EXIT_SUSPEND;if(this.set_value_(i.exit,n),e){var o=t?s.EXIT_NAV_ALL:s.EXIT_NAV_SUSPEND;this.set_value_(i.lms_nav,o)}},DoCommit:function(){this.changed_&&(this.changed_=!1,this.api_call_("commit",""))},SetSessionTime:function(t){var e=this.my_.SCORM_COMMAND_MAP,i=this.format_duration_(t);this.set_value_(e.time,i)},GetEntry:function(){var t=this.my_.SCORM_COMMAND_MAP,e=this.get_value_(t.entry),i=TRACKING.SCORM;switch(e){case i.ENTRY_EMPTYSTRING:case i.ENTRY_ABINITIO:case i.ENTRY_RESUME:return e}return i.ENTRY_EMPTYSTRING},GetMode:function(){var t=this.my_.SCORM_COMMAND_MAP,e=this.get_value_(t.mode),i=TRACKING.SCORM;switch(e){case i.MODE_NORMAL:case i.MODE_BROWSE:case i.MODE_REVIEW:return e}return i.MODE_NORMAL},GetObjectiveCount:function(){var t=this.my_.SCORM_COMMAND_MAP,e=Number(this.get_value_(t.obj_count));return isNaN(e)?0:e},InitObjectives:function(){for(var t=this.GetObjectiveCount(),e={count_:t},i=t-1;0<=i;i--){e[this.GetObjectiveId(i)]={scorm_pos:i}}return TRACKING.debug.Track({source:"SCORM_connector.initObjectives",count:t}),e},ResetObjective:function(t){var e=t.scorm_pos;if(null!=e){var i=null,s=null;"project"==t.tclass&&TRACKING.SCORABLE_LESSONS[t.mode]&&(i="number"==typeof t.cur?t.cur:0,s="number"==typeof t.max?t.max:0),this.SetObjectiveCurrentScore(e,i),this.SetObjectiveMaxScore(e,s),this.SetObjectiveStatus(e,null,null)}},CreateObjective:function(t,e,i,s,n){var o=this.my_.SCORM_COMMAND_MAP,r=this.GetObjectiveCount(),a=o.obj_base+"."+r+".",l=arguments[5]||null;return this.set_value_(a+o.obj_id,t),this.get_value_(a+o.obj_id)!=t?null:(null!=e&&this.set_value_(a+o.obj_score_raw,e),null!=i&&this.set_value_(a+o.obj_score_max,i),l&&this.SetObjectiveDescription(r,l),this.SetObjectiveStatus(r,s,n),r)},SetObjectiveDescription:function(t,e){var i=this.my_.SCORM_COMMAND_MAP;if(i.obj_description){var s=i.obj_base+"."+t+"."+i.obj_description;this.set_value_(s,e)}},SetObjectiveCurrentScore:function(t,e){if(o(e)||n(e)){var i=this.my_.SCORM_COMMAND_MAP,s=i.obj_base+"."+t+"."+i.obj_score_raw;this.set_value_(s,e)}},SetObjectiveScaledScore:function(t,e){var i=this.my_.SCORM_COMMAND_MAP;if(i.obj_score_scaled&&"number"==typeof e){var s=i.obj_base+"."+t+"."+i.obj_score_scaled;e=Math.round(100*e)/100,this.set_value_(s,e)}},SetObjectiveMaxScore:function(t,e){if(o(e)||n(e)){var i=this.my_.SCORM_COMMAND_MAP,s=i.obj_base+"."+t+"."+i.obj_score_max;this.set_value_(s,e)}},SetObjectiveMinScore:function(t,e){if(o(e)||n(e)){var i=this.my_.SCORM_COMMAND_MAP,s=i.obj_base+"."+t+"."+i.obj_score_min;this.set_value_(s,e)}},SetObjectiveStatus:function(t,e,i){var s=this.my_.SCORM_COMMAND_MAP,n=s.obj_base+"."+t+".",o=n+s.obj_completion,r=n+s.obj_success;this.set_status_(o,r,e,i,arguments[3])},SetObjectiveProgressMeasure:function(t,e){var i=this.my_.SCORM_COMMAND_MAP;if(i.obj_progress&&"number"==typeof e){var s=i.obj_base+"."+t+"."+i.obj_progress;e=Math.round(100*e)/100,this.set_value_(s,e)}},GetObjectiveId:function(t){var e=this.my_.SCORM_COMMAND_MAP,i=e.obj_base+"."+t+"."+e.obj_id;return this.get_value_(i)},GetObjectiveCurrentScore:function(t){var e=this.my_.SCORM_COMMAND_MAP,i=e.obj_base+"."+t+"."+e.obj_score_raw,s=Number(this.get_value_(i));return isNaN(s)?0:s},GetObjectiveMaxScore:function(t){var e=this.my_.SCORM_COMMAND_MAP,i=e.obj_base+"."+pos+"."+e.obj_score_max,s=Number(this.get_value_(i));return isNaN(s)?0:s},GetObjectiveCompletion:function(t){var e=this.my_.SCORM_COMMAND_MAP,i=e.obj_base+"."+t+"."+e.obj_completion;return this.get_completion_(i)},GetObjectiveSuccess:function(t){var e=this.my_.SCORM_COMMAND_MAP,i=e.obj_base+"."+t+"."+e.obj_success;return this.get_success_(i)},GetCompletion:function(){return this.get_completion_(this.my_.SCORM_COMMAND_MAP.completion)},GetSuccess:function(){return this.get_success_(this.my_.SCORM_COMMAND_MAP.success)},SetStatus:function(t,e){var i=this.my_.SCORM_COMMAND_MAP;this.set_status_(i.completion,i.success,t,e,arguments[2])},SetProgressMeasure:function(t){var e=this.my_.SCORM_COMMAND_MAP;e.progress&&"number"==typeof t&&(t=Math.round(100*t)/100,this.set_value_(e.progress,t))},SetMaxScore:function(t){(o(t)||n(t))&&this.set_value_(this.my_.SCORM_COMMAND_MAP.score_max,t)},SetMinScore:function(t){(o(t)||n(t))&&this.set_value_(this.my_.SCORM_COMMAND_MAP.score_min,t)},SetCurrentScore:function(t){(o(t)||n(t))&&this.set_value_(this.my_.SCORM_COMMAND_MAP.score_raw,t)},SetScaledScore:function(t){var e=this.my_.SCORM_COMMAND_MAP;e.score_scaled&&"number"==typeof t&&(t=Math.round(100*t)/100,this.set_value_(e.score_scaled,t))},get_value_:function(t){var e=this.api_call_("get_value",t);return this.cache_[t]=e},set_value_:function(t,e){if(this.cache_[t]!=e){if(this.api_call_("set_value",t,e),this.safe_mode_){var i=this.my_.SCORM_COMMAND_MAP,s=this.my_.WRITE_ONLY_MAP;for(var n in i)if(i[n]==t&&s[n])return;var o=this.api_call_("get_value",t);e!=o&&TRACKING.central.ScormSafeModeError(t,e,o)}else this.cache_[t]=e;this.changed_=!0}},api_call_:function(t){var e=this.api_,i=this.my_.SCORM_FUNCTION_MAP[t],s=null,n=!1,o=null,r=arguments[1],a=arguments[2];if(e&&i&&"undefined"!=typeof e[i])try{s=null!=r&&null!=a?e[i](r,a):null!=r?e[i](r):e[i](),n=!0}catch(_){o=_}var l={source:"SCORM.api_call_ ("+this.my_.SCORM_VERSION+")",fun:i};if("string"==typeof r&&""!=r){l.fun+=" ("+r,null!=a&&(l.fun+=", "+a),l.fun+=")";var c=typeof s;"number"!=c&&"string"!=c&&"boolean"!=c||(l.fun+=" => "+s)}return n||(l.success=!1),null!=o&&(l.error_msg=o),TRACKING.debug.Track(l),s},format_duration_:function(t){var e=this.time_to_values_(t),i=e.cs,s=e.s,n=e.min,o=e.h,r=e.day,a=e.m,l=e.y,c="P";return 0<l&&(c+=l+"Y"),0<a&&(c+=a+"M"),0<r&&(c+=r+"D"),(0<o||0<n||0<s||0<i)&&(c+="T"),0<o&&(c+=o+"H"),0<n&&(c+=n+"M"),(0<s||0<i)&&(c+=s,0<i&&(c+="."+i),c+="S"),c},format_timestamp_:function(t){var e=new Date(t),i=Math.floor(e.getMilliseconds()/10),s=e.getSeconds(),n=e.getMinutes(),o=e.getHours(),r=e.getDate(),a=e.getMonth();a<10&&(a="0"+a),r<10&&(r="0"+r),o<10&&(o="0"+o),n<10&&(n="0"+n),s<10&&(s="0"+s);var l=[e.getFullYear(),a,r].join("-"),c=[o,n,s].join(":");return 0<i&&(i<10&&(i="0"+i),c+="."+i),l+"T"+c},time_to_values_:function(t){var e=Math.floor(t%1e3/10),i=(t=Math.floor(t/1e3))%60,s=(t=Math.floor(t/60))%60,n=(t=Math.floor(t/60))%24;return t=Math.floor(t/24),{y:0,m:0,day:0,h:n,min:s,s:i,cs:e}},set_status_:function(t,e,i,s){if(!0!==arguments[4]){var n=TRACKING.SCORM;!0===i?this.set_value_(t,n.COMPLETION_COMPLETED):!1===i?this.set_value_(t,n.COMPLETION_INCOMPLETE):this.set_value_(t,n.COMPLETION_UNKNOWN),!0===s?this.set_value_(e,n.SUCCESS_PASSED):!1===s?this.set_value_(e,n.SUCCESS_FAILED):this.set_value_(e,n.SUCCESS_UNKNOWN)}},get_completion_:function(t){var e=this.get_value_(t),i=TRACKING.SCORM;switch(e){case i.COMPLETION_COMPLETED:case i.SUCCESS_PASSED:case i.SUCCESS_FAILED:return!0}return!1},get_success_:function(t){var e=this.get_value_(t),i=TRACKING.SCORM;switch(e){case i.SUCCESS_PASSED:return!0;case i.SUCCESS_FAILED:return!1}return null}}}(),TRACKING.connector.scorm12=function(t){TRACKING.connector.scorm2004.call(this,t),this.my_=TRACKING.connector.scorm12},TRACKING.connector.scorm12.prototype=new TRACKING.connector.scorm2004,TRACKING.connector.scorm12.SCORM_VERSION="12",TRACKING.connector.scorm12.SCORM_FUNCTION_MAP={init:"LMSInitialize",get_value:"LMSGetValue",set_value:"LMSSetValue",commit:"LMSCommit",terminate:"LMSFinish"},TRACKING.connector.scorm12.SCORM_COMMAND_MAP={completion:"cmi.core.lesson_status",entry:"cmi.core.entry",exit:"cmi.core.exit",location:"cmi.core.lesson_location",mode:"cmi.core.lesson_mode",time:"cmi.core.session_time",success:"cmi.core.lesson_status",suspend:"cmi.suspend_data",progress:null,score_scaled:null,score_raw:"cmi.core.score.raw",score_min:"cmi.core.score.min",score_max:"cmi.core.score.max",obj_count:"cmi.objectives._count",obj_base:"cmi.objectives",obj_id:"id",obj_success:"status",obj_completion:"status",obj_description:null,obj_progress:null,obj_score_scaled:null,obj_score_raw:"score.raw",obj_score_min:"score.min",obj_score_max:"score.max",int_count:"cmi.interactions._count",int_base:"cmi.interactions",int_id:"id",int_type:"type",int_timestamp:"time",int_weighting:"weighting",int_response:"student_response",int_result:"result",int_latency:"latency",int_description:null,int_correct_base:"correct_responses",int_correct_count:"_count",int_correct_pattern:"pattern",int_obj_count:"objectives._count",int_obj_base:"objectives",int_obj_id:"id",pref_language:"cmi.student_preference.language"},TRACKING.connector.scorm12.WRITE_ONLY_MAP={exit:!0,time:!0},TRACKING.connector.scorm12.INTERACTION_TYPE_MAP={true_false:"true-false",choice:"choice",fill_in:"fill-in",matching:"matching",performance:"performance",sequencing:"sequencing",likert:"likert",numeric:"numeric"},WCT.ExtendObject(TRACKING.connector.scorm12.prototype,{SetExit:function(t){var e=TRACKING.SCORM,i=t?e.EXIT_EMPTYSTRING:e.EXIT_SUSPEND,s=this.my_.SCORM_COMMAND_MAP;this.set_value_(s.exit,i)},format_duration_:function(t){var e=this.time_to_values_(t),i=e.cs,s=e.s,n=e.min,o=e.h,r=e.day,a=e.m;1e4<=(o+=24*(365.25*e.y+30.4375*a+r))&&(o=9999),o<10?o="000"+o:o<100?o="00"+o:o<1e3&&(o="0"+o),n<10&&(n="0"+n),s<10&&(s="0"+s);var l=o+":"+n+":"+s;return 0<i&&(i<10&&(i="0"+i),l+="."+i),l},format_timestamp_:function(t){var e=this.format_duration_(t).split(":");return e[0]=e[0].substr(2),e.join(":")},set_status_:function(t,e,i,s){if(!0!==arguments[4]){var n=TRACKING.SCORM;!0===s?this.set_value_(e,n.SUCCESS_PASSED):!1===s?this.set_value_(e,n.SUCCESS_FAILED):!0===i?this.set_value_(t,n.COMPLETION_COMPLETED):!1===i&&this.set_value_(t,n.COMPLETION_INCOMPLETE)}}}),TRACKING.bookmark=function(t,e){this.api_=t,this.version_=e,this.objectives_standalone_=!1},TRACKING.bookmark.MAX_VERSION="2",TRACKING.bookmark.prototype=function(){var p={1:{PAGESET_ID:"1",LESSON_ID:"2",SetPageset:function(t){var e=TRACKING.central.GetShortcutMap(),i=null!=t.bookmark&&""!=t.bookmark?e.uid[t.bookmark]:"",s=[];for(var n in t.pages)t.pages[n]&&s.push(e.uid[n]);return[i,s=s.join(TRACKING.DELIMITER.visited_slides)]},GetPageset:function(t,e){var i=TRACKING.central.GetShortcutMap();t.bookmark="string"==typeof e[0]&&""!=e[0]?i.shortcut[e[0]]:"";for(var s="string"==typeof e[1]?e[1].split(TRACKING.DELIMITER.visited_slides):[],n=s.length-1;0<=n;n--){var o=i.shortcut[s[n]];null!=t.pages[o]&&(t.pages[o]=!0)}},SetLesson:function(t){var e=TRACKING.backend.scorm.FIXED,i="number"==typeof t.bookmark?t.bookmark:"",s="number"==typeof t.progress?Number(t.progress.toFixed(e)):0,n=t.completed?1:0;if(TRACKING.SCORABLE_LESSONS[t.mode]){var o,r="number"==typeof t.cur?Number(t.cur.toFixed(e)):0,a="number"==typeof t.max?Number(t.max.toFixed(e)):0,l="number"==typeof t.cum?Number(t.cum.toFixed(e)):0,c="number"==typeof t.min?Number(t.min.toFixed(e)):0;switch(t.passed){case!1:o=0;break;case!0:o=1;break;default:o=2}return[i,s,n,r,a,l,c,o]}return[i,s,n]},GetLesson:function(t,e){var i=""!=e[0]?Number(e[0]):"",s=Number(e[1]),n=Number(e[2]);if(t.bookmark=isNaN(i)?"":i,t.progress=isNaN(s)?0:s,t.completed=!isNaN(n)&&Boolean(n),TRACKING.SCORABLE_LESSONS[t.mode]){var o=Number(e[3]),r=Number(e[4]),a=Number(e[5]),l=Number(e[6]);switch(t.cur=isNaN(o)?0:o,t.max=isNaN(r)?0:r,t.cum=isNaN(a)?0:a,t.min=isNaN(l)?0:l,Number(e[7])){case 0:t.passed=!1;break;case 1:t.passed=!0;break;default:t.passed=null}}}},2:{PAGESET_ID:"",LESSON_ID:"2",SetPageset:function(t){var e=TRACKING.central.GetShortcutMap(),i=t.bookmark?e.uid[t.bookmark]:"",s=[],n=[];for(var o in t.pages){var r=e.uid[o];t.pages[o]?s.push(r):n.push(r)}var a=TRACKING.DELIMITER.visited_slides;if(s.length<=n.length){var l=s.indexOf(i);return 0<=l&&l.toString().length<i.length&&(i=l),s=s.join(a),i||s?[i,s]:null}return[i,n=a+n.join(a)]},GetPageset:function(t,e){var i=TRACKING.central.GetShortcutMap(),s="string"==typeof e[0]?e[0]:"";s&&!isNaN(Number(s))&&(s=Number(s));var n=[],o=!1;if(e[1]&&"string"==typeof e[1]&&(n=e[1].split(TRACKING.DELIMITER.visited_slides),o="-"==e[1].charAt(0)),o)if("-"==e[1])for(var r in t.pages)t.pages[r]=!0;else for(var r in n.shift(),t.pages){var a=i.uid[r];-1==n.indexOf(a)&&(t.pages[r]=!0)}else{"number"==typeof s&&(s=n[s]);for(var l=n.length-1;0<=l;l--){r=i.shortcut[n[l]];null!=t.pages[r]&&(t.pages[r]=!0)}}t.bookmark=i.shortcut[s]||""},SetLesson:function(t){var e=TRACKING.backend.scorm.FIXED,i="number"==typeof t.bookmark?t.bookmark:"",s="number"==typeof t.progress?Number(t.progress.toFixed(e)):0,n=t.completed?1:0,o="";if(t.visited){var r=TRACKING.DELIMITER.visited_tourstop_ranges,a=TRACKING.DELIMITER.visited_tourstop_groups;for(var l in o=[],t.visited)o.push(Number(l));o=o.toRangedString(r,a)}if(TRACKING.SCORABLE_LESSONS[t.mode]){var c,_="number"==typeof t.cur?Number(t.cur.toFixed(e)):0,d="number"==typeof t.max?Number(t.max.toFixed(e)):0,u="number"==typeof t.cum?Number(t.cum.toFixed(e)):0,h="number"==typeof t.min?Number(t.min.toFixed(e)):0;switch(t.passed){case!1:c=1;break;case!0:c=2;break;default:c=0}return i||s||n||o||_||d||u||h||c?[i,s,n,o,_,d,u,h,c]:null}return i||s||n||o?[i,s,n,o]:null},GetLesson:function(t,e){var i=e[0]?Number(e[0]):"",s=Number(e[1]),n=Number(e[2]),o=e[3]||"";t.bookmark=isNaN(i)?"":i,t.progress=isNaN(s)?0:s,t.completed=!isNaN(n)&&Boolean(n);var r=TRACKING.DELIMITER.visited_tourstop_ranges,a=TRACKING.DELIMITER.visited_tourstop_groups;o=o.rangedToArray(r,a),t.visited={};for(var l=o.length-1;0<=l;l--)t.visited[o[l]]=!0;if(TRACKING.SCORABLE_LESSONS[t.mode]){var c=Number(e[4]),_=Number(e[5]),d=Number(e[6]),u=Number(e[7]);switch(t.cur=isNaN(c)?0:c,t.max=isNaN(_)?0:_,t.cum=isNaN(d)?0:d,t.min=isNaN(u)?0:u,Number(e[8])){case 1:t.passed=!1;break;case 2:t.passed=!0;break;default:t.passed=null}}}}};return{Destructor:function(){WCT.CleanupObject(this.api_),this.api_=null},ObjectivesStandalone:function(t){this.objectives_standalone_=t},Set:function(t,e){for(var i=this.version_,s=p[i],n=TRACKING.DELIMITER,o=[],r=TRACKING.central.GetShortcutMap(),a=null!=t.bookmark?r.uid[t.bookmark]:"",l=0,c=null;c=e[l];l++){var _="book"==c.tclass,d=c.central_short_id,u=s[_?"SetPageset":"SetLesson"](c);null!=u&&(u.unshift(d),u.unshift(_?s.PAGESET_ID:s.LESSON_ID),o.push(u.join(n.objective_parts)))}o=[i,a,o.join(n.objectives)].join(n.master);var h=this.api_.SetLocation(t,o);return"boolean"==typeof h&&TRACKING.central.ScormLocationError(h,o),o},Get:function(t,e){var i=this.api_.GetLocation(t);if("string"!=typeof i||""==i)return"";var s=TRACKING.DELIMITER,n=TRACKING.central.GetShortcutMap(),o=i.split(s.master);if(3!=o.length)return"";var r=p[o[0]]||null;if(!r)return"";t.bookmark=""!=o[1]?n.shortcut[o[1]]:null;var a=""!=o[2]?o[2].split(s.objectives):[];if(this.objectives_standalone_&&1==a.length){if((o=a[0].split(s.objective_parts)).length<2)return;var l=o[0]===r.PAGESET_ID;o.splice(0,2),r[l?"GetPageset":"GetLesson"](e[0],o)}else for(var c=a.length-1;0<=c;c--)if(!((o=a[c].split(s.objective_parts)).length<2)){l=o[0]===r.PAGESET_ID;var _=n.shortcut[o[1]],d=e.indexOfAtt(_,"central_id");0<=d&&(o.splice(0,2),r[l?"GetPageset":"GetLesson"](e[d],o))}return i}}}(),TRACKING.backend=function(){this.my_=null,this.name_="TRACKING.backend",this.sco_=null,this.objectives_=null,this.config_=null,this.callback_=null,this.scope_=null},TRACKING.backend.prototype={Destructor:function(){this.my_=null,this.sco_=null,this.objectives_=null,this.config_=null,this.callback_=null,this.scope_=null},GetName:function(){return this.name_},Init:function(t,e,i,s,n){this.sco_=t,this.objectives_=e,this.config_=i,this.callback_=s,this.scope_=n},Fini:function(){},Track:function(t,e){},StoreLessonObjective:function(t){},init_done_:function(){this.callback_.call(this.scope_),this.callback_=null,this.scope_=null}},TRACKING.backend.collaborator=function(){TRACKING.backend.call(this),this.my_=TRACKING.backend.collaborator,this.name_="TRACKING.backend.collaborator"},TRACKING.backend.collaborator.prototype=new TRACKING.backend,TRACKING.backend.collaborator.isHana=function(){var t=DATA.GetS(".server"),e=t&&t.response&&t.response.version||null;return e&&"3"===e["build.edition"]},TRACKING.backend.collaborator.Available=function(){var t=DATA.GetS(".server"),e=t&&t.response&&t.response.version||null;return e&&e.collaborator_version||null},TRACKING.backend.collaborator.HasPermission=function(t){var e=DATA.GetS("mgr:self/permission"),i=e&&e.response&&e.response.permission||null;return i&&-1!==i.indexOf(t)},TRACKING.backend.collaborator.GetCollaboratorBackendName=function(t){var e="collaborator";return"@buildVersion@"!=t&&((t=t.split(".")).length<2||parseInt(t[0])<8||8==parseInt(t[0])&&parseInt(t[1])<5)&&(e="collaborator84"),e},WCT.ExtendObject(TRACKING.backend.collaborator.prototype,function(){function n(t){var e=t.mode||t.tclass,i=t.tclass+"!"+t.uid+":.track",s="?mode="+e,n=this.config_;return n.assignment_id&&(s+="&assignmentId="+n.assignment_id,arguments[1]?this.config_.restart||(s+="&startMode=continue"):s+="&queryStatus=1"),DATA.context.ToAbsPath(i)+s}return{Init:function(){TRACKING.backend.prototype.Init.apply(this,arguments),this.init_done_()},InitObjective:function(t){if(!this.config_.restart||arguments[1]){var e=n.apply(this,arguments),i=XHR.GetS(e,"JSON");i&&null!=i.sessionId&&function o(t,e){t.session_id=e.sessionId;var i=e.visited;if(i&&t.pages&&i.length)for(var s=i.length-1;0<=s;s--)null!=t.pages[i[s]]&&(t.pages[i[s]]=!0);if((i=e.tour_stops)&&i.length){t.visited={};for(s=i.length-1;0<=s;s--)t.visited[i[s]]=!0}if("number"==typeof e.lesson_max_score&&(t.cum=e.lesson_max_score),"number"==typeof e.lesson_score&&(t.cur=e.lesson_score),"undefined"!=typeof e.last_item)if("project"==t.tclass){var n=Number(e.last_item);isNaN(n)||0==n||(t.bookmark=n)}else t.bookmark=e.last_item}.call(this,t,i);var s="?mode="+(t.mode||t.tclass);t.url=DATA.context.ToAbsPath(t.tclass+"!"+t.uid+":.track")+s}},ForceNewSession:function(t){var e=n.call(this,t,!0);e=e.replace(/&startMode=continue/,"");var i=XHR.GetS(e,"JSON");i&&null!=i.sessionId&&(t.session_id=i.sessionId)},TrackRecord:function(t){if(!(t&&t.verb&&t.context&&t.object))return console.groupCollapsed("Error in .record request."),console.log(t),void console.groupEnd();t.context.app="trainer";var e=MANAGER.GetBase(),i=XHR.GetToken();i&&"Required"!==i||XHR.RequestToken(),XHR.PostS(e+"/.record",t)},Track:function(t,e){if(this.check_session_(e)){var i=arguments[2]||{},s=!0,n={session_id:e.session_id};switch(t){case"pageset_open":n.id="book_open",n.total_pages=e.total_pages;break;case"pageset_progress":i.slide_id&&(n.id="slide_load",n.slide_id=i.slide_id);break;case"pageset_close":s=!(n.id="book_close");break;case"lesson_start":e.active&&(n.id="tour_start",n.tour_stops=e.total_steps);break;case"lesson_commit":var o=e.tourstops.order_.top(),r=e.tourstops[o];if(1<r.committed_)return;n.id="tour_sub_end",WCT.ExtendObject(n,this.handle_tourstop_(r)),s=!1;break;case"lesson_end":n.id="tour_end",n.program_index=e.bookmark,n.timestamp=e.end_time,n.tour_stops=e.completed?e.cumulated_steps:e.total_steps,n.completed=e.completed,e.is_scorable&&(n.max_score=e.cum,n.pass_score=e.min,n.score=e.cur,n.passed=e.passed||!1),s=!1;break;default:return}if(n.id)XHR[s?"PostA":"PostS"](e.url,n),"lesson_end"!=t&&"pageset_close"!=t||TRACKING.RefreshCollaborator()}},check_session_:function(t){return"undefined"==typeof t.session_id&&(t.session_id=null,this.InitObjective(t,!0)),!!t.session_id},handle_tourstop_:function(t){for(var e=this.config_,i={caption:t.title,current_score:t.cur,max_score:t.cum,program_index:t.idx,timestamp:null!=t.start_time?t.start_time:t.timestamp,ts_uid:t.uid,macros:[]},s=0,n=null;n=t.macros.order_[s];s++){var o=t.macros[n],r={caption:o.caption,macro_uid:n,timestamp:o.timestamp};if(o.description&&(r.description=o.description),e.detail_tracking){if(1<e.detail_tracking&&o.events&&o.events.length){r.macro_events=[];for(var a=0,l=null;l=o.events[a];a++)"task_info"!=l.id&&r.macro_events.push(l)}null!=o.cur&&null!=o.cum&&this.set_macro_score_(r,t,o)}i.macros.push(r)}return i},set_macro_score_:function(t,e,i){t.action_score=i.cur,t.max_score=i.cum}}}()),TRACKING.backend.collaborator84=function(){TRACKING.backend.collaborator.call(this),this.my_=TRACKING.backend.collaborator84,this.name_="TRACKING.backend.collaborator84"},TRACKING.backend.collaborator84.prototype=new TRACKING.backend.collaborator,WCT.ExtendObject(TRACKING.backend.collaborator84.prototype,{Track:function(t,e){if(this.check_session_(e)){var i=arguments[2]||{},s=!0,n={session_id:e.session_id};switch(t){case"pageset_progress":i.slide_id&&(n.id="slide_load",n.slide_id=i.slide_id,n.isBook=!0,n.currentPage=i.slide_nbr,n.totalPages=e.total_pages);break;case"lesson_commit":n.id="tour_sub_start",n.program_index=e.bookmark;var o=e.tourstops.order_.length;if(1<o){var r=e.tourstops.order_[o-2],a=e.tourstops[r];1==a.committed_&&(n.prev_tour_stop=this.handle_tourstop_(a))}s=!1;break;case"lesson_end":n.id="tour_stop",n.status=e.completed&&e.passed?"passed":"failed";var l=e.tourstops.order_.top(),c=e.tourstops[l];return c&&1==c.committed_&&(n.prev_tour_stop=this.handle_tourstop_(c)),XHR.PostS(e.url,n),e.is_scorable&&this.Track("lesson_passed_status",e,i),this.Track("lesson_completed_status",e,i),void TRACKING.RefreshCollaborator();case"lesson_passed_status":n.id=t,n.lesson_max_score=e.cum,n.lesson_pass_score=e.min,n.lesson_score=e.cur,n.lesson_status=e.completed&&e.passed?"PASSED":"FAILED",s=!1;break;case"lesson_completed_status":n.id=t,e.completed?(n.status="completed",n.tour_stops=e.cumulated_steps):(n.status="incomplete",n.tour_stops=e.total_steps),s=!1;break;default:return TRACKING.backend.collaborator.prototype.Track.apply(this,arguments)}if(n.id)XHR[s?"PostA":"PostS"](e.url,n)}},set_macro_score_:function(t,e,i){t.macro_events||(t.macro_events=[]),t.macro_events.push({id:"macro_score",action_score:i.cur,max_score:i.cum,timestamp:e.timestamp})}}),TRACKING.backend.scorm=function(t,e){TRACKING.backend.call(this),this.my_=TRACKING.backend.scorm,this.name_="TRACKING.backend.scorm",this.scorm_=new TRACKING.connector[t](e),this.scorm_ok_=!1,this.bookmark_=new TRACKING.bookmark(this.scorm_,TRACKING.bookmark.MAX_VERSION)},TRACKING.backend.scorm.prototype=new TRACKING.backend,TRACKING.backend.scorm.FIXED=2,function(){function s(t){var e=0,i=null,s=null;try{for(;i=i||(t.API&&!t.API.T2_API?t.API:null),s=s||(t.API_1484_11||null),t=t.parent,(!i||!s)&&t&&++e<=20;);}catch(n){Log("Unable to scan for SCORM API!")}return i||s?{12:i,2004:s}:null}TRACKING.backend.scorm.FindAPI=function(t){for(var e=t.parent?s(t.parent):null,i=0;!e&&i++<3&&"object"==typeof t.opener&&t.opener;)e=s(t=t.opener);return e&&(e[12]||e[2004])&&MANAGER.OpenerRequired(!0),e},TRACKING.backend.scorm.FormatScore=function(t,e,i,s,n){i&&(e=1,n=!(s=2));var o=Math.pow(10,s),r=n?100:1;return e<=0?0:Math.round(r*o*t/e)/o}}(),WCT.ExtendObject(TRACKING.backend.scorm.prototype,function(){function n(){var t=this.sco_,e=this.config_;if(0!=t.scored_objects&&!e.scorm_browse_mode){var i=e.scorm_use_original_max,s=e.scorm_score_precision,n=e.scorm_score_percentage100,o=this.my_,r=o.FormatScore(t.cur,t.max,i,s,n),a=o.FormatScore(t.max,t.max,i,s,n),l=null;0<t.max&&(l=t.cur/t.max,l=Number(l.toFixed(TRACKING.backend.scorm.FIXED)));var c=this.scorm_;c.SetMinScore(0),c.SetMaxScore(a),c.SetCurrentScore(r),c.SetScaledScore(l)}}function o(t){if(null!=t.scorm_pos&&!this.config_.scorm_browse_mode){var e,i=null;if(t.track_completion_as_score&&null!=t.progress?(i=1,e=t.progress):t.is_scorable&&!1!==t.track_score&&(i=t.completed?t.cum:Math.max(t.cum,t.max),e=t.cur),null!=i){var s=this.config_,n=s.scorm_use_original_max,o=s.scorm_score_precision,r=s.scorm_score_percentage100,a=null;0<i&&(a=e/i,a=Number(a.toFixed(TRACKING.backend.scorm.FIXED)));var l=this.my_;e=l.FormatScore(e,i,n,o,r),i=l.FormatScore(i,i,n,o,r);var c=this.scorm_,_=t.scorm_pos;c.SetObjectiveMinScore(_,0),c.SetObjectiveMaxScore(_,i),c.SetObjectiveCurrentScore(_,e),c.SetObjectiveScaledScore(_,a)}}}function r(t,e){var i=TRACKING.SCORM;switch(this.config_.scorm_decide_passed){case i.PASSED_NEVER:t=null;break;case i.PASSED_ONSCORED:e&&(t=t||!1)}return t}function a(){if(!this.config_.scorm_browse_mode){var t=this.sco_,e=r.call(this,t.passed,0<t.scored_objects),i=this.scorm_;null==t.completed&&null==e||i.SetStatus(t.completed,e),i.SetProgressMeasure(Number(t.progress.toFixed(TRACKING.backend.scorm.FIXED)));var s=0;if("number"==typeof t.start_time)s=("number"==typeof t.end_time?t.end_time:(new Date).getTime())-t.start_time,i.SetSessionTime(s);return s}}function l(t){if(null!=t.scorm_pos&&!this.config_.scorm_browse_mode){if(!1!==t.track_completion){var e=null;!1===t.track_score&&!t.track_completion_as_score||(e="project"==t.tclass?r.call(this,t.passed,!1):null),this.scorm_.SetObjectiveStatus(t.scorm_pos,t.completed,e,!1)}if("number"==typeof t.progress){var i=Number(t.progress.toFixed(TRACKING.backend.scorm.FIXED));this.scorm_.SetObjectiveProgressMeasure(t.scorm_pos,i)}}}function c(t){var e=null,i=null,s=t.title||"";"project"==t.tclass&&(t.track_completion_as_score?(e=0,i=100):t.is_scorable&&!1!==t.track_score&&(e="number"==typeof t.cur?t.cur:0,i="number"==typeof t.max?t.max:0),s+=" "+t.mode);var n=TRACKING.DELIMITER.scorm_short_id,o=t.central_short_id+n+s.replace(/[^\w]/g,n);255<o.length&&(o=o.substr(0,255)),t.scorm_pos=this.scorm_.CreateObjective(o,e,i,null,null,""!=s?s:null)}return{Destructor:function(){this.scorm_.Destructor(),this.scorm_=null,this.bookmark_.Destructor(),this.bookmark_=null,this.scorm_ok_=!1,TRACKING.backend.prototype.Destructor.call(this)},Init:function(t,e,i,s,n){if(TRACKING.backend.prototype.Init.apply(this,arguments),this.scorm_ok_=this.scorm_.Init(i.scorm_safe_mode,i.scorm_location),this.scorm_ok_){var o=TRACKING.SCORM,r=this.scorm_.GetEntry();i.scorm_entry=r,i.scorm_browse_mode=this.scorm_.GetMode()==o.MODE_BROWSE,i.scorm_ignore_bookmark||this.bookmark_.Get(t,e),i.scorm_objective_tracking&&function l(){var t=this.scorm_.InitObjectives(),e=TRACKING.DELIMITER.scorm_short_id;for(var i in t){if("count_"!=i)t[i.split(e)[0]]=t[i]}for(var s=this.config_.scorm_browse_mode,n=!1,o=this.objectives_,r=0,a=null;a=o[r];r++){t[i=a.central_short_id]?a.scorm_pos=t[i].scorm_pos:s||(c.call(this,a),n=!0)}n&&!this.config_.scorm_only_one_commit&&this.scorm_.DoCommit()}.apply(this),TRACKING.debug.Track({source:"BE_scorm.Init",entry:i.scorm_entry,browse_mode:i.scorm_browse_mode})}else TRACKING.debug.Track({source:"BE_scorm.Init",success:!1});this.init_done_()},Fini:function(){if(this.scorm_ok_){var t="",e=this.scorm_,i=this.sco_;this.config_.scorm_browse_mode||(t=a.call(this),e.DoCommit(),e.SetExit(i.completed,this.config_.scorm_nav_request)),e.Fini(),TRACKING.debug.Track({source:"BE_scorm.fini",completed:i.completed,passed:i.passed,time:t})}},StoreLessonObjective:function(t){if(this.scorm_ok_){var e=this.config_;e.scorm_browse_mode||this.bookmark_.Set(this.sco_,this.objectives_),n.call(this),a.call(this),e.scorm_objective_tracking&&(o.call(this,t),l.call(this,t)),e.scorm_only_one_commit||this.scorm_.DoCommit()}},Track:function(t,e){if(this.scorm_ok_){var i=this.config_,s=i.scorm_objective_tracking;switch(s&&null==e.scorm_pos&&!i.scorm_browse_mode&&c.call(this,e),t){case"pageset_open":case"pageset_progress":case"lesson_start":case"lesson_progress":i.scorm_browse_mode||this.bookmark_.Set(this.sco_,this.objectives_);break;case"pageset_close":a.call(this),s&&l.call(this,e);break;case"lesson_commit":i.scorm_browse_mode||this.bookmark_.Set(this.sco_,this.objectives_),n.call(this),s&&o.call(this,e);break;case"lesson_end":return void this.StoreLessonObjective(e);default:return}i.scorm_only_one_commit||this.scorm_.DoCommit()}}}}()),TRACKING.backend.aicc=function(){TRACKING.backend.call(this),this.my_=TRACKING.backend.aicc,this.name_="TRACKING.backend.aicc",this.api_=this.my_.FindAPI(),this.data_=null,this.flash_wnd_=null,this.flash_callback_=null,this.flash_abort_=!1,this.flash_timeout_=null,this.bm_api_={Location:"",handler_:null,GetLocation:function(t){return this.Location},SetLocation:function(t,e){var i=this.handler_&&this.handler_.data_;i&&(i.core.lesson_location=e)}},(this.bm_api_.handler_=this).bookmark_=new TRACKING.bookmark(this.bm_api_,TRACKING.bookmark.MAX_VERSION)},TRACKING.backend.aicc.prototype=new TRACKING.backend,WCT.ExtendObject(TRACKING.backend.aicc,{STATUS:{p:"passed",c:"completed",f:"failed",i:"incomplete",b:"browsed",n:"not-attempted"},ENTRY:{"":null,a:"ab-initio",r:"resume"},EXIT:{"":"",l:"logout",t:"time-out",s:"suspend"},MODE:{b:"browse",n:"normal",r:"review"},FLASH_TIMEOUT:45e3,FindAPI:function(){var t=DATA.GetUrlParams(),e=null,i=null;for(var s in t)"aicc_sid"==s.toLowerCase()?e=t[s]:"aicc_url"==s.toLowerCase()&&(i=t[s]);return e&&i?{sid:e,url:i}:null},GetAiccRelay:function(){var t=$("AiccRelay");return BROWSER.IE?t:t?t.getElementsByTagName("embed")[0]:null},AppletReady:function(){var t=MANAGER.GetCentralTracker(),e=t?t.GetBackend():null;if(e){var i=e.my_.GetAiccRelay();try{i.AiccInit(e.api_.url,e.api_.sid)}catch(s){}e.init_()}},FlashAbort:function(){this.flash_abort_=!0,this.flash_timeout_=null;try{this.flash_wnd_.AiccAbort()}catch(t){}this.flash_wnd_=null,window.AiccReady=function(){},window.AiccError=function(){},window.AiccComplete=function(){},TRACKING.debug.Track({source:"BE_aicc.FlashAbort",tracking:"disabled"}),this.init_()},FlashReady:function(){var t=MANAGER.GetCentralTracker(),e=t?t.GetBackend():null;e&&!e.flash_abort_&&(WCT.ClearTimeout(e.flash_timeout_),e.flash_timeout_=null,TRACKING.debug.Track({source:"BE_aicc.FlashReady",url:e.api_.url,sid:e.api_.sid}),e.init_())},FlashComplete:function(t){var e=MANAGER.GetCentralTracker(),i=e?e.GetBackend():null;i&&i.flash_complete_(t)},FlashError:function(t){var e=MANAGER.GetCentralTracker(),i=e?e.GetBackend():null;i&&(i.flash_wnd_=null,TRACKING.debug.Track({source:"BE_aicc.FlashError",sid:i.api_.sid,error:t}),i.flash_complete_(""))}}),WCT.ExtendObject(TRACKING.backend.aicc.prototype,function(){function o(t){for(var e={};t.length;){var i=t[0];if(null!=(m=i.match(/\[(.*)\]/)))return e;t.shift(),(i=i.split("="))[0]=(i[0]||"").toLowerCase().trim(),i[0]&&(e[i[0]]=(i[1]||"").trim())}return e}function r(t){for(var e="";t.length;){var i=t[0];if(null!=(m=i.match(/\[(.*)\]/)))return e;t.shift(),e+=i}return e}function c(t){t=t.replace(/<pre>|<\/pre>/gi,"").replace(/\r/g,"").split("\n");for(var e={status:1,core:1,student_data:1},i={};t.length;){var s=null;if(null!=(s=t[0].match(/\[(.*)\]/))){var n=s[1].toLowerCase();t.shift(),i[n]=e[n]?o(t):r(t)}else i.status||(i.status=o(t))}return i}function _(t){var e=t.core,i=e.lesson_status;if("no-credit"==e.credit){var s=i.split(",")[1]||"";i=TRACKING.backend.aicc.STATUS.b+","+s}return["[Core]","lesson_location = 1","lesson_status = "+(i=i.replace(/,$/,"")),"score = "+e.score||"","time = "+e.time,"[Core_Lesson]",e.lesson_location].join("\r\n")}function n(t){var e=this.config_;if("java"==e.aicc_crossdomain){if("putparam"!=t||callback!=undefined)return function a(t){var e,i="putparam"==t?_(this.data_):"",s=this.my_.GetAiccRelay(),n=!0;try{e=s.AiccRequest(t,i)}catch(r){e="",n=!1}var o=c(e);return TRACKING.debug.Track({source:"BE_aicc.send_applet_",sid:this.api_.sid,applet_ok:n,command:t,data:i,resp:e}),o}.call(this,t)}else{if("flash"!=e.aicc_crossdomain)return function l(t){var e="",i=!1;"putparam"==t&&(e=_(this.data_),i=!1!==arguments[1]);var s=this.api_,n=["session_id="+s.sid,"version=4.0","command="+t,"aicc_data="+e].join("&");XHR.SetRequestHeaders({"Content-Type":"application/x-www-form-urlencoded"});var o=XHR[i?"PostA":"PostS"](s.url,n,"raw"),r=o?c(o):null;return TRACKING.debug.Track({source:"BE_aicc.send_",sid:s.sid,async:i,command:t,data:e,resp:o}),r}.call(this,t,arguments[2]);if(this.flash_abort_)return{};"function"==typeof arguments[1]&&(this.flash_callback_=arguments[1],function s(t){var e="putparam"==t?_(this.data_):"";TRACKING.debug.Track({source:"BE_aicc.send_flash_",sid:this.api_.sid,command:t,data:e});try{return void this.flash_wnd_.AiccRequest(t,e)}catch(i){}TRACKING.debug.Track({source:"BE_aicc.send_flash_",ok:!1})}.call(this,t))}return null}function s(){var t=this.sco_,e=this.config_;if(0!=t.scored_objects&&!e.aicc_browse_mode){var i=e.aicc_score_precision,s=TRACKING.backend.scorm,n=s.FormatScore(t.cur,t.max,!1,i,!0),o=s.FormatScore(t.max,t.max,!1,i,!0),r=this.data_.core;"number"==typeof n&&0<=n?(r.score=n,r.score+="number"==typeof o&&0<=o?","+o+",0":",0,0"):r.score=""}}function a(){if(!this.config_.aicc_browse_mode){var t=this.sco_,e=function a(t,e){var i=TRACKING.SCORM;switch(this.config_.aicc_decide_passed){case i.PASSED_NEVER:t=null;break;case i.PASSED_ONSCORED:e&&(t=t||!1)}return t}.call(this,t.passed,0<t.scored_objects),i=t.completed;if(null!=i||null!=e){var s=this.my_.STATUS,n=this.data_.core;n.lesson_status=!0===e?s.p:!1===e?s.f:!0===i?s.c:!1===i?s.i:s.b}var o=0;if("number"==typeof t.start_time){var r="number"==typeof t.end_time?t.end_time:(new Date).getTime();o=TRACKING.connector.scorm12.prototype.format_duration_(r-t.start_time)}return o}}return{Destructor:function(){WCT.ClearTimeout(this.flash_timeout_),this.flash_timeout_=null;var t=$("AiccRelay#container");t&&t.parentNode.removeChild(t);var e=$("AiccRelay");e&&e.parentNode.removeChild(e),window.DgoAiccAppletReady=null,window.AiccReady=null,window.AiccError=null,window.AiccComplete=null,this.bm_api_&&(this.bm_api_.handler_=null,this.bm_api_=null),this.bookmark_.Destructor(),this.bookmark_=null,WCT.CleanupObject(this.data_),this.data_=null,this.flash_callback_=null,this.flash_wnd_=null,TRACKING.backend.prototype.Destructor.call(this)},Init:function(t,e,i,s,n){TRACKING.backend.prototype.Init.apply(this,arguments),"java"==i.aicc_crossdomain?function o(){if($("AiccRelay"))this.my_.AppletReady();else{window.DgoAiccAppletReady=this.my_.AppletReady;var t=$$("div");t.id="AiccRelay#container",t.innerHTML=["<object",' id="AiccRelay"',' code="AiccRelay.class"',' archive="AiccRelay.jar"',' width="1"',' height="1"',">",'<param name="code" value="AiccRelay.class" />','<param name="archive" value="AiccRelay.jar" />',"<embed",' name="AiccRelay"',' code="AiccRelay.class"',' archive="AiccRelay.jar"',' pluginspage="http://java.com/download"',' type="application/x-java-applet"',' width="1"',' height="1"',"/>","</object>"].join(""),BROWSER.IE?t.style.display="none":t.style.visibility="hidden",document.body.appendChild(t)}}.call(this):"flash"==i.aicc_crossdomain?function l(){var t=this.config_.debug_mode,e="yes",i="0",s="0";t||(e="no",i=screen.availWidth+500,s=screen.availHeight+500);var n=this.api_;n="url="+escape(n.url)+"&sid="+escape(n.sid)+"&debug="+(t?1:0);var o=this.my_;window.AiccReady=o.FlashReady,window.AiccError=o.FlashError,window.AiccComplete=o.FlashComplete;var r=["top="+s,"left="+i,"width=10","height=10","menubar=no","toolbar=no","location=no","resizable="+e,"scrollbars="+e,"status=no"].join(",");try{this.flash_wnd_=window.open(DATA.context.ToAbsPath("trainer:aicc.html")+"?"+n,"aicc_comm",r,!1)}catch(a){this.flash_wnd_=null}this.flash_timeout_=WCT.SetTimeout(o.FlashAbort,o.FLASH_TIMEOUT,this)}.call(this):this.init_()},Fini:function(){var t=this.data_,e=this.sco_,i=this.config_;i.aicc_browse_mode||(t.core.time=a.call(this),t.core.lesson_status+=","+this.my_.EXIT[e.completed?"":"s"]),"flash"==i.aicc_crossdomain?function s(){var t=_(this.data_);try{return void this.flash_wnd_.AiccFini(t)}catch(e){}TRACKING.debug.Track({source:"BE_aicc.flash_fini_",sid:this.api_.sid,ok:!1})}.call(this):(i.aicc_browse_mode||n.call(this,"putparam",null,!1),n.call(this,"exitau"),TRACKING.debug.Track({source:"BE_aicc.fini",completed:e.completed,passed:e.passed,time:t.core&&t.core.time||""}))},StoreLessonObjective:function(t){this.config_.aicc_browse_mode||this.bookmark_.Set(this.sco_,this.objectives_),s.call(this),a.call(this),n.call(this,"putparam")},Track:function(t,e){var i=this.config_;switch(t){case"pageset_open":case"pageset_progress":case"lesson_start":case"lesson_progress":i.aicc_browse_mode||this.bookmark_.Set(this.sco_,this.objectives_);break;case"pageset_close":a.call(this);break;case"lesson_commit":i.aicc_browse_mode||this.bookmark_.Set(this.sco_,this.objectives_),s.call(this);break;case"lesson_end":return void this.StoreLessonObjective(e);default:return}n.call(this,"putparam")},init_:function(){var t=n.call(this,"getparam",this.init2_);null!=t&&this.init2_(t)},init2_:function(t){t.core||(t.core={}),this.data_=t;var e=this.my_,i=this.config_,s=t.core,n=t.core_lesson||"",o=(s.lesson_mode||"").toLowerCase().trim().charAt(0),r=(s.lesson_status||"").toLowerCase().split(","),a=(r[0]||"").trim().charAt(0),l=(r[1]||"").trim().charAt(0);i.aicc_browse_mode="browse"==e.MODE[o],i.aicc_entry=e.ENTRY[l],s.lesson_status=e.STATUS[a],this.bm_api_.Location="",i.aicc_ignore_bookmark||(this.bm_api_.Location=n||s.lesson_location||"",this.bookmark_.Get(this.sco_,this.objectives_)),s.lesson_location=this.bm_api_.Location,TRACKING.debug.Track({source:"BE_aicc.Init",entry:i.aicc_entry,browse_mode:i.aicc_browse_mode}),this.init_done_()},flash_complete_:function(t){if(TRACKING.debug.Track({source:"BE_aicc.flash_complete_",sid:this.api_.sid,resp:t}),this.flash_callback_){var e=c(t);this.flash_callback_.call(this,e),this.flash_callback_=null}}}}()),TRACKING.backend.cookie=function(){TRACKING.backend.call(this),this.my_=TRACKING.backend.cookie,this.name_="TRACKING.backend.cookie";var t={CKEY:WCT.store.KEYS.backend_cookie,MAX_LEN:2e3,Cleanup:function(t){var e=this.CKEY+t.uid;t.mode&&(e+=t.mode.charAt(0));for(var i=0,s=WCT.store.Get(e+i);null!=s;)WCT.cookie.Remove(e+i),s=WCT.store.Get(e+ ++i);WCT.cookie.Remove(e)},GetLocation:function(t){var e=this.CKEY+t.uid;t.mode&&(e+=t.mode.charAt(0));var i=WCT.store.Get(e);if(null==i)for(var s=0,n=WCT.store.Get(e+s);null!=n;)null==i?i=n:i+=n,n=WCT.store.Get(e+ ++s);return Log("Loaded Cookie ("+e+"): "+i),i},SetLocation:function(t,e){var i=e.length,s=this.MAX_LEN,n=this.CKEY+t.uid;if(t.mode&&(n+=t.mode.charAt(0)),this.Cleanup(t),i<s)WCT.store.Set(n,e);else for(var o=Math.ceil(i/s),r=0;r<o;r++){var a=e.substring(r*s,(r+1)*s);WCT.store.Set(n+r,a)}Log("Saved Cookie ("+n+"): "+e)}};this.bookmark_=new TRACKING.bookmark(t,TRACKING.bookmark.MAX_VERSION)},TRACKING.backend.cookie.prototype=new TRACKING.backend,WCT.ExtendObject(TRACKING.backend.cookie.prototype,function(){function i(t){if(this.config_.objectives_standalone)(function n(t){var e={uid:t.uid};t.mode&&(e.mode=t.mode),this.bookmark_.Set(e,[t])}).call(this,t);else{var e=this.sco_,i=this.bookmark_.Set(e,this.objectives_),s=WCT.store.KEYS.backend_cookie+e.uid;e.mode&&(s+=e.mode.charAt(0)),TRACKING.debug.Track({source:"BE_cookie.set",name:s,len:i.length,content:i})}}return{Destructor:function(){this.bookmark_.Destructor(),this.bookmark_=null,TRACKING.backend.prototype.Destructor.call(this)},Init:function(t,e,i,s,n){TRACKING.backend.prototype.Init.apply(this,arguments),i.objectives_standalone&&this.bookmark_.ObjectivesStandalone(!0);var o=this.bookmark_.Get(t,e),r=WCT.store.KEYS.backend_cookie+t.uid;t.mode&&(r+=t.mode.charAt(0)),TRACKING.debug.Track({source:"BE_cookie.get",name:r,len:o.length,cookie:o}),this.init_done_()},InitObjective:function(t){if(this.config_.objectives_standalone){var e={uid:t.uid};t.mode&&(e.mode=t.mode),this.bookmark_.Get(e,[t])}},StoreLessonObjective:function(t){i.call(this,t)},Track:function(t,e){switch(t){case"pageset_open":case"pageset_progress":case"pageset_close":case"lesson_start":case"lesson_progress":case"lesson_commit":case"lesson_end":i.call(this,e)}}}}()),TRACKING.debug={KEY_WIDTH:240,VALUE_WIDTH:320,STATUS_HEIGHT:340,LOG_HEIGHT:340,wnd_:null,enabled_:!1,ready_:!1,backend_:{name:null,type:null},source_list_:{}},function(){function r(){var t=TRACKING.debug,e=t.wnd_,i=e&&e.document||null;if(i&&i.body){i.title="TRACKING debug window";var s=i.getElementsByTagName("head")[0];if(s){for(var n=s.getElementsByTagName("style"),o=n.length-1;0<=o;o--)s.removeChild(n[o]);var r=['@CHARSET "UTF-8";',"*{padding:0px;margin:0px}","body {font-family:Tahoma;font-size:8pt;width:100%;height:100%;overflow:hidden}","#top {margin:10px;font-size:10pt;font-weight:bold}","#print {padding-left:10px;font-size:8pt;font-weight:normal}","#warning {text-align:center;margin:5px;padding:5px;font-size:9pt;font-weight:bold;color:#FF0000;border:1px solid #FF0000}","#status {border:1px solid black;overflow-x:hidden;overflow-y:scroll;margin:5px}","#log {border:1px solid black;overflow:hidden;margin:5px}","#sources {height:25px;background-color:#FFCCCC;border-bottom:1px solid #999999;overflow:auto;clear:both;line-height:25px;padding:0 5px}","#logs {overflow-x:hidden;overflow-y:scroll;padding:5px}",".source {margin-right:3px;align:baseline}",".hidden {display:none}",".log_entry {clear:both;overflow:hidden}",".log_cap {float:left;font-weight:bold;overflow:hidden;text-overflow:ellipsis}",".log_msg {float:left}",".entry_spacer {clear:both;height:10px;visibility:hidden}",".status_th {font-size:8pt;font-family:Tahoma;padding:2px 5px;text-align:left}",".status_td {vertical-align:top;font-size:8pt;font-family:Tahoma;padding:2px 5px;text-align:left}",".status_sco_row {background-color:#FFCCCC}","@media print {","body {overflow:auto !important}","#status {height:auto !important;overflow:auto !important}","#log {height:auto !important;overflow:auto !important}","#sources {display:none !important}","#logs {height:auto !important;overflow:auto !important}",".hidden {display:block !important}","}"].join(""),a=i.createElement("style");a.setAttribute("type","text/css");try{a.innerHTML=r}catch(_){a.styleSheet.cssText=r}s.appendChild(a)}var l=t.backend_,c=!l.name&&!l.type;i.body.innerHTML=['<div id="top">TRACKING DEBUG</div>',c?'<div id="warning">ATTENTION: NO BACKEND - NO CALCULATION IS DONE!</div>':"",'<div id="status"></div>','<div id="log">','<div id="sources"></div>','<div id="logs"></div>',"</div>"].join(""),e.on_checkbox_=function(t){var e=TRACKING.debug.wnd_;if(t=t||(e&&e.event||null)){var i=t.target?t.target:t.srcElement;i&&3==i.nodeType&&(i=i.parentNode);var s=i&&i.nextSibling&&i.nextSibling.nodeValue||null;null!=s&&!function l(t){var e=TRACKING.debug,i=!e.source_list_[t];e.source_list_[t]=i;var s=p();if(!s)return;var n=s.document.getElementById("logs");if(!n)return;for(var o=n.childNodes,r=0,a=null;a=o[r];r++){a.getAttribute("dgo_src")==t&&(i?a.className=a.className.replace(/hidden/g,""):a.className+=" hidden")}}(s)}},e.onresize=function(){var t=TRACKING.debug,e=t.wnd_,i=e&&e.document||null;if(i){var s=(WCT.dom.GetWindowWidth(e)||i.body.offsetWidth)-15,n=(WCT.dom.GetWindowHeight(e)||i.body.offsetHeight)-50,o=t.STATUS_HEIGHT,r=t.LOG_HEIGHT,a=o+r,l=t.backend_;l.name||l.type||(n-=35);var c=n/a;if(o=Math.floor(c*o),r=Math.floor(c*r),!(s<0||o<0||r<0)){var _=i.getElementById("status");_&&(_.style.width=s+"px",_.style.height=o+"px");var d=i.getElementById("log");d&&(d.style.width=s+"px",d.style.height=r+"px",(d=i.getElementById("logs"))&&35<=r&&(d.style.height=r-35+"px"))}}},e.onresize(),t.ready_=!0}}function p(){var t=TRACKING.debug;try{t.wnd_&&t.wnd_.document&&t.wnd_.document.body||(t.wnd_=null)}catch(e){t.wnd_=null}return t.wnd_}function l(t,e,i){var s=p();if(s){var n=TRACKING.debug,o=s.document,r=o.getElementById("logs");if(r){var a=o.createTextNode(e+": "),l=o.createTextNode(i),c=o.createElement("span"),_=o.createElement("span"),d=o.createElement("div"),u=n.source_list_[t]?"":" hidden";c.className="log_cap",_.className="log_msg",d.className="log_entry"+u,c.style.width=n.KEY_WIDTH+"px",d.setAttribute("dgo_src",t),"source"==e&&(c.style.color="#FF0000",_.style.color="#FF0000"),c.appendChild(a),_.appendChild(l),d.appendChild(c),d.appendChild(_),r.appendChild(d)}}}TRACKING.debug.Cleanup=function(){for(var t=this.wnd_&&this.wnd_.document,e=t&&t.getElementById("sources")||null,i=e&&e.getElementsByTagName("input")||[],s=0,n=null;n=i[s];s++)n.onclick=null,n.setAttribute("disabled","disabled");this.wnd_=null,this.enabled_=!1,this.ready_=!1,this.backend_={name:null,type:null},this.source_list_={}},TRACKING.debug.Init=function(t,e,i){this.enabled_=t,this.backend_.name=e||null,this.backend_.type=i||null,t&&function o(){var t=TRACKING.debug;t.source_list_={};try{var e=t.KEY_WIDTH+t.VALUE_WIDTH+60,i=t.STATUS_HEIGHT+t.LOG_HEIGHT+120,s=window.open("","TRACKING_debug_window","width="+e+",height="+i+",left=0,top=0,resizable=yes,scrollbars=yes",!1);t.wnd_=s}catch(n){return void(t.wnd_=null)}WCT.SetTimeout(r,100)}.call(this)},TRACKING.debug.Track=function(t){if(this.enabled_&&this.ready_){var e="general";for(var i in t.source&&(e=0<=t.source.indexOf(".")?t.source.split(".")[0]:t.source),null==this.source_list_[e]&&function c(t){var e=p();if(e){var i=e.document.getElementById("sources");if(i){for(var s=i.getElementsByTagName("input"),n=0,o=null;o=s[n];n++)o.onclick=null;var r=this.source_list_;r[t]=!0;var a=[];for(var l in r)a.push(['<div style="float:left;margin-right:10px">','<input class="source" type="checkbox" onclick="on_checkbox_(event)" checked="checked" />',l,"</div>"].join(""));i.innerHTML=a.join("")}}}.call(this,e),l(e,"source",t.source),t)if("source"!=i){var s=t[i],n=typeof s;"string"!=n&&"boolean"!=n&&"number"!=n&&null!=s||l(e,i,s)}var o=arguments[1]||null;if(o)switch(t.id){case"pageset_open":case"pageset_close":l(e,"book_uid",o.uid);break;case"pageset_progress":l(e,"completed",o.completed);break;case"lesson_progress":null!=o.cumulated_steps&&l(e,"cumulated_steps",o.cumulated_steps);break;case"lesson_end":l(e,"completed",o.completed),l(e,"passed",o.passed);case"lesson_start":l(e,"lesson_uid",o.uid+":"+o.mode)}!function a(t){var e=p();if(e){var i=e.document,s=i.getElementById("logs");if(s){var n=TRACKING.debug.source_list_[t]?"":" hidden",o=i.createElement("div"),r=i.createTextNode("########################");o.className="entry_spacer"+n,o.setAttribute("dgo_src",t),o.appendChild(r),s.appendChild(o)}}}(e)}},TRACKING.debug.Status=function(t,e){this.enabled_&&this.ready_&&function h(t,e){var i=p();if(i){var s=i.document.getElementById("status");if(s){for(var n=TRACKING&&TRACKING.central&&TRACKING.central.agents?TRACKING.central.agents():"-",o=['<tbody><tr class="status_sco_row">','<td class="status_td">SCO<br /><span style="font-size:6pt">',t.uid,"project"==t.tclass?"<br />"+t.mode:"","</span></td>",'<td class="status_td">',"cur: ","number"==typeof t.cur?t.cur:"-","<br />max: ","number"==typeof t.max?t.max:"-","<br />pass: ","number"==typeof t.min?t.min:"-","</td>",'<td class="status_td">',"completed: ",t.completed||!1,"<br />passed: ","boolean"==typeof t.passed?t.passed:"-","<br />progress: ",Math.round(100*(t.progress||0))/100,"</td>",'<td class="status_td">',"bookmark: ",null!=t.bookmark?t.bookmark:"-","<br />currently scored: ",t.scored_objects||0,"<br />registered agents: ",n,"</td>","</tr>"],r=0,a=null,l=!0;a=e[r];r++,l=!l){var c=0;if("book"==a.tclass)for(var _ in a.pages)a.pages[_]&&c++;o.push(['<tr style="background-color:#',l?"EFEFEF":"FFFFFF",'">','<td class="status_td">',a.central_id,a.central_short_id?'<br /><span style="font-size:7pt">('+a.central_short_id+")</span>":"","</td>",'<td class="status_td">',"cur: ","number"==typeof a.cur?a.cur:"-","<br />cum: ","number"==typeof a.cum?a.cum:"-","<br />max: ","number"==typeof a.max?a.max:"-","<br />pass: ","number"==typeof a.min?a.min:"-","</td>",'<td class="status_td">',"completed: ",a.completed||!1,"<br />passed: ","boolean"==typeof a.passed?a.passed:"-","<br />progress: ","number"==typeof a.progress?Math.round(100*a.progress)/100:"-","</td>",'<td class="status_td">',"active: ",a.active||!1,"<br />restarted: ","boolean"==typeof a.restarted?a.restarted:"-","<br />bookmark: ",null!=a.bookmark&&""!=a.bookmark?a.bookmark:"-","<br />visited: ","book"==a.tclass?c+" / "+a.total_pages:null!=a.total_steps&&null!=a.cumulated_steps?a.cumulated_steps+" / "+a.total_steps:"-","<br />scorable: ",null!=a.is_scorable?a.is_scorable:"-","<br />track_completion: ","boolean"==typeof a.track_completion?a.track_completion:"-","<br />track_score: ","boolean"==typeof a.track_score?a.track_score:"-","<br />comp_as_score: ","boolean"==typeof a.track_completion_as_score?a.track_completion_as_score:"-","<br />ignore_failed: ","boolean"==typeof a.track_incomplete_instead_failed?a.track_incomplete_instead_failed:"-","</td>","</tr>"].join(""))}o.push("</tbody>");var d=function u(){return['<table width="100%" cellpadding="0" cellspacing="0"><thead><tr style="background-color:#999999">','<th class="status_th">ID</th>','<th class="status_th">SCORE</th>','<th class="status_th">STATUS</th>','<th class="status_th">MISC</th>',"</tr></thead>TBODY</table>"].join("")}();s.innerHTML=d.replace(/TBODY/,o.join(""))}}}.apply(this,arguments)}}();var SKIN={controls_:{},bars_:{},timeline_:{},Cleanup:function(){for(var t in SKIN.controls_)SKIN.control.Cleanup(t);for(var t in SKIN.bars_)SKIN.bar.Cleanup(t);for(var t in SKIN.timeline_)SKIN.timeline.Cleanup(t)}};function Topmost(t){if(!arguments.length)return null;(Topmost.SCOPE=this).cfg_={},this.popup_=window.createPopup(),this.interval_=null,this.title_="",this.controls_=[],this.skins_=[],this.debug_win_in_=!1,this.ev_x_=null,this.ev_y_=null,this.ev_w_=null,this.ev_h_=null,this.ev_id_=null,this.ev_fill_=!1,this.win_left_=0,this.win_top_=0,this.mini_=!1,this.mini_w_=null,this.mini_h_=null,this.skin_min_h_=Topmost.MINI_H;for(var e=DATA.CFG_TOPMOST,i=this.cfg_,s=e.length-1;0<=s;s--){var n=e[s].substr(8);n&&(i[n]=t[e[s]])}this.get_pos_(),i.skin=t.skin,i.width=Math.max(Topmost.event.MIN_W,i.width),i.height=Math.max(Topmost.event.MIN_H,i.height);var o=WCT.DeepCopy(DATA.GetS(DATA.SKIN_PREFIX+i.skin+":popup.txt")),r=new WCT.context(DATA.context).ToAbsPath(DATA.SKIN_PREFIX+i.skin)+"/";WCT.skin.ExtendUrls(o,r),this.skin_=o}SKIN.control={Cleanup:function(t){var e=SKIN.controls_[t];if(e){var i=e.dom;if(i){try{i.onkeydown=null,i.onclick=null,i.onmouseover=null,i.onmouseout=null,i.onmousedown=null,i.onmouseup=null,i.onmousemove=null,i.ontouchstart=null,i.ontouchend=null,i.onselectstart=null,i.ondragstart=null}catch(s){}i.parentNode&&i.parentNode.removeChild(i)}delete e.id,delete e.doc,delete e.onexec,delete e.scope,delete e.skin,delete e.dom,delete e.enabled,delete e.visible,delete e.active,delete e.img_id,delete e.title,delete e.text1,delete e.text2,e.mouseover&&(e.mouseover.cb=null,e.mouseover.scope=null,delete e.mouseover),e.mouseout&&(e.mouseout.cb=null,e.mouseout.scope=null,delete e.mouseout),e.mousedown&&(e.mousedown.cb=null,e.mousedown.scope=null,delete e.mousedown),e.mouseup&&(e.mouseup.cb=null,e.mouseup.scope=null,delete e.mouseup),e.touchstart&&(e.touchstart.cb=null,e.touchstart.scope=null,delete e.touchstart),e.touchend&&(e.touchend.cb=null,e.touchend.scope=null,delete e.touchend),delete SKIN.controls_[t]}},Add:function(t){var e=t.id,i=t.skin,s=t.dom;if(!(e&&i&&i.image&&s))return null;var n=(t.doc||document).createElement(t.tag||"div"),o=i.x||0;return t.rtl&&(o=WCT.skin.ConvertXToRtl(o)),n.id=e,n.style.cursor="pointer",n.style.border="0",n.style.backgroundColor="transparent",n.tabIndex=t.tabindex||0,n.setAttribute("role",t.role||"button"),"button"===t.tag&&(n.style.overflow="visible",n.setAttribute("type","button")),WCT.skin.ApplyPosition(n,{x:o,y:i.y||0,w:i.w||0,h:i.h||0}),i.image&&WCT.skin.ApplyBgImage(n,i.image),s.appendChild(n),n.onkeydown=SKIN.control._onKeyControl,n.ondblclick=SKIN.control.on_mouse_control_,n.onclick=SKIN.control.on_mouse_control_,n.onmouseover=SKIN.control.on_mouse_control_,n.onmouseout=SKIN.control.on_mouse_control_,n.onmousedown=SKIN.control.on_mouse_control_,n.onmouseup=SKIN.control.on_mouse_control_,n.ontouchstart=SKIN.control.on_touch_control_,n.ontouchend=SKIN.control.on_touch_control_,n.onselectstart=function(){return!1},n.ondragstart=function(){return!1},SKIN.controls_[e]={id:e,onexec:t.onexec||null,scope:t.scope||null,skin:i,dom:n,enabled:!0,visible:!0,active:!1,img_id:"image",title:null,rtl:t.rtl},t.title&&this.SetTitle(e,t.title),null!=t.visible&&this.Visible(e,t.visible),null!=t.enabled&&this.Enabled(e,t.enabled),null!=t.active&&this.Active(e,t.active),n},RegisterCallback:function(t,e,i,s){var n=SKIN.controls_[t];if(!n)return!1;switch(e){case"click":n.onexec=i,n.scope=s;break;case"mouseover":case"mouseout":case"mousedown":case"mouseup":case"touchstart":case"touchend":case"keydown":n[e]={cb:i,scope:s}}},IgnoreEvent:function(t,e){var i=SKIN.controls_[t];if(!i||!i.dom)return!1;i["on"+e]=null},Enabled:function(t){var e=SKIN.controls_[t];if(!e)return null;var i=arguments[1];return"boolean"==typeof i&&e.enabled!=i&&(e.enabled=i,e.dom.style.cursor=i?"pointer":"default",!i&&e.skin.image_d?WCT.skin.ApplyBgImage(e.dom,e.skin.image_d):i&&WCT.skin.ApplyBgImage(e.dom,e.skin.image)),e.enabled},Visible:function(t){var e=SKIN.controls_[t];if(!e)return null;var i=arguments[1];if("boolean"==typeof i&&e.visible!=i){var s=arguments[2]||"display";e.visible=i,"display"==s?e.dom.style.display=i?"block":"none":"visibility"==s&&(e.dom.style.visibility=i?"visible":"hidden")}return e.visible},Active:function(t){var e=SKIN.controls_[t];if(!e)return null;var i=arguments[1],s=arguments[2]||!1;return"boolean"!=typeof i||e.active==i&&!s||(e.active=i,e.dom.style.cursor=i?"default":"pointer",i&&e.skin.image_a?WCT.skin.ApplyBgImage(e.dom,e.skin.image_a):i||WCT.skin.ApplyBgImage(e.dom,e.skin.image)),e.active},ModifyImageId:function(t,e){var i=SKIN.controls_[t];i&&i.skin[e]&&i.img_id!=e&&(i.img_id=e,WCT.skin.ApplyBgImage(i.dom,i.skin[e]))},MoveTo:function(t,e,i){var s=SKIN.controls_[t];if(s){var n={x:e=s.rtl?WCT.skin.ConvertXToRtl(e):e,y:i};WCT.skin.ApplyPosition(s.dom,n)}},SetTitle:function(t,e){var i=SKIN.controls_[t];i&&i.title!=e&&(i.title=e,i.dom.setAttribute("title",e),i.dom.setAttribute("aria-label",e))},GetDom:function(t){var e=SKIN.controls_[t];return e?e.dom:null},get_event_:function(t){return t||(window.event?t=window.event:Topmost.Enabled()&&(t=Topmost.SCOPE.GetEvent())),t&&(t=WCT.event.Standardize(t)).target&&t.target.id?"dblclick"==t.type?null:t:null},prepareControlAction:function(t){if(!(t=SKIN.control.get_event_(t)))return!1;var e=t.target;if(!e||!e.id)return!1;var i=SKIN.controls_[e.id];return!!i&&{obj:i,tar:e,evt:t}},_onKeyControl:function(t){var e=SKIN.control.prepareControlAction(t);if(!e)return!0;var i=e.obj[e.evt.type];return i&&i.cb.call(i.scope,e.tar.id,e.evt),!0},on_mouse_control_:function(t){if(t.isTrusted){var e=SKIN.control.prepareControlAction(t);if(!e)return!0;var i=e.obj,s=e.tar;if(t=e.evt,i.visible&&i.enabled&&!i.active){if("click"==t.type)BROWSER.MOBILE||WCT.skin.ApplyBgImage(s,i.skin[i.img_id]),i.onexec&&i.onexec.call(i.scope,s.id,t);else{if(!BROWSER.MOBILE){var n={mouseover:"_h",mouseout:"",mousedown:"_a",mouseup:"_h"}[t.type],o=i.skin[i.img_id+n]||i.skin[i.img_id]||{id:""};WCT.skin.ApplyBgImage(s,o)}var r=i[t.type];r&&r.cb.call(r.scope,s.id,t)}return!(t.cancelBubble=!0)}return!0}},on_touch_control_:function(t){if(1!=t.changedTouches.length||"touchstart"==t.type&&1<t.touches.length)return!0;var e=t.target;if(!e||!e.id)return!0;var i=e.id.substring(0,e.id.lastIndexOf("#")),s=SKIN.controls_[e.id]||SKIN.controls_[i];if(!s)return!0;if(s.visible&&s.enabled&&!s.active){var n=s[t.type];n&&n.cb.call(n.scope,e.id,t,0)}return!0}},function(){function C(t,e,i,s,n,o){var r=0,a=e.bg[o];"m"==o?(r=e.bg.l&&e.bg.l.w||0,(a=WCT.DeepCopy(a)).id||(a.id=e.src||""),a.repeat="x"):("r"==o&&(r="-0"),a.id||((a=WCT.DeepCopy(a)).id=e.src||""));var l=s.createElement("div"),c=e.bg[o].w||0;return WCT.skin.ApplyPosition(l,{x:r,y:0,w:c,h:n}),WCT.skin.ApplyBgImage(l,a),l.id=t+"#"+o,i.appendChild(l),c}function r(t,e,i){if("t"!=e){var s="pos_"+e,n=0<=t[s]?t.dom.childNodes[t[s]]:null;if(n){var o;if("m"==e){if(!(o=t.skin["bg"+i]&&t.skin["bg"+i].m))return;(o=WCT.DeepCopy(o)).id||(o.id=t.skin.src||""),o.repeat="x"}else{if(!(o="i"==e?t.skin["image"+i]:t.skin["bg"+i]&&t.skin["bg"+i][e]))return;o.id||((o=WCT.DeepCopy(o)).id=t.skin.src||"")}WCT.skin.ApplyBgImage(n,o)}}else{var r=t.skin["text_color"+i]||t.skin.text_color||"#000000",a=$(t.id+"#t",t.doc);a&&(a.style.color=r)}}SKIN.textcontrol={Cleanup:SKIN.control.Cleanup,RegisterCallback:SKIN.control.RegisterCallback,IgnoreEvent:SKIN.control.IgnoreEvent,GetDom:SKIN.control.GetDom,Add:function(t){var e=t.id,i=t.skin,s=t.dom;if(!e||!i||!s)return null;var n=t.doc||document,o=t.rtl||!1,r=i.h||0,a=0,l=0,c=0,_=n.createElement("div");_.id=e,_.style.cursor="pointer",-1<t.tabindex&&(_.setAttribute("role","button"),_.tabIndex=t.tabindex);var d=0,u=-1,h=-1,p=-1;i.bg&&(i.bg.l&&(l+=a=C(e,i,_,n,r,"l"),u=d++),i.bg.m&&(C(e,i,_,n,r,"m"),h=d++),i.bg.r&&(l+=C(e,i,_,n,r,"r"),p=d++));var f=-1;i.image&&(c+=function y(t,e,i,s,n,o){var r=e.image;r.id||((r=WCT.DeepCopy(r)).id=e.src||"");var a=e.img_h||r.h||0,l=e.img_w||r.w||0,c=Math.max(0,n-a>>1),_=c;r.l&&(_=r.l),r.t&&(c=r.t),o&&(_=WCT.skin.ConvertXToRtl(_));var d=s.createElement("div");return WCT.skin.ApplyPosition(d,{x:_,y:c,w:l,h:a}),WCT.skin.ApplyBgImage(d,r),d.id=t+"#i",i.appendChild(d),c+l+(e.img_text_spacing||0)}(e,i,_,n,r,o),f=d++);var m=o?WCT.skin.ConvertXToRtl(i.x):i.x,b=Math.max(l,c);WCT.skin.ApplyPosition(_,{x:m,y:i.y,w:b,h:r}),0<=h&&(_.childNodes[h].style.width=b-l+"px");var v=n.createElement("div"),g=o?WCT.skin.ConvertXToRtl(c):c;return WCT.skin.ApplyPosition(v,{x:g,y:0,h:r}),WCT.skin.ApplyTextFormats(v,i),WCT.dom.NotSelectable(v),v.id=e+"#t",v.style.lineHeight=r+"px",v.style.overflow="hidden",v.style.textOverflow="ellipsis",v.style.whiteSpace="nowrap",i.text_icon_spacing&&(v.style.paddingLeft=i.text_icon_spacing+"px"),_.appendChild(v),s.appendChild(_),_.onkeydown=SKIN.textcontrol._onKeyControl,_.ondblclick=SKIN.textcontrol.on_mouse_control_,_.onclick=SKIN.textcontrol.on_mouse_control_,_.onmouseover=SKIN.textcontrol.on_mouse_control_,_.onmouseout=SKIN.textcontrol.on_mouse_control_,_.onmousedown=SKIN.textcontrol.on_mouse_control_,_.onmouseup=SKIN.textcontrol.on_mouse_control_,_.ontouchstart=SKIN.control.on_touch_control_,_.ontouchend=SKIN.control.on_touch_control_,_.onselectstart=function(){return!1},_.ondragstart=function(){return!1},SKIN.controls_[e]={id:e,doc:n,onexec:t.onexec||null,scope:t.scope||null,skin:i,dom:_,enabled:!0,visible:!0,active:!1,img_id:"bg",ml:a,mw:l,rw:c,pos_l:u,pos_m:h,pos_r:p,pos_i:f},(t.text||t.text_h)&&this.SetText(e,t.text||"",t.text_h||""),_},Enabled:function(t){var e=SKIN.controls_[t];if(!e)return null;var i=arguments[1];if("boolean"==typeof i&&e.enabled!=i){e.enabled=i,e.dom.style.cursor=i?"pointer":"default",e.dom.setAttribute("aria-disabled",!i);var s=i?"":"_d";r(e,"l",s),r(e,"m",s),r(e,"r",s),r(e,"i",s),r(e,"t",s)}return e.enabled},SetText:function(t,e){var i=SKIN.controls_[t];if(i&&i.dom){i.text1=e,i.text2=arguments[2]||null,i.dom.setAttribute("title",e);var s=i.dom.lastChild;s.style.visibility="hidden",WCT.SetNodeText(s,e,i.doc);var n=s.cloneNode(1);n.id=t+"#t#c",n.style.width="auto",n.style.overflow="auto",n.style.visibility="hidden",BROWSER.IE&&BROWSER.VERSION<11&&(i.dom.style.visibility="hidden",i.dom.style.width="auto"),i.dom.appendChild(n),WCT.SetTimeout(SKIN.textcontrol.resize_,10,SKIN.textcontrol,[t])}},resize_:function(t){var e=SKIN.controls_[t];if(e){var i=$(t+"#t#c",e.doc),s=0;i&&(s=i.offsetWidth,i.parentNode.removeChild(i));var n=e.dom.lastChild;!e.rw&&0<e.ml&&(n.style.left=e.ml+"px"),n.style.width=s+1+"px",n.style.visibility="visible",s=s+e.mw+e.rw,e.dom.style.width=s+"px",e.dom.style.visibility="visible",0<=e.pos_m&&(e.dom.childNodes[e.pos_m].style.width=s-e.mw+"px")}},_onKeyControl:function(t){13!==(t=SKIN.control.get_event_(t)).button&&32!==t.button||WCT.event.CreateAndDispatchEvent("MouseEvent","click",t.target.lastChild)},on_mouse_control_:function(t){if(!(t=SKIN.control.get_event_(t)))return!0;var e=t.target;if(!e||!e.id)return!0;var i=e.id.substring(0,e.id.lastIndexOf("#")),s=SKIN.controls_[e.id];if(!(s=s||SKIN.controls_[i]))return!0;if("click"==t.type&&s.text1&&s.text2&&SKIN.textcontrol.SetText(i,s.text2,s.text1),s.visible&&s.enabled&&!s.active){if("click"==t.type)BROWSER.MOBILE||(r(s,"l",""),r(s,"m",""),r(s,"r",""),r(s,"i",""),r(s,"t","")),s.onexec&&s.onexec.call(s.scope,i,t);else{if(!BROWSER.MOBILE){var n={mouseover:"_h",mouseout:"",mousedown:"_a",mouseup:"_h"}[t.type];r(s,"l",n),r(s,"m",n),r(s,"r",n),r(s,"i",n),r(s,"t",n)}var o=s[t.type];o&&o.cb.call(o.scope,i,t)}return!(t.cancelBubble=!0)}return!0}}}(),SKIN.bar={Cleanup:function(t){var e=SKIN.bars_[t];e&&(delete e.dom,delete e.act,delete e.pre,delete e.progress,delete e.preloaded,delete e.ori,delete e.size,delete SKIN.bars_[t])},Add:function(t){var e=t.id,i=t.skin,s=t.dom;if(e&&i&&i.image&&s){s.tabIndex=0,s.style.height="55%",s.setAttribute("role","progressbar"),t.steps&&(s.setAttribute("aria-valuemin","1"),s.setAttribute("aria-valuemax",t.steps));var n,o=t.rtl||!1,r=t.ori||"hor",a="hor"==r?{x:"x",w:"w"}:{x:"y",w:"h"},l=t.doc||document,c=i.x||0,_={x:c,y:i.y||0,w:i.w||0,h:i.bar_h||i.h||0},d=null,u=null,h=null,p=null;if(i.image_l&&"number"==typeof i.image_l.w)(n=WCT.DeepCopy(_))[a.w]=i.image_l[a.w],d=l.createElement("div"),WCT.skin.ApplyPosition(d,n),WCT.skin.ApplyBgImage(d,i.image_l);if(i.image_r&&"number"==typeof i.image_r.w)(n=WCT.DeepCopy(_))[a.x]=n[a.x]+n[a.w]-i.image_r[a.w],n[a.w]=i.image_r[a.w],u=l.createElement("div"),WCT.skin.ApplyPosition(u,n),WCT.skin.ApplyBgImage(u,i.image_r);if(o&&(_.x=WCT.skin.ConvertXToRtl(c)),i.image_p)(n=WCT.DeepCopy(_))[a.w]=0,"hor"!=r&&(n[a.x]="-0"),(p=l.createElement("div")).id=e+"#p",WCT.skin.ApplyPosition(p,n),WCT.skin.ApplyBgImage(p,i.image_p);if(i.image_a)(n=WCT.DeepCopy(_))[a.w]=0,"hor"!=r&&(n[a.x]="-0"),(h=l.createElement("div")).id=e+"#a",WCT.skin.ApplyPosition(h,n),WCT.skin.ApplyBgImage(h,i.image_a);var f=l.createElement("div");f.id=e,WCT.skin.ApplyPosition(f,_),WCT.skin.ApplyBgImage(f,i.image),s.appendChild(f),p&&s.appendChild(p),h&&s.appendChild(h),d&&s.appendChild(d),u&&s.appendChild(u),SKIN.bars_[e]={dom:f,act:h,pre:p,progress:0,preloaded:0,ori:r,size:i[a.w]}}},Resize:function(t,e){var i=SKIN.bars_[t];if(!i)return null;if(i.size!=e){var s="hor"==i.ori?"width":"height";i.size=e,i.dom.style[s]=e+"px"}},Progress:function(t){var e=SKIN.bars_[t];if(!e)return null;var i=arguments[1],s=arguments[5];if("number"==typeof i&&(e.progress!=i||s)&&0<=i&&i<=1){if(e.progress=i,e.act){var n=arguments[2]||e.size||0,o="hor"==e.ori?"width":"height";e.act.style[o]=Math.floor(n*i)+"px"}var r=arguments[3],a=arguments[4];if(r&&a){var l=document.getElementById(t.split("#bar")[0]);l.setAttribute("aria-valuetext",r+"/"+a),l.setAttribute("aria-valuenow",r/a*100)}}return e.progress},Preloaded:function(t){var e=SKIN.bars_[t];if(!e)return null;var i=arguments[1];if("number"==typeof i&&e.preloaded!=i&&0<=i&&i<=1&&(e.preloaded=i,e.pre)){var s=arguments[2]||e.size||0,n="hor"==e.ori?"width":"height";e.pre.style[n]=Math.floor(s*i)+"px"}return e.preloaded},Visible:function(t){var e=SKIN.bars_[t];if(!e)return null;var i=arguments[1];return"boolean"==typeof i&&e.visible!=i&&(e.visible=i,e.dom.style.display=i?"block":"none",e.act&&(e.act.style.display=i?"block":"none"),e.pre&&(e.pre.style.display=i?"block":"none")),e.visible}},SKIN.timeline=function(){function r(t,e,i,s){for(var n=1;n<=e;n++)n<i?SKIN.control.ModifyImageId(t+n,"imagep"):n==i?SKIN.control.ModifyImageId(t+n,"image"):n<=s?SKIN.control.ModifyImageId(t+n,"imagel"):SKIN.control.ModifyImageId(t+n,"imagef")}return{Cleanup:function(t){var e=SKIN.timeline_[t];if(e){if(SKIN.bar.Cleanup(t+"#bar"),e.ctls){for(var i=0,s=e.ctls.length;i<s;i++)SKIN.control.Cleanup(e.ctls[i]);delete e.ctls}delete e.dom,delete e.text,delete e.step,delete e.pre,delete e.steps,delete e.skin,delete e.bu_skin,delete e.ori,delete e.doc,delete SKIN.timeline_[t]}},Add:function(t){var e=t.id,i=t.skin,s=t.dom;if(!e||!i||!s)return null;var n=t.steps,o=t.doc||document,r=t.rtl||!1,a=o.createElement("div");a.id=e,WCT.skin.ApplyTextFormats(a,i),a.style.position="absolute",s.appendChild(a);var l={};for(var c in i)"bullet_"==c.substr(0,7)&&(l[c.substr(7)]=i[c]);var _={h:0};for(var c in i)"bar_"==c.substr(0,4)&&(_[c.substr(4)]=i[c]);_.y=(l.h>>1)-(_.h>>1),SKIN.bar.Add({id:e+"#bar",skin:_,dom:a,ori:t.ori,doc:o,rtl:r,steps:n});var d=o.createElement("h1");d.id=e+"#text",WCT.skin.ApplyTextFormats(d,i),d.style.position="absolute",d.style.left="0",d.style.top=_.y+_.h+1+"px",d.style.width="100%",d.style.overflow="hidden",d.style.textOverflow="ellipsis",d.style.whiteSpace="nowrap",r&&(d.style.direction="rtl"),a.appendChild(d);var u=[];if(n)for(var h=e+"#",p=1;p<=n;p++)SKIN.control.Add({id:h+p,skin:l,dom:a,onexec:t.onexec,scope:t.scope,doc:o,rtl:r,tag:"button",tabindex:-1}),u.push(h+p);return SKIN.timeline_[e]={dom:a,text:d||null,step:1,pre:0,steps:n,skin:i,bu_skin:l,ori:t.ori,doc:o,ctls:u,rtl:r},t.visibles&&this.SetVisibles(e,t.visibles),t.jumpables&&this.SetJumpables(e,t.jumpables),t.titles&&this.SetTitles(e,t.titles),a},Resize:function(t,e){var i=SKIN.timeline_[t];if(i){var s="hor"==i.ori,n=s?"width":"height",o=s?i.rtl?"right":"left":"top",r=s?"w":"h";if(i.dom.style[n]=e+"px",SKIN.bar.Resize(t+"#bar",e),this.Step(t,i.step,!0),i.steps){var a=0;i.bu_skin[r]&&(e-=a=i.bu_skin[r]>>1),e+=1;for(var l=t+"#",c=1<i.steps?e/(i.steps-1):e,_=1;_<=i.steps;_++){var d=s?_:i.steps-_+1,u=i.doc.getElementById(l+d);if(u){var h=Math.round((_-1)*c)-a;u.style[o]=h+"px"}}}}},MoveTo:function(t,e,i){var s=SKIN.timeline_[t];if(s){var n={x:e=s.rtl?WCT.skin.ConvertXToRtl(e):e,y:i};WCT.skin.ApplyPosition(s.dom,n)}},Visible:function(t){var e=SKIN.timeline_[t];if(!e)return null;var i=arguments[1];return"boolean"==typeof i&&e.visible!=i&&(e.visible=i,e.dom.style.display=i?"block":"none"),e.visible},Step:function(t){var e=SKIN.timeline_[t];if(e&&e.steps){var i=arguments[1],s=arguments[2];if("number"==typeof i&&0<i&&i<=e.steps&&(e.step!=i||s)){var n=1<e.steps?(i-1)/(e.steps-1):1,o=t+"#";e.step=i,SKIN.bar.Progress(t+"#bar",n,e.size,i,e.steps,s),r(o,e.steps,e.step,e.pre)}return e.step}},Preloaded:function(t){var e=SKIN.timeline_[t];if(e&&e.steps){var i=arguments[1];if("number"==typeof i&&0<i&&i<=e.steps&&e.pre!=i){var s=1<e.steps?(i-1)/(e.steps-1):1,n=t+"#";e.pre=i,SKIN.bar.Preloaded(t+"#bar",s,e.size),r(n,e.steps,e.step,e.pre)}return e.pre}},SetText:function(t,e){var i=SKIN.timeline_[t];i&&i.text&&WCT.SetNodeText(i.text,e,i.doc)},SetTitles:function(t,e){var i=SKIN.timeline_[t];if(i){t+="#";for(var s=1;s<=i.steps;s++)SKIN.control.SetTitle(t+s,e[s-1])}},SetVisibles:function(t,e){var i=SKIN.timeline_[t];if(i){t+="#";for(var s=1;s<=i.steps;s++)SKIN.control.Visible(t+s,e[s-1])}},SetJumpables:function(t,e){var i=SKIN.timeline_[t];if(i){t+="#";for(var s=1;s<=i.steps;s++)SKIN.control.Enabled(t+s,e[s-1])}}}}(),SKIN.popup={GetDim:function(t){var e={l:0,r:0,t:0,b:0,w:0,h:0};return t&&(e.l=[t.w_w||0],t.nw&&t.nw.w&&e.l.push(t.nw.w),t.w&&t.w.w&&e.l.push(t.w.w),t.sw&&t.sw.w&&e.l.push(t.sw.w),e.l=e.l.min(),e.r=[t.e_w||0],t.ne&&t.ne.w&&e.r.push(t.ne.w),t.e&&t.e.w&&e.r.push(t.e.w),t.se&&t.se.w&&e.r.push(t.se.w),e.r=e.r.min(),e.t=[t.n_h||0],t.nw&&t.nw.h&&e.t.push(t.nw.h),t.n&&t.n.h&&e.t.push(t.n.h),t.ne&&t.ne.h&&e.t.push(t.ne.h),e.t=e.t.min(),e.b=[t.s_h||0],t.sw&&t.sw.h&&e.b.push(t.sw.h),t.s&&t.s.h&&e.b.push(t.s.h),t.se&&t.se.h&&e.b.push(t.se.h),e.b=e.b.min(),e.w=e.l+e.r,e.h=e.t+e.b),e},CreateFrame:function(t,e,i){if(!(e&&i&&e.n_h&&e.s_h&&e.w_w&&e.e_w&&e.nw&&e.n&&e.ne&&e.w&&e.e&&e.sw&&e.s&&e.se))return!1;for(var s=i.doc||document,n=i.id||"",o=0,r=0,a=["nw","n","ne","w","e","sw","s","se"],l=0,c=null;c=a[l++];){var _=e[c];if(_){switch(c){case"nw":_.p={x:0,y:0,w:e.w_w,h:e.n_h};break;case"n":o=e.nw.p.w,_.p={x:o,y:r,w:i.w-e.w_w-e.e_w,h:e.n_h};break;case"ne":o+=e.n.p.w,_.p={x:o,y:r,w:e.e_w,h:e.n_h};break;case"w":o=0,r=e.ne.p.h,_.p={x:o,y:r,w:_.w||e.w_w,h:i.h-e.n_h-e.s_h};break;case"e":var d=_.w||e.e_w;o+=i.w-d,_.p={x:o,y:r,w:d,h:e.w.p.h};break;case"sw":o=0,r+=e.e.p.h,_.p={x:o,y:r,w:e.w_w,h:e.s_h};break;case"s":o+=e.sw.p.w,_.p={x:o,y:r,w:e.n.p.w,h:e.s_h};break;case"se":o+=e.s.p.w,_.p={x:o,y:r,w:e.e_w,h:e.s_h}}var u=s.createElement("div");u.id=n+c,i.resizable&&!i.mini&&(u.style.cursor=c+"-resize",u.onmousedown=i.onmousedown||null,i.controls&&i.controls.push(u)),_.p.w<0&&(_.p.w=0),_.p.h<0&&(_.p.h=0);var h=WCT.skin;h.ApplyPosition(u,_.p),_.image&&h.ApplyBgImage(u,_.image),_.background_color&&(u.style.backgroundColor=_.background_color),t.appendChild(u)}}return!0},CreateTitle:function(t,e,i){if(!e||!i)return!1;var s=i.doc||document,n=i.id||"";(e=WCT.DeepCopy(e)).w=i.w,e.tooltip=i.title,e.x&&(e.w-=2*e.x),i.rtl&&(e.x=WCT.skin.ConvertXToRtl(e.x)),e.padding&&delete e.padding,e.padding_top&&delete e.padding_top,e.padding_bottom&&delete e.padding_bottom;var o=WCT.skin,r=s.createElement("div");return r.id=n+"title",o.ApplyPosition(r,e),o.ApplyTextFormats(r,e),o.ApplyPadding(r,e),WCT.dom.NotSelectable(r),r.style.overflow="hidden",r.style.textOverflow="ellipsis",r.style.whiteSpace="nowrap",e.h&&(r.style.lineHeight=e.h+"px"),i.rtl&&(r.style.direction="rtl"),WCT.SetNodeText(r,i.title,s),t.appendChild(r),i.movable&&i.onmousedown&&(r.style.cursor="pointer",r.onmousedown=i.onmousedown,i.controls&&i.controls.push(r)),r},CreateControl:function(t,e,i){if(!e||!i)return!1;var s=i.doc||document,n=i.id||"",o=SKIN.control.Add({id:n,skin:e,dom:t,onexec:i.oncontrol,scope:i.scope,doc:s,title:i.title,rtl:i.rtl});return i.skins&&i.skins.push({t:"control",i:n}),o}},WCT.ExtendObject(Topmost,{MINI_W:150,MINI_H:37,REFRESH_INTERVAL:200,SCOPE:null,POSITION:null,WinBehind:function(){if(MANAGER.standalone){var t=Topmost.POSITION;try{resizeTo(t.width,t.height),moveTo(t.left,t.top)}catch(e){}}else document.body.style.visibility="visible"},WinOut:function(){if(!Topmost.SCOPE||!Topmost.SCOPE.debug_win_in_)if(MANAGER.standalone)try{moveTo(screen.availWidth+500,screen.availHeight+500)}catch(t){}else document.body.style.visibility="hidden"},Enabled:function(){return null!=Topmost.SCOPE},Show:function(){Topmost&&Topmost.SCOPE&&Topmost.SCOPE.show_&&Topmost.SCOPE.show_()},GetTaskDim:function(t){var e={l:0,r:0,t:0,b:0},i=t&&t.task;return i&&(e.l=i.outer_spacing_l||0,e.r=i.outer_spacing_r||0,e.t=i.outer_spacing_t||0,e.b=i.outer_spacing_b||0),e}}),Topmost.prototype=function(){function a(){for(var t;t=this.controls_.shift();)t.onclick=null,t.onmouseover=null,t.onmouseout=null,t.onmousedown=null,t.onmouseup=null,t.onmousemove=null,t.onselectstart=null,t.ondragstart=null;for(;t=this.skins_.shift();)SKIN[t.t].Cleanup(t.i)}return{Destructor:function(){a.call(this),this.popup_&&(this.Hide(),this.popup_=null),this.cfg_=null,Topmost.SCOPE=null,MANAGER.standalone||(document.body.style.visibility="visible")},Show:function(){if(!this.skin_||!this.fill_())return this.Destructor(),!1;this.win_left_=Math.min(window.screenLeft,screen.availWidth),this.win_top_=Math.min(window.screenTop,screen.availHeight);var t=SKIN.popup.GetDim(this.skin_.frame);return this.skin_min_h_=t.h,this.show_(),!0},Hide:function(){this.interval_&&WCT.ClearTimeout(this.interval_);var t=this.popup_.document.body;t.onmouseenter=null,t.onmousedown=null,t.onmousemove=null,t.onmouseup=null,t.onclick=null,(t=document.body).onmousedown=null,t.onmousemove=null,t.onmouseup=null,t.onclick=null,t.releaseCapture(),this.popup_.hide(),!1!==arguments[0]?MANAGER.handler.CloseTopmostConnected():Topmost.WinBehind()},ToggleMinimize:function(){var t=this.cfg_;this.mini_?(this.mini_=!1,t.left=t.left+t.width-this.mini_w_,t.width=this.mini_w_,t.height=this.mini_h_):(this.mini_=!0,this.mini_w_=t.width,this.mini_h_=t.height,t.left=t.left+t.width-Topmost.MINI_W,t.width=Topmost.MINI_W,t.height=this.skin_min_h_),this.Refresh.call(this,!0)},IsMinimized:function(){return this.mini_},AfterResize:function(){},Refresh:function(){!0===arguments[0]&&(this.ev_fill_=!0),this.interval_&&WCT.ClearTimeout(this.interval_),this.show_()},GetDocument:function(){return this.popup_&&this.popup_.document||null},GetEvent:function(){return this.popup_.document.parentWindow.event},GetSkin:function(){return this.skin_},GetWH:function(){var t=this.cfg_;return{w:t.width,h:t.height}},SetTitle:function(t){this.title_=t;var e=this.popup_&&this.popup_.document||null,i=e&&e.getElementById("title");i&&(WCT.SetNodeText(i,t,e),i.setAttribute("title",t))},SetCSS:function(t){var e=this.popup_.document,i=e.getElementsByTagName("head")[0];i||(i=$$("head",e),e.documentElement.appendChild(i));var s=$$("link",e);s.href=t,s.type="text/css",s.rel="stylesheet",i.appendChild(s)},show_:function(){this.popup_.document.body.onmouseenter=Topmost.event.OnMouseEnter,this.ev_fill_&&(this.ev_fill_=!1,this.fill_(this));var t=this.cfg_;try{this.popup_.show(t.left,t.top,t.width,t.height)}catch(e){}this.debug_win_in_||(Topmost.POSITION={left:t.left,top:t.top,width:t.width,height:t.height},Topmost.WinOut()),this.interval_=WCT.SetTimeout(Topmost.Show,Topmost.REFRESH_INTERVAL)},fill_:function(){a.call(this),this.popup_.document.body.innerHTML="";var t=MANAGER.handler.GetTopmostConnected(),e=t.GetContentInfo().rtl,i=this.popup_.document,s=i.body,n={resizable:!0,movable:!0,mini:this.mini_,controls:this.controls_,skins:this.skins_,title:this.title_,doc:i,w:this.cfg_.width,h:this.cfg_.height,onmousedown:Topmost.event.OnMoveResize,oncontrol:Topmost.event.OnControl,scope:this,id:"",rtl:e},o=this.skin_,r=SKIN.popup;return!(!r.CreateFrame(s,o.frame,n)||!r.CreateTitle(s,o.title,n))&&(n={skins:this.skins_,doc:i,oncontrol:Topmost.event.OnControl,scope:this,rtl:e},o.exit&&(n.id="exit",n.title=t.Trans(o.exit.tooltip||""),r.CreateControl(s,o.exit,n)),o.restore&&o.minimize&&(n.id=this.mini_?"restore":"minimize",n.title=t.Trans(o[n.id].tooltip||""),r.CreateControl(s,o[n.id],n)),!0)},get_pos_:function(){var t=this.cfg_,e=0,i=screen.availWidth;switch(t.orientation){case"N":case"S":case"C":e=i-t.width>>1;break;case"NE":case"E":case"SE":e=i-t.width}var s=0,n=screen.availHeight;switch(t.orientation){case"W":case"E":case"C":s=n-t.height>>1;break;case"SW":case"S":case"SE":s=n-t.height}t.left=e,t.top=s},debug_:function(t){var e=MANAGER.handler.GetActive(),i=e&&e.GetSlideHandler(),s=i&&i.GetWindow();if(s&&MANAGER.standalone&&s.Log){try{moveTo(0,0)}catch(n){return}this.debug_win_in_=!0,s.DEBUG=!0,s.Log(t)}}}}(),Topmost.event=function(){function move_(){var t=Topmost.SCOPE,e=t&&t.popup_&&t.popup_.document||null;if(e){var i=e.parentWindow.event;if(i){var s=e.getElementById("top"),n=e.getElementById("title");return s&&(s.style.cursor="move"),n&&(n.style.cursor="move"),t.cfg_.left=i.screenX-t.ev_x_,t.cfg_.top=i.screenY-t.ev_y_,t.Refresh(),!0}}}function stop_move_(){Topmost.event.Stop(this);var t=Topmost.SCOPE,e=t&&t.popup_&&t.popup_.document||null;if(!e)return!0;var i=e.getElementById("top"),s=e.getElementById("title");return i&&(i.style.cursor="pointer"),s&&(s.style.cursor="pointer"),!0}function resize_(){var t=Topmost.SCOPE;if(!t)return!0;var e=t.popup_&&t.popup_.document.parentWindow.event;if(e){var i=null,s=null,n=null,o=null;switch(t.ev_id_){case"nw":case"w":case"sw":i=e.screenX-t.ev_x_,n=t.cfg_.width+t.cfg_.left-i;break;case"ne":case"e":case"se":n=e.screenX-t.ev_w_-t.cfg_.left}switch(t.ev_id_){case"nw":case"n":case"ne":s=e.screenY-t.ev_y_,o=t.cfg_.height+t.cfg_.top-s;break;case"sw":case"s":case"se":o=e.screenY-t.ev_h_-t.cfg_.top}return null!=n&&(n<Topmost.event.MIN_W&&(n=Topmost.event.MIN_W),n==t.cfg_.width&&(n=null)),null!=o&&(o<Topmost.event.MIN_H&&(o=Topmost.event.MIN_H),o==t.cfg_.height&&(o=null)),null==n&&null==o||(null!=i&&(t.cfg_.left=i),null!=s&&(t.cfg_.top=s),null!=n&&(t.cfg_.width=n),null!=o&&(t.cfg_.height=o),t.AfterResize(),t.Refresh(!0)),!0}}function stop_resize_(){return Topmost.event.Stop(this),!0}return{MIN_W:100,MIN_H:100,MOVE_RESIZE_MAP:{top:{f1:"move_",f2:"stop_move_"},title:{f1:"move_",f2:"stop_move_"},nw:{f1:"resize_",f2:"stop_resize_"},n:{f1:"resize_",f2:"stop_resize_"},ne:{f1:"resize_",f2:"stop_resize_"},w:{f1:"resize_",f2:"stop_resize_"},e:{f1:"resize_",f2:"stop_resize_"},sw:{f1:"resize_",f2:"stop_resize_"},s:{f1:"resize_",f2:"stop_resize_"},se:{f1:"resize_",f2:"stop_resize_"}},CONTROL_MAP:{exit:"Hide",minimize:"ToggleMinimize",restore:"ToggleMinimize"},Stop:function(t){t.releaseCapture(),t.onmousemove=null,t.onmouseup=null},OnMouseEnter:function(){var t=Topmost.SCOPE;return t&&(t.popup_&&t.popup_.document.body.setActive(),window.focus(),Topmost.WinOut()),!0},OnMoveResize:function(){var t=Topmost.SCOPE;if(!t)return!0;var evt=t.popup_.document.parentWindow.event,tar=evt.srcElement;if(!tar||!tar.id)return!0;var map=Topmost.event.MOVE_RESIZE_MAP[tar.id];if(!map)return!0;var f1=map.f1||null,f2=map.f2||null;if(f1&&f2&&(f1=eval(f1),f2=eval(f2)),"function"!=typeof f1||"function"!=typeof f2)return!0;t.ev_x_=evt.screenX-t.cfg_.left,t.ev_y_=evt.screenY-t.cfg_.top,t.ev_w_=t.ev_x_-t.cfg_.width,t.ev_h_=t.ev_y_-t.cfg_.height,t.ev_id_=tar.id;var p=this.parentNode;return p.setCapture(),p.onmousemove=f1,p.onmouseup=f2,evt.cancelBubble=!0,!0},OnControl:function(t){var e=Topmost.SCOPE;if(e){var i=Topmost.event.CONTROL_MAP[t];i&&e[i]&&e[i]()}}}}(),Topmost.praxis=function(){Topmost.apply(this,arguments),this.steps_=0,this.step_=0,this.visible_steps_=null,this.jumpable_steps_=null,this.titles_steps_=null,this.task_h_=Topmost.praxis.TASK_DEF_HEIGHT,this.task_min_h_=0,this.task_text_="",this.content_="",this.content_bgimages_=[],this.saved_h_=null,this.poi_=null,this.cx_=0,this.cy_=0,this.cont_pos_=null},Topmost.praxis.prototype=new Topmost,WCT.ExtendObject(Topmost.praxis,{TASK_DEF_HEIGHT:150,ScrollToPOI:function(){var t=Topmost.SCOPE;if(t&&t.poi_){var e=t.cont_pos_,i=t.popup_&&t.popup_.document,s=i&&i.getElementById("content");if(e&&s){var n=s.scrollWidth,o=s.scrollHeight,r=e.w,a=e.h;if(r<n||a<o){var l=t.cx_||0,c=t.cy_||0,_={x:l,y:c,w:r,h:a},d=WCT.POI.Focus[t.poi_.focus_type](t.poi_,_);null!=d.x&&(d.x=Math.min(Math.max(r-n,-d.x),0)),null!=d.y&&(d.y=Math.min(Math.max(a-o,-d.y),0));var u={x:null!=d.x?d.x:l,y:null!=d.y?d.y:c};t.cx_=u.x,t.cy_=u.y,t.poi_uid_=WCT.POI.Animate(s,_,u,"SineInOut",t.poi_.anim_time,10,null,null,!0),t.poi_=null}}}},OnContentMoveStart:function(){var t=Topmost.SCOPE;if(t){var e=t.cont_pos_,i=t.popup_&&t.popup_.document,s=i&&i.parentWindow.event;if(e&&s){var n=i.getElementById("content");if(n){var o=n.scrollWidth,r=n.scrollHeight;if(!(o<=e.w&&r<=e.h)){t.start_x_=s.clientX-t.cx_,t.start_y_=s.clientY-t.cy_,t.stop_x_=-o+e.w,t.stop_y_=-r+e.h;var a=n.parentNode;a.setCapture(),a.onmouseup=Topmost.praxis.OnContentMoveEnd,a.onmousemove=Topmost.praxis.OnContentMove}}}}},OnContentMoveEnd:function(){var t=Topmost.SCOPE;if(t){var e=t.popup_&&t.popup_.document,i=e&&e.parentWindow.event;if(i){var s=e.getElementById("content")||null;if(s){var n=Math.max(t.stop_x_,Math.min(0,i.clientX-t.start_x_)),o=Math.max(t.stop_y_,Math.min(0,i.clientY-t.start_y_));s.style.left=n+"px",s.style.top=o+"px",t.cx_=n,t.cy_=o;var r=s.parentNode;r.releaseCapture(),r.onmouseup=null,r.onmousemove=null}}}},OnContentMove:function(){var t=Topmost.SCOPE;if(t){var e=t.popup_&&t.popup_.document,i=e&&e.parentWindow.event;if(i){var s=e.getElementById("content")||null;if(s){var n=Math.max(t.stop_x_,Math.min(0,i.clientX-t.start_x_)),o=Math.max(t.stop_y_,Math.min(0,i.clientY-t.start_y_));s.style.left=n+"px",s.style.top=o+"px"}}}},OnSeparatorClick:function(){var t=Topmost.SCOPE;if(t)if(t.sep_moved_)t.sep_moved_=!1;else{var e=t.skin_.separator,i=t.skin_.content;if(e&&i){var s=t.cfg_;null==t.saved_h_?(t.saved_h_=s.height,s.height=t.task_h_+e.h+(i.outer_spacing_b||0)-1):(s.height=t.saved_h_,t.saved_h_=null),Topmost.praxis.SetHeights(),t.Refresh(!0)}}},OnSeparatorMoveStart:function(){var t=Topmost.SCOPE;if(t){var e=t.popup_&&t.popup_.document.parentWindow.event;if(e){var i=t.cfg_;if(null==t.task_ev_h_){var s=t.skin_.frame?SKIN.popup.GetDim(t.skin_.frame).b:0;t.task_ev_h_=t.task_h_,t.task_ev_mh_=i.height-t.skin_.separator.sep_sp.h+1,null!=s&&(t.task_ev_mh_-=s)}var n=Math.max(t.task_min_h_,e.screenY-t.ev_y_+t.task_ev_h_-i.top);return(n=Math.min(n,t.task_ev_mh_))!=t.task_h_&&(t.sep_moved_=!0,t.task_h_=n,Topmost.praxis.SetHeights()),!0}}},OnSeparatorMoveEnd:function(){var t=Topmost.SCOPE;return t&&(t.sep_moved_&&WCT.SetTimeout(Topmost.praxis.AfterSeparatorMove,20),delete t.task_ev_h_,delete t.task_ev_mh_,Topmost.event.Stop(this)),!0},AfterSeparatorMove:function(){var t=Topmost.SCOPE;t&&(t.sep_moved_=!1)},SetHeights:function(){var t=Topmost.SCOPE;if(t){var e=t.popup_.document,i=t.skin_.task,s=i&&i.area||null,n=i&&i.timeline||null,o=e.getElementById("frame"),r=e.getElementById("task");if(s&&n&&o&&r){var a=[];i.prev&&a.push(i.prev.h),i.pnext&&a.push(i.next.h);var l=Math.max(n.h,a.length?a.max():0),c=t.task_h_-(i.outer_spacing_t||0),_=c-(s.outer_spacing_t||0)-(s.outer_spacing_b||0)-l;o.style.height=c+"px",0<_?(r.style.height=_+"px",r.style.display="block"):r.style.display="none"}var d=e.getElementById("sep_w"),u=e.getElementById("sep_e"),h=e.getElementById("sep_c"),p=e.getElementById("sep_sp");if(d&&u&&h&&p){var f=t.task_h_-1+"px";d.style.top=f,u.style.top=f,h.style.top=f,p.style.top=f}var m=t.skin_.separator,b=t.skin_.content,v=e.getElementById("content#outside");if(m&&b&&v){var g=b.outer_spacing_b||0,y=t.cfg_.height-t.task_h_-m.h-g+1;t.cont_pos_.h=y,v.style.height=y+"px"}}}}),WCT.ExtendObject(Topmost.praxis.prototype,function(){function f(){var t=this.skin_.task.timeline;if(t){var e=this.skins_.indexOfAtt("timeline","i");0<=e&&SKIN.timeline.Cleanup("timeline"),this.skins_.splice(e,1);var i=MANAGER.handler.GetTopmostConnected(),s=this.popup_.document,n=s.getElementById("frame");SKIN.timeline.Add({id:"timeline",skin:t,dom:n,ori:"hor",steps:this.steps_,onexec:o,scope:this,doc:s,rtl:i.GetContentInfo().rtl,visibles:this.visible_steps_,jumpables:this.jumpable_steps_,titles:this.titles_steps_}),SKIN.timeline.MoveTo("timeline",6,-20),SKIN.timeline.Resize("timeline",this.cfg_.width-(t.outer_spacing_r||0)),this.skins_.push({t:"timeline",i:"timeline"})}}function o(t){var e=Number(t.split("#").top());!isNaN(e)&&0<e&&e<=this.steps_&&this.Jump(e-1)}return{Destructor:function(){var t=this.popup_.document.parentWindow;t&&(t.ctx=null,t.Page=null),WCT.POI.StopAnimation(this.poi_uid_),this.task_text_=null,this.content_=null,this.content_bgimages_=null,this.visible_steps_=null,this.jumpable_steps_=null,this.titles_steps_=null,this.poi_=null,Topmost.prototype.Destructor.call(this)},Restart:function(){this.content_="",this.content_bgimages_=[]},AfterResize:function(){this.cx_=0,this.cy_=0},SetSteps:function(t,e,i,s){this.steps_=t,this.visible_steps_=e,this.jumpable_steps_=i,this.titles_steps_=s,this.skin_.task.timeline&&f.call(this)},SetStep:function(t){this.step_=t,SKIN.timeline.Step("timeline",t+1)},SetTask:function(t){var e=this.popup_.document,i=e&&e.getElementById("task")||null;this.task_text_=t,i&&(i.innerHTML=t)},SetContent:function(t){var e=t.innerHTML;if(e!=this.content_){this.content_=e;var i=this.popup_.document,s=i&&i.getElementById("content")||null;if(s){if(function h(t){var e=t.indexOf('id="base_obj#bgimage"');e<0&&(e=t.indexOf("id=base_obj#bgimage"));var i=t.indexOf("</div></div>",e+1);if(i<0&&(i=t.indexOf("</DIV></DIV>",e+1)),e<0||i<0)return!0;for(var s=t.substring(e,i).match(/src=".*?"/),n=s.length-1;0<=n;n--)s[n]=s[n].substring(5,s[n].length-1);var o=this.content_bgimages_;if(s.length!=o.length)return this.content_bgimages_=s,!0;for(n=s.length-1;0<=n;n--)if(s[n]!=o[n])return this.content_bgimages_=s,!0;return!1}.call(this,e))s.innerHTML=e;else{for(var n=!1,o=s.childNodes,r=null,a=0;r=o[a];)r.nodeType!=WCT.dom.ELEMENT_NODE?a++:n?s.removeChild(r):("base_obj"==r.id&&(n=!0),a++);var l=$$("div",i);for(l.innerHTML=e,n=!1,o=l.childNodes,r=null,a=0;r=o[a];)r.nodeType!=WCT.dom.ELEMENT_NODE?a++:n?s.appendChild(r):("base_obj"==r.id&&(n=!0),a++)}for(var c=t.getElementsByTagName("input"),_=(a=0,null);_=c[a++];){if("checkbox"==_.type||"radio"==_.type)(u=i.getElementById(_.id))&&(u.checked=_.checked,u.value=_.value)}var d=t.getElementsByTagName("select");for(a=0,_=null;_=d[a++];){var u;(u=i.getElementById(_.id))&&(u.selectedIndex=_.selectedIndex)}this.poi_&&WCT.SetTimeout(Topmost.praxis.ScrollToPOI,5)}}},ScrollToPOI:function(t,e,i,s){s.focus_type=e,s.anim_time=i,this.poi_=s},ResetPOI:function(){this.poi_={x:0,y:0,w:100,h:100,time:100,focus_type:"Simple"};var t=this.popup_.document,e=t&&t.getElementById("content")||null;e&&(e.style.left="0px",e.style.top="0px")},Prev:function(){var t=MANAGER.handler.GetTopmostConnected();t&&t.ExecCommand("prev_task")},Next:function(){var t=MANAGER.handler.GetTopmostConnected();t&&t.ExecCommand("next_task")},Jump:function(t){var e=MANAGER.handler.GetTopmostConnected();e&&e.ExecCommand("jump",t)},fill_:function(){if(Topmost.prototype.fill_.call(this)&&!this.mini_){var t=this.popup_.document.parentWindow;if(t&&(t.ctx={cfg_show:function(){parent.topmost_ctx&&parent.topmost_ctx.cfg_show&&parent.topmost_ctx.cfg_show(arguments[0],!0,"force=1")}},t.Page={RTFireTrigger:function(){parent.topmost_ctx&&parent.topmost_ctx.cfg_show&&parent.topmost_ctx.cfg_show("trigger!"+arguments[0])}}),function p(){var t=WCT.DeepCopy(this.skin_.task);if(!t)return!1;var e=t.area||null,i=t.timeline;if(!e||!i)return!1;t.x=t.outer_spacing_l||0,t.y=t.outer_spacing_t||0,e.border_style="solid",e.border_width=1,e.padding=5,e.x=e.outer_spacing_l||0,e.y=e.outer_spacing_t||0,t.prev&&(t.prev.x||(t.prev.x=-29),t.prev.y=-5),t.next&&(t.next.x||(t.next=-5),t.next.y=-5);var s=this.popup_.document,n=s.body;t.w=this.cfg_.width-t.x-(t.outer_spacing_r||0);var o=$$("div",s);o.id="frame",WCT.skin.ApplyPosition(o,t),WCT.skin.ApplyTextFormats(o,t),n.appendChild(o);var r=[];t.prev&&r.push(t.prev.h),t.pnext&&r.push(t.next.h);var a=Math.max(i.h,r.max());this.task_min_h_=t.y+e.y+a,e.w=t.w-e.x-(e.outer_spacing_r||0);var l=MANAGER.handler.GetTopmostConnected(),c=l.GetContentInfo().rtl,_=$$("div",s);_.id="task",_.className="dgo_text_container",WCT.skin.ApplyPosition(_,e,!0),WCT.skin.ApplyBorder(_,e),WCT.skin.ApplyTextFormats(_,e),_.style.overflow="auto",c?(_.style.direction="rtl",_.setAttribute("dir","rtl")):(_.style.direction="ltr",_.setAttribute("dir","ltr")),o.appendChild(_),_.onselectstart=function(){return!1},_.ondragstart=function(){return!1},this.controls_.push(_),f.call(this);var d=SKIN.popup,u={skins:this.skins_,doc:s,oncontrol:Topmost.event.OnControl,scope:this,rtl:c};t.prev&&(u.id="prev",u.title=l.Trans(t.prev.tooltip),d.CreateControl(o,t.prev,u)),t.next&&(u.id="next",u.title=l.Trans(t.next.tooltip),d.CreateControl(o,t.next,u));var h=Topmost.event.CONTROL_MAP;return h.prev="Prev",h.next="Next",this.SetTask(this.task_text_),!0}.call(this)&&function _(){var t=this.skin_.separator;if(!t||!this.skin_.task)return!1;var e=this.popup_.document,i=e.body,s=this.task_h_-1,n=this.cfg_.width,o=t.h,r=this.skin_.frame?SKIN.popup.GetDim(this.skin_.frame).b:0;for(var a in Topmost.event.MIN_H=s+o+r,t)if("object"==typeof t[a]){var l=$$("div",e),c=t[a];switch(a){case"sep_w":c.x=0,c.h=o;break;case"sep_e":c.x="-0",c.h=o;break;case"sep_c":c.x=t.sep_w.w,c.w=n-t.sep_w.w-t.sep_e.w,c.h=o,Topmost.event.MOVE_RESIZE_MAP[a]={f1:"Topmost.praxis.OnSeparatorMoveStart",f2:"Topmost.praxis.OnSeparatorMoveEnd"},l.style.cursor="n-resize",l.onmousedown=Topmost.event.OnMoveResize,this.controls_.push(l);break;case"sep_sp":c.x=n-c.w>>1,c.h=o,Topmost.event.MOVE_RESIZE_MAP[a]={f1:"Topmost.praxis.OnSeparatorMoveStart",f2:"Topmost.praxis.OnSeparatorMoveEnd"},l.style.cursor="pointer",l.onmousedown=Topmost.event.OnMoveResize,l.onclick=Topmost.praxis.OnSeparatorClick,this.controls_.push(l)}l.id=a,WCT.skin.ApplyPosition(l,c),WCT.skin.ApplyBgImage(l,c.image),i.appendChild(l)}return!0}.call(this)&&function d(){var t=this.skin_.separator,e=this.skin_.content;if(!t||!e)return!1;var i=this.popup_.document,s=i.body,n=e.outer_spacing_l||0,o=e.outer_spacing_r||0,r=e.outer_spacing_b||0,a={x:n,y:0==r?"-0":-r,w:this.cfg_.width-n-o};this.cont_pos_=a;var l=$$("div",i);l.id="content#outside",WCT.skin.ApplyPosition(l,a),l.style.overflow="hidden",s.appendChild(l),this.controls_.push(l);var c=$$("div",i);return c.id="content",c.style.position="absolute",c.style.left=this.cx_+"px",c.style.top=this.cy_+"px",c.style.cursor="move",l.appendChild(c),c.onselectstart=function(){return!1},c.ondragstart=function(){return!1},c.onmousedown=Topmost.praxis.OnContentMoveStart,this.controls_.push(c),c.innerHTML=this.content_,this.poi_&&WCT.SetTimeout(Topmost.praxis.ScrollToPOI,5),!0}.call(this))return Topmost.praxis.SetHeights(),this.SetStep(this.step_),!0}return!1}}}());var DEFAULTS={ok:{t:"boolean",d:!0},show:{t:"string",d:""},style:{t:"string",d:"default"},library:{t:"string",d:"library.txt"},navigator:{t:"boolean",d:!1},help4:{t:"boolean",d:!1},cache:{t:"boolean",d:!0},version:{t:"string",d:"~~~VERSION~~~"},selftest:{t:"boolean",d:!1},title:{t:"string",d:""},window_cfg_top:{t:"number",d:null},window_cfg_left:{t:"number",d:null},window_cfg_width:{t:"number",d:null},window_cfg_height:{t:"number",d:null},window_cfg_orientation:{t:"string",d:""},window_cfg_name:{t:"string",d:""},window_cfg_force:{t:"boolean",d:null},window_cfg_features_fullscreen:{t:"boolean",d:!1},window_cfg_features_menubar:{t:"boolean",d:!0},window_cfg_features_toolbar:{t:"boolean",d:!0},window_cfg_features_location:{t:"boolean",d:!0},window_cfg_features_resizable:{t:"boolean",d:!0},window_cfg_features_scrollbars:{t:"boolean",d:!0},window_cfg_features_status:{t:"boolean",d:!0},handler_preloadfile:{t:"string",d:""},handler_socket:{t:"boolean",d:!1},handler_window_close:{t:"boolean",d:!0},handler_preload_lib:{t:"boolean",d:!1},video_mode:{t:"boolean",d:!1},video_fps:{t:"number",d:25},video_debug:{t:"string",d:""},panel_orientation:{t:"string",d:"top"},panel_fixed:{t:"boolean",d:!1},panel_toc_numbering:{t:"string",d:"1."},panel_toc_animation:{t:"boolean",d:!1},panel_lesson_nav_mode:{t:"string",d:"tourstop"},panel_nav_disabled:{t:"boolean",d:!1},panel_nav_chapter:{t:"boolean",d:!0},hide_panel:{t:"boolean",d:!1},panel_show_topic_title:{t:"boolean",d:!0},panel_send_content:{t:"boolean",d:!0},panel_taskinfo_toggle:{t:"boolean",d:!1},panel_show_help:{t:"boolean",d:!0},panel_show_exit:{t:"boolean",d:!0},panel_show_logo:{t:"boolean",d:!0},panel_show_subtitle:{t:"boolean",d:!1},tracking_backend:{t:"string",d:"none"},tracking_collaborator_detail:{t:"number",d:2},tracking_debug_mode:{t:"boolean",d:!1},tracking_scorm_simulation:{t:"boolean",d:!1},prevent_server_check:{t:"boolean",d:!1},trackable:{t:"string",d:""},scorm_tracking:{t:"string",d:"score"},scorm_decide_passed:{t:"string",d:"on_completion"},scorm_suspend_resume:{t:"string",d:"enabled"},scorm_scoring:{t:"string",d:"scoring_percentage"},scorm_score_precision:{t:"number",d:2},scorm_only_one_commit:{t:"boolean",d:!0},scorm_objective_tracking:{t:"boolean",d:!1},scorm_safe_mode:{t:"boolean",d:!1},scorm_location:{t:"string",d:"auto"},scorm_allow_restart:{t:"boolean",d:!0},scorm_nav_request:{t:"boolean",d:!1},aicc_tracking:{t:"string",d:"score"},aicc_objective_tracking:{t:"boolean",d:!1},aicc_decide_passed:{t:"string",d:"on_completion"},aicc_suspend_resume:{t:"string",d:"enabled"},aicc_score_precision:{t:"number",d:2},aicc_crossdomain:{t:"string",d:"disabled"},aicc_allow_restart:{t:"boolean",d:!0},feedback_enabled:{t:"boolean",d:!1},feedback_force_end:{t:"boolean",d:!1},feedback_external_url:{t:"string",d:""},assignmentId:{t:"string",d:""},startMode:{t:"string",d:"start"},step:{t:"string",d:""},assets:{t:"object",d:[]},caption:{t:"string",d:""},description:{t:"string",d:""},shortdesc:{t:"string",d:""},tclass:{t:"string",d:""},uid:{t:"string",d:""},language:{t:"string",d:""},keywords:{i:!0},context_id:{t:"string",d:""},creator:{t:"string",d:""},ctx:{t:"boolean",d:!1},book_style:{t:"string",d:"standard"},content_slide:{t:"string",d:""},book_page_sound:{t:"string",d:""},book_close_sound:{t:"string",d:""},single_click_opens_book:{t:"boolean",d:!1},hide_audio_controls:{t:"boolean",d:!1},hide_navigation_controls:{t:"boolean",d:!1},hide_play_pause_button:{t:"boolean",d:!1},hide_index_page_button:{t:"boolean",d:!1},hide_search_button:{t:"boolean",d:!1},hide_toc_control:{t:"boolean",d:!1},hide_progress_control:{t:"boolean",d:!1},lms_cfg_track_completion:{t:"boolean",d:!0},max_score_percent:{t:"number",d:null},mastery_score_percent:{t:"number",d:null},scaling:{t:"number",d:1},contentlanguage:{t:"string",d:"en-US"},"control.mastery_percent":{t:"number",d:80},macroset:{t:"string",d:""},mediaqualities:{t:"string",d:".gsm.wav;.mp3"},mode:{t:"string",d:""},recording_mode:{t:"string",d:""},topmost:{t:"boolean",d:!1},glossary_width:{t:"number",d:400},en_transition:{t:"boolean",d:!0},en_transition_rev:{t:"boolean",d:!0},t2_transition:{t:"string",d:"progid:DXImageTransform.Microsoft.GradientWipe(GradientSize=0.25, wipestyle=0, motion=reverse)"},t2_transition_rev:{t:"string",d:"progid:DXImageTransform.Microsoft.GradientWipe(GradientSize=0.25, wipestyle=0, motion=forward)"},t2_skin:{t:"string",d:"trainer_skin",n:"skin"},tr:{t:"string",d:"standard"},guilanguage:{t:"string",d:"en-US"},show_focus_layer:{t:"boolean",d:!1},show_startpage:{t:"boolean",d:!1},show_stoppage:{t:"boolean",d:!0},startpage:{t:"string",d:""},big_mouse:{t:"boolean",d:!1},view_mode:{t:"string",d:"100"},mobile_view_mode:{t:"string",d:"100"},allow_mobile_pinch_zoom:{t:"boolean",d:!1},show_tts_subtitle:{t:"boolean",d:!1},sub_font_family:{t:"string",d:"Arial"},sub_font_size:{t:"string",d:"13"},sub_text_color:{t:"string",d:"#FFFFFF"},sub_align:{t:"string",d:"Center"},sub_background_color:{t:"string",d:"#000000"},lib_shortdesc:{t:"boolean",d:!0},lib_desc:{t:"boolean",d:!0},lib_assets:{t:"boolean",d:!0},lib_tree:{t:"boolean",d:!0},lib_searchstring:{t:"string",d:""},lib_startentity:{t:"string",d:""},lib_glossary_root:{t:"string",d:""},lib_caption:{t:"string",d:""},lib_breadcrumb_trail:{t:"boolean",d:!0},lib_search_slides:{t:"boolean",d:!0},lib_entity_caption:{t:"boolean",d:!0},lib_list_mode:{t:"string",d:"content"},lib_glossary_rootlang:{t:"boolean",d:!1},lib_full_expand_check:{t:"boolean",d:!1},playback_mode:{t:"string",d:"audio_text"},allow_restart:{t:"boolean",d:!0},book_show_book_group:{t:"boolean",d:!1},book_show_cdoc:{t:"boolean",d:!1},book_noslide_template:{t:"string",d:""},book_show_project:{t:"boolean",d:!1},book_project_template:{t:"string",d:""},book_show_media_video:{t:"boolean",d:!1},book_media_template_video:{t:"string",d:""},book_show_media_audio:{t:"boolean",d:!1},book_media_template_audio:{t:"string",d:""},book_show_media_image:{t:"boolean",d:!1},book_media_template_image:{t:"string",d:""},book_show_media_doc:{t:"boolean",d:!1},book_media_template_doc:{t:"string",d:""},book_show_media_file:{t:"boolean",d:!1},book_media_template_file:{t:"string",d:""},vol_master:{t:"number",d:100},vol_narrative:{t:"number",d:80},vol_booksound:{t:"number",d:50},vol_effects:{t:"number",d:50},vol_lesson:{t:"number",d:100},disable_fx:{t:"boolean",d:!0},audio_ext:{t:"string",d:".mp3"},keys_play:{t:"string",d:"space"},keys_pause:{t:"string",d:"space"},keys_stop:{t:"string",d:""},keys_back:{t:"string",d:"left"},keys_next:{t:"string",d:"right"},keys_feedback:{t:"string",d:"ctrl_f1"},keys_focus_bar:{t:"string",d:"ctrl_f2"},keys_focus_panel:{t:"string",d:"shift_f2"},keys_focus_content:{t:"string",d:"f2"},keys_show_highlight:{t:"string",d:""},keys_ignore_hotkeys:{t:"boolean",d:!1},GetFull:function(){var t=DEFAULTS,e={};for(var i in t){var s=t[i];"function"==typeof s||s.i||(e[s.n||i]=s.d)}return e},Clamp:function(t,e){var i=DEFAULTS[t];if(!i||i.i)return undefined;switch(i.t){case"boolean":var s=WCT.ClampBoolean(e,!0);if("boolean"==typeof s)return s;break;case"number":if("number"==typeof e)return e;if(null!=e){var n=Number(e);if(!isNaN(n))return n}break;case"object":if("object"==typeof e)return e;break;case"string":if(null!=e)return e+""}return arguments[2]?i.d:undefined}};window.DEBUG||(DEBUG=!1);var SEARCH={},CACHING_MODES={FULL:"full",MOBILE:"mobile"},WA_LAYOUT={path:"",global:"trainer_global.js",book:"trainer_book.js",demo:"trainer_demo.js",lib:"trainer_lib.js",praxis:"trainer_praxis.js",test:"trainer_test.js",uebung:"trainer_uebung.js",pres:"trainer_pres.js",guided:"trainer_guided.js",sim_fallbacks:"simulation_fallbacks.js",slide_fallbacks:"slide_fallbacks.js"};!function(){var k={wnd:null,active:null},s={},a=null,i="entity.txt",e=null,d=0,c=!1,_="",E={},w="",R="",u={},l=null,h={},p=0,f={};function m(t){for(var e=[],i=[],s=0,n=null;n=t[s];s++){var o=this.GetS(n);o?e.push(o):i.push(n)}c&&(_=i.join(", ")),arguments[1]?e.push(E,arguments[1]):e.push(E);var r=function l(t){for(var e=DEFAULTS.GetFull(),i=0,s=null;s=t[i++];)for(var n in s){var o=DEFAULTS.Clamp(n,s[n],!0);void 0!==o&&(e[DEFAULTS[n].n||n]=o)}e&&!function a(t){t.window_cfg_name=t.window_cfg_name.replace(/ /g,"_"),t.topmost=!1,t.lms_cfg_track_completion||(t.scorm_tracking="none",t.aicc_tracking="none");var e=DATA.CFG_KEYS;for(var i in e)for(var s=e[i],n=s.length-1;0<=n;n--)t[s[n]]=t[s[n]].replace(/ /g,"_");t.lib_searchstring&&(t.lib_list_mode="search");t.book_noslide_template||(t.book_show_book_group=!1,t.book_show_cdoc=!1);t.book_media_template_video||(t.book_show_media_video=!1);t.book_media_template_audio||(t.book_show_media_audio=!1);t.book_media_template_image||(t.book_show_media_image=!1);t.book_media_template_doc||(t.book_show_media_doc=!1);t.book_media_template_file||(t.book_show_media_file=!1);t.book_project_template||(t.book_show_project=!1);t.video_debug&&(t.video_mode=!0,t.video_fps=10);if(t.video_mode||t.navigator||t.help4){var o={window_cfg_top:null,window_cfg_left:null,window_cfg_width:null,window_cfg_height:null,window_cfg_orientation:null,window_cfg_name:null,window_cfg_features_menubar:null,window_cfg_features_toolbar:null,window_cfg_features_location:null,window_cfg_features_resizable:null,window_cfg_features_scrollbars:null,window_cfg_features_status:null,window_cfg_features_fullscreen:!1};for(var e in(t.video_mode||t.navigator)&&(o.show_startpage=!1,o.show_stoppage=!1),o)t[e]=DEFAULTS.Clamp(e,o[e],!0)}if(t.ctx){var r=DATA.GetUrlSearch(!0).ctx.split("&").toMap({delimiter:"="});for(var n in delete r.ctx,t.ctx={},r)t.ctx[n.toLowerCase()]=r[n].toLowerCase()}t.prevent_server_check&&DATA.OmitRequest(".server")}(e);return e}(e);return r&&r.ok?r:null}function b(t,e){e&&DATA.CACHING_MODE==CACHING_MODES.MOBILE&&0<=t.search(/:lesson\.js$|:slide\.js$|:textatoms.*?\.txt$|adaptable!.*?\.txt$/)||(h[t]=e)}function r(t,e){var i=this.MULTI_FILE_ID,s=this.context.Resolve(t);if("object"!=typeof e||!e||!e[i])return b(s,e),e;e[this.MULTI_FILE_MAP_ID]&&(function l(t){for(var e in t)for(var i=t[e],s=0,n=null;n=i[s++];)u[n]=e}.call(this,e[this.MULTI_FILE_MAP_ID]),delete e[this.MULTI_FILE_MAP_ID]),b(s,null);var n=WCT.address,o=null;for(var r in e)if(r!=i){var a=new n(r).AsString();b(a,e[r]),a==s&&(o=e[r])}return o}function v(){var t=E.library||"library.txt",e=this.GetS(t);return e||"library.txt"==t||(t="library.txt",e=this.GetS(t)),E.library=t,e&&(i=e.entity_filename||"entity.txt"),e}function g(t){return t.replace(/entity\.txt/,i).replace(/^config:/,WA_LAYOUT.path).replace(/simulation_fallbacks\.js/,WA_LAYOUT.sim_fallbacks).replace(/slide_fallbacks\.js/,WA_LAYOUT.slide_fallbacks)}function y(t,e){if(0===t.indexOf("mgr:")&&TRACKING.backend.collaborator.Available()){var i=e.GetBase().replace(/\/(%7E|~)tag\/published/,"").replace(/\/[^\/]+?\/[^\/]+?$/,"");e.SetServerBase(i)}}window.DATA={INDEX_HTML:"index.html",MACROSET:DEBUG?["simulation_defaults.js","simulation_help.js","simulation_pp.js","simulation.js","simulation_branchform.js","simulation_action.js","simulation_quiz.js"]:["simulationr.js"],SLIDE_RENDERER:DEBUG?"slide/slide.htm":"slide.htm",MULTI_FILE_ID:"multi_file_",MULTI_FILE_MAP_ID:"multi_file_map_",SKIN_PREFIX:"adaptable!",CACHING_MODE:CACHING_MODES.FULL,HTML_STYLES_CSS:"adaptable!text_styles:text_styles.css",TEXT_STYLES:"text_styles",DEFAULT_LANGUAGE:WCT.language.DEFAULT,LANGUAGE_SOURCES:["glossary:textatoms."],BOOT_FF_REBOOT:"FF_REBOOT",BOOT_ERROR:"ERROR",BOOT_OK:"OK",BOOT_REOPEN:"REOPEN",BOOT_TOPMOST:"TOPMOST",BOOT_ERROR_PAGE:"ERRORPAGE",CFG_KEYS:{lesson:["keys_play","keys_pause","keys_stop","keys_back","keys_next","keys_show_highlight","keys_focus_bar","keys_focus_panel","keys_focus_content"],book:["keys_stop","keys_back","keys_next","keys_focus_bar","keys_focus_panel","keys_focus_content"],slide:["keys_stop","keys_focus_bar","keys_focus_panel","keys_focus_content"],library:["keys_stop","keys_back","keys_next","keys_focus_bar","keys_focus_panel","keys_focus_content"],file:["keys_stop","keys_focus_bar","keys_focus_panel","keys_focus_content"]},CFG_VOLUME:["vol_master","vol_narrative","vol_booksound","vol_effects","disable_fx"],CFG_WINDOW:["title","window_cfg_top","window_cfg_left","window_cfg_width","window_cfg_height","window_cfg_orientation","window_cfg_name","window_cfg_features_fullscreen","window_cfg_features_menubar","window_cfg_features_toolbar","window_cfg_features_location","window_cfg_features_resizable","window_cfg_features_scrollbars","window_cfg_features_status","window_cfg_force"],CFG_TOPMOST:["topmost"],HELP_DEF_LANG:"en-US",HELP_LANGUAGES:{"de-DE":!0,"en-US":!0},HELP_LIBRARY_KEY:2001,HELP_LESSON_KEY:2022,HELP_BOOK_KEY:2003,LESSON_MODE:{demo:!0,uebung:!0,praxis:!0,test:!0,pres:!0,guided:!0},LESSON_TOUR_KEY:"Tour",SHARE_URL:"",context:new WCT.context,Cleanup:function(){for(var t in k.wnd=null,k.active=null,s)delete s[t];s={},i="entity.txt",e=null,WCT.CleanupObject(E),E={},R=w="",WCT.CleanupObject(l),l=null,WCT.CleanupObject(h),h={},WCT.CleanupObject(f),p=0,f={},u={},this.context&&this.context.Destructor(),this.context=new WCT.context},InitLight:function(){var t=this.context;t.Set("glossary","standard"),t.Set("style","default"),t.Set("trainer","standard"),PLATFORM.IOS&&PLATFORM.VERSION<7&&(this.CACHING_MODE=CACHING_MODES.MOBILE);var e=location,i=0<=e.href.indexOf("?"),s=0<=e.href.indexOf("#"),n=unescape(e.href.split(i||!s?"?":"#")[0]),o=n.lastIndexOf("/"),r=n.lastIndexOf("\\"),a=-1,l="/";if(0<=o?a=o:0<=r&&(a=r,l="\\"),t.SetSlashType(l),R=unescape(e.search),e.hash){R.search(/&hash=/)&&(R=R.replace(/\&hash=[^&]+/,""));for(var c=e.hash.substr(1).split("&"),_=[],d=0,u=c.length;d<u;d++){var h=c[d];_.push((-1===h.search("=")?"hash=":"")+h)}_.length&&(R+="&"+_.join("&"))}if(R&&(0<=R.indexOf("&")||0<=R.indexOf("="))){var p=R.substr(1).split("&");R="";for(d=0,u=p.length;d<u;d++){var f=p[d].split("=");if("hash"==f[0].trim()){R="#"+f[1].trim(),p.splice(d,1);break}}w=unescape("?"+p.join("&"))}if(n=n.substr(0,0<=a?a:0),t.SetBase(n),t.Set("trainer",TRAINER_VERSION),E.version=TRAINER_VERSION,this.DEFAULT_LANGUAGE=WCT.language.FromBrowser(this.DEFAULT_LANGUAGE),w.length&&"?"==w.charAt(0)){var m=w.substr(1),b=m.indexOf("ctx=1");0<=b&&(m=m.substr(0,b+5)),WCT.ExtendObject(E,m.split("&").toMap({delimiter:"="}))}E.cache=!E.cache||WCT.ClampBoolean(E.cache),E.force_tablet?(BROWSER.TABLET=!0,BROWSER.MOBILE=!0):E.force_phone&&(BROWSER.PHONE=!0,BROWSER.MOBILE=!0);var v=null;window.opener?v=BROADCAST.SendClient(window.opener,"GetActiveManager"):parent&&parent.parent&&(v=BROADCAST.SendClient(parent.parent,"GetActiveManager"));var g=null;if(null!=v)try{v.MANAGER&&(g=v.MANAGER.GetUid())&&MANAGER.GetBase()!=v.MANAGER.GetBase()&&(g=null)}catch(S){g=null}if(g&&g!=MANAGER.GetUid()){k.wnd=v,k.active=!1;var y=BROADCAST.SendMaster("ClientInit",window);this.Parse(y)}else k.wnd=window,k.active=!0;var C=E.style;if(!C){var T=e.hash.match(/style=([^&]+)(&|$)/);C=T?T[1]:"default"}E.style=DEFAULTS.Clamp("style",C,!0),t.Set("style",E.style);var x=this.GetS("style:entity.txt");if(!x&&"default"!==E.style){x=this.GetS("style!default:entity.txt");var A=this.GetS("style:entity.txt");A?x=A:t.Set("style","default")}return x&&x.simulation_playback&&(WA_LAYOUT.path="adaptable!"+x.simulation_playback+":",x.text_styles&&(this.HTML_STYLES_CSS="adaptable!"+x.text_styles+":text_styles.css",this.TEXT_STYLES=x.text_styles)),E},InitFull:function(){var t=E,e=null,i=null;if(1==t.error)return{boot_status_:this.BOOT_ERROR_PAGE,msg:t.error_msg,opt:t.error_opt};if(t.handler_preloadfile&&this.GetS(t.handler_preloadfile),l={type:null},t.config&&!t.show){var s=t.config.split("/");s[2]=s[2].replace(/\..*$/,""),t.show=s[0]+"!"+s[1]+":"+s[2]}t.share_url&&(this.SHARE_URL=t.share_url);var n=null;if(t.show){var o=new WCT.address(t.show);l.full=o.AsString(),l.tclass=o.class_id,l.uid=o.local_id,"project"==o.class_id?this.LESSON_MODE[o.sub_path]?l.mode=o.sub_path:t.mode&&this.LESSON_MODE[t.mode]?l.mode=t.mode:l.filename=o.sub_path:l.filename=o.sub_path}else if(n=v.call(this,t.library))if(n.root){o=n.root;l.full=o.tclass+"!"+o.uid+(o.mode?":"+o.mode:""),l.tclass=o.tclass,l.uid=o.uid,l.mode=o.mode}else _="No Library Root!";if(l.filename&&!HANDLER.file.IsAcceptedExt(l.filename))return{boot_url_:this.context.ToAbsPath(l.full),boot_status_:this.BOOT_URL};if(l.uid){switch(c=!0,l.tclass){case"project":e=this.LESSON_MODE[l.mode]?(R?l.tourstop=R.substring(1):"tourstop"===o.sub_class_id&&(l.tourstop=o.sub_local_id),i=HANDLER.MODE.lesson,this.GetConfig("project",l.uid,l.mode)):(i=HANDLER.MODE.library,n||v.call(this,t.library),this.GetConfig("project",l.uid));break;case"book":R&&(l.bookmark=R.substring(1)),i=HANDLER.MODE.book,e=this.GetConfig("book",l.uid);break;case"slide":i=HANDLER.MODE.slide,e=this.GetConfig("slide",l.uid);break;case"group":R&&(l.bookmark=R.substring(1)),i=HANDLER.MODE.library,n||v.call(this,t.library),e=this.GetConfig("group",l.uid);break;case"cdoc":case"media":i=HANDLER.MODE[l.tclass],e=this.GetConfig(l.tclass,l.uid)}c=!1,l.filename&&(i=HANDLER.MODE.file)}if(!e||!i)return{boot_status_:BROWSER.FIREFOX&&"file"==this.context.GetProtocol()?this.BOOT_FF_REBOOT:this.BOOT_ERROR,boot_msg_:_};e.boot_status_=this.BOOT_OK,l.type=i,e.tr&&this.context.Set("glossary",e.tr),e.handler_preloadfile&&this.GetS(e.handler_preloadfile),a=this.ExtractWindowConfig(e);var r=this.RequiresNewWindow(a,!0);return BROWSER.IE&&BROWSER.VERSION<11&&l.type==HANDLER.MODE.lesson&&"praxis"==l.mode?(e.topmost=!0,e.boot_status_=this.BOOT_TOPMOST):k.active&&!BROWSER.MOBILE&&r&&(e.boot_status_=this.BOOT_REOPEN),e.boot_msg_=_,l.type==HANDLER.MODE.library&&e.lib_startentity&&(l.bookmark||(l.bookmark=e.lib_startentity),e.lib_startentity=""),e},GetConfig:function(){var t=arguments[0]||(l?l.tclass:null);if(!t)return null;var e=arguments[1],i=arguments[2],s=arguments[3];if("project"==t&&i){var n=["config:"+WA_LAYOUT.global,"config:"+WA_LAYOUT[i],"project!"+e+":"+i+".js"],o=this.GetS(n[2]);return this.context.Set("style",E.style||o&&o.style||DEFAULTS.style.d),m.call(this,n,s)}var r={book:"book",slide:"book",group:"lib",project:"lib",cdoc:"lib",media:"lib"}[t];n=["config:"+WA_LAYOUT.global,"config:"+WA_LAYOUT[r]];return e&&n.push(t+"!"+e+":entity.txt"),m.call(this,n,s)},ExtractWindowConfig:function(t){for(var e=this.CFG_WINDOW,i=null,s=0,n=null;n=e[s];s++)if("window_cfg_"==n.substr(0,11)){var o=null,r=DEFAULTS[n].t;if("string"==r){if(""==t[n])continue}else if("number"==r){if("number"!=typeof t[n]||t[n]<0)continue}else if("boolean"!=r)continue;if(null!=t[n]&&(o=t[n]),null!=o){i=i||{};var a=n.substr(11);"features_"==a.substr(0,9)?(i.features||(i.features={}),i.features[a.substr(9)]=o):i[a]=o}}return i},RequiresNewWindow:function(t){if(t.force)return!0;var e=arguments[1]||!1,i=a;for(var s in t)switch(s){case"top":case"left":case"width":case"height":if(-1!=t[s]&&(e||i[s]!=t[s]))return!0}var n=t.features,o=i.features;if(!n)return!1;if(!o)return!0;for(var s in n)switch(s){case"fullscreen":if(e&&n[s]||!e&&o[s]!=n[s])return!0;break;case"menubar":case"toolbar":case"location":case"resizable":case"scrollbars":case"status":if(e&&!n[s]||!e&&o[s]!=n[s])return!0}return!1},GetWindowConfig:function(){return a},GetUrlParams:function(){return E},GetUrlSearch:function(){if(arguments[0]){var t=w.indexOf("ctx=1");return 0<=t?{search:"&"==w.charAt(t-1)?w.substr(0,t-1):w.substr(0,t),ctx:w.substr(t)}:{search:w,ctx:""}}return w},GetUrlHash:function(){return R},GetStartObject:function(){return l},OmitRequest:function(t){var e=this.context.Resolve(t);"undefined"==typeof h[e]&&(h[e]=null)},SetEntityFilter:function(t){i=null==t?null!=e?e:"entity.txt":(null==e&&(e=i),"entity"+t+".txt")},GetS:function(t){var e=arguments[2]||this.context;y(t,e),t=g(t);var i=e.Resolve(t);if("undefined"!=typeof h[i])return h[i];var s=null;if(k.active){if(u[i]&&(this.GetS(u[i]),"undefined"!=typeof h[i]))return h[i];d++;var n=null!=arguments[1]?arguments[1]:"eval",o=e.ToAbsPath(t);if(E.cache||".server"===i||(o+="?"+Date.now()),s=XHR.GetS(o,n),d--,"XML"==n){if(!arguments[3])return s;s=arguments[3](s)}}else d++,s=(s=BROADCAST.SendMaster("GetData",t,arguments[1],e.Stringify()))?JSON.parse(s):null,d--;return r.call(this,t,s)},GetSM:function(t){if(!TRACKING.backend.collaborator.Available())return null;if(1==t.length)return this.GetS(t[0]);for(var e=arguments[1]||this.context,i=[],s=[],n=[],o=[],r=0,a=t.length;r<a;r++){var l=g(t[r]),c=e.Resolve(l);"undefined"==typeof h[c]?(i[r]=null,s.push({k:c,i:r}),n.push({method:"GET",url:e.ToRelPath(l),body:"{}"}),o.push(l)):i[r]=h[c]}if(!s.length)return i;var _=null;if(d++,_=k.active?(_=XHR.PostS(e.GetBase()+"/multiple_request",{request:n},"JSON"))&&_.response||null:(_=BROADCAST.SendMaster("GetDataM",JSON.stringify(o),e.Stringify()))?JSON.parse(_):null,d--,!_||_.length!=s.length)return i;for(r=0,a=s.length;r<a;r++)_[r]&&!_[r].error_message?(b(s[r].k,_[r]),i[s[r].i]=_[r]):b(s[r].k,null);return i},GetA:function(t,e,i){var s=arguments[4]||this.context;y(t),t=g(t);var n=s.Resolve(t);if("undefined"==typeof h[n]){var o=s.ToAbsPath(t);E.cache||(o+="?"+Date.now());var r=null!=arguments[3]?arguments[3]:"eval",a=p++;d++,f[a]={f:e,s:i,a:t,e:r,x:arguments[5]},XHR.GetA(o,this,function(t){d--,this.GetA_cb(a,t),a=null},function(){d--},r)}else e.call(i,h[n],t)},GetA_cb:function(t,e){var i=f[t];if(void 0!==i){if(delete f[t],"XML"==i.e){if(!i.x)return void i.f.call(i.s,e,i.a);e=i.x(e)}e=r.call(this,i.a,e),i.f.call(i.s,e,i.a)}},GetAll:function(t){0<d?WCT.SetTimeout(this.GetAll,100,this,[t]):this.GetA(t+":entity.txt",this.GetAll_cb,this)},GetAll_cb:function(t,e){if(t&&t.assets)for(var i=0,s=null;s=t.assets[i++];)s.tclass&&s.uid&&this.GetAll(s.tclass+"!"+s.uid)},SetActiveManager:function(t){var e=null;try{e=t.MANAGER.GetUid()}catch(s){}if(null!=e){if(k.active=!1,e==MANAGER.GetUid()){k.active=!0;var i=BROADCAST.SendMaster("ClientInit");this.Parse(i),MANAGER.InitTracking(),BROADCAST.SendMaster("NewMasterReady")}k.wnd=t}},GetActiveManager:function(){return k},AddClient:function(t){var e=null;try{e=t.MANAGER.GetUid()}catch(i){}null!=e&&(s[e]=t)},RemoveClient:function(t){delete s[t]},HasClients:function(){for(var t in s)return!0;return!1},GetClients:function(){return s},GetSlideRendererUrl:function(){var t=arguments[0]||{};t.edit_mode=0,t.t2=1,t.uid=WCT.uid.Generate("6");var e=[];for(var i in t)e.push(i+"="+t[i]);arguments[1]&&e.push("hash="+arguments[1]),t=e.join("&");var s="trainer:"+DATA.SLIDE_RENDERER;return(s=this.context.ToAbsPath(s))+(t?"#"+t:"")},Stringify:function(){return JSON.stringify({cache:h,wa_layout:WA_LAYOUT,mfm:u})},Parse:function(t){t&&(t=JSON.parse(t),h=t.cache,WA_LAYOUT=t.wa_layout,u=t.mfm)},Trans:function(t){var e=arguments[1]||this.DEFAULT_LANGUAGE;if("mul"==e&&(e="en-US"),h["lang!"+e])return null!=(u=h["lang!"+e][t])?u:"["+t+"]";var i=this.LANGUAGE_SOURCES,s=this.DEFAULT_LANGUAGE,n={},o=null;"standard"!=this.context.Get("glossary")&&(o=new WCT.context(this.context)).Set("glossary","standard");for(var r=0,a=null;a=i[r];r++){var l=a+e+".txt";if(o){var c=this.GetS(l,""),_=this.GetS(l,"",o);if(c||_||e==s||(l=a+s+".txt",c=this.GetS(l,""),_=this.GetS(l,"",o)),_){if(_=WCT.localization.Parse(_),c)for(var d in c=WCT.localization.Parse(c))_[d]=c[d];b(l,_),WCT.ExtendObject(n,_)}else c&&(c=WCT.localization.Parse(c),b(l,_),WCT.ExtendObject(n,_))}else{var u;(u=this.GetS(l,""))||e==s||(l=a+s+".txt",u=this.GetS(l,"")),u&&(b(l,u=WCT.localization.Parse(u)),WCT.ExtendObject(n,u))}}return b("lang!"+e,n),null!=n[t]?n[t]:"["+t+"]"}}}();var SCORM_API=function(){var i={},s=!1;return{Enable:function(t){t?window.API_1484_11=this:window.API_1484_11&&(window.API_1484_11=null)},Initialize:function(){if(confirm("Restart?")){i=WCT.store.Get(WCT.store.KEYS.scorm_api)||"{}";try{i=JSON.parse(i)}catch(t){i={}}}else WCT.store.Remove(WCT.store.KEYS.scorm_api),i={};s=!0},Terminate:function(){s=!1},GetValue:function(t){return s&&"undefined"!=typeof i[t]?i[t]:null},SetValue:function(t,e){s&&(i[t]=e)},Commit:function(){}}}(),SOCKETS={Cleanup:function(){for(var t in SOCKETS)"Cleanup"!=t&&SOCKETS[t].Destructor()}};function Socket(t,e,i){var s=WCT.uid.Generate(8,"SOCK_");(SOCKETS[s]=this).uid_=s,this.url_=t,this.cb_=e,this.scope_=i,this.conn_=null}function SocketHandler(t,e){this.callback_=t,this.scope_=e,this.socket_=null,this.socket_tries_=0,this.socket_synch_=!1}function VolumeSlider(t,e,i){var s=arguments[3],n=arguments[4],o=arguments[5];this.vols_=s?WCT.DeepCopy(s):{},this.mutes_=n?WCT.DeepCopy(n):{};var r=MANAGER.handler.Get(t);this.hdl_uid_=t,this.uid_=WCT.uid.Generate(10,"VS"),this.id_=r.GetUid()+"#volume",this.dom_parent_=e,this.callback_=i,this.allow_mouse_close_=!1,this.timeout_=null,this.ctl_dom_=o||null,this.slider_ids_=[],VolumeSlider.CONTAINER[this.uid_]=this;var a=WCT.skin.Merge(VolumeSlider.SKIN,r.GetSkin("panel").hor.volume,!1,!0);if(a.channels){for(var l=[],c=0,_=0,d=a.channels.length;_<d;_++)chnl={id:a.channels[_],x:c,y:a.y,w:a.w,h:a.h-2*a.padding},0<_&&(chnl.border_color=a.separator_color,chnl.border_style="none none none "+a.separator_style,chnl.border_width=a.separator_width,c+=a.separator_width),a.background_color&&(chnl.background_color=a.background_color),l.push(chnl),c+=a.w;a.channels=l}var u=(this.skin_=a).font_size;VolumeSlider.CAP_H=Math.max(20,Math.max(u+a.channel_text_padding_t,a.audio_icon.h+a.audio_icon_margin_t+a.audio_icon_margin_b)),VolumeSlider.BOT_H=Math.max(16,Math.max(u+a.mute_text_padding_t,(a.checkbox_h||13)+a.checkbox_margin_t+a.checkbox_margin_b)),this.show_()}function TaskInfo(t,e){this.hdl_uid_=t,this.info_=e,this.uid_=t+"#"+(e.uid||"taskinfo"),this.fader_=null,this.loaded_=!1,this.created_=!1,this.visible_=!1,this.auto_h_=!1,this.content_h_=null,this.full_h_=null,this.skin_=null,this.mini_=!1,this.skin_d_={l:0,t:0,r:0,b:0},this.controls_=[],this.dnd_=null,this.viewport_dim_=null,this.cur_x_=0,this.cur_y_=0,this.dragged_=!1,this.ctx_={hdl_uid_:t,taskinfo_:this,Cleanup:function(){this.taskinfo_=null},cfg_show:function(){var t=MANAGER.handler.Get(this.hdl_uid_),e=t?t.GetSlideCtx(0):null;e&&e.cfg_show.apply(e,arguments)}}}function Searchfield(t){var e=t.hdl_id,i=t.id,s=t.skin,n=t.dom,o=t.rtl||!1;this.hdl_id_=e,this.id_=i,this.onsearch_=t.onsearch,this.scope_=t.scope,this.rtl_=o,this.skin_=s;i=e+"#"+i;var r=$$("div");r.id=i,r.style.position="absolute",r.style.height=s.h+"px",n.appendChild(r),Searchfield.STORE[i]=this,i+="#";var a=$$("div");a.id=i+"bg",a.className="trainer-search",a.style.position="absolute",WCT.skin.ApplyMargin(a,s),a.style.borderWidth=(s.input_border_w||s.border_width)+"px",a.style.borderStyle=s.input_border_style||"solid",a.style.borderColor=s.input_border_color||"#999 #666 #666 #999",s.input_border_radius&&(a.style.borderRadius=s.input_border_radius+"px"),a.style.backgroundColor="#fff",r.appendChild(a);var l=MANAGER.handler.Get(e),c=WCT.dom.CreateInputElement("text");if(o&&(c.style.direction="rtl"),c.id=i+"ip",c.setAttribute("autocorrect","off"),c.setAttribute("autocomplete","off"),c.setAttribute("placeholder",l.Trans("SEARCH")),c.style.border="0",c.style.position="absolute",c.setAttribute("role","search"),s.font_size&&(c.style.fontSize=s.font_size+"px"),s.input_font_size&&(c.style.fontSize=s.input_font_size),BROWSER.MOBILE?c.onblur=function(t){window.parent&&window.parent.scrollTo(0,0)}:c.style.WebkitAppearance="none",c.onkeyup=Searchfield.OnKeyup,a.appendChild(c),s.clear){o&&(s.clear.x=WCT.skin.ConvertXToRtl(s.clear.x));var _=MANAGER.handler.Get(this.hdl_id_);SKIN.control.Add({id:i+"clear",skin:s.clear,dom:r,tag:"button",title:_.Trans("SEARCH_CLEAR"),onexec:Searchfield.OnClear,scope:this}),SKIN.control.Visible(i+"clear",!1,"visibility")}s.magnifier&&(o&&(s.magnifier.x=WCT.skin.ConvertXToRtl(s.magnifier.x)),SKIN.control.Add({id:i+"magni",skin:s.magnifier,dom:r,tabindex:-1,role:"presentation"}).style.cursor="default")}Socket.OnEvent=function(t,e,i){var s=SOCKETS[t];if(s)switch(e){case"open":case"close":s.cb_&&s.cb_.call(s.scope_,e);break;case"error":case"message":s.cb_&&s.cb_.call(s.scope_,e,i.data)}},Socket.prototype={Destructor:function(){this.Close(),delete SOCKETS[this.uid_],this.cb_=null,this.scope_=null},Open:function(){var t=this.conn_;if(t&&t.readyState<=1)return!0;var e=this.uid_,i=window.WebSocket||window.MozWebSocket;try{t=i?new i("ws://"+this.url_):null}catch(s){t=null}return!!(this.conn_=t)&&(t.onopen=function(t){Socket.OnEvent(e,"open",t)},t.onmessage=function(t){Socket.OnEvent(e,"message",t)},t.onerror=function(t){Socket.OnEvent(e,"error",t)},t.onclose=function(t){Socket.OnEvent(e,"close",t)},!0)},Close:function(){this.conn_&&this.conn_.close(),this.conn_=null},Send:function(t){var e=this.conn_;e&&1==e.readyState&&e.send(t)},GetState:function(){return c?c.readyState:null}},SocketHandler.MAX_SOCKET_RECONNECTS=3,SocketHandler.OnSocket=function(t){var e={cing:!1,open:!1,sync:!1,disc:!1},i=this.socket_;switch(t){case"error":return;case"open":this.socket_synch_=!1,this.socket_tries_=0,this.socket_.Send("HELO"),e.open=!0;break;case"init":i||(i=new Socket(document.location.host+"/",SocketHandler.OnSocket,this),this.socket_synch_=!1,this.socket_tries_=0,this.socket_=i);case"close":if(e.disc=!0,!i)break;++this.socket_tries_<SocketHandler.MAX_SOCKET_RECONNECTS?(e.disc=!1,e.cing=!0,i.Open()||WCT.SetTimeout(SocketHandler.OnSocket,100,this,["close"])):(this.socket_=null,i.Destructor());break;case"message":var s=arguments[1];this.socket_synch_=s,e.sync=!0;break;case"sync":if(!i)return;if(!1!==this.socket_synch_){e.sync=!0;break}case"unsync":if(!i)return;e.open=!0}e.conn=!1!==this.socket_synch_,e.message=this.socket_synch_,this.callback_.call(this.scope_,e)},SocketHandler.prototype={Destructor:function(){if(this.callback_=null,this.scope_=null,this.socket_){var t=this.socket_;this.socket_=null,t.Destructor()}this.socket_synch_=null},Init:function(){SocketHandler.OnSocket.call(this,"init")},Sync:function(){SocketHandler.OnSocket.call(this,"sync")},Unsync:function(){SocketHandler.OnSocket.call(this,"unsync")}},function(){function v(t){for(var e=this.treeindex_;t&&"book"!=t.tclass;)t=e[t.par];return t?t.tclass+"!"+t.uid:null}function g(t,e){var i=this.list_,s=this.treeindex_,n=s[s[t.tree_nbr].par],o=n?n.subtree:[],r=o.indexOfAtt(t.tree_nbr,"nbr");if(0<=r)for(var a,l=e?1:-1;a=o[r+=l];){var c=null!=a.list_idx?i[a.list_idx].order_idx:null;if(null!=c)return c}return null}function u(t){for(var e=this.list_,i=e.indexOfAtt(t,"order_idx"),s=e[i].level;e[i-1]&&e[i-1].level==s;)i--;return e[i].order_idx}function y(t,e){var i=this.list_,s=this.entities_,n=s.cdoc,o=this.cdoc_,r=s.media,a=this.media;a=a.video||a.audio||a.image||a.other||a.doc;for(var l,c=i[t],_="cdoc"==c.tclass&&(n[c.uid].order.length||!o)||"media"==c.tclass&&(r[c.uid].order.length||!a),d=e?1:-1;l=i[t+=d];)switch(l.tclass){case"book":case"group":_=!0;break;case"media":if(a){if(l.order_idx&&(_||r[l.uid].order.length||l.level!=c.level))return 0<d?l.order_idx:u.call(this,l.order_idx)}else _=!0;break;case"cdoc":if(o){if(l.order_idx&&(_||n[l.uid].order.length||l.level!=c.level))return 0<d?l.order_idx:u.call(this,l.order_idx)}else _=!0;break;case"slide":if(l.order_idx&&(_||l.level!=c.level))return 0<d?l.order_idx:u.call(this,l.order_idx)}return null}window.Toc=function(t,e){var i=arguments[2]||{};this.tclass_=t,this.uid_=e,this.cdoc_=i.cdoc||!1,this.media=i.media,this.book_group_=i.book_group||!1,this.project_=i.project||!1,this.has_mngr_=TRACKING.backend.collaborator.Available(),this.entities_={book:{},slide:{},group:{},project:{},cdoc:{},media:{}},this.list_=[],this.tree_=[],this.order_=[],this.navi_={},this.keywords_={},this.treeindex_={},this._hidden=[],this._slideCnt=0,function m(t,e,i){var s=this.entities_;if("slide"!=t&&s[t][e])return!1;var n=DATA.GetS(t+"!"+e+":entity.txt");if(!n)return!1;var o={tclass:t,subType:n.sub_type||"",uid:e,caption:n.caption||"",shortdesc:n.shortdesc||"",description:n.description||"",assets:WCT.DeepCopy(n.assets||[]),hidden_in_toc:"undefined"!=typeof n.hidden_in_toc&&WCT.ClampBoolean(n.hidden_in_toc),pageset:[],order:[],parents:[],visited:!1};if("media"===t){var r=o.subType;if("pdf"==r&&(r="doc"),!this.media[r])return!1}if(s[t][e]=o,"slide"===t&&this._slideCnt++,o.hidden_in_toc&&this._hidden.push(this._slideCnt),{slide:1,cdoc:1}[t]&&(o.keywords=n.keywords||""),"slide"==t)return o.language=n.language||"",o.assets=[],!0;if(this.has_mngr_){for(var a=[],l=0,c=null;c=o.assets[l];l++)switch(c.tclass){case"slide":case"project":case"group":case"cdoc":case"media":case"book":a.push(c.tclass+"!"+c.uid+":entity.txt")}a.length&&DATA.GetSM(a)}var _=this.cdoc_,d=this.project_,u=this.book_group_,h=this.media,p={slide:1,project:1,group:1,cdoc:1,book:1,media:1};for(l=0,c=null;c=o.assets[l++];)if(p[c.tclass]){var f="book"!=c.tclass?i:c.uid;m.call(this,c.tclass,c.uid,f)?(o.order.push(c.tclass+"!"+c.uid),s[c.tclass][c.uid].parents.push(t+"!"+e),("slide"===c.tclass||u&&("group"===c.tclass||"book"===c.tclass)||_&&"cdoc"===c.tclass||d&&"project"===c.tclass||h&&"media"===c.tclass)&&s.book[i].pageset.push(c.uid)):o.assets.splice(--l,1)}return u&&e==i&&s.book[e].pageset.push(e),!0}.call(this,t,e,e)&&!1!==i.full_setup&&(function d(t,e){if(!("slide"===t||this.cdoc_&&"cdoc"===t||this.media&&"media"===t||this.project_&&"project"===t||this.book_group_&&("book"===t||"group"===t))){for(var i=this.entities_,s=i[t][e],n=WCT.DeepCopy(s.order),o=0,r=null;r=n[o++];)r=r.split("!"),d.call(this,r[0],r[1]);if(!s.order.length){var a=t+"!"+e,l=s.parents;for(o=0,r=null;r=l[o++];){var c=i[(r=r.split("!"))[0]][r[1]],_=c.order.indexOf(a);0<=_&&c.order.splice(_,1)}}}}.call(this,t,e),function _(t,e){var i=this.entities_[t][e],s=this.list_,n=s.length,o=arguments[2]||0;if(i=i||{},s.push({tclass:t,uid:e,caption:i.caption||"",level:o++,list_idx:n,hidden_in_toc:!!i.hidden_in_toc}),"slide"==t||this.cdoc_&&"cdoc"==t||this.media&&"media"===t||this.project_&&"project"==t||this.book_group_&&("book"==t||"group"==t)){var r=this.order_;s[n].order_idx=r.length,r.push(t+"!"+e)}for(var a=i.order||[],l=0,c=null;c=a[l++];)c=c.split("!"),_.call(this,c[0],c[1],o)}.call(this,t,e),function u(t,e,i){var s=this.entities_[t][e],n=arguments[3]||0,o="number"==typeof arguments[4]?arguments[4]:null,r=[],a={type:"Ref",tclass:t,caption:(s=s||{}).caption||"",shortdesc:s.shortdesc||"",description:s.description||"",uid:e,subtree:r,nbr:n,par:o};i.push(a),this.treeindex_[n]=a,o=n++;for(var l=s.assets||[],c=0,_=null;_=l[c++];)"Ref"==_.type||"undefined"==typeof _.type?n=u.call(this,_.tclass,_.uid,r,n,o):((_=WCT.DeepCopy(_)).nbr=n++,_.par=o,r.push(_));return n}.call(this,t,e,this.tree_),function r(t){for(var e=this.list_,i=arguments[1]||0,s=0,n=null;n=t[s++];){var o=e.indexOfAtt(n.uid,"uid",i);0<=o&&(e[n.list_idx=o].tree_nbr=n.nbr,i=o+1),n.subtree&&(i=r.call(this,n.subtree,i))}return i}.call(this,this.tree_),function b(){var t=this.list_,e=this.treeindex_,i=this.navi_,s=this.entities_,n=s.cdoc,o=s.media,r=this.cdoc_,a=this.media;a=a.video||a.audio||a.image||a.other||a.doc;for(var l=this.project_,c=this.book_group_,_=0,d=this.order_.length;_<d;_++){var u=t.indexOfAtt(_,"order_idx"),h=t[u],p=e[h.tree_nbr],f=e[p.par];switch(i[_]={book:v.call(this,p),chap:null,next:g.call(this,h,!0),prev:g.call(this,h,!1)},h.tclass){case"book":case"group":i[_].chap=h.tclass+"!"+h.uid;break;case"cdoc":case"media":"cdoc"!==h.tclass||!n[h.uid].order.length&&r?"media"!==h.tclass||!o[h.uid].order.length&&a||(i[_].chap="media!"+h.uid):i[_].chap="cdoc!"+h.uid;case"project":if("project"==h.tclass&&!l)break;case"slide":if(!f)break;i[_].chap||(i[_].chap=f.tclass+"!"+f.uid),c||(i[_].next=y.call(this,u,!0),i[_].prev=y.call(this,u,!1))}}}.call(this),function l(){var t=this.entities_,e=WCT.DeepCopy(t.slide,t.cdoc),i=this.keywords_;for(var s in e)for(var n=e[s].keywords.split(","),o=0,r=n.length;o<r;o++){var a=n[o].trim();a&&(i[a]||(i[a]=[]),i[a].push({uid:s,caption:e[s].caption}))}}.call(this))},window.Toc.prototype={Destructor:function(){this.tclass_=null,this.uid_=null,WCT.CleanupObject(this.entities_),WCT.CleanupObject(this.list_),WCT.CleanupObject(this.tree_),WCT.CleanupObject(this.order_),WCT.CleanupObject(this.navi_),WCT.CleanupObject(this.keywords_),WCT.CleanupObject(this.treeindex_),this.entities_=null,this.list_=null,this.tree_=null,this.order_=null,this.navi_=null,this.keywords_=null,this.treeindex_=null},GetBooks:function(){return this.entities_.book},GetProjects:function(){return this.entities_.project},GetList:function(){return this.list_},GetTree:function(){return this.tree_},GetKeywords:function(){return this.keywords_},GetSlideCount:function(){return this.order_.length},GetBook:function(t){var e=this.navi_[t];return e&&e.book?(e=e.book.split("!"),this.entities_[e[0]][e[1]]):null},GetChapter:function(t){var e=this.navi_[t];return e&&e.chap?(e=e.chap.split("!"),this.entities_[e[0]][e[1]]):null},GetSlide:function(t){var e=this.order_[t];return e?(e=e.split("!"),this.entities_[e[0]][e[1]]):null},GetSlideOrderIdx:function(t,e){switch(t){case"prev":case"next":var i=this.navi_[e];return i&&null!=i[t]?i[t]:null;case"cur":var s=this.list_;if("uid"==(arguments[2]||"uid")){var n=null,o=e;0<=o.indexOf("!")&&(n=(o=o.split("!"))[0],o=o[1]);var r=null;if(n)for(var a=0,l=null;l=s[a];a++)if(l.tclass==n&&l.uid==o){r=a;break}if(null==r&&(r=s.indexOfAtt(e,"uid")),"number"==typeof(r=s[r]?s[r].order_idx:null))return r}else{for(;s[e]&&null==s[e].order_idx;)e++;if(null!=s[e].order_idx)return s[e].order_idx}}return null},GetSlideListIdx:function(t){var e=this.list_.indexOfAtt(t,"order_idx");return 0<=e?e:null},GetListItems:function(t,e){for(var i=[],s=0,n=this.list_,o=null;o=n[s];s++)o.tclass==t&&o.uid==e&&i.push(o);return i},MarkVisited:function(t){var e=arguments[1]||"slide",i=this.entities_,s=i[e]&&i[e][t]||null;if(s){s.visited=!0;for(var n=this.cdoc_,o=this.book_group_,r=this.project_,a=0,l=null;l=s.parents[a++];){var c=l.split("!"),_=c[0];if(!(n&&"cdoc"==_||r&&"project"==_||o&&{book:1,group:1}[_])){for(var d=c[1],u=i[_][d],h=!0,p=0,f=null;f=u.order[p++];){var m=f.split("!"),b=m[0],v=m[1];if(!i[b][v].visited){h=!1;break}}h&&this.MarkVisited(d,_)}}}},IsVisited:function(t,e){var i=this.entities_[t];return i&&i[e]&&i[e].visited||!1},GetVisited:function(){var t=this.entities_,e=[];for(var i in t){var s=t[i];for(var n in s)s[n].visited&&e.push(s[n])}return e},GetHidden:function(){return this._hidden}}}(),WCT.ExtendObject(VolumeSlider,{SUPPORTED_CHANNELS:{Master:!0,Booksound:!0,Pagesound:!0,Narrative:!0,Effects:!0},FX_CHANNEL:"Effects",DEFAULT:50,TIMEOUT:200,CONTAINER:{},SKIN:{w:80,h:154,border_color:"#EFEFEF",border_width:1,border_style:"solid",font_family:"Arial",font_size:12,text_color:"#000000",padding:1,checkbox_margin_t:0,checkbox_margin_r:3,checkbox_margin_b:0,checkbox_margin_l:2,separator_color:"#999999",separator_style:"solid",separator_width:1,channel_text_padding_t:0,mute_text_padding_t:0,audio_icon_margin_t:0,audio_icon_margin_r:0,audio_icon_margin_b:0,audio_icon_margin_l:0},Cleanup:function(){var t=VolumeSlider.CONTAINER;for(var e in t)t[e].Destructor(),delete t[e]},OnOver:function(t){for(var e=(t=WCT.event.Standardize(t)).target;e&&!e.getAttribute("vs_uid");)e=e.parentNode;var i=e&&e.getAttribute("vs_uid")||null;if(i){var s=VolumeSlider.CONTAINER[i]||null;s&&(s.allow_mouse_close_=!0,s.timeout_&&WCT.ClearTimeout(s.timeout_))}},OnOut:function(t){for(var e=(t=WCT.event.Standardize(t)).target;e&&!e.getAttribute("vs_uid");)e=e.parentNode;var i=e&&e.getAttribute("vs_uid")||null;if(i){var s=VolumeSlider.CONTAINER[i]||null;s&&s.allow_mouse_close_&&(s.timeout_=WCT.SetTimeout(VolumeSlider.Close,250,VolumeSlider,[s.uid_]))}},Close:function(t){var e=VolumeSlider.CONTAINER[t]||null;if(e){var i=MANAGER.handler.Get(e.hdl_uid_);e.callback_.call(i,"close")}},OnMute:function(t){if(t.isTrusted){var e=WCT.event.Standardize(t),i=e.target&&e.target.getAttribute("vs_uid")||null;if(i){var s=VolumeSlider.CONTAINER[i]||null;if(s){var n=e.target.id.split("#"),o=n[n.length-3],r=e.target.checked;arguments[1]&&(r=!r);var a=MANAGER.handler.Get(s.hdl_uid_);s.mutes_[o]=r,s.SetMute(o,r),s.callback_.call(a,"mute",o,r)}}}},OnMuteKey:function(t){32===WCT.event.Standardize(t).button&&VolumeSlider.OnMute(t,!0)}}),VolumeSlider.prototype=function(){function H(t,e){var i={38:5,40:-5}[e.button],s=t.split("#")[3];if(i&&s){var n=this.vols_[s]+i;this.SetVolume(s,Math.max(0,Math.min(100,n)));var o=MANAGER.handler.Get(this.hdl_uid_);this.callback_.call(o,"volume",s,n)}}function B(t,e){var i=$(t);if(i){var s=this.skin_,n=WCT.dom.GetPosition(i.parentNode,!0),o=VolumeSlider.BOT_H,r=VolumeSlider.CAP_H,a=new WCT.dnd(i,null,!1);a.Restrict("x",!0),a.Restrict("y",!1,r+s.padding,s.h-s.padding-o-s.slider_icon.h),a.SetCallback("onend",l,this),"touchstart"==e.type?a.Begin(e.changedTouches[arguments[2]],!0):a.Begin(e),a.SetStartPos(n.left,n.top+(i.offsetHeight>>1)),this.dnd_=a}}function l(t){var e=this.skin_;if(e){var i=t.id.split("#"),s=i[i.length-2],n=e.h-VolumeSlider.CAP_H-VolumeSlider.BOT_H-2*e.padding-e.slider_icon.h,o=Math.round(100*(t.offsetTop-VolumeSlider.CAP_H-e.padding)/n),r=MANAGER.handler.Get(this.hdl_uid_);o=100-Math.max(0,Math.min(100,o)),t.setAttribute("aria-valuenow",o),this.vols_[s]=o,this.callback_.call(r,"volume",s,o)}}return{Destructor:function(){if(delete VolumeSlider.CONTAINER[this.uid_],this.timeout_&&(WCT.ClearTimeout(this.timeout_),this.timeout_=null),this.slider_ids_){for(var t=this.slider_ids_.length-1;0<=t;t--)SKIN.control.Cleanup(this.slider_ids_[t]);this.slider_ids_=null}this.skin_=null,this.dom_parent_=null,this.callback_=null,this.vols_=null,this.mutes_=null,this.hdl_uid_=null,this.ctl_dom_=null;var e=$(this.id_+"#main");t=$(this.id_+"#iframe");e&&(e.onmouseover=null,e.parentNode&&e.parentNode.removeChild(e)),t&&t.parentNode&&t.parentNode.removeChild(t)},SetVolume:function(t,e){var i=$(this.id_+"#main#"+t+"#slider_ico");if(i&&this.skin_&&this.skin_.slider_icon){"number"!=typeof e&&(e=VolumeSlider.DEFAULT);var s=this.skin_,n=s.h-VolumeSlider.CAP_H-VolumeSlider.BOT_H,o=s.slider_icon.h,r=Math.round((n-o)/100*(100-e))+VolumeSlider.CAP_H+s.padding;i.style.top=r+"px",i.setAttribute("aria-valuenow",e),this.vols_[t]=e}},SetMute:function(t,e){var i=this.id_+"#main#"+t,s=$(i+"#bottom#mute");if(s){"boolean"==typeof e||(e=!1),s.checked=e?"checked":"";var n=$(i+"#ico");if(n){var o=this.skin_,r=e?o.audio_icon_d:o.audio_icon;WCT.skin.ApplyBgImage(n,r),WCT.skin.ApplyPosition(n,{w:r.w,h:r.h})}var a=i+"#slider_ico";SKIN.control.Enabled(a,!e)}},show_:function(){var t=function _(){var t=this.id_,e=this.skin_,i=MANAGER.handler.Get(this.hdl_uid_),s=WCT.iframe.Create();WCT.skin.ApplyBorder(s,e),s.id=t+"#iframe",s.tabIndex=-1,s.setAttribute("role","presentation"),s.style.height=e.h+"px",s.style.borderColor="transparent",s.style.backgroundColor="#fff",s.style.opacity="0.01",s.setAttribute("vs_uid",this.uid_);var n=$$("div");WCT.skin.ApplyBorder(n,e),WCT.dom.NotSelectable(n),n.id=t+"#main",n.tabIndex=0,n.setAttribute("role","application"),n.setAttribute("aria-label",i.Trans("VOLUME")),n.style.height=e.h+"px",n.style.position="absolute",n.setAttribute("vs_uid",this.uid_);var o=this.dom_parent_;return o.appendChild(s),o.appendChild(n),n.onmouseover=VolumeSlider.OnOver,n.onmouseout=VolumeSlider.OnOut,n.focus(),{dom:n,iframe:s}}.call(this);(function P(t){for(var e=t.dom,i=t.iframe,s=this.skin_,n=s.channels||[],o=VolumeSlider.CAP_H,r=VolumeSlider.BOT_H,a=this.slider_ids_,l=this.uid_,c=this.vols_,_=this.mutes_,d=this.id_+"#main#",u=VolumeSlider.SUPPORTED_CHANNELS,h=0,p=-1,f=MANAGER.handler.Get(this.hdl_uid_),m=f.GetConfig("disable_fx"),b=VolumeSlider.FX_CHANNEL,v=0,g=null;g=n[v];v++)if(u[g.id]&&(!m||g.id!=b)){h+=g.w,p++;var y=d+g.id,C=$$("div");C.id=y,C.setAttribute("role","slider"),C.setAttribute("aria-labelledby",y+"caption"),C.style.position="relative",WCT.skin.ApplyPosition(C,g),C.style.width=s.w-2*s.padding+"px",WCT.skin.ApplyTextFormats(C,g),WCT.skin.ApplyBorder(C,g),C.style.overflow="hidden",C.style.padding=s.padding+"px",e.appendChild(C),y+="#";var T=$$("label");if(T.id=y+"caption",T.style.display="block",T.style.height=o+"px",T.style.fontFamily=s.font_family,T.style.fontSize=s.font_size+"px",T.style.color=s.text_color,T.style.overflow="hidden",T.style.marginTop=s.channel_text_padding_t+"px",C.appendChild(T),s.audio_icon){var x=$$("div"),A=s.audio_icon;x.id=y+"ico",x.setAttribute("role","presentation"),WCT.skin.ApplyBgImage(x,A),WCT.skin.ApplyPosition(x,{x:s.padding,y:s.padding,w:A.w,h:A.h}),WCT.skin.ApplyMargin(x,{margin_left:s.audio_icon_margin_l,margin_right:s.audio_icon_margin_r,margin_top:s.audio_icon_margin_t,margin_bottom:s.audio_icon_margin_b}),T.appendChild(x),T.style.paddingLeft=s.audio_icon_margin_l+s.audio_icon_margin_r+A.w+2+"px"}var S=f.Trans("CHANNEL_"+g.id.toUpperCase()),k=document.createTextNode(S);T.setAttribute("title",g.id),T.appendChild(k);var E=s.slider_bg||{},w=E.w||0,R=$$("div");R.id=y+"slider_bg",E.id&&WCT.skin.ApplyBgImage(R,E),WCT.skin.ApplyPosition(R,{x:g.w-w>>1,y:o+s.padding,w:w,h:g.h-o-r}),R.setAttribute("role","presentation"),C.appendChild(R);var N=y+"slider_ico",G={image:s.slider_icon,image_h:s.slider_icon_h,image_a:s.slider_icon_a,image_d:s.slider_icon_d,x:g.w-s.slider_icon.w>>1,y:o+s.padding,w:s.slider_icon.w,h:s.slider_icon.h},O=SKIN.control.Add({id:N,skin:G,dom:C,tag:"button"});O.setAttribute("aria-label",f.Trans("VOLUME")+" "+S),O.setAttribute("aria-valuemin","0"),O.setAttribute("aria-valuemax","100"),SKIN.control.RegisterCallback(N,"mousedown",B,this),SKIN.control.RegisterCallback(N,"touchstart",B,this),SKIN.control.RegisterCallback(N,"keydown",H,this),SKIN.control.IgnoreEvent("click"),a.push(N),this.SetVolume(g.id,c[g.id]);var I=$$("div");I.id=y+"bottom",WCT.skin.ApplyPosition(I,{x:0,y:-s.padding,w:g.w,h:r}),I.style.fontFamily=s.font_family,I.style.fontSize=s.font_size+"px",I.style.color=s.text_color,I.style.lineHeight=r+"px",I.style.whiteSpace="nowrap",I.style.overflow="hidden";var M=WCT.dom.CreateInputElement("checkbox"),D=y+"bottom#mute";M.id=D,M.dataset.dispatchEnter="false",M.style.position="absolute",M.style.marginTop=s.checkbox_margin_t+"px",M.style.marginRight=s.checkbox_margin_r+"px",M.style.marginBottom=s.checkbox_margin_b+"px",M.style.marginLeft=s.padding+s.checkbox_margin_l+"px",M.style.verticalAlign="middle",s.checkbox_w&&(M.style.width=s.checkbox_w+"px"),s.checkbox_h&&(M.style.height=s.checkbox_h+"px"),M.setAttribute("vs_uid",l),M.onclick=VolumeSlider.OnMute,M.onkeyup=VolumeSlider.OnMuteKey;var W=$$("label"),L=f.Trans("AUDIO_MUTE");W.htmlFor=D,W.setAttribute("aria-label",L+" "+S),W.style.position="absolute",W.style.height=r+"px",W.style.paddingTop=s.mute_text_padding_t+"px",W.style.left=s.padding+s.checkbox_margin_l+s.checkbox_margin_r+(s.checkbox_w||13)+"px",W.innerHTML=L,I.appendChild(M),I.appendChild(W),C.appendChild(I),this.SetMute(g.id,_[g.id])}h+=p*s.separator_width,e.style.width=h+"px",i.style.width=h+"px"}).call(this,t);var e=this.ctl_dom_;if(e){var i=WCT.dom.GetPosition(this.ctl_dom_),s=e.offsetWidth,n=t.dom.offsetWidth,o=WCT.dom.GetWindowWidth(),r=i.left+(s>>1)-(n>>1);o<r+n+5?r=Math.max(0,o-n-5):r<5&&(r=5);var a=t.dom.offsetHeight,l=WCT.dom.GetWindowHeight(),c=i.top+e.offsetHeight+2;l<c+a+5&&(c=Math.max(0,i.top-a-5)),t.iframe.style.left=r+"px",t.iframe.style.top=c+"px",t.dom.style.left=r+"px",t.dom.style.top=c+"px",BROWSER.SAFARI&&(t.dom.style.display="none",t.dom.offsetHeight,t.dom.style.display=""),PLATFORM.IOS&&(t.dom.style.opacity=.999)}t.dom=null,t.iframe=null}}}(),TaskInfo.CSS_RELOAD_TIME=250,TaskInfo.prototype=function(){function f(t){var e=null;try{e=t.contentWindow.document}catch(i){}return e||null}function m(t){var e=this.info_,i=e&&!this.loaded_?f(t):null;if(i&&i.body){var s=MANAGER.handler.Get(this.hdl_uid_),n=s.GetContext(),o=$("customcss",i);o&&(o.href=n.ToAbsPath(DATA.HTML_STYLES_CSS)),i.body.className="dgo_text_container";var r=s.GetContentInfo().rtl;i.body.setAttribute("dir",r?"rtl":"ltr"),t.contentWindow.ctx=this.ctx_;var a=this.skin_d_,l=this.skin_.content||{},c=(l.padding_left||0)+(l.padding_right||0),_=i.createElement("div");i.body.style.backgroundColor=e.bgcolor,_.style.overflow="auto",_.style.width=Math.max(0,e.w-a.l-a.r-c)+"px",WCT.skin.ApplyPadding(_,l),PLATFORM.IOS&&(_.style.WebkitOverflowScrolling="touch"),n.Set("macro",e.macro_uid),n.SetScope("macro"),_.innerHTML=n.ResolveHtmlString(e.text),i.body.appendChild(_),this.loaded_=!0,WCT.SetTimeout(s.Resize,TaskInfo.CSS_RELOAD_TIME,s,[null,!0])}}function n(t){if(this.loaded_&&(!this.created_||arguments[1])){var e=this.uid_,i=MANAGER.handler.Get(this.hdl_uid_),s=$(e);if(s.tabIndex=0,s.setAttribute("role","dialog"),s.setAttribute("aria-labelledby",e+"#title"),s.setAttribute("aria-describedby",e+"#content"),i&&s){var n=$(e+"#content"),o=n&&f(n),r=o&&o.body;if(o=(o=r&&r.getElementsByTagName("div"))&&o[0]){var a,l=this.info_,c=this.skin_d_;this.created_?a=this.content_h_:(a=this.auto_h_?o.offsetHeight:l.h-c.t-c.b,this.content_h_=a),a+c.t+c.b+t.y+10>=t.h&&(a=Math.max(0,t.h-t.y-c.t-c.b-10)),a=Math.max(c.min_h-c.t-c.b,a);var _=this.skin_,d=_.content||{},u=(d.padding_top||0)+(d.padding_bottom||0),h=a+c.t+c.b;s.style.height=h+"px",n.style.height=a+"px",o.style.height=Math.max(0,a-u)+"px",this.full_h_=h,b.call(this,s,t);var p=$(e+"#frame");p&&p.parentNode.removeChild(p),(p=$$("div")).id=e+"#frame",s.insertBefore(p,s.firstChild),SKIN.popup.CreateFrame(p,_.frame,{id:e+"#frame#",w:l.w,h:h}),this.created_=!0,T.call(this),this.Visible(this.visible_)}}}}function b(t,e){if(this.dragged_)(function _(t,e){var i=this.info_.w,s=this.info_.h,n=this.cur_x_,o=this.cur_y_,r=e.x,a=e.y,l=e.w+r,c=e.h+a;l<n+i&&r<n&&0<l-i&&(t.style.left=l-i+"px",this.cur_x_=l-i),c<o+s&&a<o&&s<c&&(t.style.top=c-s+"px",this.cur_y_=c-s)}).call(this,t,e);else{var i=this.info_,s=this.full_h_;"left"==i.x.s&&"auto"!=i.x.v?t.style.left=e.x+"px":"right"==i.x.s&&0==e.x?t.style.left=e.w-i.w+"px":"auto"==i.x.v?t.style.left=Math.max(e.x,e.w-i.w>>1)+"px":(t.style.left="",t.style.right="",t.style[i.x.s]=i.x.v+"px"),"top"==i.y.s&&"auto"!=i.y.v?t.style.top=e.y+"px":"bottom"==i.y.s&&0==e.y?t.style.top=e.h-s+"px":"auto"==i.y.v?t.style.top=Math.max(e.y,e.h-s>>1)+"px":(t.style.top="",t.style.bottom="",t.style[i.y.s]=i.y.v+"px")}}function v(t,e,i){var s=MANAGER.handler.Get(this.hdl_uid_);if(s&&e[t]){var n={skins:this.controls_,oncontrol:a,scope:this,rtl:s.GetContentInfo().rtl},o=WCT.DeepCopy(e[t]);n.id=this.uid_+"#"+t,n.title=s.Trans(o.tooltip||"");var r=SKIN.popup.CreateControl(i,o,n);r.tabIndex=0,r.setAttribute("role","button"),r&&"restore"==t&&SKIN.control.Visible(n.id,!1)}}function a(t,e){switch(t=t.split("#").top()){case"exit":this.Close();break;case"minimize":if(this.mini_)return;this.mini_=!0;var i=this.skin_d_,s=WCT.DeepCopy(this.viewport_dim_);s.h=i.min_h-i.t-i.b,o.call(this,!0),n.call(this,s,!0),o.call(this),SKIN.control.Visible(this.uid_+"#minimize",!1),SKIN.control.Visible(this.uid_+"#restore",!0);break;case"restore":if(!this.mini_)return;this.mini_=!1,o.call(this,!0),n.call(this,this.viewport_dim_,!0),o.call(this),SKIN.control.Visible(this.uid_+"#restore",!1),SKIN.control.Visible(this.uid_+"#minimize",!0)}}function g(){a.call(this,"#exit",null,!0)}function o(){var t=$(this.uid_);t&&(arguments[0]?(this.cur_x_=t.offsetLeft,this.cur_y_=t.offsetTop):(t.style.left=this.cur_x_+"px",t.style.top=this.cur_y_+"px"))}function y(t){if(this.viewport_dim_){var e=this.viewport_dim_,i=$$("div");i.id=this.uid_+"#sr_cover",i.style.position="absolute",i.style.left=e.x+"px",i.style.top=e.y+"px",i.style.width=e.w+"px",i.style.height=e.h+"px",t.parentNode.insertBefore(i,t);var s=this.skin_d_,n=$$("div");n.id=this.uid_+"#tw_cover",n.style.position="absolute",n.style.left=s.l+"px",n.style.top=s.t+"px",n.style.width=this.info_.w-s.l-s.r+"px",n.style.height=this.content_h_+"px",t.appendChild(n)}}function C(){var t=$(this.uid_+"#sr_cover");t&&t.parentNode.removeChild(t),(t=$(this.uid_+"#tw_cover"))&&t.parentNode.removeChild(t),this.dragged_=!0;var e=$(this.uid_);e&&(this.cur_x_=e.offsetLeft,this.cur_y_=e.offsetTop)}function T(){var t=this.viewport_dim_,e=this.dnd_;if(t&&e){var i=t.x,s=t.w-this.info_.w+t.x;e.Restrict("x",i==s,i,s);var n=t.y,o=t.h-this.full_h_+t.y;e.Restrict("y",n==o,n,o)}}return{Destructor:function(){if(this.ctx_&&(this.ctx_.Cleanup(),this.ctx_=null),this.controls_){for(var t=0,e=null;e=this.controls_[t];t++)SKIN[e.t].Cleanup(e.i),this.controls_[t]=null;this.controls_=null}this.dnd_&&(this.dnd_.Destructor(),this.dnd_=null),this.fader_&&(this.fader_.Destructor(),this.fader_=null);var i=$(this.uid_);i&&i.parentNode.removeChild(i),this.info_=null,this.skin_=null,this.skin_d_=null,this.viewport_dim_=null},Resize:function(t){this.viewport_dim_=t,n.call(this,t),T.call(this);var e=$(this.uid_);e&&b.call(this,e,t)},Show:function(t){var e=MANAGER.handler.Get(this.hdl_uid_),i=this.info_;if(e&&i.text&&!$(this.uid_)){var s=e.GetConfig("skin"),n=WCT.DeepCopy(DATA.GetS(DATA.SKIN_PREFIX+s+":taskinfo.txt")),o=e.GetContext().ToAbsPath("skin:")+"/";if(WCT.skin.ExtendUrls(n,o),(this.skin_=n)&&n.frame){var r=SKIN.popup.GetDim(n.frame);if(r.min_h=n.frame?r.h:Topmost.MINI_H,("number"!=typeof i.w||i.w<=Topmost.MINI_W)&&(i.w=Topmost.MINI_W),("number"!=typeof i.h||i.h<=r.min_h)&&(i.h<=0&&(this.auto_h_=!0),i.h=r.min_h),i.modal&&!PLATFORM.ANDROID){var a=new WCT.Fader(this.uid_+"#fader",{opacity:.05,bgcolor:"#FFFFFF"},{callback_f:g,callback_s:this});a.Create(t),this.fader_=a}(function f(){var t=this.info_,e={s:"left",v:0},i={s:"top",v:0};switch((t.orientation||"").toLowerCase()){case"ne":e.s="right";break;case"n":e.v="auto";break;case"nw":break;case"w":i.v="auto";break;case"sw":i.s="bottom";break;case"s":e.v="auto",i.s="bottom";break;case"se":e.s="right",i.s="bottom";break;case"e":e.s="right",i.v="auto";break;case"c":default:e.v="auto",i.v="auto"}t.x=e,t.y=i}).call(this);var l=$$("div");l.id=this.uid_,l.style.position="absolute",l.style.width=i.w+"px",l.style.height=i.h+"px",l.style.visibility="hidden",i.modal&&(l.style.zIndex=1),t.appendChild(l);var c=e.GetContentInfo().rtl,_={w:i.w-n.title.padding_left-n.title.padding_right,title:i.title||e.Trans("TASK"),id:this.uid_+"#",rtl:c},d=SKIN.popup.CreateTitle(l,n.title,_);if(d){d.style.cursor="pointer";var u=new WCT.dnd(l,d);u.SetCallback("onbegin",y,this),u.SetCallback("onend",C,this),this.dnd_=u}v.call(this,"exit",n,l),!1!==i.mini&&(v.call(this,"restore",n,l),v.call(this,"minimize",n,l));var h=this.skin_.content;h&&(r.l=h.outer_spacing_l||0,r.r=h.outer_spacing_r||0),r.t=Math.max(r.t,n.title?n.title.h:0);var p=WCT.iframe.Create(DATA.context.ToAbsPath("trainer:about_blank.html"));p.id=this.uid_+"#content",p.style.position="absolute",p.style.left=r.l+"px",p.style.top=r.t+"px",p.style.width=i.w-r.l-r.r+"px",p.style.overflow="hidden",WCT.iframe.Load(p,m,this,l,[p]),this.skin_d_=r}}},Close:function(){var t=MANAGER.handler.Get(this.hdl_uid_);if(t){var e=t.Trans("CLOSE_TASK");!1!==this.info_.close_msg&&!confirm(e)||t.ExecCommand("taskinfo_close")}},Visible:function(){var t=arguments[0];if("boolean"==typeof t){var e=$(this.uid_);e&&(e.style.visibility=t&&this.loaded_?"visible":"hidden",BROWSER.MOBILE&&(e.style.display=t&&this.loaded_?"":"none")),this.visible_=t}return this.visible_},IsModal:function(){return this.info_&&this.info_.modal||!1}}}(),WCT.ExtendObject(Searchfield,{STORE:{},Cleanup:function(){var t=Searchfield.STORE;for(var e in t)delete t[e]},OnKeyup:function(t){var e=this.id.lastIndexOf("#"),i=this.id.substr(0,e),s=Searchfield.STORE[i];if(s)return SKIN.control.Visible(i+"#clear",""!=this.value,"visibility"),27==(t=WCT.event.Standardize(t)).keyCode&&Searchfield.OnClear.call(s),13!=t.keyCode||(BROWSER.MOBILE&&this.blur(),s.onsearch_&&s.onsearch_.call(s.scope_,this.value,13==t.keyCode)),WCT.event.Cancel(t)},OnClear:function(){var t=this.hdl_id_+"#"+this.id_;SKIN.control.Visible(t+"#clear",!1,"visibility"),this.onsearch_&&this.onsearch_.call(this.scope_,"");var e=$(t+"#ip");e&&(e.focus(),e.value="")}}),Searchfield.prototype={Destructor:function(){var t=this.hdl_id_+"#"+this.id_;delete Searchfield.STORE[t],SKIN.control.Cleanup(t+"#clear"),SKIN.control.Cleanup(t+"#magni");var e=$(t);e&&e.parentNode.removeChild(e),this.onsearch_=null,this.scope_=null,this.skin_=null},GetDom:function(){return $(this.hdl_id_+"#"+this.id_)},SetWH:function(t,e){var i=this.hdl_id_+"#"+this.id_,s=this.skin_,n=0,o=$(i);o&&(o.style.width=t+"px",o.style.height=e+"px");var r=$((i+="#")+"bg"),a=2*s.border_width;r&&(t=Math.max(0,t-s.margin_left-s.margin_right-a),e=Math.max(0,e-s.margin_top-s.margin_bottom-a),r.style.width=t+"px",r.style.height=e+"px");var l=$(i+"clear");if(l){var c=l.offsetWidth;t-=c,this.rtl_&&(n+=c)}var _=$(i+"magni");if(_){var d=_.offsetWidth;t-=d,this.rtl_||(n+=d)}var u=$(i+"ip");u&&(e=Math.max(0,e),u.style.left=n+"px",u.style.width=Math.max(0,t)+"px",u.style.height=e+"px",u.style.lineHeight=e+"px")},SetXY:function(t,e){var i=$(this.hdl_id_+"#"+this.id_);i&&(i.style[this.rtl_?"right":"left"]=t+"px",i.style.top=e+"px")},SetValue:function(t){var e=this.hdl_id_+"#"+this.id_,i=$(e+"#ip");i&&(i.value=t),SKIN.control.Visible(e+"#clear",!!t.length,"visibility")},Blur:function(){var t=$(this.hdl_id_+"#"+this.id_+"#ip");t&&t.blur()},Focus:function(){var t=$(this.hdl_id_+"#"+this.id_+"#ip");t&&t.focus()}};var API={T2_API:!0,GotoEntity:function(t){var e=MANAGER.handler.GetActive();if(e&&e.ExecCommand){var i=t.split("!");e.ExecCommand("jump_"+i[0],i[1])}}},BROADCAST={SendMaster:function(t){var e=DATA.GetActiveManager(),i=arguments[1],s=arguments[2],n=arguments[3],o=arguments[4],r=arguments[5],a=arguments[6];try{var l=e&&e.wnd&&e.wnd.BROADCAST&&e.wnd.BROADCAST.Receive||null;return l?null!=a?l(t,i,s,n,o,r,a):null!=r?l(t,i,s,n,o,r):null!=o?l(t,i,s,n,o):null!=n?l(t,i,s,n):null!=s?l(t,i,s):null!=i?l(t,i):l(t):null}catch(c){}return null},SendClients:function(t){var e=DATA.GetClients();for(var i in e)this.SendClient(e[i],t,arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6])},SendClient:function(t,e){var i=arguments[2],s=arguments[3],n=arguments[4],o=arguments[5],r=arguments[6],a=arguments[7];try{var l=t&&t.BROADCAST&&t.BROADCAST.Receive||null;return l?null!=a?l(e,i,s,n,o,r,a):null!=r?l(e,i,s,n,o,r):null!=o?l(e,i,s,n,o):null!=n?l(e,i,s,n):null!=s?l(e,i,s):null!=i?l(e,i):l(e):null}catch(c){}return null},Receive:function(t){var e=MANAGER.broadcast[t];if(e){var i=arguments[1],s=arguments[2],n=arguments[3],o=arguments[4],r=arguments[5],a=arguments[6];return null!=a?e(i,s,n,o,r,a):null!=r?e(i,s,n,o,r):null!=o?e(i,s,n,o):null!=n?e(i,s,n):null!=s?e(i,s):null!=i?e(i):e()}return null}};function LayoutManager(){this.layout_=arguments[0]||[]}LayoutManager.prototype=function(){function r(){for(var t=this.layout_,e="hor"==t.a,i=0,s=0,n=0,o=[],r=[],a=0,l=null;l=t[a++];){for(var c=0,_=0,d=[],u=[],h=0,p=0,f=null;f=l.els[p++];)f.v&&(c+=f.w,_+=f.h,d.push(f.w),u.push(f.h),f.a&&i++,h++);0<h&&("hor"==l.a?(c+=l.si*(h-1)+l.sl+l.sr,_=Math.max.apply(null,u)+l.st+l.sb):(c=Math.max.apply(null,d)+l.sl+l.sr,_+=l.si*(h-1)+l.st+l.sb),e?(s+=c,r.push(_)):(o.push(c),n+=_))}return e?n=Math.max.apply(null,r):s=Math.max.apply(null,o),{w:s,h:n,a:i}}return{Destructor:function(){this.layout_=null},FromPanelSkin:function(t,e){var i=e||"hor",s=[];s.a=i;for(var n=0,o=null,r=0;o=t[n++];){for(var a={a:o.alignment||"hor",si:o.inner_spacing||0,sl:o.outer_spacing_l||0,sr:o.outer_spacing_r||0,st:o.outer_spacing_t||0,sb:o.outer_spacing_b||0,els:[]},l=0,c=null;c=o.elements[l++];)a.els.push({w:c.w||0,h:c.h||0,a:c.autosize||!1,v:!0,cnt:r++});s.push(a)}this.layout_=s},Visible:function(t,e){for(var i=this.layout_,s=0,n=null;n=i[s++];){var o=n.els.indexOfAtt(t,"cnt");if(0<=o)return void(n.els[o].v=e)}},Apply:function(t,e){var i={w:t,h:e},s=r.call(this),n=function o(t,e){var i="hor"==this.layout_.a,s=0;return 0<e.a&&(i&&t.w>e.w?s=(t.w-e.w)/e.a:!i&&t.h>e.h&&(s=(t.h-e.h)/e.a)),s}.call(this,i,s);return function g(t,e,i){for(var s=this.layout_,n="hor"==s.a,o=[],r=0,a=0,l=0,c=null;c=s[l++];){var _=c.sl,d=c.st;n?_+=r:d+=a;for(var u=[],h=[],p=0,f=0,m=null;m=c.els[f++];)if(m.v){0<p&&("hor"==c.a?_+=c.si:d+=c.si);var b=m.w,v=m.h;m.a&&(n?b+=i:v+=i),o.push({x:_,y:d,w:b,h:v}),"hor"==c.a?_+=b:d+=v,u.push(b),h.push(v),p++}else o.push({x:0,y:0,w:0,h:0});0<p&&(n?(r=_+c.sr,"vert"==c.a&&(r+=Math.max.apply(null,u))):(a=d+c.sb,"hor"==c.a&&(a+=Math.max.apply(null,h))))}return o}.call(this,i,s,n)},GetMinDim:function(){var t=r.call(this);return{w:t.w,h:t.h}}}}();var Print={Close:function(){var t=$("print_box");t&&t.parentNode.removeChild(t),(t=$("print_elem"))&&t.parentNode.removeChild(t);for(var e=document.body.childNodes,i=0,s=null;s=e[i++];)s.style&&(s.style.display="",s.style.visibility="",PLATFORM.IOS&&(s.style.zIndex="",s.style.opacity=""))},Open:function(t,e){for(var i=document.body,s=i.childNodes,n=0,o=null;o=s[n++];)o.style&&(o.style.display="none",o.style.visibility="hidden",PLATFORM.IOS&&(o.style.zIndex=0,o.style.opacity=0));var r=$$("div"),a=t.GetContentInfo().rtl?"rtl":"";r.id="print_box",r.style.direction=a,r.style.padding="5px",r.style.fontWeight="bold",r.style.fontFamily=e.style.fontFamily,PLATFORM.MOBILE&&(r.style.width=WCT.dom.GetWindowWidth()+"px"),i.appendChild(r),e.style.width="",e.id="print_elem";try{i.appendChild(e)}catch(c){r.innerHTML=e.outerHTML}if(window.print(),arguments[2])Print.Close();else{var l=$$("a");l.style.direction=a,l.href="javascript:void(0);",l.appendChild($$2(t.Trans("BACK"))),l.onclick=Print.Close,PLATFORM.MOBILE&&(l.ontouchend=Print.Close),r.firstChild?r.insertBefore(l,r.firstChild):r.appendChild(l)}}},NOTIFICATION={SPACER:"<br /><br />"};function DropDown(t){this.uid_=WCT.uid.Generate(8,"DD_"),this.hdl_id_=t.hdl_id,this.dom_id_=t.id+"#"+this.uid_,this.skin_=t.skin,this.rtl_=t.rtl||!1,this.tabindex_=t.tabindex||0,this.options_=[],this.current_=null,this.fader_=null,this.open_=!1,this.sel_=null,this.cb_fun_=null,this.cb_scp_=null,(DropDown.STORE[this.uid_]=this).style_={bg:null,ico:null}}!function(){var s={background_color:"#999999",background_color_h:"#CCCCCC",border_left:"1px solid #666666",border_bottom:"1px solid #666666",border_right:"1px solid #666666",border_bottom_left_radius:3,border_bottom_right_radius:3,box_shadow:"2px 2px 3px 1px rgba(0, 0, 0, 0.3)",font_family:"Arial,Helvetica,sans-serif",font_size:15,text_align:"center",padding_top:8,padding_left:5,padding_right:20,padding_bottom:8,y:1,w:"60%"},a="notification",l=!1,n=null,c=!1,_=[],d="",u=null;function o(t){var e=(t=WCT.event.Standardize(t)).target,i="";switch(t.type){case"mouseover":i="_h";case"mouseout":n["background_color"+i]&&(e.style.backgroundColor=n["background_color"+i]);break;case"click":!function s(){var t=$(a);l=!0;var e=(new Date).getTime();WCT.SetTimeout(h,1,null,[t,e,0,-u,200])}()}}function h(t,e,i,s,n){var o=(new Date).getTime(),r=Math.min((o-e)/n,1),a=i+s*r;t.style.top=a+"px",r<1?WCT.SetTimeout(h,1,null,[t,e,i,s,n]):(c=!1,l?(l=!1,t.parentNode.removeChild(t)):(t.style.top="0px",p()))}function p(){var t=$(a);if(t){for(var e="",i=d;e=_.shift();)i=e+NOTIFICATION.SPACER+i;if(_=[],i!=d){d=i;var s=t.cloneNode(1);s.id+="#clone",t.parentNode.appendChild(s),t.style.visibility="hidden",t.innerHTML=d;var n=t.offsetHeight,o=n-u;if(0==o)return t.style.visibility="visible",void s.parentNode.removeChild(s);t.style.top=-o+"px",t.style.visibility="visible",u=n,s.parentNode.removeChild(s);var r=(new Date).getTime();WCT.SetTimeout(h,1,null,[t,r,-o,o,200])}}}NOTIFICATION.SetSkin=function(t){for(var e in n=WCT.DeepCopy(s),t)n[e]=t[e];var i=arguments[1];"string"==typeof i&&(this.SPACER=i)},NOTIFICATION.ShowMessage=function(t){if(n)if(e=$(a))_.push(t),c||p();else{var e;(e=$$("div")).id=a,WCT.skin.ApplyPosition(e,n),WCT.skin.ApplyTextFormats(e,n),WCT.skin.ApplyBorder(e,n),WCT.skin.ApplyPadding(e,n),e.style.zIndex=2,e.style.cursor="pointer",e.innerHTML=t,document.body.appendChild(e),d=t,e.onmouseover=o,e.onmouseout=o,e.onclick=o,this.Resize(),u=e.offsetHeight,e.style.top=-u+"px",c=!0;var i=(new Date).getTime();WCT.SetTimeout(h,1,null,[e,i,-u,u,200])}},NOTIFICATION.Resize=function(){var t=$(a);if(t){var e=WCT.dom.GetWindowWidth(),i=e;if("number"==typeof n.w)i-=n.w;else{if(!(0<=n.w.indexOf("%")))return;i-=e*parseInt(n.w)/100}i>>=1,t.style.left=i+"px"}}}(),function(){var i=[],a={};function l(){return MANAGER.handler.Get(i[0])}function n(){var t=l();if(t){var e=a[t.GetUid()].hash||DATA.GetUrlHash()||"";WCT.bookmark.Set(e)}}function t(t){var e=l();if(e&&e.OnBookmark){t=t.split("&");for(var i=a[e.GetUid()],s={},n=0,o=t.length;n<o;n++){var r=t[n].split("=");"undefined"!=typeof i[r[0]]&&(s[r[0]]=r[1])}e.OnBookmark(s)}}window.BOOKMARK={Start:function(){WCT.bookmark.Observe(t)},Stop:function(){WCT.bookmark.StopObserving()},AddHandler:function(t){i.push(t),a[t]={}},RemoveHandler:function(t){var e=i.indexOf(t);e<0||(i.splice(e,1),delete a[t],n())},SetState:function(t,e){if(a[t]){var i=!1;for(var s in e)a[t][s]!==e[s]&&(a[t][s]=e[s],i=!0);i&&n()}}}}(),DropDown.STORE={},DropDown.prototype=function(){function v(t){var e=arguments[1]||s;t.onmouseover=e,t.onmouseout=e,t.onmousedown=e,t.onmouseup=e,t.onclick=n}function i(t){t.onmouseover=null,t.onmouseout=null,t.onmousedown=null,t.onmouseup=null,t.onclick=null}function h(t,e,i){var s=$$("div");return s.id=i,s.style.position="absolute",s.style.backgroundRepeat="no-repeat",s.style.fontSize="1px",s.style.cursor="pointer",s.style.backgroundImage="url("+(e.id||"")+")",s.style.backgroundPosition=(e.x||0)+"px "+(e.y||0)+"px",s}function o(){var t=this.options_;if(!t.length)return!1;var e=this.current_;e||(e=t[0],this.current_=e);var i=this.skin_.icons,s=i[e]&&i[e].image||null;if(!s)return!1;var n=s.id||"",o=this.style_,r=this.dom_id_+"#i",a=$(r);if(a)o.ico!=n&&(a.style.backgroundImage="url("+n+")",o.ico=n),a.style.backgroundPosition=(s.x||0)+"px "+(s.y||0)+"px";else{if(!arguments[0])return!1;(a=h(0,s,r)).style[this.rtl_?"right":"left"]=(i.x||0)+"px",a.style.top=(i.y||0)+"px",a.style.width=(i.w||0)+"px",a.style.height=(i.h||0)+"px",arguments[0].appendChild(a),o.ico=n}return!0}function d(t,e){var i={over:"_h",down:"_a",up:"_h"}[e.type.replace(/mouse/,"")]||"";return(this.rtl_?t["image_rtl"+i]||t.image_rtl:null)||t["image"+i]||t.image}function s(t){var e=(this.id||"").split("#").top(),i=DropDown.STORE[e];if(i){var s=i.skin_,n=s&&s.icons&&s.icons[i.current_]||null;if(n){t=WCT.event.Standardize(t);var o={bg:{s:d.call(i,s,t),i:i.dom_id_},ico:{s:d.call(i,n,t),i:i.dom_id_+"#i"}},r=i.style_;for(var a in o){var l=$(o[a].i),c=o[a].s;if(l&&c){var _=c.id||"";r[a]!=_&&(l.style.backgroundImage="url("+_+")",r[a]=_),l.style.backgroundPosition=(c.x||0)+"px "+(c.y||0)+"px"}}}}}function g(t){var e=(this.id||"").split("#")[2],i=DropDown.STORE[e];if(i){var s=i.skin_,n=s&&s.popup||null;if(n){var o=(t=WCT.event.Standardize(t)).target.id?t.target:t.target.parentNode,r=o.id.split("#").top();if(!(i.options_.indexOf(r)<0)){var a={over:"_h",down:"_a",up:"_h"}[t.type.replace(/mouse/,"")]||"";o.style.color=n["text_color"+a]||"#000",o.style.backgroundColor=n["background_color"+a]||"#fff";var l=null;if(n.icons&&n.icons[r]&&(l=d.call(i,n.icons[r],t)),!l&&s.icons[r]&&(l=d.call(i,s.icons[r],t)),l){var c=$(o.id+"#i"),_=l.id||"";_!=i.style_["p_"+r]&&(c.style.backgroundImage="url("+_+")",i.style_["p_"+r]=_),c.style.backgroundPosition=(l.x||0)+"px "+(l.y||0)+"px"}i.sel_=r}}}}function n(t){var e=(this.id||"").split("#"),i=DropDown.STORE[e[2]];if(i)if("p"==e.top()){var s=(t.target.id?t.target:t.target.parentNode).id.split("#").top(),n=i.options_.indexOf(s);y.call(i),r.call(i,n)}else i.open_?y.call(i):function b(){if(this.open_)return;this.open_=!0;var t=this.skin_,e=t.popup;if(!e)return;var i=PLATFORM.IOS&&7<=PLATFORM.VERSION,s=i?WCT.dom.GetWindowWidth()+"px":null,n=i?WCT.dom.GetWindowHeight()+"px":null,o=new WCT.Fader(this.dom_id_+"#f",{bgcolor:"#fff",opacity:.01,w:s,h:n},{callback_f:y,callback_s:this});o.Create(document.body),this.fader_=o;var r=MANAGER.handler.Get(this.hdl_id_),a=r?r.GetSkin():{};a=a.font_family;var l=this.dom_id_+"#p",c=$$("div");c.id=l,c.setAttribute("role","listbox"),c.style.position="absolute",c.style.zIndex="1",c.style.backgroundColor=e.outer_background_color||"#fff",c.style.border=e.outer_border||0,c.style.padding=(e.inner_spacing||0)+"px",e.box_shadow&&(c.style.boxShadow=e.box_shadow);a&&(c.style.fontFamily=a);var _=$$("div");_.style.border=e.inner_border||0,c.appendChild(_),l+="#";for(var d=0,u=this.options_,h=null;h=u[d++];)C.call(this,h,_,l);var p=this.rtl_,f=$(this.dom_id_);f=WCT.dom.GetPosition(f);var m=r.GetHandlerDim();p?c.style.right=m.w-f.left-(t.w||0)+"px":c.style.left=f.left+"px";c.style.top=f.top+(t.h||0)+1+"px",document.body.appendChild(c),PLATFORM.IOS&&p&&(c.style.right="",c.style.left=m.w-c.offsetWidth+"px");v(c,g),_.childNodes[0].focus()}.call(i)}function r(t){this.current_=this.options_[t],o.call(this),this.cb_fun_&&this.cb_fun_.call(this.cb_scp_,this.current_)}function y(){this.open_=!1,this.fader_&&(this.fader_.Destructor(),this.fader_=null);var t=$(this.dom_id_+"#p");t&&(i(t),t.parentNode.removeChild(t),$(this.dom_id_).focus())}function C(t,e,i){var s=this.skin_,n=s.icons,o=s.popup;if(!n||!o)return null;var r=this.rtl_,a=s.font_size||12,l=o.item_spacing||0,c=$$("div");c.id=i+t,c.tabIndex=this.tabindex_,c.style.position="relative",c.style.cursor="pointer",c.style.direction=r?"rtl":"ltr",c.style.whiteSpace="nowrap",c.style.textOverflow="ellipsis",c.style.borderBottom=o.item_border||0,c.style.backgroundColor=o.background_color||"#fff",c.style.color=o.text_color||"#000",c.style.padding=l+"px",c.style.transform="translateY(1px)",c.style.outlineOffset="-2px",c.style.fontSize=a+"px",c.style.lineHeight=Math.max(a,n.h)+"px",c.style[r?"paddingRight":"paddingLeft"]=l+(o.icon_spacing||0)+(n.w||0)+"px";var _=o.icons&&o.icons[t]&&o.icons[t].image||n[t]&&n[t].image||null;if(!_)return null;var d=h(0,_,i+t+"#i");d.style[r?"right":"left"]=l+"px",d.style.top=l+"px",d.style.width=(n.w||0)+"px",d.style.height=(n.h||0)+"px",c.appendChild(d);var u=MANAGER.handler.Get(this.hdl_id_).Trans(n[t].text||"");return c.appendChild($$2(u)),e.appendChild(c),c}return{Destructor:function(){y.call(this),delete DropDown.STORE[this.uid_],this.cb_fun_=null,this.cb_scp_=null,this.options_=null;var t=this.dom_id_,e=$(t+"#b");e&&e.parentNode.removeChild(e),(e=$(t))&&(i(e),e.parentNode.removeChild(e))},SetCallback:function(t,e){this.cb_fun_=t,this.cb_scp_=e},SetOptions:function(t){this.options_=t},SetDefault:function(t){this.current_=t},SetXY:function(t,e){var i=$(this.dom_id_);i&&(i.style[this.rtl_?"right":"left"]=t+"px",i.style.top=e+"px")},Select:function(t){var e=Math.max(0,this.options_.indexOf(t));r.call(this,e)},Create:function(t){var e=this.skin_,i=e[this.rtl_?"image_rtl":"image"]||e.image;if(!i||!e.icons)return!1;var s=MANAGER.handler.Get(this.hdl_id_),n=$$("div");return n.id=this.dom_id_,n.tabIndex=this.tabindex_,n.setAttribute("role","button"),n.setAttribute("aria-haspopup","listbox"),n.setAttribute("aria-label",s.Trans("PANEL_VIEWMODE")),n.setAttribute("aria-expanded","false"),n.style.backgroundImage="url("+(i.id||"")+")",n.style.backgroundPosition=(i.x||0)+"px "+(i.y||0)+"px",n.style.backgroundRepeat="no-repeat",n.style.position="absolute",n.style.fontSize="1px",n.style.outlineOffset="-2px",n.style.cursor="pointer",n.style.top="0",n.style.width=(e.w||0)+"px",n.style.height=(e.h||0)+"px",this.style_.bg=i.id||"",!!o.call(this,n)&&(v.call(this,n),arguments[1]?t.insertBefore(n,t.firstChild):t.appendChild(n),!0)}}}(),function(){function u(){MANAGER.zoom_current_!=screen.deviceXDPI&&(MANAGER.zoom_current_=screen.deviceXDPI,MANAGER.OnResize())}function o(t){var e=$(t);e&&e.parentNode.removeChild(e)}function n(){window.opener=window,window.open("","_parent"),window.close()}function h(t){MANAGER.Cleanup();for(var e=document.body,i=e.childNodes,s=i.length-2;1<s;s--)e.removeChild(i[s]);if(e.className="error",t.msg||t.opt){var n=$("error_msg"),o=$("error_opt");n.innerHTML="",o.innerHTML="",n.appendChild($$2(t.msg||"")),o.appendChild($$2(t.opt?t.opt.replace(/\\r\\n/g,"<br />").replace(/\\n/g,"<br />"):""))}t.redirect&&DEBUG&&Log("MANAGER.RedirectErrorPage has been called!",!0)}function p(t,e,i,s){var n=i||"",o=s||"";e.features||(e.features={}),e.features.fullscreen?BROWSER.EDGE?e.features={fullscreen:!0,left:0,top:0,width:screen.availWidth,height:screen.availHeight}:e.features={fullscreen:!0}:delete e.features.fullscreen;var r=f(e);null!=r.w&&(e.features.width=r.w),null!=r.h&&(e.features.height=r.h),null!=r.x&&(e.features.left=r.x),null!=r.y&&(e.features.top=r.y);var a=[];for(var l in e.features)"boolean"==typeof e.features[l]?a.push(l+"="+(e.features[l]?1:0)):a.push(l+"="+e.features[l]);a=a.join(","),t+=n+o;var c=e.name||"wpb";e.reuse||(c+="_"+(new Date).getTime());var _=null;try{_=self.open(t,c,a)}catch(h){}if(_||!e.show_error)return _;var d=MANAGER.Trans("ERROR_1"),u=MANAGER.Trans("ERROR_1.h");return MANAGER.RedirectErrorPage(d,u),null}function a(t,e,i){var s,n,o=0,r=0;return n=BROWSER.IE?(s=screen.availWidth,screen.availHeight):(s=screen.width,screen.height),e<0&&(e=s),i<0&&(i=n),0<=t.indexOf("E")?o=s-e:-1==t.indexOf("W")&&(o=Math.round((s-e)/2)),0<=t.indexOf("S")?r=n-i:-1==t.indexOf("N")&&(r=Math.round((n-i)/2)),{x:o,y:r}}function f(t){var e={},i="number"==typeof t.width?t.width:-1,s="number"==typeof t.height?t.height:-1;t.win_autosize&&(i=Math.max(MANAGER.MIN_WIN_W,i),s=Math.max(MANAGER.MIN_WIN_H,s)),0<=i&&(e.w=i),0<=s&&(e.h=s);var n="string"==typeof t.orientation?t.orientation.toUpperCase():null;if(n){var o=a(n,i,s);"number"==typeof t.left&&(o.x+=t.left),"number"==typeof t.top&&(o.y+=t.top),e.x=o.x,e.y=o.y}else"number"==typeof t.left&&(e.x=t.left),"number"==typeof t.top&&(e.y=t.top);return e}function m(t,e){var i=e||{},s=MANAGER.MIN_WIN_W,n=MANAGER.MIN_WIN_H;n="number"==typeof window.outerWidth?(s=window.outerWidth,window.outerHeight):i.w||i.h?(s=i.w||WCT.dom.GetWindowWidth(),i.h||WCT.dom.GetWindowHeight()):(s=WCT.dom.GetWindowWidth(),WCT.dom.GetWindowHeight());var o=a(t,s,n);"number"==typeof i.x&&(o.x+=i.x),"number"==typeof i.y&&(o.y+=i.y);try{moveTo(o.x,o.y)}catch(r){}}function l(){var t=0,e=window;try{do{var i=e.MANAGER;if(i&&i.WND_EVT_ID&&e[i.WND_EVT_ID])return e;e=e.parent}while(e&&++t<=20)}catch(s){Log(s)}return null}function r(t){var e=l();if(!e)return!0;var i=e.WCT.event.Standardize(t),s=e.MANAGER.events_[i.type];if(!s)return!0;for(var n=[],o=0,r=null;r=s[o];o++)n.push(r);var a=e.MANAGER.WND_EVT_ID;for(o=0,r=null;r=n[o];o++)if(r.id&&r.wid==this[a]&&(r.f&&r.f.call(r.s,i,this),i.stop_immediately_))return e.WCT.event.Cancel(t);return!i.stop_propagation_||e.WCT.event.Cancel(t)}function i(){WCT.event.hotkey.Start(window),(TRACKING.central.GetBackendType()||TRACKING.backend.collaborator.Available())&&PRODUCER.DisableHttpTracking();var t=DATA.GetStartObject(),e=(DATA.GetConfig(t.tclass)||{}).video_debug;e&&(WCT.event.hotkey.Observe(e,"up",PRODUCER.VideoExport.Tick,PRODUCER.VideoExport),NOTIFICATION.SetSkin({font_size:10},"<br />"),PRODUCER.VideoExport.Debug("VideoExport - continue with: "+e));var i=this.topmost_,s=this.handler.Init(t);i&&(s.ConnectTopmost(i),i.Show()||s.ConnectTopmost(null),this.topmost_=null)}window.MANAGER={T2_BUILDNUMBER:"10.0.0",MIN_WIN_W:104,MIN_WIN_H:102,MAX_DEBUG_MSGS:50,WND_EVT_ID:"T2_WND_EVT_ID",UID_LEN:18,UID_PREF_MAN:"M_",UID_PREF_HDL:"H_",UID_PREF_SEARCH:"S_",HDL_ALIGN_STACK:"stack",HDL_ALIGN_HOR:"hor",HDL_ALIGN_VERT:"vert",HDL_ALIGN_TILE:"tile",standalone:!0,uid_:null,just_an_opener_:!1,forbid_close_:!1,loaded_macrosets_:{},central_tracker_:null,events_:{},resize_to_:null,zoom_current_:null,zoom_watcher_:null,topmost_:null,_lockTitle:!1,Init:function(){PLATFORM.IOS&&!function r(){var t=window.innerHeight;if(t)for(var e=document.getElementsByTagName("meta"),i=0,s=null;s=e[i++];)if("viewport"==s.name){var n=s.parentNode,o=$$("meta");return o.name="viewport",o.content=s.content.replace(/device-height/i,t),n.appendChild(o),void n.removeChild(s)}}(),document.body.className="",this.uid_=WCT.uid.Generate(this.UID_LEN,this.UID_PREF_MAN),window[MANAGER.WND_EVT_ID]=this.uid_,window.onresize=MANAGER.OnResize,window.onhelp=function(){return!1},document.onhelp=function(){return!1},BROWSER.MOBILE&&!PLATFORM.ANDROID&&(window.onorientationchange=MANAGER.OnOrientation),MANAGER.HandleFocus(),BOOKMARK.Start(),BROWSER.IE&&function o(){MANAGER.zoom_current_=screen.deviceXDPI,MANAGER.zoom_watcher_=WCT.SetInterval(u,500)}();try{this.standalone=parent.MANAGER&&parent.MANAGER.GetUid()==this.uid_}catch(a){}var t=DATA.InitLight();if(!t.selftest){(t=DATA.InitFull()).tracking_scorm_simulation&&SCORM_API.Enable(!0);var e=null;switch(t.boot_status_){case DATA.BOOT_FF_REBOOT:return void function l(){var t=DATA.context.GetBase()+"/"+DATA.INDEX_HTML,e=DATA.GetUrlSearch(),i=DATA.GetUrlHash();e&&(t+=e),i&&(t+=i),location.href=t}();case DATA.BOOT_ERROR:return void this.RedirectErrorPage(MANAGER.Trans("ERROR_2"),MANAGER.Trans("ERROR_2.h"),t.boot_msg_);case DATA.BOOT_URL:BROADCAST.SendMaster("ClientStop",this.uid_,!0),this.Cleanup();try{location.href=t.boot_url_}catch(a){}return;case DATA.BOOT_TOPMOST:t.navigator||t.help4||(Topmost.WinOut(),e=new Topmost.praxis(t),this.topmost_=e);break;case DATA.BOOT_REOPEN:return void function c(t){var e=DATA.ExtractWindowConfig(t)||{};if(e.show_error=!0,e.reuse=!1,this.just_an_opener_=!0,window.COLL_REFRESH=TRACKING.GetCollRefresh(),this.standalone)try{window.moveTo(0,screen.availHeight+5e3)}catch(i){}p(DATA.context.GetBase()+"/"+DATA.INDEX_HTML,e,DATA.GetUrlSearch(),DATA.GetUrlHash())}.call(this,t);case DATA.BOOT_ERROR_PAGE:return void h(t)}delete t.boot_status_,NOTIFICATION.SetSkin(),t.boot_msg_&&(NOTIFICATION.ShowMessage(this.Trans("ERROR_2")+"<br />"+t.boot_msg_),delete t.boot_msg_),this.SetCtx(),PRODUCER.Init();var i=DATA.ExtractWindowConfig(t)||{},s=DATA.GetActiveManager();if(s.active){if(this.standalone&&!e){var n=DEFAULTS.Clamp("window_cfg_orientation",i.orientation,!0);n&&m(n)}this.InitTracking()}else this.standalone&&!e&&(!function _(t){var e=f(t),i=WCT.dom.GetWindowWidth(),s=WCT.dom.GetWindowHeight();("number"!=typeof e.w||e.w<0)&&(e.w=i),("number"!=typeof e.h||e.h<0)&&(e.h=s);var n=e.w-i,o=e.h-s;if(0!=n||0!=o)try{resizeBy(n,o)}catch(a){}var r="string"==typeof t.orientation?t.orientation.toUpperCase():null;r&&(e.w=i,e.h=s,m(r,e))}(i),!BROWSER.IE&&i.features&&i.features.fullscreen&&(BROWSER.SAFARI||PLATFORM.MAC||BROWSER.EDGE?(self.moveTo(0,0),self.resizeTo(screen.availWidth,screen.availHeight)):function d(){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(i){}try{var t=Components.interfaces.nsIWindowMediator,e=Components.classes["@mozilla.org/appshell/window-mediator;1"].getService(t).getMostRecentWindow("navigator:browser");e.fullScreen=!0,e.toolbar.visible=!1,e.statusbar.visible=!1,e.menubar.visible=!1,e.locationbar.visible=!1,e.personalbar.visible=!1,e.directories.visible=!1,MOZ19||e.BrowserFullScreen()}catch(s){return self.moveTo(0,0),self.resizeTo(screen.availWidth,screen.availHeight),!1}return!0}())),s.wnd.COLL_REFRESH&&(window.COLL_REFRESH=s.wnd.COLL_REFRESH),BROADCAST.SendMaster("ClientReady",this.uid_)}},InitTracking:function(){var t=arguments[0];if(t){try{t.AddAgent(this.uid_)}catch(e){Log(e)}this.central_tracker_=t,i.call(this)}else{DATA.GetActiveManager().active?(TRACKING.AGENT_UID_PREFIX=this.UID_PREF_MAN,TRACKING.Init(DATA.GetStartObject(),this.uid_,i,this)):i.call(this)}},SetWindowTitle:function(t){if(!this._lockTitle||!1===arguments[1]){this._lockTitle=!!arguments[1];try{document.title=t||""}catch(e){}}},SetCentralTracker:function(t){this.central_tracker_=t},GetCentralTracker:function(){return this.central_tracker_},Unload:function(){this.Fini(!1)},Fini:function(){DATA.GetActiveManager().active?!1===arguments[0]?this.Cleanup():DATA.HasClients()||this.handler.Exists()||this.CloseWindow():BROADCAST.SendMaster("ClientDone",this.uid_,arguments[0])},Cleanup:function(){if(DATA.GetActiveManager().active&&!this.just_an_opener_&&BROADCAST.SendClients("ClientClose",!0),BOOKMARK.Stop(),window.BOOK_SCO_TOC&&(window.BOOK_SCO_TOC.Destructor(),window.BOOK_SCO_TOC=null),WCT.event.hotkey.Stop(window),function t(){MANAGER.zoom_watcher_&&(WCT.ClearInterval(MANAGER.zoom_watcher_),MANAGER.zoom_watcher_=null)}(),window.COLL_REFRESH=null,window.onresize=null,window.onorientationchange=null,window.onfocus=null,window.onblur=null,window.onhelp=null,document.onhelp=null,window.ctx=null,this.handler.Cleanup(),this.event.Cleanup(),SOCKETS.Cleanup(),this.central_tracker_)try{this.central_tracker_.RemoveAgent(this.uid_)}catch(e){Log(e)}this.uid_=null,this.CleanupEventHandling(),Searchfield.Cleanup(),WCT.Cleanup(),SKIN.Cleanup(),VolumeSlider.Cleanup(),TRACKING.Cleanup(),HANDLER.library.Search.Cleanup(),DATA.Cleanup(),this.central_tracker_=null},RedirectErrorPage:function(t,e){arguments[2]&&(e+=" --- "+arguments[2]);var i=location.href,s=DATA.context.GetBase();s&&(i=i.split(s)[1]),h({msg:t,opt:e+=" --- "+i,redirect:!0})},Execute:function(t,e){if(t.external)this.ExecuteExternal(t.external,e);else{var i=HANDLER.base.GetConfig(t,e);if(i){var s=DATA.ExtractWindowConfig(i);BROWSER.IE&&s.features.fullscreen&&"project"==t.tclass&&"praxis"==t.mode&&(s.features.fullscreen=!1),!(!BROWSER.MOBILE&&DATA.RequiresNewWindow(s))||t.lib_embed||e&&e.force_same?this.handler.Init(t):function c(t,e){var i=DATA.GetUrlSearch(!0).search;i=i?i.substr(1).split("&").toMap({delimiter:"="}):{};for(var s=["left","top","width","height","orientation"],n=null;n=s.shift();)e[n]&&(i["window_cfg_"+n]=e[n]);if(t.lib_searchstring)delete i.show,i.lib_searchstring=t.lib_searchstring;else{var o=t.mode||t.filename||"",r=t.tclass+"!"+t.uid;t.tourstop&&(r+=":tourstop!"+t.tourstop),r+=o?":"+o:"",t.bookmark&&(r+="#slide!"+t.bookmark),i.show=r,delete e.force,e.reuse=!1,BROWSER.IE&&t.type==HANDLER.MODE.lesson&&"praxis"==t.mode&&delete e.features}if(i="?"+WCT.ObjectToArray(i,"=").join("&"),!p(DATA.context.GetBase()+"/"+DATA.INDEX_HTML,e,i)){var a=DATA.GetConfig();if(!(!!a&&(a.navigator||a.help4))){var l=MANAGER.Trans("ERROR_1.h");NOTIFICATION.ShowMessage(l)}}}(t,s)}}},ExecuteExternal:function(t,e){if(t.indexOf("mailto:")){var i=e?DATA.ExtractWindowConfig(e):null;if(i)i.show_error=!1,p(t,i);else try{window.open(t)}catch(s){alert(s.message)}}else(function n(t){var e=WCT.uid.Generate(8),i=this.uid_+"#i"+e,s=WCT.iframe.Create(t);s.id=i,s.style.width="10px",s.style.height="10px",document.body.appendChild(s),WCT.SetTimeout(o,10,this,[i])}).call(this,t)},OpenHelp:function(t){DATA.HELP_LANGUAGES[t]||(t=DATA.HELP_DEF_LANG);var e="help!"+t+":default.htm",i=DATA.context.ToAbsPath(e);arguments[1]&&(i+="?ckey="+arguments[1]),this.ExecuteExternal(i)},GetUid:function(){return this.uid_},GetBase:function(){return DATA.context?DATA.context.GetBase():""},GetActiveManager:function(){return DATA.GetActiveManager()},OpenerRequired:function(t){try{opener.MANAGER&&opener.MANAGER.ForbidClose()}catch(e){}},ForbidClose:function(){this.forbid_close_=!0},CloseWindow:function(){var t=DATA.GetConfig(),e=!!t&&t.navigator,i=!!t&&t.help4;if((t=!t||t.handler_window_close)&&(this.Cleanup(),this.standalone&&!this.forbid_close_)){if(e)try{window.external.CloseWindow()}catch(s){}if(i&&window!==top)try{return void top.postMessage("closeLightbox","*")}catch(s){}BROWSER.IE||BROWSER.EDGE?WCT.SetTimeout(n,1):window.close()}},AddMacroset:function(t){if(!this.loaded_macrosets_[t]){for(var e=DATA.context.ToAbsPath("macroset!"+t)+"/",i=DATA.MACROSET.length,s=0;s<i;s++)WCT.ExtendHeadByJS(e+DATA.MACROSET[s],null,window,"macroset!"+t+":"+DATA.MACROSET[s]);this.loaded_macrosets_[t]=!0}return!0},OnResize:function(){var t=arguments[0];BROWSER.IE&&BROWSER.VERSION<9?(MANAGER.resize_to_&&WCT.ClearTimeout(MANAGER.resize_to_),MANAGER.resize_to_=WCT.SetTimeout(MANAGER.handler.Align,10,MANAGER,[t])):(MANAGER.handler.Align(t),PLATFORM.ANDROID&&t&&MANAGER.OnOrientation(t)),NOTIFICATION.Resize(t)},OnOrientation:function(t){MANAGER.handler.SetOrientation(t)},ObserveEvent:function(t,e,i,s){var n=arguments[4]||window;n[MANAGER.WND_EVT_ID]&&(WCT.event.Observe(t,r,n),this.events_[t]||(this.events_[t]=[]),this.events_[t].push({id:e,f:i,s:s,w:n,wid:n[MANAGER.WND_EVT_ID]}))},StopEventObserving:function(t,e){var i=null;if(this.events_[t]){for(var s=this.events_[t],n=0,o=null;o=s[n];n++)if(o.id==e){i=o.w,o.f=null,o.s=null,o.w=null,s.splice(n,1);break}s.length||(delete this.events_[t],WCT.event.StopObserving(t,r,i))}},CleanupEventHandling:function(){for(var t in this.events_){for(var e=0,i=null;i=this.events_[t][e];e++)WCT.event.StopObserving(t,r,i.w),i.f=null,i.s=null,i.w=null;delete this.events_[t]}this.events_={}},Trans:function(t){return DATA.Trans(t,arguments[1])},SetCtx:function(){window.ctx={cfg_show:function(){var t=MANAGER&&MANAGER.handler&&MANAGER.handler.GetSlideCtx()||null;t&&t.cfg_show.apply(t,arguments)}}},HandleFocus:function(){try{window.onfocus=MANAGER.OnFocus,window.onblur=MANAGER.OnFocus}catch(s){}for(var t=this.handler.Iterate(!0);t;){var e=t.GetSlideRendererIFrame(0),i=e&&e.contentWindow||null;i&&(i.onfocus=MANAGER.OnFocus,i.onblur=MANAGER.OnFocus),t=this.handler.Iterate()}},GetUrl:function(){var t=this.handler.GetActive();return t?t.GetUrl(arguments[0]):DATA.context.GetBase()+"/index.html"},OnFocus:function(t){var e=(o=l())?o.MANAGER:null;if(e&&(t=o.WCT.event.Standardize(t)))if("focus"==t.type){var i=(s=e.handler.GetActive())&&s.GetUid()||null;for((o=(n=s&&s.GetSlideRendererIFrame(0))&&n.contentWindow||null)&&o.hdl_onfocus&&o.hdl_onfocus(),s=e.handler.Iterate(!0);s;){if(s.GetUid()!=i)(o=(n=s.GetSlideRendererIFrame(0))&&n.contentWindow||null)&&o.hdl_onblur&&o.hdl_onblur();s=e.handler.Iterate()}}else for(var s=e.handler.Iterate(!0);s;){var n,o;(o=(n=s.GetSlideRendererIFrame(0))&&n.contentWindow||null)&&o.hdl_onblur&&o.hdl_onblur(),s=e.handler.Iterate()}}}}(),MANAGER.handler=function(){var l={},c=[],s=null,e=0;function r(t){var e=l[t],i=e.GetContentInfo(),s=e.GetCompletionState();return s.type="closehandler",s.finished=!0,s.handler_id=t,s.content_id=i.address,s}return{Cleanup:function(){for(var t in l){var e=r(t);l[t].Destructor(!0),MANAGER.event.Broadcast(e)}l={},c=[],s=null},Get:function(t){return l[t]||null},Count:function(){return c.length},GetActive:function(){for(var t in l)if(l[t].IsActive())return l[t];return null},Iterate:function(){arguments[0]&&(e=0);var t=c[e++];return l[t]||null},BaseInit:function(t){var e=MANAGER.GetCentralTracker(),i=new HANDLER[t.type](t,e),s=i.GetUid();return(l[s]=i).Init(),i},Init:function(t){var e=this.BaseInit(t),i=e.GetUid();return c.push(i),this.Align(),MANAGER.OnFocus({type:"focus"}),BOOKMARK.AddHandler(i),e},Fini:function(t){var e=arguments[1],i=l[t];if(i){var s=r(t);if(!1!==e){var n=c.indexOf(t);0<=n&&c.splice(n,1),i.Destructor(),delete l[t]}MANAGER.event.Broadcast(s)}BOOKMARK.RemoveHandler(t),this.Exists()?(this.Align(),MANAGER.OnFocus({type:"focus"})):!1!==e&&MANAGER.Fini();var o=MANAGER.handler.GetActive();o&&(MANAGER.SetWindowTitle(o.GetTitle()||"trainer",!1),o.SetTitle())},GetTopmostConnected:function(){for(var t in l)if(l[t].HasTopmost())return l[t];return null},CloseTopmostConnected:function(){for(var t in l)l[t].HasTopmost()&&(l[t].ConnectTopmost(null),l[t].Fini())},Exists:function(){return 0<c.length},GetSlideCtx:function(){var t=0,e=null,i=null;do{for(;(e=l[c[t++]])&&!e.GetSlideCtx;);if(!e)break}while(!(i=e.GetSlideCtx(0)));return i},GetOrientation:function(){var t="portrait",e="landscape";if(PLATFORM.ANDROID){var i=$("oricheck"),s=i&&WCT.dom.GetComputedStyle(i,window,"background-color");if(s)return parseInt(s.substr(4,1))?t:e;var n="outer";return 0!=window[n+"Width"]&&0!=window[n+"Height"]||(n="inner"),window[n+"Width"]>window[n+"Height"]?e:t}return PLATFORM.WINTABLET?screen.width>screen.height?e:t:Math.abs(window.orientation)%180?e:t},SetOrientation:function(t){var e=this.GetOrientation();if(e!=s){for(var i in s=e,l)l[i].Orientation(e,t);this.Align(t),window.scrollTo(0,0)}},Align:function(){var t=arguments[0]||null,e=WCT.dom.GetWindowWidth(),i=WCT.dom.GetWindowHeight(),s=c.length;if(s)if(1==s){(r=l[c[0]]).SetPosition(0,0,e,i,t),r.SetHandlerCount(1),r.SetActive(!0),t||r.Resize(null,!0)}else{for(var n=null,o=0;o<s;o++){if((r=l[c[o]]).GetType()==HANDLER.MODE.library){n=r;break}}for(o=0;o<s;o++){var r=l[c[o]];if(n&&r.IsLibEmbedded()){var a=n.GetEmbeddedPos()||{x:0,y:0,w:e,h:i};r.SetPosition(a.x,a.y,a.w,a.h,t)}else r.SetPosition(0,0,e,i,t);BROWSER.IE&&BROWSER.VERSION<11&&o<s-1?r.SetHandlerCount(1):r.SetHandlerCount(s),r.SetActive(!1)}l[c[s-1]].SetActive(!0)}}}}(),MANAGER.broadcast={ClientInit:function(t){return DATA.AddClient(t),DATA.Stringify()},ClientReady:function(t){var e=DATA.GetClients()[t];MANAGER.just_an_opener_?BROADCAST.SendClients("NewMaster",e):BROADCAST.SendClient(e,"ClientInitTracking")},ClientStop:function(t){DATA.RemoveClient(t),DATA.HasClients()||MANAGER.Fini(!arguments[1])},ClientDone:function(t){var e=DATA.GetClients()[t];e&&BROADCAST.SendClient(e,"ClientClose",null,arguments[1]),DATA.RemoveClient(t),DATA.HasClients()||MANAGER.Fini()},ClientClose:function(){!1===arguments[1]?MANAGER.Cleanup():MANAGER.CloseWindow(arguments[0]||!1)},ClientInitTracking:function(){var t=DATA.GetActiveManager(),e=t.wnd&&t.wnd.MANAGER&&t.wnd.MANAGER.GetCentralTracker()||null;MANAGER.InitTracking(e)},NewMaster:function(t){DATA.SetActiveManager(t)},NewMasterReady:function(){MANAGER.CloseWindow()},GetActiveManager:function(){return DATA.GetActiveManager().wnd},GetData:function(t){var e=null;arguments[2]&&(e=new WCT.context).Parse(arguments[2]);var i=DATA.GetS(t,arguments[1],e);return i?JSON.stringify(i):null},GetDataM:function(t){var e=null;arguments[1]&&(e=new WCT.context).Parse(arguments[1]);var i=DATA.GetSM(JSON.parse(t),e);return i?JSON.stringify(i):null},BroadcastEvent:function(t){DATA.GetActiveManager().active&&BROADCAST.SendClients("BroadcastEvent",t),MANAGER.event.Handle(t)}},function(){var n=[];MANAGER.event={Cleanup:function(){this.UnregisterListener()},RegisterListener:function(t){n.push(t)},UnregisterListener:function(){var t=arguments[0]||{},e=[];if(t.control_id)for(var i=0,s=null;s=n[i++];)s.handler_id===t.handler_id&&s.slide_id===t.slide_id&&s.control_id===t.control_id||e.push(s);else if(t.slide_id)for(i=0,s=null;s=n[i++];)s.handler_id===t.handler_id&&s.slide_id===t.slide_id||e.push(s);else if(t.handler_id)for(i=0,s=null;s=n[i++];)s.handler_id!==t.handler_id&&e.push(s);n=e},Broadcast:function(t){t.manager_id=MANAGER.GetUid(),BROADCAST.SendMaster("BroadcastEvent",JSON.stringify(t))},Handle:function(t){t=JSON.parse(t);for(var e=0,i=null;i=n[e++];)if(i.content_id===t.content_id){var s=MANAGER.handler.Get(i.handler_id);if(!s){this.UnregisterListener({handler_id:i.handler_id});continue}s.BroadcastEvent({content_id:i.content_id,slide_id:i.slide_id,control_id:i.control_id,data:t})}}}}();var PRODUCER={http_:!0,Init:function(){var t=DATA.context.GetBase();t.search(/127\.0\.0\.1/)<0&&t.search(/localhost/)<0&&(this.http_=!1)},SetMacroUid:function(t){if(this.http_)if(0==DATA.context.GetProtocol().indexOf("http")){var e=DATA.context.GetBase()+"/lesson_tracking",i={current_mac_uid:t};BROWSER.IE?null==XHR.PostS(e,i)&&(PRODUCER.http_=!1):XHR.PostA(e,i,null,function(){},PRODUCER.DisableHttpTracking)}else this.http_=!1},DisableHttpTracking:function(){window.PRODUCER&&(PRODUCER.http_=!1)}};function Popup(t){arguments.length&&(this.hdl_id_=t.hdl_id,this.skin_=t.skin,this.callback_=t.callback,this.scope_=t.scope,this.id_="",this.buttons_=[],this.dnd_=null,this.moved_=!1)}function Panel(t,e,i){this.hdl_id_=t,this.callback_=e,this.scope_=i;var s=MANAGER.handler.Get(t).GetSkin("panel")||{};this.hor_=s.hor?new Panel.standard(t,"hor",s,Panel.prototype.on_panel_,this):null,this.vert_=s.vert?new Panel.standard(t,"vert",s,Panel.prototype.on_panel_,this):null,this.data_={},this.shown_=!1,this.ori_=null,this.lesson_pause_=!1}function Profile(t,e){var i=MANAGER.handler.Get(t);this.hdl_uid_=t,this.cb_=e,this.uid_=t+"#profile",this.skin_=i.GetSkin("profile"),this.fader_=null,this.tabs_={},this.tab_active_=null,this.dnd_=null}PRODUCER.VideoExport=function(){var i=!1;function s(t,e,i){var s=e,n=i;try{void 0!==s?void 0!==n?external[t](s,n):external[t](s):external[t]()}catch(o){}}return{Debug:function(t){(DATA.GetConfig()||{}).video_debug&&NOTIFICATION.ShowMessage(t)},Enabled:function(){return"boolean"==typeof arguments[0]&&(i=arguments[0]),i},SetFPS:function(t){this.Debug("SetFPS: "+t);var e=MANAGER.handler.GetActive();(e=e?e.GetSlideHandler():null)&&e.SetupVideoMode(t)},Progress:function(t,e){i&&(this.Debug("Progress: "+t+" / "+e),s("OnProgress",t,e))},Resize:function(){i&&(this.Debug("Resize"),s("OnResize",WCT.dom.GetWindowWidth(),WCT.dom.GetWindowHeight()))},Ready:function(){i&&(this.Debug("Ready"),this.Resize(),s("OnReady"))},Tick:function(){this.Debug("Tick");var t=MANAGER.handler.GetActive();t&&t.VideoTick()},TickDone:function(t){i&&(this.Debug("TickDone"+(t?" ("+t+")":"")),s("OnFrameReady"))},Audio:function(t,e){i&&(this.Debug("Audio: "+t+" - "+e),s("start"==t?"OnAudioStart":"OnAudioStop",e))},Fini:function(){i&&(this.Debug("Fini"),s("OnFinish"))}}}(),Popup.OnDnd=function(){this.moved_=!0},Popup.prototype={Destructor:function(){var t=this.hdl_id_,e=t+"#"+this.id_;if(this.dnd_&&(this.dnd_.Destructor(),this.dnd_=null),this.buttons_){for(var i=SKIN.textcontrol,s=0,n=null;n=this.buttons_[s++];)i.Cleanup(e+"#buttons#"+n.id);this.buttons_=null}var o=$(e);if(o){var r=o.parentNode;r.scrollTop=0,r.scrollLeft=0,r.style.overflow="hidden",r.removeChild(o)}if(PLATFORM.ANDROID){var a=MANAGER.handler.Get(t);HANDLER.MODE.library===a.GetType()&&a.SetVisibility(!0)}var l=$(e+"#cover");l&&l.parentNode.removeChild(l);var c=$(e+"#evt");c&&c.parentNode.removeChild(c),this.skin_=null,this.callback_=null,this.scope_=null},Resize:function(){var t=this.hdl_id_,e=MANAGER.handler.Get(t),i=e&&e.GetHandlerDim(),s=this.skin_;if(i&&s){var n=WCT.skin,o=t+"#"+this.id_,r=$(o+"#cover");r&&n.ApplyPosition(r,i);var a=$(o+"#evt");if(a&&n.ApplyPosition(a,i),!this.moved_){var l=Math.max(0,i.w-(s.w||0)>>1),c=Math.max(0,i.h-(s.h||0)>>1),_=$(o);_&&(_.style.left=l+"px",_.style.top=c+"px")}}},Show:function(t){var e=this.hdl_id_,i=MANAGER.handler.Get(e),s=i&&i.GetDom(),n=this.skin_;if(!(s&&n.frame&&n.text&&n.button))return null;var o=e+"#"+this.id_,r=WCT.skin,a=i.GetHandlerDim(),l=WCT.iframe.Create();l.id=o+"#cover",r.ApplyPosition(l,a),n.background_color&&(PLATFORM.ANDROID&&!BROWSER.CHROME||(l.style.backgroundColor=n.background_color),l.style.opacity=.5),s.appendChild(l),PLATFORM.ANDROID&&HANDLER.MODE.library===i.GetType()&&i.SetVisibility(!1);var c=$$("div");c.id=o+"#evt",r.ApplyPosition(c,a),s.appendChild(c);var _=n.w||0,d=n.h||0,u=Math.max(0,a.w-n.w>>1),h=Math.max(0,a.h-n.h>>1),p=$$("div");p.id=o,p.tabIndex=0,p.setAttribute("role","dialog"),p.setAttribute("aria-labelledby",o+"#title"),p.style.position="absolute",p.style.left=u+"px",p.style.top=h+"px",p.style.width=_+"px",p.style.height=d+"px",s.appendChild(p),s.style.overflow="auto",p.focus();var f=i.GetContentInfo().rtl,m=n.title;if(o+="#",SKIN.popup.CreateFrame(p,n.frame,{id:o,w:_,h:d}),m){var b=SKIN.popup.CreateTitle(p,m,{id:o,w:_,title:t,rtl:f});this.dnd_=new WCT.dnd(p,b),this.dnd_.SetCallback("onbegin",Popup.OnDnd,this)}var v=SKIN.popup.GetDim(n.frame);v.x=v.l,v.y=v.t,v.w=_-v.w,v.h=d-v.h;var g=$$("div");g.id=o+"content",f&&(g.style.direction="rtl"),r.ApplyPosition(g,v),r.ApplyTextFormats(g,n.text),p.appendChild(g);var y=n.button,C=v.b-(y.h||0)>>1,T=y.outer_spacing_r||3,x={x:-v.r-T,y:v.y+v.h+C,w:v.w-T,h:Math.max(0,v.b-C)},A=$$("div");A.id=o+"buttons",A.style.textAlign=f?"left":"right",r.ApplyPosition(A,x),p.appendChild(A),o+="buttons#";for(var S=SKIN.textcontrol,k=f?"marginRight":"marginLeft",E=!0,w=0,R=null;R=this.buttons_[w++];){var N=S.Add({id:o+R.id,skin:y,dom:A,onexec:this.on_button_,scope:this,tabindex:0,text:i.Trans(R.textkey)});N.style.position="relative",N.style.display="inline-block",E||(N.style[k]=T+"px"),E=!1}return{cont:g,dim:v}},SetZIndex:function(t){var e=this.hdl_id_+"#"+this.id_,i=$(e+"#cover");i&&(i.style.zIndex=t);var s=$(e+"#evt");s&&(s.style.zIndex=t);var n=$(e);n&&(n.style.zIndex=t)},enable_button_:function(t,e){t=this.hdl_id_+"#"+this.id_+"#buttons#"+t,SKIN.textcontrol.Enabled(t,e)},close:function(){this.on_button_(this.hdl_id+"#"+this.id_+"#buttons#cancel",{})},on_button_:function(t,e){}},Popup.KeywordSearch=function(t){Popup.call(this,t),this.keywords_=t.keywords,this.tabindex_=t.tabindex||0,this.id_="kwsearch",this.buttons_=[{id:"view",textkey:"VIEW"},{id:"cancel",textkey:"CANCEL"}],this.sf_=null,this.s1_=null,this.s2_=null,this.st_=null},Popup.KeywordSearch.prototype=new Popup,Popup.KeywordSearch.STYLE={background_color_a:"#3399FF",text_color_a:"#FFFFFF"},Popup.KeywordSearch.OnTextbox=function(t){var e=(t=WCT.event.Standardize(t)).target.id.split("#"),i=e.length,s=e[i-2];if("keywords"==s||"resources"==s){var n=MANAGER.handler.Get(e[0]),o=n&&n.GetSearch();if(o){var r=e[i-1];"keywords"==s?o.select_list1_(r):o.select_list2_(r)}}},WCT.ExtendObject(Popup.KeywordSearch.prototype,{Destructor:function(){this.keywords_=null,this.sf_&&(this.sf_.Destructor(),this.sf_=null);var t=this.hdl_id_+"#"+this.id_,e=$(t+"#keywords"),i=$(t+"#resources");e&&(e.onclick=null),i&&(i.onclick=null),Popup.prototype.Destructor.call(this)},Show:function(){var t=this.skin_;if(!t.search)return!1;var e=this.hdl_id_,i=MANAGER.handler.Get(e),s=Popup.prototype.Show.call(this,i.Trans("KEYWORD_SEARCH"));if(!s)return!1;this.enable_button_("view",!1);for(var n=t.text.outer_spacing_l||0,o=t.text.outer_spacing_r||0,r=Math.min(n,o),a=[{id:"search",textkey:"SEARCH_STRING",type:"search"},{id:"keywords",textkey:"KEYWORDS",type:"box"},{id:"resources",textkey:"RESOURCES",type:"box"}],l=HANDLER.library.ModuleSearch.STYLE,c=Math.max(t.text.line_height,t.text.font_size,12),_=Math.max(0,s.dim.h-t.search.h-15-3*c-4*l.border_width-10)>>1,d=e+"#"+this.id_+"#",u=i.GetContentInfo().rtl,h=0,p=null;p=a[h++];){var f=d+p.id,m=$$("label");if(m.id=f+"#label",m.htmlFor=d+p.id,m.style.display="block",m.style.marginLeft=n+"px",m.style.marginRight=o+"px",m.style.marginTop="5px",m.style.fontWeight="bold",m.appendChild($$2(i.Trans(p.textkey))),s.cont.appendChild(m),"box"==p.type){var b=$$("div");b.id=f,b.tabIndex=this.tabindex_,b.setAttribute("role","list"),b.setAttribute("aria-labelledby",f+"#label"),b.style.height=_+"px",b.style.borderWidth=l.border_width+"px",b.style.borderStyle="solid",b.style.borderColor="#999 #666 #666 #999",b.style.borderRadius=l.border_radius+"px",b.style.marginLeft=n+"px",b.style.marginRight=o+"px",b.style.overflowX="hidden",b.style.overflowY="scroll",s.cont.appendChild(b),b.onclick=Popup.KeywordSearch.OnTextbox}else{var v=HANDLER.library.ModuleSearch.GetStyle(t.search),g=new Searchfield({hdl_id:e,id:this.id_+"#search",skin:v,dom:s.cont,onsearch:this.on_search_,scope:this,rtl:u}),y=s.dim.w-2*r+v.margin_left+v.margin_right;g.SetWH(y,t.search.h),g.SetXY(r-v.margin_left,0),this.sf_=g}}return this.fill_list1_(),this.sf_&&this.sf_.Focus(),!0},fill_list1_:function(){var t=this.hdl_id_+"#"+this.id_+"#keywords",e=$(t),i=this.keywords_,s=arguments[0]||null;e.innerHTML="";var n=this.s1_=null;for(var o in i)if(!s||s[o]){var r=$$("div");r.id=t+"#"+o,r.tabIndex=this.tabindex_,r.setAttribute("role","listitem"),r.style.padding="0 2px",r.style.cursor="pointer",r.appendChild($$2(o)),e.appendChild(r),n=n||o}this.select_list1_(n)},select_list1_:function(t){var e=this.hdl_id_+"#"+this.id_+"#keywords#";if(this.s1_){var i=$(e+this.s1_);i&&(i.style.backgroundColor="",i.style.color="")}var s=$(e+t);if(s){var n=Popup.KeywordSearch.STYLE;s.style.backgroundColor=n.background_color_a,s.style.color=n.text_color_a}this.s1_=t,this.fill_list2_(t)},fill_list2_:function(t){var e=this.hdl_id_+"#"+this.id_+"#resources",i=$(e);i.innerHTML="",this.s2_=null,this.enable_button_("view",!1);var s=this.keywords_[t];if(s){e+="#";for(var n=0,o=null;o=s[n++];){var r=$$("div");r.id=e+o.uid,r.tabIndex=this.tabindex_,r.setAttribute("role","listitem"),r.style.padding="0 2px",r.style.cursor="pointer",r.appendChild($$2(o.caption)),i.appendChild(r)}}},select_list2_:function(t){var e=this.hdl_id_+"#"+this.id_+"#resources#";if(this.s2_){var i=$(e+this.s2_);i&&(i.style.backgroundColor="",i.style.color="")}var s=$(e+t);if(s){var n=Popup.KeywordSearch.STYLE;s.style.backgroundColor=n.background_color_a,s.style.color=n.text_color_a}this.s2_=t,this.enable_button_("view",!0),this.callback_&&this.callback_.call(this.scope_,!0,t)},on_button_:function(t,e){if(this.callback_){var i=0<=t.search(/view$/);this.callback_.call(this.scope_,i)}},on_search_:function(t){var e=(t=t.toLowerCase()).split(" "),i=e.length-1,s=this.keywords_;if(this.st_!=t){this.st_=t;var n={};for(var o in s){var r=o.toLowerCase();if(0<=r.indexOf(t))n[o]=1;else for(var a=i;0<=a;a--)if(0<=r.indexOf(e[a])){n[o]=1;break}}this.fill_list1_(n)}}}),Popup.ManagerFeedback=function(t){Popup.call(this,t),this.id_="feedback",this.buttons_=[{id:"submit",textkey:"FEEDBACK_SEND"},{id:"cancel",textkey:"CANCEL"}],this.submit_id_=null,this.cancel_id_=null},Popup.ManagerFeedback.prototype=new Popup,Popup.ManagerFeedback.CheckResponse=function(hdl_id){var count=arguments[1]||0,hdl=MANAGER.handler.Get(hdl_id),me=hdl&&hdl.GetFeedback();if(me){var recf=$(hdl_id+"#"+me.id_+"#rec");if(recf&&recf.contentWindow){var bdy="error";try{var doc=recf.contentWindow.document;bdy=doc&&doc.body,bdy=bdy&&bdy.innerText.replace(/\n|\r/g,"")}catch(e){bdy="error"}!bdy&&count<20&&WCT.SetTimeout(Popup.ManagerFeedback.CheckResponse,100,Popup.ManagerFeedback,[hdl_id,count++]);var res="";try{res=JSON.parse(bdy),res=res&&res.response}catch(e){res=""}if(res&&(WCT.IsEmptyObject(res)||!0===res.success))return void me.callback_.call(me.scope_);if(""!=bdy){me.enable_button_("submit",!0),me.enable_button_("cancel",!0);var err={};try{eval("err = "+bdy)}catch(e){err.message_error_code="MGR_FEEDBACK_UNSPECIFIED_ERR"}if(err)return void NOTIFICATION.ShowMessage(MANAGER.Trans(err.message_error_code))}WCT.SetTimeout(Popup.ManagerFeedback.CheckResponse,100,Popup.ManagerFeedback,[hdl_id,count])}}},WCT.ExtendObject(Popup.ManagerFeedback.prototype,{Destructor:function(){var t=this.hdl_id_+"#"+this.id_,e=$(t+"#rec");e&&e.parentNode.removeChild(e),WCT.event.hotkey.Suspend(t,!1),Popup.prototype.Destructor.call(this)},Show:function(){var t=this.hdl_id_,e=MANAGER.handler.Get(t);if(e){var i=Popup.prototype.Show.call(this,e.Trans("FEEDBACK_TITLE"));if(!i)return!1;var s=WCT.iframe.Create(DATA.context.ToAbsPath("trainer:about_blank.html"),null,t+"#feedback#rec");s.tabIndex=-1,s.setAttribute("role","presentation"),s.style.display="none",document.body.appendChild(s);var n=e.GetContentInfo(),o=DATA.GetS(n.tclass+"!"+n.uid+":entity.txt"),r=e.GetCurrentSlide?e.GetCurrentSlide():null,a=e.GetCurrentTourstop?e.GetCurrentTourstop():null,l=e.GetCurrentMacro?e.GetCurrentMacro():null,c=n.selection||"",_=c?DATA.GetS(c+":entity.txt"):null,d={type:e.GetType(),uid:n.tclass+"!"+n.uid,mode:n.mode||"",title:o.caption||"",tsidx:a&&null!=a.orig_index_?a.orig_index_+1:"",tsuid:a&&a.uid,tstitle:a&&a.title,macuid:l&&l.uid||"",slideuid:r&&r.uid||"",slidetitle:r&&r.caption||"",startentity:c,startentitytitle:_&&_.caption||"",lib_list_mode:n.lib_list_mode},u=t+"#"+this.id_+"#",h=$$("form");h.id=u+"form",h.enctype="multipart/form-data",h.encoding="multipart/form-data",h.method="post",h.target=u+"rec";var p=DATA.context.GetBase()+"/"+n.tclass;h.action=p+"/"+n.uid+"/.comment",i.cont.appendChild(h);var f=XHR.GetToken();if(f||(XHR.GetS(p,"JSON"),f=XHR.GetToken()),f){var m=WCT.dom.CreateInputElement("hidden","X-CSRF-Token");m.value=f,h.appendChild(m)}for(var b in d){(N=WCT.dom.CreateInputElement("hidden",b)).value=d[b],h.appendChild(N)}var v=this.skin_,g=v.inputradio||{},y=(b="outer_spacing_",{t:3,r:3,b:0,l:5});for(var C in y)g[b+C]="undefined"!=typeof g[b+C]?g[b+C]:y[C];for(var T=v.text.outer_spacing_l||0,x=v.text.outer_spacing_r||0,A=g[b+"t"]+g[b+"b"]+(g.h||13),S=0,k=(d=[{txt:"FEEDBACK_QUESTION"},{id:"mist",txt:"FEEDBACK_MISTAKE",radio:"radiobutton",val:1},{id:"comm",txt:"FEEDBACK_COMMENTS",radio:"radiobutton",val:2},{txt:"DESCRIPTION"},{area:"description"}]).length;S<k;S++){var E=d[S],w=$$("div");if(w.id=u+"wrp-"+S,w.style.marginLeft=T+"px",w.style.marginRight=x+"px",w.style.whiteSpace="nowrap",w.style.overflow="hidden",h.appendChild(w),E.radio){(N=WCT.dom.CreateInputElement("radio",E.radio)).id=u+E.id,N.value=E.val,N.style.marginTop=g.outer_spacing_t+"px",N.style.marginRight=g.outer_spacing_r+"px",N.style.marginBottom=g.outer_spacing_b+"px",N.style.marginLeft=g.outer_spacing_l+"px",g.w&&(N.style.width=g.w+"px"),g.h&&(N.style.height=g.h+"px"),N.style.verticalAlign="middle",w.appendChild(N);var R=$$("label");R.appendChild($$2(e.Trans(E.txt))),R.setAttribute("for",u+E.id),w.appendChild(R)}else if(E.area){var N;(N=$$("textarea")).name=E.area,N.setAttribute("aria-labelledby",u+"wrp-"+(S-1)),N.style.resize="none",N.style.width=i.dim.w-T-x-4+"px";var G=x,O=v.text&&v.text.line_height||0;G+=2*O+2*Math.max(A,O)+O/3,N.style.height=Math.round(i.dim.h-G)+"px",v.input&&WCT.skin.ApplyTextFormats(N,v.input),w.appendChild(N)}else w.appendChild($$2(e.Trans(E.txt)))}WCT.event.hotkey.Suspend(t+"#"+this.id_,!0);var I=u.substring(0,u.length-1),M=document.getElementById(I);return M&&WCT.event.Observe("keydown",this.onKey.bind(this),M),!0}},onKey:function(t){"Escape"===t.key&&this.close()},on_button_:function(t,e){var i=!0;if(0<=t.search(/submit$/)){var s=$(this.hdl_id_+"#"+this.id_+"#form");s&&(this.callback_&&(WCT.SetTimeout(Popup.ManagerFeedback.CheckResponse,50,Popup.ManagerFeedback,[this.hdl_id_]),this.enable_button_("submit",!1),this.enable_button_("cancel",!1)),i=!1,s.submit())}i&&this.callback_&&this.callback_.call(this.scope_)}}),Panel.ORI_MAP={left:"vert",right:"vert",top:"hor",bottom:"hor"},Panel.prototype=function(){function r(){return this[(Panel.ORI_MAP[this.ori_]||"")+"_"]||null}function a(t){var e=this.data_;3==arguments.length?(e[t]||(e[t]={}),e[t][arguments[1]]=WCT.DeepCopy(arguments[2])):e[t]=WCT.DeepCopy(arguments[1]);var i=r.call(this);i&&i.Exec(t,arguments[1],arguments[2])}function l(t){var e=this[t];if(e){var i=this.data_;for(var s in i){var n=i[s];if("object"==typeof n)if(null==n||n.isArray)e.Exec(s,n);else for(var o in n)e.Exec(s,o,n[o]);else e.Exec(s,n)}}}return{Destructor:function(){this.callback_=null,this.scope_=null,this.hor_&&(this.hor_.Destructor(),this.hor_=null),this.vert_&&(this.vert_.Destructor(),this.vert_=null),WCT.CleanupObject(this.data_),this.data_=null},Resize:function(t,e){if(!this.shown_)return null;var i=MANAGER.handler.Get(this.hdl_id_).GetSkin("panel"),s={x:0,y:0,w:t,h:e};switch(this.ori_){case"top":s.h=i.hor.h;break;case"left":s.w=i.vert.w;break;case"bottom":s.y=e-i.hor.h,s.h=i.hor.h;break;case"right":s.x=t-i.vert.w,s.w=i.vert.w}var n=r.call(this),o=n?n.Resize(t,e):{w:0,h:0};return s.w=Math.max(s.w,o.w),s.h=Math.max(s.h,o.h),s},RefreshIE:function(){var t=r.call(this);t&&t.RefreshIE()},HandleOri:function(t){if(t.cmd&&-1!=t.cmd.search("orientation_toggle_")){var e=t.cmd.substr(19),i={top:"bottom",bottom:"top"};this.Show(i[e]),this.VisibleCommand("orientation_toggle_"+e,!1),this.VisibleCommand("orientation_toggle_"+i[e],!0)}},Show:function(t){var e=Panel.ORI_MAP[t]+"_";if(!this[e])if(this.hor_)t="top",e="hor_";else{if(!this.vert_)return;t="left",e="vert_"}var i,s=this.data_;if(this.ori_!=t){if(null==this.ori_){i=this[e],this.ori_=t,l.call(this,e),s.Move=t,i.Move(t),i.Show();var n=null!=this.vert_,o=null!=this.hor_;a.call(this,"EnableOrientation","left",n),a.call(this,"EnableOrientation","right",n),a.call(this,"EnableOrientation","top",o),a.call(this,"EnableOrientation","bottom",o),a.call(this,"EnableOrientation","float",!1),this.shown_=!0}else{switch(this.ori_+"_"+t){case"left_right":case"right_left":case"top_bottom":case"bottom_top":i=r.call(this),a.call(this,"Move",t);break;case"left_top":case"left_bottom":case"right_top":case"right_bottom":case"top_left":case"top_right":case"bottom_left":case"bottom_right":(i=r.call(this))&&i.Hide(),i=this[e],l.call(this,e),a.call(this,"Move",t),i.Show()}this.ori_=t}a.call(this,"ActiveOrientation",t),this.VisibleCommand("orientation_toggle_top",!1),this.VisibleCommand("orientation_toggle_bottom",!1)}},Visible:function(t){var e=r.call(this);e&&e[t?"Show":"Hide"]()},Steps:function(t){a.call(this,"Steps",t)},EnableToc:function(t){a.call(this,"EnableToc",t)},VisibleToc:function(t){a.call(this,"VisibleToc",t)},VisibleProgress:function(t){a.call(this,"VisibleProgress",t)},EnableCommand:function(t,e){a.call(this,"EnableCommand",t,e)},ActiveCommand:function(t,e){a.call(this,"ActiveCommand",t,e)},VisibleCommand:function(t,e){a.call(this,"VisibleCommand",t,e)},SetBookStep:function(t){var e=MANAGER.handler.Get(this.hdl_id_).GetToc(),i=null!=e.GetSlideOrderIdx("prev",t),s=null!=e.GetSlideOrderIdx("next",t);a.call(this,"Step",t),a.call(this,"EnableCommand","prev_chapter",i),a.call(this,"EnableCommand","prev",0<t),a.call(this,"EnableCommand","next",0<=t&&t+1<this.data_.Steps),a.call(this,"EnableCommand","next_chapter",s)},PreventNavigation:function(t){var e=MANAGER.handler.Get(this.hdl_id_),i=e.GetToc&&e.GetToc();if(i){var s=e.GetCurrentSlide(),n=i.GetSlideOrderIdx("cur",s.uid),o=null!=i.GetSlideOrderIdx("prev",n),r=null!=i.GetSlideOrderIdx("next",n);a.call(this,"EnableCommand","prev_chapter",!t&&o),a.call(this,"EnableCommand","prev",!t&&0<n),a.call(this,"EnableCommand","next",!t&&0<=n&&n+1<this.data_.Steps),a.call(this,"EnableCommand","next_chapter",!t&&r),a.call(this,"EnableToc",!t)}},SetLessonStep:function(t,e){a.call(this,"Step",t);var i=MANAGER.handler.Get(this.hdl_id_);if(i&&i.GetConfig("panel_nav_disabled")||!1)a.call(this,"VisibleCommand","prev",!1),a.call(this,"VisibleCommand","next",!1),a.call(this,"VisibleCommand","pause",!1),a.call(this,"VisibleCommand","play",!1);else{var s="demo"==e||"pres"==e||"guided"==e;a.call(this,"EnableCommand","prev",0<t),a.call(this,"EnableCommand","next",0<=t&&t+1<this.data_.Steps),a.call(this,"VisibleCommand","pause",s&&!this.lesson_pause_),a.call(this,"VisibleCommand","play",s&&this.lesson_pause_)}},SetLessonPause:function(t,e){this.lesson_pause_=t,this.SetLessonStep(this.data_.Step,e)},VisibleTimeline:function(t){a.call(this,"VisibleTimeline",t)},VisibleTimelineText:function(t){a.call(this,"VisibleTimelineText",t)},SetTimelinePreloaded:function(t){a.call(this,"SetTimelinePreloaded",t)},SetTimelineText:function(t){a.call(this,"SetTimelineText",t)},SetTimelineTitles:function(t){a.call(this,"SetTimelineTitles",t)},SetTimelineVisibles:function(t){a.call(this,"SetTimelineVisibles",t)},SetTimelineJumpables:function(t){a.call(this,"SetTimelineJumpables",t)},SetAudioControls:function(t,e,i){var s=BROWSER.MOBILE;a.call(this,"VisibleCommand","audio_mute",!s&&!t),a.call(this,"VisibleCommand","audio_unmute",!s&&t),a.call(this,"VisibleCommand","audio_play",e||i),a.call(this,"VisibleCommand","audio_pause",!e&&!i)},SetHandlerCount:function(t){a.call(this,"SetHandlerCount",t)},LogoClickable:function(t){a.call(this,"LogoClickable",t)},LogoVisible:function(t){a.call(this,"LogoVisible",t)},SetStatusText:function(t){a.call(this,"SetStatusText",t)},GetControl:function(t){var e=r.call(this);return e?e.GetControl(t,arguments[1]):null},GetPanel:function(){return this.hor_?this.hor_:this.vert_?this.vert_:null},on_panel_:function(t){t.ori&&this.Show(t.ori),this.HandleOri(t),this.callback_.call(this.scope_,t)}}}(),Panel.standard=function(t,e,i,s,n){this.hdl_id_=t,this.ori_=e,this.skin_=i,this.callback_=s,this.scope_=n,this.dom_=null,this.to_=null,this.w_=null,this.h_=null,this.orig_w_=null,this.orig_h_=null,this.res_to_=null,this.res_dc_=null;var o=i[e]&&i[e].groups||[],r=[],a={prev_chapter:{id:-1,target:"next_chapter"},next_chapter:{id:-1,target:"prev_chapter"}},l=MANAGER.handler.Get(this.hdl_id_);l.GetType()!==HANDLER.MODE.library&&(a.prev={id:-1,target:"next"},a.next={id:-1,target:"prev"});for(var c=0,_=null,d=0;_=o[c];c++)for(var u=0,h=null;h=_.elements[u++];)if(Panel.controls[h.type]){var p=h.type+(h.subtype?"#"+h.subtype:""),f=new Panel.controls[h.type](t,e,h,p,Panel.standard.prototype.on_control_,this);f.ctl_type=h.type,f.ctl_subtype=h.subtype||null,f.ctl_count=d++,r.push(f),a[f.ctl_subtype]&&(a[f.ctl_subtype].id=r.length-1)}if(l.GetContentInfo().rtl)for(var m in a)if(0<=a[m].id&&0<=a[a[m].target].id){var b=r[a[m].id],v=r[a[a[m].target].id],g=WCT.DeepCopy(b.skin_);b.skin_=WCT.DeepCopy(v.skin_),v.skin_=WCT.DeepCopy(g),a[m].id=-1}this.controls_=r,this.lm_=new LayoutManager,this.lm_.FromPanelSkin(o,e)},Panel.standard.DelayedResize=function(t){var e=MANAGER.handler.Get(t);if(e){e.Resize(null,!0);var i=e.GetPanel();if((i=i&&i.GetPanel()||null)&&i.res_dc_)for(var s=0,n=null;n=i.res_dc_[s++];)n.ctl.Visible(n.val,!0)}},Panel.standard.prototype=function(){function n(t,e){for(var i=this.controls_,s="Visible"==e,n=!1,o=arguments.length,r=arguments[2],a=arguments[3],l=this.lm_,c=this.res_dc_||[],_=0,d=null;d=i[_++];)if((!t||d.ctl_type==t)&&d[e]){var u=a;if(3==o)u=r;else if(r&&d.ctl_subtype!=r)continue;s?(d.Autosize()||l.Visible(d.ctl_count,u),c.push({ctl:d,val:u}),d[e](u,!1),n=!0):d[e](u)}n&&(this.res_dc_=c,this.res_to_&&WCT.ClearTimeout(this.res_to_),this.res_to_=WCT.SetTimeout(Panel.standard.DelayedResize,15,Panel.standard,[this.hdl_id_]))}function i(t){var e=this.dom_;e&&(e.style.height=t+"px")}return{Destructor:function(){if(this.res_to_&&(WCT.ClearTimeout(this.res_to_),this.res_to_=null),this.res_dc_=null,this.callback_=null,this.scope_=null,this.skin_=null,this.dom_&&(this.dom_.parentNode.removeChild(this.dom_),this.dom_=null),this.lm_&&(this.lm_.Destructor(),this.lm_=null),this.controls_){for(var t=this.controls_,e=t.length-1;0<=e;e--)t[e].Destructor(),t[e]=null;this.controls_=null}},Resize:function(){var t=null,e=this.lm_.GetMinDim(),i=this.skin_[this.ori_];if(e.w=isNaN(i.w)?e.w:Math.min(i.w,e.w),e.h=isNaN(i.h)?e.h:Math.min(i.h,e.h),2==arguments.length&&(this.orig_w_=arguments[0],this.orig_h_=arguments[1]),this.w_=Math.max(this.orig_w_,e.w),this.h_=Math.max(this.orig_h_,e.h),t="hor"==this.ori_?(this.dom_.style.width=this.w_+"px",{w:this.w_,h:e.h}):(this.dom_.style.height=this.h_+"px",{w:e.w,h:this.h_}),null!=this.w_&&null!=this.h_){for(var s=this.lm_.Apply(this.w_,this.h_),n=this.controls_,o=0,r=null;r=s[o];o++){var a=n.indexOfAtt(o,"ctl_count");0<=a&&n[a].MoveTo(r.x,r.y,r.w,r.h)}return t}},RefreshIE:function(){var t=this.dom_,e=parseInt(t.style.height);t.style.height=e+1+"px",WCT.SetTimeout(i,1,this,[e])},Show:function(){this.dom_||function l(){var t=this.skin_[this.ori_];if(t){var e={x:0,y:0,w:"100%",h:"100%"};"hor"==this.ori_?("bottom"==this.to_&&(e.y="-0"),e.h=t.h||0):("right"==this.to_&&(e.x="-0"),e.w=t.w||0);var i=MANAGER.handler.Get(this.hdl_id_),s=$$("div");if(s.id=this.hdl_id_+"#panel."+this.ori_,s.tabIndex=0,s.setAttribute("role","toolbar"),s.setAttribute("aria-label",i.Trans("top"===this.to_?"GUI_TOP_BAR":"GUI_BOTTOM_BAR")),WCT.skin.ApplyPosition(s,e),t.image){var n=WCT.DeepCopy(t.image);n.repeat="hor"==this.ori_?"x":"y",WCT.skin.ApplyBgImage(s,n)}this.dom_=s,i.GetDom().appendChild(s);for(var o=this.controls_,r=0,a=null;a=o[r++];)a.Show(s)}}.call(this),this.dom_&&(this.dom_.style.display="block")},Hide:function(){this.dom_&&(this.dom_.style.display="none")},Exec:function(t){var e=arguments[1],i=arguments[2];switch(t){case"EnableOrientation":n.call(this,"orientation","Enabled",e);break;case"ActiveOrientation":n.call(this,"orientation","Active",null,!1),n.call(this,"orientation","Active",e,!0);break;case"Steps":n.call(this,null,"Steps",e);break;case"Step":n.call(this,null,"Step",e);break;case"Move":this.Move(e);break;case"EnableToc":n.call(this,"toc","Enabled",e);break;case"VisibleToc":n.call(this,"toc","Visible",e);break;case"VisibleProgress":n.call(this,"progress","Visible",e);break;case"SetStatusText":n.call(this,"status","SetText",e);break;case"EnableCommand":n.call(this,"control","Enabled",e,i);break;case"ActiveCommand":n.call(this,"control","Active",e,i);break;case"VisibleCommand":n.call(this,"control","Visible",e,i);break;case"SetHandlerCount":n.call(this,"control","SetHandlerCount",e);break;case"LogoClickable":n.call(this,"logo","Enabled",e);break;case"LogoVisible":n.call(this,"logo","Visible",e);break;case"SetTimelineTitles":n.call(this,"timeline","SetTitles",e);break;case"SetTimelineVisibles":n.call(this,"timeline","SetVisibles",e);break;case"SetTimelineJumpables":n.call(this,"timeline","SetJumpables",e);break;case"SetTimelinePreloaded":n.call(this,"timeline","SetPreloaded",e);break;case"SetTimelineText":n.call(this,"timeline","SetText",e);break;case"VisibleTimeline":n.call(this,"timeline","Visible",e);break;case"VisibleTimelineText":n.call(this,"timeline","VisibleText",e);break;default:throw new Error("Panel.standard.Exec - unknown cmd: "+t)}},Move:function(t){var e=this.dom_,i=null,s=null;"hor"!=this.ori_||"top"!=t&&"bottom"!=t?"vert"!=this.ori_||"left"!=t&&"right"!=t||(i="left",s="right"):(i="top",s="bottom"),i&&(this.to_=t,e&&(e.style[i]="",e.style[s]="",e.style[t]="0px"),n.call(this,null,"Move",t))},GetControl:function(t){for(var e=arguments[1]||"",i=this.controls_,s=0,n=null;n=i[s++];)if(n.ctl_type==t&&(!e||n.ctl_subtype==e))return n;return null},on_control_:function(t){this.callback_.call(this.scope_,t)}}}(),Panel.controls=function(t,e,i,s,n,o){arguments.length&&(this.hdl_id_=t,this.ori_=e,this.skin_=i,this.id_=s,this.callback_=n,this.scope_=o,this.state_={v:!0,e:!0,a:!1},this.x_=null,this.y_=null,this.w_=null,this.h_=null,this.dom_id_=t+"#panel."+e+"#"+s)},Panel.controls.prototype={Destructor:function(){var t=$(this.dom_id_);t&&t.parentNode.removeChild(t),this.skin_=null,this.callback_=null,this.scope_=null,this.state_=null},GetDom:function(){return $(this.dom_id_)},Autosize:function(){return this.skin_&&this.skin_.autosize||!1},Visible:function(){var t=arguments[0],e=this.state_;if("boolean"==typeof t&&(e.v!=t||arguments[1])){if(!1!==arguments[1]){var i=$(this.dom_id_);i&&(i.style.display=t?"block":"none")}e.v=t}return e.v},MoveTo:function(t,e,i,s){if(this.state_.v&&(this.x_!=t||this.y_!=e||this.w_!=i||this.h_!=s)){var n=arguments[4]||0,o=arguments[5]||0;this.x_=t,this.y_=e,this.w_=i,this.h_=s,this.move_to_(n,o)}},move_to_:function(t,e){var i=$(this.dom_id_);if(i){var s=this.x_,n=this.w_,o=this.h_;if(n<=t||o<=e)i.style.display="none";else{var r=MANAGER.handler.Get(this.hdl_id_),a="left",l="right";!!r&&r.GetContentInfo().rtl&&(a="right",l="left"),s<0?(i.style[l]=-s+"px",i.style[a]=""):(i.style[a]=s+"px",i.style[l]=""),i.style.top=this.y_+"px",i.style.width=n+"px",i.style.height=o+"px",i.style.display="block"}}}},Panel.controls.control=function(){Panel.controls.apply(this,arguments),this.cb_key_="cmd"},Panel.controls.control.prototype=new Panel.controls,WCT.ExtendObject(Panel.controls.control.prototype,{Destructor:function(){SKIN.control.Cleanup(this.dom_id_),Panel.controls.prototype.Destructor.call(this)},Show:function(t){var e=this.skin_,i=this.dom_id_,s=this.state_,n=MANAGER.handler.Get(this.hdl_id_),o=null;e.tooltip&&(o=n.Trans(e.tooltip)),SKIN.control.Add({id:i,skin:e,dom:t,tag:"button",onexec:this.on_exec_,scope:this,title:o,visible:s.v,enabled:s.e,active:s.a,rtl:n.GetContentInfo().rtl}),null!=s.hcount&&this.SetHandlerCount(s.hcount)},Visible:function(){var t=arguments[0],e=this.state_;return"boolean"!=typeof t||e.v==t&&!arguments[1]||(!1!==arguments[1]&&SKIN.control.Visible(this.dom_id_,t),e.v=t),e.v},Enabled:function(){var t=arguments[0],e=this.state_;return"boolean"==typeof t&&e.e!=t&&(SKIN.control.Enabled(this.dom_id_,t),e.e=t),e.e},Active:function(){var t=arguments[0],e=this.state_;return"boolean"==typeof t&&e.a!=t&&(SKIN.control.Active(this.dom_id_,t),e.a=t),e.a},SetHandlerCount:function(t){if("control#exit"==this.id_){var e=$(this.dom_id_+"#count");if((this.state_.hcount=t)<2)e&&e.parentNode.removeChild(e);else if(e)e.firstChild.nodeValue=t;else{var i=this.skin_,s=SKIN.control.GetDom(this.dom_id_);if(i&&i.badge&&s){var n=WCT.DeepCopy(i.badge);n.x="-0",n.y=1,n.border_style="solid",n.border_width=1,n.padding_left=2,n.padding_right=2,n.font_size&&(n.line_height=n.font_size),(e=$$("div")).id=this.dom_id_+"#count",WCT.skin.ApplyPosition(e,n),WCT.skin.ApplyTextFormats(e,n),WCT.skin.ApplyBorder(e,n),WCT.skin.ApplyPadding(e,n),e.appendChild($$2(t)),e.setAttribute("role","presentation"),e.setAttribute("aria-hidden","true"),s.appendChild(e)}}}},MoveTo:function(){if(Panel.controls.prototype.MoveTo.apply(this,arguments),"control#exit"==this.id_&&1<this.state_.hcount){var t=$(this.dom_id_+"#count");if(!t)return;var e=MANAGER.handler.Get(this.hdl_id_).GetContentInfo().rtl,i=this.skin_.badge,s=-(i.w>>1);t.style[e?"left":"right"]=s+"px";var n=1-(i.h>>1);n=Math.max(n,1-this.y_),t.style.top=n+"px"}},move_to_:function(t,e){var i=this.dom_id_;this.w_<=t||this.h_<=e?SKIN.control.Visible(i,!1):(SKIN.control.MoveTo(i,this.x_,this.y_),SKIN.control.Visible(i,!0))},on_exec_:function(){if(!this.state_.d){var t={};t[this.cb_key_]=this.id_.split("#").top(),this.callback_.call(this.scope_,t)}}}),Panel.controls.logo=function(){Panel.controls.apply(this,arguments)},Panel.controls.logo.prototype=new Panel.controls,WCT.ExtendObject(Panel.controls.logo.prototype,{Destructor:function(){var t=$(this.dom_id_);t&&(t.onclick=null,t.parentNode.removeChild(t)),Panel.controls.prototype.Destructor.call(this)},Show:function(t){var e=$$("div");e.id=this.dom_id_,e.style.position="absolute",this.skin_.image&&WCT.skin.ApplyBgImage(e,this.skin_.image),t.appendChild(e)},Enabled:function(t){var e=$(this.dom_id_);if(t){var i=MANAGER.handler.Get(this.hdl_id_);e.title=i.Trans("CONTENT"),e.tabIndex=0,e.setAttribute("role","link"),e.style.cursor="pointer",e.onclick=function s(){this.callback_.call(this.scope_,{logo:1})}.bind(this)}else e.onclick=null,e.style.cursor="default",e.setAttribute("role","presentation")}}),Panel.controls.orientation=function(){Panel.controls.control.apply(this,arguments),this.cb_key_="ori"},Panel.controls.orientation.prototype=new Panel.controls.control,Panel.controls.orientation.prototype.Show=function(t){MANAGER.handler.Get(this.hdl_id_).GetConfig("panel_fixed")||Panel.controls.control.prototype.Show.call(this,t)},Panel.controls.progress=function(){Panel.controls.apply(this,arguments),this.step_=null,this.steps_=null},Panel.controls.progress.prototype=new Panel.controls,WCT.ExtendObject(Panel.controls.progress.prototype,{Destructor:function(){SKIN.bar.Cleanup(this.dom_id_+"#bar"),Panel.controls.prototype.Destructor.call(this)},Show:function(t){var e=this.skin_,i=this.dom_id_,s=MANAGER.handler.Get(this.hdl_id_).GetContentInfo().rtl,n=$$("div");n.id=i,n.style.position="absolute",t.appendChild(n),SKIN.bar.Add({id:i+"#bar",skin:e,steps:this.steps_,dom:n,rtl:s});var o=$$("div");WCT.skin.ApplyTextFormats(o,e),o.style.position="absolute",o.style.top=e.bar_h+2+"px",o.style.width="100%",o.style.textAlign="center",s&&(o.style.direction="rtl"),n.appendChild(o),this.state_.v||(n.style.display="none")},Step:function(t){this.step_=t;var e=this.steps_;t=Math.min(t+1,e);var i=MANAGER.handler.Get(this.hdl_id_).GetToc().GetHidden(),s=i.length;e-=s;for(var n=0,o=0;o<s;o++)i[o]<t&&n++;s&&-1!==i.indexOf(t)&&(t=""),t&&SKIN.bar.Progress(this.dom_id_+"#bar",0<e?t/e:0,null,t,e),t&&(t-=n);var r=$(this.dom_id_);if(r){var a=(t||"-")+" / "+e;WCT.SetNodeText(r.lastChild,a)}},Steps:function(t){this.steps_=t}}),Panel.controls.status=function(){Panel.controls.apply(this,arguments)},Panel.controls.status.prototype=new Panel.controls,WCT.ExtendObject(Panel.controls.status.prototype,{Show:function(t){var e=MANAGER.handler.Get(this.hdl_id_).GetContentInfo().rtl,i=$$("h1");i.id=this.dom_id_,WCT.skin.ApplyTextFormats(i,this.skin_),i.style.position="absolute",i.style.overflow="hidden",i.style.textOverflow="ellipsis",i.style.whiteSpace="nowrap",e&&(i.style.direction="rtl"),WCT.dom.NotSelectable(i),t.appendChild(i)},SetText:function(t){var e=$(this.dom_id_);e&&(WCT.SetNodeText(e,t),e.setAttribute("title",t))}}),Panel.controls.timeline=function(){Panel.controls.apply(this,arguments),this.step_=null,this.steps_=null},Panel.controls.timeline.prototype=new Panel.controls,Panel.controls.timeline.MIN_W=49,WCT.ExtendObject(Panel.controls.timeline.prototype,{Destructor:function(){SKIN.timeline.Cleanup(this.dom_id_),Panel.controls.prototype.Destructor.call(this)},Show:function(t){var e=MANAGER.handler.Get(this.hdl_id_).GetContentInfo().rtl;SKIN.timeline.Add({id:this.dom_id_,skin:this.skin_,dom:t,ori:this.ori_,steps:this.steps_,onexec:this.on_exec_,scope:this,rtl:e}).style.display="none"},Step:function(t){this.step_=t,SKIN.timeline.Step(this.dom_id_,t+1,arguments[1])},Steps:function(t){this.steps_=t},SetPreloaded:function(t){SKIN.timeline.Preloaded(this.dom_id_,t+1)},VisibleText:function(t){this.state_.vt=t},SetText:function(t){!1!==this.state_.vt&&SKIN.timeline.SetText(this.dom_id_,t)},SetTitles:function(t){SKIN.timeline.SetTitles(this.dom_id_,t)},SetVisibles:function(t){SKIN.timeline.SetVisibles(this.dom_id_,t)},SetJumpables:function(t){SKIN.timeline.SetJumpables(this.dom_id_,t)},MoveTo:function(t,e,i,s){Panel.controls.prototype.MoveTo.call(this,t,e,i,s,Panel.controls.timeline.MIN_W)},move_to_:function(t,e){var i=this.dom_id_;this.w_<=t||this.h_<=e?SKIN.timeline.Visible(i,!1):(SKIN.timeline.MoveTo(i,this.x_,this.y_),SKIN.timeline.Resize(i,this.w_),SKIN.timeline.Visible(i,!0))},on_exec_:function(t){id=Number(t.split("#").top()),isNaN(id)||this.callback_.call(this.scope_,{timeline:id-1})}}),Panel.controls.toc=function(){Panel.controls.apply(this,arguments),this.iframe_=null,this.main_=null,this.enabled_=!0,this.visible_=!0,this.step_=null,this.pos_=null;var t=Panel.controls.toc,e=WCT.DeepCopy(this.skin_);e.h=t.H,e.border_width=1,e.border_style="solid",e.border_color="#999999",e.font_size||(e.font_size=t.FONT_SIZE),this.skin_=e},Panel.controls.toc.prototype=new Panel.controls,Panel.controls.toc.CELL_PADDING=3,Panel.controls.toc.FONT_SIZE=12,Panel.controls.toc.H=16,Panel.controls.toc.OPEN_MARGIN=10,Panel.controls.toc.MIN_W=100,WCT.ExtendObject(Panel.controls.toc.prototype,function(){function a(t,e){var i=this.main_;if(i&&i.open_){for(var s=t.target;s&&s.id&&s.id.search(/toc$/)<0;)s=s.parentNode;s&&s.id||(i.Colorize(!1),i.Close(t),i.Step(i.step_,!0,!1))}}return{Destructor:function(){MANAGER.StopEventObserving("mousedown",this.dom_id_+"_1"),MANAGER.StopEventObserving("mousedown",this.dom_id_+"_2"),this.iframe_&&(this.iframe_.Destructor(),this.iframe_=null),this.main_&&(this.main_.Destructor(),this.main_=null),Panel.controls.prototype.Destructor.call(this)},Show:function(t){if("hor"==this.ori_){var e=Panel.controls.toc,i=this.skin_,s=this.dom_id_;(o=new e.iframe(this.hdl_id_,this.dom_id_+"#iframe",i)).Create(t),this.iframe_=o;var n=new e.main(this,this.hdl_id_,this.dom_id_,i,this.pos_);n.Create(t),this.main_=n;var o,r=(o=MANAGER.handler.Get(this.hdl_id_).GetSlideRendererIFrame(0)||null)&&o.contentWindow||null;MANAGER.ObserveEvent("mousedown",s+"_1",a,this),r&&MANAGER.ObserveEvent("mousedown",s+"_2",a,this,r)}},Visible:function(){"boolean"==typeof arguments[0]&&(this.visible_=arguments[0]);var t=this.visible_&&"number"==typeof this.w_&&this.w_>=Panel.controls.toc.MIN_W,e=this.state_;return t!=e.v&&(e.v=t,this.main_&&this.main_.SetVisible(t),this.iframe_&&this.iframe_.SetVisible(t)),t},Enabled:function(){var t=arguments[0];return"boolean"==typeof t&&(this.enabled_=t,this.main_&&this.main_.SetEnabled(t)),this.enabled_},MoveTo:function(t,e,i,s){if(this.x_!=t||this.y_!=e||this.w_!=i||this.h_!=s){this.x_=t,this.y_=e,this.w_=i,this.h_=s;var n=this.iframe_,o=this.main_;n&&o&&this.Visible()&&(o.MoveTo(t,e,i,s),n.MoveTo(t,e,i,s))}},Move:function(t){this.pos_=t,this.main_&&this.main_.Move(t)},Step:function(t){WCT.dom.IOSOpacitySwitch(this.main_.GetDom());var e=this.main_;if(e&&null!=t){var i=MANAGER.handler.Get(this.hdl_id_).GetToc().GetSlideListIdx(t);this.step_=t,null!=i&&(e.UpdateVisited(),e.Step(i))}},GetDom:function(){return null},GetMain:function(){return this.main_},GetIFrame:function(){return this.iframe_}}}()),Panel.controls.toc.main=function(t,e,i,s,n){this.par_=t,this.hdl_id_=e,this.dom_id_=i,this.skin_=s,this.pos_=n,this.rows_=null,this.rmap_=null,this.open_=!1,this.enabled_=!0,this.open_h_=0,this.cell_h_=0,this.top_=0,this.height_=0,this.tabindex_=0,this.step_=null,this.hover_=null,this.to_anim_=null,this.toc_opacity_=null},Panel.controls.toc.main.ANIM_INT=50,Panel.controls.toc.main.ANIM_SPEED=200,Panel.controls.toc.main.Animate=function(t,e,i,s,n){var o=$(e+"#m");if(o){var r=Math[0<n?"min":"max"](i+n,s);if(o.style.top=r+"px",r!=s){var a=MANAGER.handler.Get(t),l=a&&a.GetPanel()||null,c=(l&&l.GetControl("toc")||null).GetMain();if(c){i+=n;var _=Panel.controls.toc.main;c.to_anim_=WCT.SetTimeout(_.Animate,_.ANIM_INT,_,[t,e,i,s,n])}}}},Panel.controls.toc.main.prototype=function(){function i(t,e){var i=WCT[e]||null;if(i){var s=[],n=null;for(t=t.split(".");n=t.shift();){var o=Number(n);s.push(i(o))}return s.join(".")}return t}function k(t,e){switch(e){case"none":return"";case"1.":return t.join(".")+".";case"I.":return i(t.join("."),"ArabicToRoman")+".";case"i.":return i(t.join("."),"ArabicToRoman").toLowerCase()+".";case"A.":return i(t.join("."),"ArabicToLetters")+".";case"a.":return i(t.join("."),"ArabicToLetters").toLowerCase()+".";default:Log("Panel.toc.generate_order_ - unsupported numbering: "+e)}return""}function o(t){for(var e=(t=WCT.event.Standardize(t)).target,i=-1<e.id.search(/#m#\d+#\d/)?e.id:e.id+"#0";e&&e.id&&e.id.search(/toc$/)<0;)e=e.parentNode;if(!e||!e.id)return null;var s=e.id.split("#")[0],n=MANAGER.handler.Get(s),o=n&&n.GetPanel()||null,r=o&&o.GetControl("toc")||null,a=r&&r.GetMain()||null;return a?{id:i,me:a,toc:n.GetToc()}:null}function n(t){var e=o(t);if(e&&e.me.enabled_)if(e.me.open_){e.me.Colorize(!1),e.me.Close(),e.me.Step(e.me.step_,!0,!1);var i=e.id.split("#");if(1<i.length&&e.toc&&(i=Number(i[i.length-2]),!isNaN(i))){var s=e.toc.GetSlideOrderIdx("cur",i,"list_idx"),n=e.me.par_;null!=s&&n.callback_.call(n.scope_,{toc:s})}}else e.me.Open(),e.me.Colorize(!0)}function r(t){var e=o(t);if(e&&e.me.open_){var i=e.id.split("#");1<i.length&&(i=Number(i[i.length-2]),isNaN(i)||e.me.Colorize(!0,i))}}function a(t){var e=o(t);e&&e.me.open_&&e.me.Colorize(!0)}function m(t){for(var e=0,i=null;i=this.rows_[e];e++)i.Prepare4Scrollbar(t);var s=$(this.dom_id_);s&&(s.style.overflowY=t?"scroll":"hidden")}return{Destructor:function(){if(this.to_anim_&&(WCT.ClearTimeout(this.to_anim_),this.to_anim_=null),this.par_=null,this.skin_=null,WCT.CleanupObject(this.rmap_),this.rmap_=null,this.rows_){for(var t=this.rows_.length-1;0<=t;t--)this.rows_[t].Destructor(),this.rows_[t]=null;this.rows_=null}var e=$(this.dom_id_);e&&(e.onclick=null,e.onmouseover=null,e.onmouseout=null,e.parentNode.removeChild(e))},Create:function(t){var e=this.skin_,i=$$("div");i.id=this.dom_id_,i.tabIndex=this.tabindex_,i.setAttribute("role","button"),i.setAttribute("aria-haspopup","listbox"),WCT.skin.ApplyBorder(i,e),WCT.skin.ApplyTextFormats(i,e),i.style.position="absolute",i.style.cursor="pointer",i.style.overflow="hidden",i.onclick=n,i.onmouseover=r,i.onmouseout=a,t.appendChild(i);var s=$$("div");s.id=this.dom_id_+"#m",s.tabIndex=-1,s.setAttribute("role","listbox"),s.setAttribute("aria-expanded","false"),WCT.skin.ApplyTextFormats(s,e),s.style.position="absolute",s.style.left="0",s.style.top="0",i.appendChild(s),function S(t){for(var e=this.dom_id_+"#m#",i=this.skin_,s=MANAGER.handler.Get(this.hdl_id_),n=s.GetToc(),o=n.GetList(),r=Panel.controls.toc.row,a=[],l={},c=0,_=1,d=s.GetConfig("panel_toc_numbering"),u=s.GetConfig("book_show_cdoc"),h=s.GetConfig("book_show_project"),p=s.GetConfig("book_show_book_group"),f=[0],m=[],b=0,v=null;v=o[b];b++)if(p||0!=v.level){var g=!1;if("slide"!=v.tclass){var y=o[b+1];g=y&&y.level>v.level,"cdoc"==v.tclass||"media"===v.tclass?u||(g=!0):"project"==v.tclass||p||(g=!0)}for(;m.length&&m.top()>=v.level;)m.pop(),f.pop();f[f.length-1]++;var C=k(f,d),T=C+" "+v.caption,x=n.IsVisited(v.tclass,v.uid),A=new r(t,e+b,i,T,[C,v.caption,"",_],x,g,v.hidden_in_toc,b);a.push(A),l[b]=c++,"slide"==v.tclass?v.hidden_in_toc||_++:((!m.length||m.top()<v.level)&&(m.push(v.level),f.push(0)),(u&&"cdoc"==v.tclass||h&&"project"==v.tclass||p&&("book"==v.tclass||"group"==v.tclass))&&_++)}this.rows_=a,this.rmap_=l}.call(this,s)},MoveTo:function(t,e,i,s){this.Close();var n=MANAGER.handler.Get(this.hdl_id_),o="left",r="right";!!n&&n.GetContentInfo().rtl&&(o="right",r="left");var a=this.skin_;a.border_width&&(i-=2*a.border_width);var l=$(this.dom_id_);l&&(t<0?(l.style[r]=-t+"px",l.style[o]=""):(l.style[o]=t+"px",l.style[r]=""),l.style.top=e+"px",l.style.width=i+"px",l.style.height=s+"px"),this.top_=e,this.height_=s;var c=this.rows_;if(c){for(var _=[[],[],[],[]],d=0,u=null;u=c[d];d++){var h=u.GetCellWidths();_[0].push(h[0]),_[1].push(h[1]),_[2].push(h[2]),_[3].push(h[3])}var p=2*Panel.controls.toc.CELL_PADDING;_[0]=Math.max(_[0].max()-p,0),_[2]=Math.max(_[2].max()-p,0),_[3]=Math.max(_[3].max()-p,0),_[1]=Math.max(i-_[0]-_[2]-_[3]-4*p,0);var f=Math.max(a.font_size,s),m=f*d;this.cell_h_=f,this.open_h_=m,(l=$(this.dom_id_+"#m")).style.width=i+"px",l.style.height=m+"px";var b=0;for(u=null;u=c[b];b++)u.SetCellWidths(_),u.SetCellHeights(f)}},SetVisible:function(t){var e=$(this.dom_id_);e&&(e.style.display=t?"block":"none")},SetEnabled:function(t){this.enabled_=t},GetDom:function(){return $(this.dom_id_)},UpdateVisited:function(){for(var t=MANAGER.handler.Get(this.hdl_id_).GetToc(),e=this.rows_,i=this.rmap_,s=t.GetVisited(),n=0,o=null;o=s[n];n++)for(var r=t.GetListItems(o.tclass,o.uid),a=0,l=null;l=r[a];a++){var c=i[l.list_idx];null!=c&&e[c]&&e[c].SetVisited()}},Step:function(t){if(this.to_anim_&&(WCT.ClearTimeout(this.to_anim_),this.to_anim_=null),this.step_!=t||arguments[1]){var e=null!=this.step_?this.rmap_[this.step_]:0,i=this.rmap_[t];this.step_=t;var s=MANAGER.handler.Get(this.hdl_id_).GetConfig("panel_toc_animation"),n=0,o=0,r=this.skin_.menu_entry;r&&(o=WCT.skin.GetPaddingHeight(r),n=r.padding_top||0);var a=(-this.cell_h_-o)*i-n;if(!1!==arguments[2]&&s){var l=-this.cell_h_*e,c=(_=(a-l)/Panel.controls.toc.main.ANIM_SPEED*Panel.controls.toc.main.ANIM_INT,Panel.controls.toc.main);this.to_anim_=WCT.SetTimeout(c.Animate,c.ANIM_INT,c,[this.hdl_id_,this.dom_id_,l,a,_])}else{var _;(_=$(this.dom_id_+"#m"))&&(_.style.top=a+"px")}}},Move:function(t){this.pos_=t},Open:function(){if(!this.open_){this.open_=!0;var t=this.dom_id_,e=$(t);if(e){for(var i=this.top_,s=this.open_h_,n=this.rows_,o=0,r=0,a=n.length;r<a;r++){var l=n[r],c=l.GetNumber()!==this.step_&&l.GetHidden();l.SetHidden(c),c?o++:l.setTabindex(!0)}s-=o*this.height_;var _=WCT.dom.GetPosition(e).top||0,d=!1,u=Panel.controls.toc.OPEN_MARGIN;if("top"==this.pos_){var h=WCT.dom.GetWindowHeight();h<_+s+u&&(s=h-_-u,d=!0)}else _+this.height_-u<s&&(s=_+this.height_-u,d=!0),i+=this.height_-s,e.style.top=i+"px";if(e.style.height=s+"px",e.firstChild.style.top="0",PLATFORM.IOS&&(e.firstChild.style.height=s+"px"),d){m.call(this,!0);var p=$(t+"#m#"+this.step_);p&&p.scrollIntoView(!0)}this.par_.GetIFrame().MoveTo(null,i,null,s);var f=$(t+"#m");f.tabIndex=this.tabindex_,f.setAttribute("aria-expanded","true"),f.focus(),WCT.dom.IOSOpacitySwitch(e)}}},Close:function(){if(this.open_){this.open_=!1;for(var t=this.rows_,e=0,i=t.length;e<i;e++){var s=t[e];s.SetHidden(!1),s.setTabindex(!1)}var n=this.dom_id_,o=$(n);if(o){o.style.height=this.height_+"px",o.scrollTop="0",PLATFORM.IOS&&(o.firstChild.style.height=this.height_+"px"),"bottom"===this.pos_&&(o.style.top=this.top_+"px"),m.call(this,!1);var r=this.skin_,a=r.border_width?2*r.border_width:0;this.par_.GetIFrame().MoveTo(null,this.top_,null,r.h+a);var l=$(n+"#m");l.tabIndex=-1,l.setAttribute("aria-expanded","false"),o.focus()}}},Colorize:function(t){var e=arguments[1];if(null!=this.hover_){if("number"!=typeof e||this.hover_!=e){var i=this.rmap_[this.hover_];(s=this.rows_[i])&&s.SetHover(!1)}this.hover_=null}if("number"==typeof e){i=this.rmap_[e];(s=this.rows_[i])&&s.SetHover(!0),this.hover_=e}if(null!=this.step_){var s;i=this.rmap_[this.step_];(s=this.rows_[i])&&s.SetActive(t)}}}}(),Panel.controls.toc.iframe=function(t,e,i){this.hdl_id_=t,this.dom_id_=e,this.skin_=i},Panel.controls.toc.iframe.prototype={Destructor:function(){var t=$(this.dom_id_);t&&t.parentNode.removeChild(t),this.skin_=null},Create:function(t){var e=this.skin_,i=WCT.iframe.Create();i.id=this.dom_id_,i.tabIndex=-1,i.setAttribute("role","presentation"),WCT.skin.ApplyBorder(i,e),i.style.height=(e.h||0)+"px",i.style.width=(e.w||0)+"px",i.style.borderColor="transparent",i.style.backgroundColor="#fff",i.style.opacity="0.1",t.appendChild(i)},MoveTo:function(t,e,i,s){var n=MANAGER.handler.Get(this.hdl_id_),o="left",r="right";!!n&&n.GetContentInfo().rtl&&(o="right",r="left");var a=$(this.dom_id_);a&&(null!=t&&(t<0?(a.style[r]=-t+"px",a.style[o]=""):(a.style[o]=t+"px",a.style[r]="")),null!=e&&(a.style.top=e+"px"),null!=i&&(a.style.width=i+"px"),null!=s&&(a.style.height=s+"px"),WCT.dom.IOSOpacitySwitch(a))},SetVisible:function(t){var e=$(this.dom_id_);e&&(e.style.display=t?"block":"none")}},Panel.controls.toc.row=function(t,e,i,s,n,o,r){var a=arguments[7]||!1,l=$$("div");l.id=e,l.tabIndex=-1,l.setAttribute("role","listitem"),r&&(l.style.fontWeight="bold"),l.onclick=function(){},l.setAttribute("title",s),l.style.clear="both",l.style.overflow="hidden",t.appendChild(l),e+="#";var c=$$("div");c.setAttribute("title",s),c.style.cssFloat="left",c.style.overflow="hidden",c.style.padding="0 "+Panel.controls.toc.CELL_PADDING+"px";var _=c.cloneNode(0);_.id=e+0,a||_.appendChild($$2(n[0])),l.appendChild(_),(_=c.cloneNode(0)).id=e+1,_.style.textOverflow="ellipsis",_.style.whiteSpace="nowrap",_.appendChild($$2(n[1])),l.appendChild(_);var d=(i.image_v&&i.image_v.w||0)+"px";(_=c.cloneNode(0)).id=e+2,_.style.width=d,o&&WCT.skin.ApplyBgImage(_,i.image_v),_.appendChild($$2(n[2])),l.appendChild(_),(_=c.cloneNode(0)).id=e+3,_.style.textAlign="right",a||_.appendChild($$2(n[3])),l.appendChild(_),this.skin_=i,this.dom_=l,this.w1_=null,this._number=arguments[8],this._hidden_in_toc=a},Panel.controls.toc.row.prototype=function(){function e(t,e){var i=this.dom_;if(i){var s=this.skin_,n=s.text_color||"#000",o=s.background_color||"#fff";t&&(s["text_color_"+e]&&(n=s["text_color_"+e]),s["background_color_"+e]&&(o=s["background_color_"+e])),i.style.color=n,i.style.backgroundColor=o}}return{Destructor:function(){this.skin_=null,this.dom_=null},SetVisited:function(t){var e=this.dom_&&this.dom_.childNodes||null;e&&WCT.skin.ApplyBgImage(e[2],this.skin_.image_v)},SetActive:function(t){e.call(this,t,"a")},SetHover:function(t){e.call(this,t,"h")},SetHidden:function(t){var e=this.dom_;e&&(e.style.display=t?"none":"")},GetHidden:function(){return this._hidden_in_toc},GetNumber:function(){return this._number},setTabindex:function(t){this.dom_&&(this.dom_.tabIndex=t?0:-1)},Prepare4Scrollbar:function(t){var e=this.dom_&&this.dom_.childNodes||null;if(e){var i=this.w1_;t&&(i-=WCT.dom.GetScrollbarWidth()),e[1].style.width=i+"px"}},SetCellWidths:function(t){var e=this.dom_&&this.dom_.childNodes||null;e&&(this.w1_=t[1],e[0].style.width=t[0]+"px",e[1].style.width=t[1]+"px",e[2].style.width=t[2]+"px",e[3].style.width=t[3]+"px")},SetCellHeights:function(t){var e=this.dom_;e&&(t+="px",e.style.height=t,(e=e.childNodes)&&(e[0].style.height=t,e[1].style.height=t,e[2].style.height=t,e[3].style.height=t,e[0].style.lineHeight=t,e[1].style.lineHeight=t,e[3].style.lineHeight=t))},GetCellWidths:function(){var t=this.dom_&&this.dom_.childNodes||null;return t?[t[0].offsetWidth,t[1].offsetWidth,t[2].offsetWidth,t[3].offsetWidth]:[0,0,0,0]}}}(),Profile.STYLES={header_padding_l:5,header_padding_r:5,tabs_margin_t:10,tabs_margin_b:30,tabs_padding_l:5,tabs_padding_r:5,content_margin_l:5,content_margin_r:5,content_margin_t:5,content_margin_b:5,tab_margin_l:1,tab_margin_r:1,tab_margin_t:0,tab_margin_b:2,tab_padding_l:5,tab_padding_r:5,tab_border_l:1,tab_border_r:1},Profile.prototype=function(){function k(){if(this.cb_){var t=MANAGER.handler.Get(this.hdl_uid_);t&&this.cb_.call(t,"close")}}function E(t){var e=(t=WCT.event.Standardize(t)).target.id.substr(0,t.target.id.indexOf("#")),i=MANAGER.handler.Get(e),s=i&&i.GetProfile()||null;s&&"a"==t.targetName&&0<=t.target.id.indexOf(s.uid_+"#tabs#")&&function n(t){var e=t.target.id.split("#").top();if(e!=this.tab_active_)if("click"==t.type)w.call(this,e);else{var i=this.skin_.tab,s="mouseover"==t.type?"_h":"";WCT.skin.ApplyBgImage(t.target,i["image"+s]||i.image),i["text_color"+s]&&i.text_color&&(t.target.style.color=i["text_color"+s])}}.call(s,t)}function w(t){var e=this.uid_,i=$(e+"#tabs#"+t),s=$(e+"#content");if(i&&s&&this.tabs_[t]){var n=this.skin_.tab;if(this.tab_active_){var o=$(e+"#tabs#"+this.tab_active_);o&&(o.setAttribute("aria-selected","false"),WCT.skin.ApplyBgImage(o,n.image),n.text_color&&(o.style.color=n.text_color)),this.tabs_[this.tab_active_]&&this.tabs_[this.tab_active_].RemoveContent()}this.tab_active_=t,i.setAttribute("aria-selected","true"),WCT.skin.ApplyBgImage(i,n.image_a||n.image),n.text_color_a&&n.text_color&&(i.style.color=n.text_color_a),this.tabs_[t].ShowContent(s)}}function o(t,e){if(this.cb_){var i=MANAGER.handler.Get(this.hdl_uid_);i&&this.cb_.call(i,t,e)}}return{Destructor:function(){if(this.dnd_&&(this.dnd_.Destructor(),this.dnd_=null),SKIN.control.Cleanup(this.uid_+"#header#exit"),this.tabs_){for(var t in this.tabs_)this.tabs_[t].Destructor(),delete this.tabs_[t];this.tabs_=null}var e=$(this.uid_);e&&(e.onmouseover=null,e.onmouseout=null,e.onclick=null,e.parentNode.style.overflow="hidden",e.parentNode.removeChild(e)),this.fader_&&(this.fader_.Destructor(),this.fader_=null),this.hdl_uid_=null,this.cb_=null,this.skin_=null},GetConfig:function(t){return MANAGER.handler.Get(this.hdl_uid_).GetConfig(t)},Trans:function(t){return MANAGER.handler.Get(this.hdl_uid_).Trans(t)},Enable:function(){for(var t=this.uid_+"#tabs#",e=this.uid_+"#content#",i=MANAGER.handler.Get(this.hdl_uid_).GetContentInfo().rtl,s=0,n=arguments.length;s<n;s++)Profile[arguments[s]]&&(this.tabs_[arguments[s]]=new Profile[arguments[s]](this,t,e,o,i))},GetTab:function(t){return this.tabs_[t]},GetSkin:function(){return this.skin_},GetContentH:function(){var t=this.skin_,e=Profile.STYLES,i=(t.header.h||0)+(t.tab.h||0)+e.tabs_margin_t+e.tabs_margin_b+e.content_margin_t+e.content_margin_b;return Math.max((t.h||0)-i,0)},Configure:function(t,e){this.tabs_[t]&&this.tabs_[t].Configure(e)},close:function(){k.call(this)},Show:function(t,e){var i=this.skin_;if(i&&i.header&&i.exit&&i.content&&i.tab){var s=new WCT.Fader(this.uid_+"#fader");s.Create(e),this.fader_=s;var n=$$("div");n.id=this.uid_,n.tabIndex=0,n.setAttribute("role","dialog"),n.setAttribute("aria-label",this.Trans("SETTINGS")),n.className="trainer-settings",WCT.skin.ApplyPosition(n,i),WCT.skin.ApplyTextFormats(n,i),WCT.skin.ApplyBorder(n,i),n.style.overflow="hidden",n.style.zIndex="1",e.appendChild(n),e.style.overflow="auto",n.focus(),n.onmouseover=E,n.onmouseout=E,n.onclick=E;var o=s.GetDim(),r=o.w,a=o.h,l=i.w||n.offsetWidth,c=i.h||n.offsetHeight;n.style.left=Math.max(0,r-l>>1)+"px",n.style.top=Math.max(0,a-c>>2)+"px";var _=Profile.STYLES,d=$$("div");d.id=this.uid_+"#header",WCT.skin.ApplyTextFormats(d,i.header),WCT.skin.ApplyBorder(d,i.header),d.style.overflow="hidden",d.style.textOverflow="ellipsis",d.style.whiteSpace="nowrap",d.style.paddingLeft=_.header_padding_l+"px",d.style.paddingRight=_.header_padding_r+"px",i.header.h&&(d.style.height=i.header.h+"px",d.style.lineHeight=i.header.h+"px"),n.appendChild(d);var u=MANAGER.handler.Get(this.hdl_uid_).GetContentInfo().rtl,h=WCT.DeepCopy(i.exit);h.x=u?2:-2,h.y=2,SKIN.control.Add({id:this.uid_+"#header#exit",skin:h,dom:d,onexec:k,scope:this,title:this.Trans(h.tooltip),tag:"button"});var p=$$("div");p.id=this.uid_+"#tabs",p.setAttribute("role","tablist"),p.setAttribute("aria-label",this.Trans("SETTINGS")),p.style.marginTop=_.tabs_margin_t+"px",p.style.marginBottom=_.tabs_margin_b+"px",p.style.paddingLeft=_.tabs_padding_l+"px",p.style.paddingRight=_.tabs_padding_r+"px",p.style.clear="both",p.style.overflow="hidden",WCT.dom.NotSelectable(p),n.appendChild(p);var f=$$("div");f.id=this.uid_+"#content",f.className="content",WCT.skin.ApplyBorder(f,i.content),WCT.skin.ApplyTextFormats(f,i.content),f.style.marginLeft=_.content_margin_l+"px",f.style.marginRight=_.content_margin_r+"px",f.style.marginTop=_.content_margin_t+"px",f.style.marginBottom=_.content_margin_b+"px",f.style.overflow="auto",WCT.dom.NotSelectable(f),n.appendChild(f);var m=0;for(var b in this.tabs_)m++;var v=_.tabs_padding_l+_.tabs_padding_r,g=i.tab.border_left?Number(i.tab.border_left.split("px")[0]):_.tab_border_l,y=i.tab.border_right?Number(i.tab.border_right.split("px")[0]):_.tab_border_r,C=(_.tab_padding_l+_.tab_padding_r)*m,T=(g+y)*m,x=(_.tab_margin_l+_.tab_margin_r)*m,A=Math.floor((l-v-x-C-T)/m);for(var b in this.tabs_){var S=this.tabs_[b].GetTabDom();S.setAttribute("role","tab"),S.setAttribute("aria-selected","false"),WCT.skin.ApplyTextFormats(S,i.tab),i.tab.image&&WCT.skin.ApplyBgImage(S,i.tab.image),S.style.overflow="hidden",S.style.textOverflow="ellipsis",S.style.whiteSpace="nowrap",S.style.cssFloat="left",S.style.borderLeft=i.tab.border_left||_.tab_border_l+"px solid "+(i.tab.border_left_color||"#999"),S.style.borderRight=i.tab.border_right||_.tab_border_r+"px solid "+(i.tab.border_right_color||"#999"),S.style.marginLeft=_.tab_margin_l+"px",S.style.marginRight=_.tab_margin_r+"px",S.style.marginTop=_.tab_margin_t+"px",S.style.marginBottom=_.tab_margin_b+"px",S.style.paddingLeft=_.tab_padding_l+"px",S.style.paddingRight=_.tab_padding_r+"px",S.style.borderRadius=(i.tab.border_radius||0)+"px",S.style.boxShadow=i.tab.box_shadow||"0 0 0 0 #000",S.style.height=i.tab.h+"px",S.style.lineHeight=i.tab.h+"px",S.style.width=A+"px",p.appendChild(S)}this.dnd_=new WCT.dnd(n,d),w.call(this,t)}}}}(),Profile.tab=function(t,e,i,s,n){arguments.length&&(this.hdl_=t,this.name_=this.name_||"tab",this.caption_=this.caption_||"",this.tid_=e+this.name_,this.cid_=i+this.name_,this.dom_=null,this.callback_=s,this.settings_=[],this.rtl_=n)},Profile.tab.GetScope=function(t){var e=t.split("#"),i=MANAGER.handler.Get(e[0]),s=i&&i.GetProfile()||null,n=e[e.length-2];return s&&s.GetTab(n)||null},Profile.tab.prototype=function(){function u(t){var e=(t=WCT.event.Standardize(t)).target;"div"==t.targetName&&((e=this.firstChild).checked=!e.checked);var i=Profile.tab.GetScope(e.id);if(i){var s=e.id.split("#").top(),n=i.settings_.indexOfAtt(s,"id");0<=n&&(i.settings_[n].val=e.checked),i.callback_&&i.callback_.call(i.hdl_||null,i.name_,{id:s,value:e.checked})}}return{Destructor:function(){this.RemoveContent(),this.hdl_=null,this.callback_=null,this.settings_=null},GetTabDom:function(){var t=this.hdl_.Trans(this.caption_),e=$$("a");return e.id=this.tid_,e.href="javascript:void(0);",e.style.textDecoration="none",e.style.color="#000",e.style.display="block",e.setAttribute("title",t),e.appendChild($$2(t)),e},RemoveContent:function(){if(this.dom_){for(var t=this.dom_.childNodes,e=0,i=null;i=t[e++];)i.onclick=null,i.onmouseover=null,i.onmouseout=null;for(var s=this.dom_.getElementsByTagName("input"),n=(e=0,null);n=s[e++];)n.onchange=null,n.onclick=null,n.onkeyup=null;this.dom_.parentNode.removeChild(this.dom_),this.dom_=null}},Configure:function(t){for(var e=this.settings_,i=0,s=null;s=e[i++];)"boolean"==typeof t[s.id]&&(s.val=t[s.id])},ShowContent:function(t){var e=$$("div");e.id=this.cid_,this.dom_=e,t.appendChild(e),this.rtl_&&(e.style.direction="rtl");var i=this.hdl_,s=i.GetSkin(),n=this.cid_+"#",o=this.settings_;s=s.content[this.name_]||null;for(var r=0,a=null,l=o.length-1;a=o[r];r++){var c=$$("div");if(c.style.display="block",c.style.cursor="pointer",s&&(WCT.skin.ApplyTextFormats(c,s),WCT.skin.ApplyPadding(c,s),s.border_spacer&&r<l&&(c.style.borderBottom=s.border_spacer)),e.appendChild(c),"boolean"==a.type){c.onclick=u;var _=WCT.dom.CreateInputElement("checkbox");_.id=n+a.id,_.onchange=u,_.onclick=u,_.onkeyup=u,c.appendChild(_);var d=$$("label");d.setAttribute("for",_.id),d.style.cursor="pointer",d.appendChild($$2(!1!==a.loc?i.Trans(a.txt):a.txt)),c.appendChild(d),a.val&&_.setAttribute("checked","checked"),s&&(s.cb_margin_right&&(this.rtl_?_.style.marginLeft=s.cb_margin_right+"px":_.style.marginRight=s.cb_margin_right+"px"),s.cb_vertical_align&&(_.style.verticalAlign=s.cb_vertical_align))}else"help"==a.type&&(c.id=n+a.id,c.appendChild($$2(i.Trans(a.txt))),c.onclick=Profile.Help.OnEvent,BROWSER.MOBILE||(c.onmouseover=Profile.Help.OnEvent,c.onmouseout=Profile.Help.OnEvent))}return e}}}(),Profile.LibSearch=function(){this.name_=this.name_||"LibSearch",this.caption_="SEARCH",Profile.tab.apply(this,arguments),this.settings_=[{id:"caption",txt:"LIBFLAG_TITLE",type:"boolean",val:!1},{id:"shortdesc",txt:"LIBFLAG_SHORTDESC",type:"boolean",val:!1},{id:"description",txt:"LIBFLAG_DESC",type:"boolean",val:!1},{id:"keywords",txt:"LIBFLAG_KEYW",type:"boolean",val:!1},{id:"slides",txt:"LIBFLAG_SLIDES",type:"boolean",val:!1}]},Profile.LibSearch.prototype=new Profile.tab,Profile.LibSearch.prototype.ShowContent=function(t){if(!this.hdl_.GetConfig("lib_search_slides")){var e=this.settings_,i=e.indexOfAtt("slides","id");0<=i&&e.splice(i,1)}Profile.tab.prototype.ShowContent.apply(this,arguments)},Profile.LibSettings=function(){this.name_="LibSettings",this.caption_="SETTINGS",Profile.tab.apply(this,arguments),this.settings_=[{id:"use_new_window",txt:"LIBFLAG_NEWWIN",type:"boolean",val:!1}]},Profile.LibSettings.prototype=new Profile.tab,Profile.Help=function(){this.name_=this.name_||"Help",this.caption_="HELP",Profile.tab.apply(this,arguments),this.settings_=[{id:"library",txt:"HELP_LIBRARY",type:"help",val:DATA.HELP_LIBRARY_KEY},{id:"trainer",txt:"HELP_TRAINER",type:"help",val:DATA.HELP_LESSON_KEY},{id:"book",txt:"HELP_BOOK",type:"help",val:DATA.HELP_BOOK_KEY}]},Profile.Help.prototype=new Profile.tab,Profile.Help.OnEvent=function(t){t=WCT.event.Standardize(t);var e=Profile.tab.GetScope(this.id);if(e){var i=this.id.split("#"),s=e.settings_.indexOfAtt(i.top(),"id"),n=0<=s?e.settings_[s]:null;if(n)switch(t.type){case"click":var o=MANAGER.handler.Get(i[0]);MANAGER.OpenHelp(o.content_language_,n.val);break;case"mouseover":this.style.textDecoration="underline";break;case"mouseout":this.style.textDecoration="none"}}},Profile.QrCode=function(){this.name_=this.name_||"QrCode",this.caption_="QRCODE",Profile.tab.apply(this,arguments)},Profile.QrCode.prototype=new Profile.tab,Profile.QrCode.prototype.ShowContent=function(t){var e=this.hdl_.skin_,i=Profile.STYLES,s=e.h-(e.header?e.header.h:0)-(e.tab?e.tab.h:0);i.content_margin_t&&(s-=i.content_margin_t),i.content_margin_b&&(s-=i.content_margin_b),i.tabs_margin_t&&(s-=i.tabs_margin_t),i.tabs_margin_b&&(s-=i.tabs_margin_b);var n=MANAGER.handler.Get(this.hdl_.hdl_uid_),o=n?n.Trans("QR_URL_TOO_BIG"):MANAGER.Trans("QR_URL_TOO_BIG"),r=MANAGER.GetUrl(),a=Profile.tab.prototype.ShowContent.apply(this,arguments),l=WCT.QrCode.GenerateHtml(r,s,{margin:"5px auto"})||o;a.style.textAlign="center",a.innerHTML=l},Profile.ContextRoles=function(){this.name_="ContextRoles",this.caption_="CONTEXT_ROLES",Profile.tab.apply(this,arguments),this.settings_=[]},Profile.ContextRoles.prototype=new Profile.tab,WCT.ExtendObject(Profile.ContextRoles.prototype,{Configure:function(t){var e=[];for(var i in(this.settings_=e).push({id:"no_roles_",txt:"CONTEXT_ROLES_NOROLES",type:"boolean",loc:!0,val:t.no_roles_}),t)"no_roles_"!=i&&e.push({id:i,txt:i,type:"boolean",loc:!1,val:t[i]})},ShowContent:function(t){var e=this.settings_,i=e.shift();e.sort(function(t,e){var i=t.txt.toLowerCase(),s=e.txt.toLowerCase();return i<s?-1:s<i?1:0}),e.unshift(i);var s=Profile.tab.prototype.ShowContent.apply(this,arguments),n=2,o=5,r=2,a=2,l=2,c=[n,l,o,l].join("px ")+"px",_=[r,l,a,l].join("px ")+"px",d=(u=this.hdl_).GetSkin(),u=u.GetContentH(),h=d.content[this.name_];h&&(u-=(h.line_height||0)+(h.padding_top||0)+(h.padding_bottom||0)),u-=n+o+r+a;var p=$$("div");WCT.skin.ApplyBorder(p,d.content),p.style.margin=c,s.firstChild&&(s.firstChild.style.border="0px none",p.appendChild(s.firstChild));var f=$$("div");for(WCT.skin.ApplyBorder(f,d.content),f.style.margin=_,f.style.overflowY="auto",f.style.height=Math.max(u,0)+"px";s.firstChild;)f.appendChild(s.firstChild);return h.border_spacer&&f.lastChild&&(f.lastChild.style.borderBottom=h.border_spacer),s.appendChild(p),s.appendChild(f),s}});var HANDLER={MODE:{lesson:"lesson",book:"book",slide:"slide",library:"library",file:"file",cdoc:"cdoc",media:"cdoc"},base:function(t,e){this.uid_=WCT.uid.Generate(MANAGER.UID_LEN,MANAGER.UID_PREF_HDL),this.type_="base",this.active_=!1,t&&(this.content_tclass_=t.tclass,this.content_uid_=t.uid,this.content_mode_=t.mode,this.content_filename_=t.filename,this.content_language_=DATA.DEFAULT_LANGUAGE,this.content_lib_embedded_=t.lib_embed,this.central_tracker_=e,this.local_trackers_={},this.tracking_id_=null,this.skin_=null,this.config_=null,this.panel_=null,this.topmost_=null,this.profile_=null,this.feedback_=null,this.feedback_resume_=!1,this.panel_ori_=null,this.panel_vis_=!0,this.state_=null,this.steps_=0,this.step_=-1,this.audio_={muted:!1,paused:!1,stopped:!1,volumes:{},mutes:{},disabled_:!1},this.vol_slider_=null,this.ctx_={},this.ctx_[t.tclass]=t.uid,this.ctx_config_={},this.dom_=null,this.main_=null,this.x_=-1,this.y_=-1,this.w_=-1,this.h_=-1,this.res_x_=-1,this.res_y_=-1,this.res_w_=-1,this.res_h_=-1,this.cont_dim_=null,this.needs_slide_renderer_=0,this.slide_iframe_=null,this.slide_hdl_=null,this.slide_ctx_=null,this.slide_sink_=null,this.taskinfo_=null,this.taskinfo_vr_=null,this.socket_=new SocketHandler(this.onsocket_,this),this.resize_prefer_main_=!1,this.generic_key_events_=!1,this.observe_touches_=!1,this.touch_ids_=[],this._keyIds=[],this.hcount_=1,this.rtl_=!1,this._shareIsOpen=!1,this._shareDlg=null,this._accessibilityMode=!1)}};WCT.ExtendObject(HANDLER.base,{STATE_INIT:"init",STATE_STARTPAGE:"startpage",STATE_STOPPAGE:"stoppage",STATE_ENDPAGE:"endpage",STATE_STARTING:"starting",STATE_PLAYING:"play",STATE_PAUSED:"pause",STATE_IDLE:"idle",STATE_FINISHED:"finish",STATE_TERMINATED:"terminated",STATE_MAP:{init:"START",starting:"START",play:"PLAYING",pause:"PAUSED",idle:"IDLE"},ACTION_COMMAND_MAP:{exit:"exit",help:"help",feedback:"feedback",glossref:"glossref",share:"mailto",book_all_sound_stop:"audio_pause",book_all_sound_mute:"audio_mute",book_all_sound_unmute:"audio_unmute",book_sound_on:"book_sound_on",book_sound_off:"book_sound_off",book_toggle_sound:"book_toggle_sound"},GetConfig:function(t){var e=arguments[1]||{},i=HANDLER.MODE,s=t.type_||t.type,n=t.content_tclass_||t.tclass,o=t.content_uid_||t.uid,r=t.content_mode_||t.mode;return s==i.lesson?("praxis"==r&&BROWSER.IE&&BROWSER.VERSION<11&&(e.window_cfg_force=!0),DATA.GetConfig("project",o,r,e)):s==i.file?DATA.GetConfig("group",null,null,e):DATA.GetConfig(n,o,null,e)},_openFeedbackPopupCb:function(){var t=new Popup.ManagerFeedback({hdl_id:this.uid_,skin:this.skin_.feedback,callback:this.onfeedback_,scope:this});t.Show(),"library"===this.GetType()&&t.SetZIndex(1),this.feedback_=t}}),HANDLER.base.prototype=function(){function G(){this.slide_iframe_=[],this.slide_hdl_=[],this.slide_ctx_=[];var t=this.uid_,e=this.config_,i=this.slide_iframe_,s=this.slide_hdl_,n=this.slide_ctx_,o=this.needs_slide_renderer_,r=t+"#slide#",a=new HANDLER.slide.Sink(t);this.slide_sink_=a;for(var l=1;l<=o;l++){var c=$(r+l),_=c&&c.contentWindow||null,d=_&&_.Page||null;if(d){var u=new HANDLER.slide.Handler(t,c),h=new HANDLER.slide.Ctx(this.uid_,l-1);_[MANAGER.WND_EVT_ID]=t,_.T2=!0,d.SetSink(a),_.ctx=h,i.push(c),s.push(u),n.push(h)}}i.length==o?(e.video_mode&&s[0].SetupVideoMode(e.video_fps),this.topmost_&&(window.topmost_ctx=n[0]),1==o&&(this.slide_hdl_=s[0],this.slide_iframe_=i[0],this.slide_ctx_=n[0]),this.Start()):this.Fini(!1,"Unable to load SlideRenderer")}return{Destructor:function(){if(this.state_=HANDLER.base.STATE_TERMINATED,MANAGER.event.UnregisterListener({handler_id:this.uid_}),this.touch_ids_.length){for(var t=this.touch_ids_.length-1;0<=t;t--)WCT.event.touches.UnregisterCallback(this.touch_ids_[t]);this.touch_ids_=null}if(this._keyIds.length){for(t=this._keyIds.length-1;0<=t;t--){var e=this._keyIds[t];WCT.event.hotkey.StopObserving(e.button,e.id)}this._keyIds=null}if(this.RemoveTaskInfo(),this.profile_&&(this.profile_.Destructor(),this.profile_=null),this.feedback_&&(this.feedback_.Destructor(),this.feedback_=null),this.topmost_&&(this.topmost_.Destructor(),this.topmost_=null),window.topmost_ctx=null,this.vol_slider_&&(this.vol_slider_.Destructor(),this.vol_slider_=null),this.socket_&&(this.socket_.Destructor(),this.socket_=null),this.uid_=null,this.central_tracker_=null,this.main_=null,this.local_trackers_){var i=this.local_trackers_;for(var s in i)i[s].Destructor(),i[s]=null;this.local_trackers_=null}this.tracking_id_=null;var n=this.slide_hdl_;if(n){if(n.isArray){t=0;for(var o=null;o=n[t++];)o.Clear(),o.Destructor()}else n.Clear(),n.Destructor();this.slide_hdl_=null}var r=this.slide_iframe_;if(r){if(r.isArray)for(t=0,o=null;o=r[t++];){try{(a=o.contentWindow)&&(a.onfocus=null,a.onblur=null,a.ctx=null,a.on_unload())}catch(c){}o.parentNode.removeChild(o)}else{try{var a;(a=r.contentWindow)&&(a.onfocus=null,a.onblur=null,a.ctx=null,a.on_unload())}catch(c){}r.parentNode.removeChild(r)}this.slide_iframe_=null}var l=this.slide_ctx_;if(l){for(t=0,o=null;o=l[t++];)o.Destructor();this.slide_ctx_=null}this.panel_&&(this.panel_.Destructor(),this.panel_=null),this.dom_&&(this.dom_.parentNode.removeChild(this.dom_),this.dom_=null),this.slide_sink_=null,this.cont_dim_=null,this.skin_=null,this.config_=null,WCT.CleanupObject(this.ctx_),WCT.CleanupObject(this.audio_),WCT.CleanupObject(this.ctx_config_),this.ctx_=null,this.audio_=null,this.ctx_config_=null},GetUid:function(){return this.uid_},GetProfile:function(){return this.profile_},GetType:function(){return this.type_},GetPanel:function(){return this.panel_},GetFeedback:function(){return this.feedback_},GetPanelOrientation:function(){return this.panel_ori_},GetDom:function(){return this.dom_},GetSlideRendererIFrame:function(){var t=arguments[0],e=this.slide_iframe_;return e&&e.isArray?"number"==typeof t?e[t]:e:t?null:e},GetSlideHandler:function(){var t=arguments[0],e=this.slide_hdl_;return e&&e.isArray?"number"==typeof t?e[t]:e:t?null:e},GetSlideCtx:function(){var t=arguments[0],e=this.slide_ctx_;return e&&e.isArray?"number"==typeof t?e[t]:e:t?null:e},GetHandlerDim:function(){return{x:this.res_x_,y:this.res_y_,w:this.res_w_,h:this.res_h_}},ManagerTracking:function(){return"collaborator"===this.GetConfig("tracking_backend")},GetConfig:function(t){var e=this.config_;return"undefined"!=typeof e[t]?e[t]:(this.Fini(!1,"invalid config call"),null)},GetSkin:function(){var t=arguments[0]||null,e=this.topmost_;if("start_stop_page"==t&&e){var i=e.GetSkin();if(i&&i[t]){var s=e.GetWH();return(i=WCT.DeepCopy(i[t])).w=Math.floor(2*s.w/3),i.h=Math.floor(2*s.h/3),i}}var n=this.skin_;return(n&&t?n[t]:n)||null},GetContext:function(){var t=new WCT.context(DATA.context);for(var e in this.ctx_)t.Set(e,this.ctx_[e]);return t.SetScope(this.content_tclass_),t},GetContentInfo:function(){var t=this.content_tclass_,e=this.content_uid_,i=DATA.GetS(t+"!"+e+":entity.txt")||{},s=this.content_mode_,n=this.content_filename_,o=t+"!"+e;return s?o+=":"+s:n&&(o+=":"+n),{tclass:t,uid:e,mode:s,filename:n,address:o,language:this.content_language_,lib_embed:this.content_lib_embedded_,rtl:this.rtl_,caption:i.caption||"",shortdesc:i.shortdesc||"",description:i.description||""}},CreatePanel:function(){if(this.panel_&&(this.panel_.Destructor(),this.panel_=null),!this.GetSkin("panel"))return null;var t=this.config_,e=t.panel_orientation;if(this.type_==HANDLER.MODE.library)e="top";else{if(t.hide_panel)return null;var i=t.panel_fixed?null:WCT.store.Get(WCT.store.KEYS.panel_ori[this.type_]);null!=i&&(e=i)}this.panel_ori_=e;var s=new Panel(this.uid_,this.onpanel_,this),n=this.audio_;s.Steps(this.steps_),s.SetAudioControls(n.muted,n.paused,n.stopped),s.Show(e),s.SetHandlerCount(this.hcount_),s.LogoClickable(!1),s.LogoVisible(t.panel_show_logo),s.VisibleCommand("fullscreen",t.panel_fullscreen&&WCT.fullscreen.Supported(document.body)),s.VisibleCommand("feedback",t.feedback_enabled),s.VisibleCommand("socket_connecting",!1),s.VisibleCommand("socket_connected",!1),s.VisibleCommand("socket_synched",!1),s.VisibleCommand("socket_disconnected",!1),s.VisibleCommand("taskinfo_toggle",!1),s.VisibleCommand("mailto",t.panel_send_content),s.VisibleCommand("help",t.panel_show_help),s.VisibleCommand("exit",t.panel_show_exit),t.panel_fixed||s.VisibleCommand("orientation_toggle_"+e,!0),s.Visible(this.panel_vis_),this.panel_=s;var o=this.Resize(null,!0);if(BROWSER.MOBILE&&(s.VisibleCommand("audio_mute",!1),s.VisibleCommand("audio_unmute",!1),s.VisibleCommand("audio_volume",!1),o)){var r=this.GetSlideRendererIFrame(0),a=r&&r.contentWindow;a&&a.hdl_onresize&&a.hdl_onresize(null,o.w,o.h)}return s},RemovePanel:function(){this.vol_slider_&&(this.vol_slider_.Destructor(),this.vol_slider_=null),this.panel_&&(this.panel_=this.panel_.Destructor(),this.Resize())},ExecCommand:function(t){var e=arguments[1],i=this.audio_,s=this.GetSlideHandler(0),n=this.panel_;switch(t){case"mailto":this.open_share_dlg_();break;case"glossref":(function b(t,e){var i=DATA.GetS(t+":entity.txt");if(i){var s=this.GetContext();s.Set(i.tclass,i.uid),s.SetScope(i.tclass);var n=i.description||" ";n=s.ExpandHtmlString(n),this.SetTaskInfo({uid:"taskinfo_"+t,title:i.caption,text:n,bgcolor:"#FFFFFF",orientation:"C",macro_uid:"",mini:!1,close_msg:!1,modal:!0,w:this.config_.glossary_width,h:0},!0),this.TaskInfoVisible(!0)}}).call(this,e,arguments[2]);break;case"taskinfo_toggle":this.TaskInfoVisible(!this.TaskInfoVisible(),"toggle");break;case"taskinfo_close":this.TaskInfoVisible(!1,"close");break;case"socket_disconnected":this.socket_.Init();break;case"socket_connected":this.socket_.Sync();break;case"fullscreen":return WCT.fullscreen[WCT.fullscreen.Active()?"Disable":"Enable"]($(this.uid_)),!0;case"focusBar":case"focusPanel":case"focusContent":var o={focusBar:['div[id*="panel.hor"]','div[id*="panel.ver"]'],focusPanel:['div[class="region-sidebar"]'],focusContent:['[class="region-content"]']},r=o[t][0],a=o[t][1],l=MANAGER.handler.GetActive().GetUid(),c=document.querySelectorAll("#"+l+" "+r)||document.querySelectorAll("#"+l+" "+a);c[0]&&c[0].focus();break;case"exit":if((BROWSER.IPHONE||BROWSER.IPAD)&&window.navigator.standalone)return void alert("Sorry, exit not allowed in fullscreen mode.");this.Fini();break;case"audio_mute":case"audio_unmute":if(i.disabled_)break;var _="audio_mute"==t;i.muted=_,i.mutes.Master=_,s&&s.MediaMute("Master",_),n&&n.SetAudioControls(i.muted,i.paused,i.stopped);break;case"audio_play":case"audio_resume":if(i.disabled_)break;i.paused=!1,i.stopped=!1,s&&("audio_play"==t?s.MediaPlay(!0):s.MediaPlay(!0,null,!0)),n&&n.SetAudioControls(i.muted,i.paused,i.stopped);break;case"audio_pause":if(i.disabled_)break;i.paused=!0,s&&s.MediaPlay(!1),n&&n.SetAudioControls(i.muted,i.paused,i.stopped);break;case"audio_stop":if(i.disabled_)break;i.paused=!1,i.stopped=!0,s&&s.MediaStop(),n&&n.SetAudioControls(i.muted,i.paused,i.stopped);break;case"audio_toggle":if(i.disabled_)break;this.ExecCommand(i.paused?"audio_play":"audio_pause");break;case"audio_volume":if(i.disabled_)break;i.volumes[e.channel]=e.volume,s&&s.MediaVolume(e.channel,e.volume);break;case"audio_c_mute":if(i.disabled_)break;i.mutes[e.channel]=e.muted,"Master"==e.channel?this.ExecCommand(e.muted?"audio_mute":"audio_unmute"):s&&s.MediaMute(e.channel,e.muted);break;case"audio_c_play":if(i.disabled_)break;"Master"==e.channel?this.ExecCommand("audio_play"):s&&s.MediaPlay(!0,e.channel);break;case"audio_c_pause":if(i.disabled_)break;"Master"==e.channel?this.ExecCommand("audio_pause"):s&&s.MediaPlay(!1,e.channel);break;case"feedback":if(!this.feedback_&&this.config_.feedback_enabled){this.type_==HANDLER.MODE.lesson&&this.state_==HANDLER.base.STATE_PLAYING&&(this.feedback_resume_=!0,this.ExecCommand("pause"));var d=this.config_.feedback_external_url;if(d){var u=this.GetContentInfo(),h={tclass:1,uid:1,mode:1,macro:1,filename:1,slide:1,selection:1},p=[];for(var f in u)null!=h[f]&&null!=u[f]&&p.push(f+"="+escape(u[f]));d+=(0<=d.indexOf("?")?"&":"?")+p.join("&"),MANAGER.ExecuteExternal(d)}else this._openFeedbackPopup()}break;case"book_sound_on":s&&s.MediaPlayPagesound();break;case"book_sound_off":s&&s.MediaStopPagesound();break;case"book_toggle_sound":if(!s)break;var m=s.MediaPlaying("Pagesound");s.MediaStopPagesound(),m||s.MediaPlayPagesound()}},ExecAction:function(t){var e=HANDLER.base.ACTION_COMMAND_MAP||{},i=(HANDLER[this.type_].ACTION_COMMAND_MAP||{})[t]||e[t];i&&this.ExecCommand(i,arguments[1],arguments[2])},Track:function(t){var e=this.tracking_id_&&this.local_trackers_[this.tracking_id_]||null;e&&e.Track(t)},TrackCompletion:function(){var t=this.tracking_id_&&this.local_trackers_[this.tracking_id_]||null;if(t){var e=t.GetQuizScore();t.Commit(),t.Completed(e.cur>=e.pass,!0)}},StartExecutable:function(t){var e=arguments[1];this.topmost_&&((e=e||{}).window_cfg_force=1),MANAGER.Execute(t,e)},StartFile:function(t){if(t.filename)if(HANDLER.file.IsAcceptedExt(t.filename))t.type="file",this.StartExecutable(t,arguments[1]);else{var e=this.GetContext(),i=t.tclass&&t.uid?t.tclass+"!"+t.uid+":"+t.filename:t.filename,s=WCT.address.AddDownloadFlag(t.filename),n=e.ToAbsPath(i)+(s?"?download=1":"");if(PLATFORM.WINCE)location.href=n;else try{window.open(n)}catch(o){}}},SetHandlerCount:function(t){this.hcount_=t,this.panel_&&this.panel_.SetHandlerCount(this.hcount_)},setAccessibilityMode:function(t){var e=arguments[1]||{},i=0===e.clientX&&0===e.clientY;if(t!==this._accessibilityMode&&!i){this._accessibilityMode=t,WCT.dom[t?"AddClass":"RemoveClass"](document.body,"accessibility-mode");for(var s=1;s<=this.needs_slide_renderer_;s++){var n=$(this.uid_+"#slide#"+s),o=n&&n.contentWindow||null,r=o&&o.Page||null;r&&r.setAccessibilityMode(this._accessibilityMode)}}},SetPosition:function(t,e,i,s){if("number"==typeof t&&this.x_!=t||"number"==typeof e&&this.y_!=e||"number"==typeof i&&this.w_!=i||"number"==typeof s&&this.h_!=s)"number"==typeof t&&(this.x_=t),"number"==typeof e&&(this.y_=e),"number"==typeof i&&(this.w_=i),"number"==typeof s&&(this.h_=s),this.Resize(arguments[4]);else if(arguments[4]){var n=this.GetSlideRendererIFrame(0),o=n&&n.contentWindow||null;if(o&&o.hdl_onresize)if(BROWSER.MOBILE){var r=this.cont_dim_;o.hdl_onresize(t,r.w,r.h)}else o.hdl_onresize(t)}},ConnectTopmost:function(t){this.topmost_=t},HasTopmost:function(){return null!=this.topmost_},Orientation:function(){},Resize:function(){var t=WCT.event.Standardize(arguments[0]);if(PRODUCER.VideoExport.Resize(),this.w_<0&&this.h_<0||!arguments[1]&&this.x_==this.res_x_&&this.y_==this.res_y_&&this.w_==this.res_w_&&this.h_==this.res_h_)return{abort:!0};this.res_x_=this.x_,this.res_y_=this.y_,this.res_w_=this.w_,this.res_h_=this.h_;var e=this.dom_;if(e&&(e.style.left=this.x_+"px",e.style.top=this.y_+"px",e.style.width=this.w_+"px",e.style.height=this.h_+"px",!this.w_&&!this.h_))return{abort:!0};var i=null,s={w:this.w_,h:this.h_};this.panel_&&this.panel_vis_&&(i=this.panel_.Resize(this.w_,this.h_),e.style.overflow="fit"===this.config_.view_mode&&this.w_<i.w?"scroll":"hidden",s.w=Math.max(s.w,i.w),s.h=Math.max(s.h,i.h));var n=this.GetSlideRendererIFrame(0),o=this.resize_prefer_main_?this.main_||n:n||this.main_;if(o){var r={x:0,y:0,w:s.w,h:s.h};if(i&&(r=WCT.geometry.ExciseRects(r,[i]),r=WCT.geometry.GetBiggestRect(r)),r=r||{x:0,y:0,w:200,h:200},o.style.left=r.x+"px",o.style.top=r.y+"px",o.style.width=r.w+"px",o.style.height=r.h+"px",WCT.dom.AndroidOpacitySwitch(o),this.cont_dim_=r,0<o.id.search(/#slide#\d+$/)&&t){var a=o.contentWindow;a&&a.hdl_onresize&&a.hdl_onresize(t,r.w,r.h)}return this.feedback_&&this.feedback_.Resize(),this.taskinfo_&&this.taskinfo_.Resize(r),this._shareDlg&&this._shareDlg.Resize(r),r}return null},ScrollToPOI:function(t,e,i,s){if(this.topmost_)this.topmost_.ScrollToPOI&&this.topmost_.ScrollToPOI(t,e,i,s);else{var n=this.dom_.scrollLeft,o=this.dom_.scrollTop,r={x:n,y:o,w:this.w_,h:this.h_},a=this.cont_dim_||{x:0,y:0,w:0,h:0},l=WCT.POI.Focus[e](t,r);null!=l.x&&(l.x=Math.min(Math.max(0,l.x),a.w+a.x-this.w_)),null!=l.y&&(l.y=Math.min(Math.max(0,l.y),a.h+a.y-this.h_));var c={x:null!=l.x?l.x:n,y:null!=l.y?l.y:o};WCT.POI.Animate(this.dom_,{x:n,y:o},c,"SineInOut",i,10)}},Init:function(){this.state_=HANDLER.base.STATE_INIT,PLATFORM.IOS&&7==PLATFORM.VERSION&&(document.body.style.position="fixed");var t=HANDLER.base.GetConfig(this);if(t){if(t.language){this.content_language_=t.language;var e=document.documentElement,i=t.language.split("-")[0]||t.language;e.setAttribute("lang",i)}else t.contentlanguage&&(this.content_language_=t.contentlanguage);this.rtl_=WCT.IsLanguageRTL(this.content_language_);var s=TRACKING.backend.collaborator,n=s.Available()&&s.HasPermission("content_comment_edit"),o=t.feedback_external_url;!t.feedback_enabled||n||o||(t.feedback_enabled=!1),this.config_=t;var r=document.getElementById("region_keys"),a=this.Trans("HELP_REGION_BAR")+" "+t.keys_focus_bar.replace(/_/g," + ")+". "+this.Trans("HELP_REGION_CONTENT")+" "+t.keys_focus_content.replace(/_/g," + ")+". "+this.Trans("HELP_REGION_PANEL")+" "+t.keys_focus_panel.replace(/_/g," + ");r.setAttribute("aria-label",a),r.focus();var l=this._checkHcSkin(),c=DATA.SKIN_PREFIX+(l||t.skin);this.ctx_.skin=c;var _=this.GetContext(),d=WCT.DeepCopy(DATA.GetS("skin:"+this.type_+".txt","JSON",_));if(!d&&l&&(c=DATA.SKIN_PREFIX+t.skin,this.ctx_.skin=c,_=this.GetContext(),d=WCT.DeepCopy(DATA.GetS("skin:"+this.type_+".txt","JSON",_))),d){var u=_.ToAbsPath("skin:")+"/";if(this.type_==HANDLER.MODE.library){var h=!1;if(WCT.ClampBoolean(d.tree_icons)){var p=WCT.DeepCopy(DATA.GetS("skin:tree_icons.txt","JSON",_));p&&p.id&&(WCT.skin.ExtendUrls(p,u),WCT.TREE_ICONS=p,h=!0)}if(!h){var f=_.ToAbsPath("trainer:")+"/";WCT.skin.ExtendUrls(WCT.TREE_ICONS,f)}}if(document.getElementById("apple1").href=u+"t_app_icon_browser_64x64.png",document.getElementById("apple2").href=u+"t_app_icon_tiny_76x76.png",document.getElementById("apple3").href=u+"t_app_icon_small_120x120.png",document.getElementById("apple4").href=u+"t_app_icon_medium_152x152.png",document.getElementById("apple5").href=u+"t_app_icon_normal_192x192.png",document.getElementById("apple6").href=u+"t_app_icon_normal_192x192.png",document.getElementById("icon1").href=u+"t_app_icon_browser_64x64.png",document.getElementById("icon2").href=u+"t_app_icon_general_128x128.png",document.getElementById("icon3").href=u+"t_app_icon_normal_192x192.png",document.getElementById("msa1").content=u+"t_app_icon_tiny_76x76.png",document.getElementById("msa2").content=u+"t_app_icon_medium_152x152.png",document.getElementById("msa3").content=u+"t_app_icon_normal_192x192.png",document.getElementById("msa4").content=u+"t_app_icon_normal_192x192.png",t.feedback_enabled||t.panel_send_content){var m=DATA.GetS("skin:feedback.txt","JSON",_);m?d.feedback=WCT.DeepCopy(m):t.feedback_enabled=!1}var b=DATA.GetS("skin:mouse.txt","JSON",_);b&&(d.mouse=WCT.DeepCopy(b)),WCT.skin.ExtendUrls(d,u),this.skin_=d;var v=$$("div");v.id=this.uid_,v.style.position="absolute",v.style.overflow="hidden",document.body.appendChild(v),this.dom_=v;var g=HANDLER[this.type_].prototype,y=DATA.CFG_KEYS[this.type_]||[];t.feedback_enabled&&(y=y.concat(["keys_feedback"]));for(var C={},T=y.length-1;0<=T;T--){var x=t[y[T]];if(x&&"string"==typeof x)for(var A=x.split(","),S=A.length-1;0<=S;S--){var k=A[S].trim();WCT.event.hotkey.Observe(k,"down",g.onkeydown_,this),WCT.event.hotkey.Observe(k,"up",g.onkeyup_,this),C[k]=!0}}var E=this._keyIds;if(C.space||E.push({button:"space",id:WCT.event.hotkey.Observe("space","up",g._onEnterSpaceKey,this)}),C.enter||E.push({button:"enter",id:WCT.event.hotkey.Observe("enter","up",g._onEnterSpaceKey,this)}),C.esc||E.push({button:"esc",id:WCT.event.hotkey.Observe("esc","up",g._onEscapeKey,this)}),WCT.event.Observe("click",this.setAccessibilityMode.bind(this,!1)),WCT.event.Observe("keydown",this.setAccessibilityMode.bind(this,!0)),this.observe_touches_){var w=WCT.event.touches,R=this.touch_ids_;R.push(w.RegisterCallback("swipeleft",g.onswipeleft_,this)),R.push(w.RegisterCallback("swiperight",g.onswiperight_,this)),R.push(w.RegisterCallback("swipeup",g.onswipeup_,this)),R.push(w.RegisterCallback("swipedown",g.onswipedown_,this))}PRODUCER.VideoExport.Enabled(t.video_mode);var N=this.needs_slide_renderer_;N?HANDLER.slide.InitSlide(this.uid_+"#slide",this.dom_,N,G,this):this.Start()}else this.Fini(!1,"Unable to load skin: "+this.type_+".txt")}else this.Fini(!1,"No handler config available!")},SetActive:function(t){if(this.active_!==t){this.active_=t,this.SetTitle();var e=this.GetDom();e&&(e.style.display=t?"block":"none")}},SetTitle:function(){this.config_.title&&MANAGER.SetWindowTitle(this.config_.title,!0)},SetVisibility:function(t){this.dom_.style.display=t?"":"none"},IsActive:function(){return this.active_},Start:function(){if(this.state_=HANDLER.base.STATE_STARTING,function r(){for(var t=this.audio_,e=this.config_,i=this.GetSlideHandler(0),s=DATA.CFG_VOLUME,n=s.length-1;0<=n;n--)if("vol_"==s[n].substr(0,4)){var o=s[n].substr(4).toFirstUpperCase();null==t.volumes[o]&&(t.volumes[o]=e[s[n]],i&&i.MediaVolume(o,e[s[n]]))}}.call(this),this.needs_slide_renderer_){var t=this.config_,e=this.GetSlideHandler(0),i=this.GetSkin("mouse");(i=i&&(i[t.big_mouse?"big":"standard"]||i.standard||null))&&e.SetMouseSkin(i),e.SetConfig("accessibilityMode",!1),e.SetConfig("view_mode",t.view_mode),e.SetConfig("show_tts_subtitle",t.show_tts_subtitle),e.SetConfig("subtitle_style",{font_family:t.sub_font_family,font_size:t.sub_font_size,text_color:t.sub_text_color,align:t.sub_align,background_color:t.sub_background_color}),BROWSER.MOBILE&&(e.SetConfig("mobile_view_mode",t.mobile_view_mode),e.SetConfig("allow_mobile_pinch_zoom",t.allow_mobile_pinch_zoom)),MANAGER.HandleFocus()}},GetCompletionState:function(){return{completed:null,passed:null,score:{cur:null,max:null},progress:{cur:null,max:null}}},Fini:function(){if(this.state_!=HANDLER.base.STATE_TERMINATED){this.state_=HANDLER.base.STATE_FINISHED;var t=arguments[0];if(!1===t){var e=[this.Trans("ERROR_GENERAL"),this.Trans("ERROR_2"),arguments[1]].join("<br/>");NOTIFICATION.ShowMessage(e)}PRODUCER.VideoExport.Fini(),MANAGER.handler.Fini(this.uid_,t)}},BroadcastEvent:function(t){var e=this.slide_hdl_;(e=(e.isArray?e:[e])[t.slide_id])&&(t.data.control_id=t.control_id,delete(t=t.data).manager_id,delete t.handler_id,e.BroadcastEvent(t))},GetTaskInfo:function(){return this.taskinfo_},GetTitle:function(){return this.config_.caption},SetTaskInfo:function(t){var e=this.content_mode_;if("test"==e&&t.in_test||"uebung"==e&&t.in_practice||arguments[1]){if(this.RemoveTaskInfo(),this.taskinfo_=new TaskInfo(this.uid_,t),this.taskinfo_.Show(this.dom_),this.panel_)this.GetConfig("panel_taskinfo_toggle")&&this.panel_.VisibleCommand("taskinfo_toggle",!0);this.renderer_ctx_&&this.renderer_ctx_.SetTaskInfoOrientation(t.orientation)}},TaskInfoVisible:function(){var t=this.taskinfo_;if(t){var e=arguments[0],i=arguments[1];if(t.IsModal()&&!1===e)return this.RemoveTaskInfo(),!1;if(e){var s=t.Visible(),n=this.taskinfo_vr_;if(!s&&"macroset"==i&&("toggle"==n||"close"==n))return!1}else this.taskinfo_vr_=i;return t.Visible(e)}return!1},RemoveTaskInfo:function(){this.taskinfo_&&(this.taskinfo_.Destructor(),this.taskinfo_=null)},Trans:function(t){return MANAGER.Trans(t,this.content_language_)},SetConfig:function(t,e){this.ctx_config_[t]=e},ShowPanel:function(t){this.panel_vis_!=t&&(this.panel_vis_=t,this.panel_&&(this.panel_.Visible(t),this.Resize(null,!0)))},VideoTick:function(){var t=this.GetSlideHandler(0);t&&t.VideoTick()},OnVideoAudio:function(t,e){PRODUCER.VideoExport.Audio(t,e)},OnSlideState:function(t,e,i,s,n){"ticker_tick"==t&&PRODUCER.VideoExport.TickDone("OnSlideState: "+[e,i,s,n].join(" "))},IsLibEmbedded:function(){return this.content_lib_embedded_},GetUrl:function(){var t=DATA.context.GetBase()+"/"+DATA.INDEX_HTML+"?",e=this.config_.style;return e!==DEFAULTS.style.d&&(t+="style="+e+"&"),t+"show="+this.content_tclass_+"!"+this.content_uid_},_openFeedbackPopup:function(){var t=HANDLER.base._openFeedbackPopupCb;XHR.SetRequestHeaders({"Cache-Control":"no-cache"}),XHR.GetA(".server",this,t,t,"JSON")},onkeyup_:function(t,e,i){var s=HANDLER.base.prototype.onkeydown_.apply(this,arguments);if(this.generic_key_events_&&s){var n={stop:"exit",next:"next",back:"prev",focus_bar:"focusBar",focus_panel:"focusPanel",focus_content:"focusContent"}[s[0]];n&&WCT.SetTimeout(this.ExecCommand,1,this,[n])}return s},onkeydown_:function(t,e,i){var s=DATA.CFG_KEYS[this.type_]||[],n=this.config_;if(!n||!this.active_||this.feedback_)return null;n.feedback_enabled&&(s=s.concat(["keys_feedback"]));for(var o=[],r=s.length-1;0<=r;r--)for(var a=n[s[r]].split(","),l=a.length-1;0<=l;l--){a[l].trim()==t&&(i.hasToBeCancelled=!0,o.push(s[r].substr(5)))}return o.length?o:null},_checkHcSkin:function(){if(BROWSER.IE||BROWSER.EDGE||BROWSER.EDGECHR){return{"rgb(1, 1, 1)":"trainer_high_contrast_black","rgb(254, 254, 254)":"trainer_high_contrast_white"}[window.getComputedStyle(document.body).backgroundColor]}},_onEnterSpaceKey:function(t,e,i){"object"!=typeof i.target||"enter"===t&&i.target&&i.target.dataset&&"false"===i.target.dataset.dispatchEnter||!this.active_||WCT.event.CreateAndDispatchEvent("MouseEvent","click",i.target)},_onEscapeKey:function(t,e,i){this._shareIsOpen&&this._shareDlg&&this._shareDlg.close(),this.search_&&this.search_.buttons_&&this.search_.close(),this.profile_&&this.profile_.close(),this.feedback_&&this.feedback_.close()},onswipeleft_:function(){},onswiperight_:function(){},onswipeup_:function(){},onswipedown_:function(){},onpanel_:function(t){if(null!=t.ori||t.cmd&&0<=t.cmd.search("orientation_toggle_")){var e=t.ori||{top:"bottom",bottom:"top"}[t.cmd.substr(19)];this.vol_slider_&&this.vol_slider_.Destructor(),this.vol_slider_=null,this.panel_ori_=e,WCT.store.Set(WCT.store.KEYS.panel_ori[this.type_],e),this.Resize(null,!0)}else if("audio_volume"==t.cmd){if(this.vol_slider_)this.vol_slider_.Destructor(),this.vol_slider_=null;else if(this.skin_.panel.hor.volume){var i=this.panel_.GetControl("control","audio_volume"),s=i&&i.GetDom()||null;if(!s)return;this.vol_slider_=new VolumeSlider(this.uid_,this.dom_,this.onvolume_,this.audio_.volumes,this.audio_.mutes,s)}}else null!=t.cmd?("audio_play"==t.cmd&&(t.cmd="audio_resume"),this.ExecCommand(t.cmd,{play:"user",pause:"user"}[t.cmd])):null!=t.toc?this.ExecCommand("jump",t.toc):null!=t.timeline?this.ExecCommand("jump",t.timeline):t.logo&&this.ExecCommand("logoclick")},onvolume_:function(t,e,i){switch(t){case"close":this.vol_slider_.Destructor(),this.vol_slider_=null;break;case"volume":this.ExecCommand("audio_volume",{channel:e,volume:i});break;case"mute":this.ExecCommand("audio_c_mute",{channel:e,muted:i})}},onfeedback_:function(){this.feedback_&&(this.feedback_.Destructor(),this.feedback_=null,this.feedback_resume_&&(this.feedback_resume_=!1,this.ExecCommand("play")))},onsocket_:function(t){var e=this.panel_;e&&(e.VisibleCommand("socket_connecting",t.cing),e.VisibleCommand("socket_connected",t.open),e.VisibleCommand("socket_synched",t.sync),e.VisibleCommand("socket_disconnected",t.disc),t.open&&e.EnableCommand("socket_connected",t.conn))},reset_audio_to_slide_:function(){var t=this.audio_,e=this.GetSlideHandler(0);if(e){for(var i in e.MediaMute("Master",t.muted),t.volumes)e.MediaVolume(i,t.volumes[i]);for(var i in t.mutes)"Master"!=i&&e.MediaMute(i,t.mutes[i])}},open_share_dlg_:function(){var t=arguments[0]||this.content_tclass_+"!"+this.content_uid_,e=this.skin_&&this.skin_.feedback;if(t&&e&&!this._shareIsOpen){this.ManagerTracking()&&TRACKING.backend.collaborator.prototype.TrackRecord({verb:{id:"share"},context:{id:t},object:{id:t,type:t.split("!")[0],objectType:"library:share"}}),this._shareIsOpen=!0;var i=WCT.uid.Generate(8),s=new WCT.context(DATA.context),n={Localize:this.Trans.bind(this)},o={callback_f:function(){this._shareIsOpen=!1,this._shareDlg=null},callback_s:this};s.Set("server_base_url",s.GetBase());var r=this.GetUrl(!0);DATA.SHARE_URL&&(r=r.replace(DATA.context.GetBase(),encodeURI(DATA.SHARE_URL)));var a=this._shareDlg=new WCT.SharePopup(i,s,n,o,{sel:t,url:r,rtl:this.GetContentInfo().rtl,tabindex:0,keyevents:!0},e);a.Create(this.Trans("SHARE_CONTENT")),a.SetZIndex(1)}}}}(),HANDLER.lesson=function(t,e){HANDLER.base.apply(this,arguments),this.tracking_id_=this.content_uid_+":"+this.content_mode_;var i=null;if(null!=t.tourstop){i=t.tourstop;var s=Number(i);!isNaN(s)&&0<s&&(i=s-1)}this.content_tourstop_=i,this.content_macro_=t.macro||null,this.bookmark_tourstop_=null,this.autostop_=t.autostop||!1,this.type_=HANDLER.MODE.lesson,this.needs_slide_renderer_=1,this.feedback_stop_after_=!1,this.quiz_timeout_=!1,this.tracking_data_=null,this.lesson_=null,this.current_slide_={},this.renderer_ctx_=null,this.continue_mode_=null,this.steps_=-1,this.tries_=0,this.restart_=!1,this.restart_topmost_=!1,this.cur_macro_=null,this.startstop_=null,this.score_max_=0,this.score_pass_=0,this.ready_to_start_=!1,this.video_mode_ready_=!1,this.set_topmost_css_=!1,this.topmost_to_=null},HANDLER.lesson.prototype=new HANDLER.base,WCT.ExtendObject(HANDLER.lesson,{START_STOP_TEXTKEY:{demo:"Demo",praxis:"Concurrent",uebung:"Practice",test:"Test",pres:"FreePresentation",guided:"GuidedPresentation"},CONTINUE_MODE_TOURSTOP:"tourstop",CONTINUE_MODE_TASKSET:"taskset",IN_PRACTICE:1,IN_TEST:2,IN_DEMO:4,IN_PRAX:8,INIT_MAX_TRIES:300,INIT_WAIT:100,ACTION_COMMAND_MAP:{lesson_play:"play",lesson_pause:"pause",lesson_next:"next",lesson_prev:"prev",next_task:"next_task",prev_task:"prev_task",jump_task:"jump_task",startstop_print:"startstop_print",startstop_details:"startstop_details",stop:"stop",jump:"jump",restart:"restart"},GetSlideObject:function(){return{stop_:null}},SetTopmostContent:function(t){var e=MANAGER.handler.Get(t);if(e&&e.slide_hdl_&&e.topmost_){e.topmost_to_=null;var i=e.slide_hdl_.GetApi("document"),s=i&&i.getElementById("canvas");s&&e.topmost_.SetContent(s);var n=e.slide_hdl_.IsIdle(!0)||BROWSER.IE&&BROWSER.VERSION<9?Topmost.REFRESH_INTERVAL:50;e.topmost_to_=WCT.SetTimeout(HANDLER.lesson.SetTopmostContent,n,HANDLER.lesson,[t])}},ShowAsSlide:function(t,e,i){var s=DATA.GetS("project!"+t+":entity.txt")||{};i.project=s;var n={GetS:DATA.GetS.bind(DATA)},o={};for(var r in s)switch(r){case"shortdesc":case"description":o[s.tclass+":."+r]=WCT.Placeholder.Resolve(s[r]||"",i.ctx,n);break;case"assets":continue;default:o[s.tclass+":."+r]=s[r]}e.SetContextMap(o);var a=new WCT.context(i.ctx);a.Set("project",t),a.SetScope("project");var l={caption:1,shortdesc:1,description:1},c={},_=DATA.LESSON_MODE;for(var d in _)s[d+"_link"]="",s[d+"_caption"]="",s[d+"_v"]=!1,l[d+"_caption"]=1,c[d+"_link"]=1;if(s.assets)for(var u=0,h=null;h=s.assets[u++];)h.type==DATA.LESSON_TOUR_KEY&&_[h.mode]&&(s[h.mode+"_caption"]=h.caption,s[h.mode+"_v"]=!0);if(e.Template()==i.template){var p=e.GetApi("Controls")||{};for(var f in p){if(l[b=p[f].GetName()]){var m=a.ResolveHtmlString(s[b]||"",a);e.UpdateControl(f,"text",m),2==(d=b.split("_")).length&&e.UpdateControl(f,"hidden",!s[d[0]+"_v"])}else if(c[b]){d=b.split("_")[0];e.UpdateControl(f,"link_to","project!"+t+":"+d),e.UpdateControl(f,"hidden",!s[d+"_v"])}}}else{p=i.slide.controls;for(var f in p){var b;if(l[b=p[f].name])p[f].text=a.ResolveHtmlString(s[b]||"",a),2!=(d=b.split("_")).length||s[d[0]+"_v"]||(p[f].hidden=!0);else if(c[b]){d=b.split("_")[0];p[f].link_to="project!"+t+":"+d,p[f].hidden=!s[d+"_v"]}}HANDLER.slide.ShowSlide(i.template,e,i)}},GetOrigIdx:function(){for(var t=this.lesson_.tourstops,e=this.step_,i=null;0<=e;){if(t[e]&&null!=t[e].orig_index_){i=t[e].orig_index_;break}e--}return null!=i?i:-2},NewOrigIdx:function(){var t=HANDLER.lesson.GetOrigIdx.call(this),e=this.local_trackers_[this.tracking_id_],i=e?e.GetCurTsIndex():null;return null==t||i==t&&!arguments[0]?-1:t}}),WCT.ExtendObject(HANDLER.lesson.prototype,function(){function s(t){return this.startstop_=new HANDLER.lesson.StartStop(this.uid_,this.content_mode_),this.startstop_.Show(t)}function i(){var t=this.config_;t?!t.show_startpage||0<=t.startpage.indexOf("no_pause.html")||this.topmost_?this.ready_to_start_=!0:(this.state_=HANDLER.base.STATE_STARTPAGE,s.call(this,"start")||(this.ready_to_start_=!0)):this.Fini(!1,"Lesson config not available!")}function r(t){var e=$(this.uid_+"#loading");t?e?this.ready_to_start_&&(e.style.display="block"):((e=$$("div")).id=this.uid_+"#loading",e.style.position="absolute",e.style.backgroundColor="#FFFFFF",e.style.left=(this.x_||0)+"px",e.style.top=(this.y_||0)+"px",e.style.width=this.w_?this.w_+"px":"100%",e.style.height=this.h_?this.h_+"px":"100%",e.innerHTML=['<table style="width:100%;height:100%">',"<tr>",'<td style="text-align:center;vertical-align:middle;font-size:16px;font-weight:bold">',this.Trans("LOADING_MACROSET"),"</td>","</tr>","</table>"].join(""),this.ready_to_start_||(e.style.display="none"),this.dom_.appendChild(e)):e&&e.parentNode.removeChild(e)}function b(t){var e=HANDLER.base,i=this.panel_,s=this.slide_hdl_,n=this.content_mode_;switch(t){case e.STATE_PLAYING:var o=this.state_;this.state_=t,o==e.STATE_PAUSED&&v.call(this),i&&(C.call(this),i.SetLessonPause(!1,n)),s.Pause(!1,arguments[1]);break;case e.STATE_PAUSED:this.state_=t,i&&(C.call(this),i.SetLessonPause(!0,n)),s.Pause(!0,arguments[1]);break;case e.STATE_IDLE:this.state_=t,i&&(C.call(this),i.SetLessonPause(!0,n))}}function a(){if(this.state_!=HANDLER.base.STATE_TERMINATED&&this.state_!=HANDLER.base.STATE_FINISHED)if(window.MacroRenderer)if(MacroRenderer.PreProcessTourstops&&window.MacroDefaultsHandler){var t=this.lesson_,e=WCT.DeepCopy(DATA.GetS("config:simulation_fallbacks.js")||{}),i={};if(e.global){for(var s in e.global)i[s]=e.global[s];delete e.global}for(var s in t.global_params)i[s]=t.global_params[s];var n=new HANDLER.lesson.RendererCtx(this.uid_,this.content_uid_,this.content_mode_,"current_slide_",t.meta.audio_ext||this.GetConfig("audio_ext"),this.GetConfig("vol_lesson"));(this.renderer_ctx_=n).SetDefaults(e),n.SetGlobalParams(i);var o=this.GetConfig("video_mode");n.SetVideoMode(o),o&&this.ShowPanel(!1),MacroDefaultsHandler.PrepareGlobals(n),WCT.event.hotkey.SetIgnoreHotkey(this.GetConfig("keys_ignore_hotkeys")),t.tourstops?(t.orig_tourstops_=t.tourstops,this.orig_steps_=t.tourstops.length,t.tourstops=MacroRenderer.PreProcessTourstops(n,t.tourstops,{navigation:this.GetConfig("panel_lesson_nav_mode")})):(t.orig_tourstops_=[],t.orig_steps_=0,t.tourstops=[]),this.steps_=t.tourstops&&t.tourstops.length||0,r.call(this,!1),g.call(this)}else this.Fini(!1,"Bad MacroRenderer");else this.tries_++<HANDLER.lesson.INIT_MAX_TRIES?(r.call(this,!0),WCT.SetTimeout(a,HANDLER.lesson.INIT_WAIT,this)):this.Fini(!1,"Unable to load MacroRenderer");else this.Fini(!1,"Errors during lesson init!")}function g(){if(this.state_!=HANDLER.base.STATE_TERMINATED&&this.state_!=HANDLER.base.STATE_FINISHED)if(this.ready_to_start_&&window.MacroRenderer)if(this.steps_<=0||!function f(){var t=this.central_tracker_,e={uid:this.content_uid_,mode:this.content_mode_},i=t?t.GetBackendType():"none",s=TRACKING.InitLesson(e,i),n=this.lesson_,o=new TRACKING.local.lesson(t,s,n.meta,n.orig_tourstops_);return(this.local_trackers_[this.tracking_id_]=o).Start(),this.bookmark_tourstop_=o.GetBookmark(),o.SetScores(this.score_max_,this.score_pass_),!o.Aborted()}.call(this))y.call(this);else{var t=0<=["demo","pres","guided","praxis"].indexOf(this.content_mode_)&&function m(){for(var t=this.lesson_&&this.lesson_.tourstops||[],e=0,i=null;i=t[e++];)if(i.audio&&"number"==typeof i.audio_duration&&0<i.audio_duration)return!0;return!1}.call(this);this.audio_.disabled_=!t,this.state_=HANDLER.base.STATE_STARTING,this.current_slide_={};for(var e=this.config_,i=this.lesson_&&this.lesson_.tourstops||[],s=[],n=[],o=[],r=e.panel_nav_disabled,a=0,l=null;l=i[a];a++)s.push(l.title),n.push(l.visible),o.push(!r&&l.jumpable);var c=null,_=this.topmost_;if(_?_.SetSteps(this.steps_,n,o,s):c=this.CreatePanel(),c&&(this.audio_.disabled_&&(c.VisibleCommand("text_on",!1),c.VisibleCommand("text_off",!1),c.VisibleCommand("audio_mute",!1),c.VisibleCommand("audio_unmute",!1),c.VisibleCommand("audio_volume",!1)),e.panel_show_topic_title||c.VisibleTimelineText(!1),c.SetTimelineTitles(s),c.SetTimelineVisibles(n),c.SetTimelineJumpables(o)),function b(t){if(MacroRenderer.start_unit)for(var e=0,i=null;i=t[e++];)if(i.macros)for(var s=0,n=null;n=i.macros[s++];)if("start_unit"==n.macro_template)return void MacroRenderer.start_unit(this.renderer_ctx_,n)}.call(this,i),this.step_=0,this.restart_||function v(t){var e=this.content_tourstop_,i=this.bookmark_tourstop_,s=this.orig_steps_;"string"==typeof e?(e=t.indexOfAtt(e,"uid"),this.step_=0<=e?e:1):this.step_="number"==typeof e&&0<=e&&e<s?e:"number"==typeof i&&0<=i&&i<s?i:0}.call(this,i),_&&(this.restart_topmost_&&_.Show(),_.SetStep(this.step_)),this.restart_=!1,this.restart_topmost_=!1,this.state_=HANDLER.base.STATE_PLAYING,c&&(c.SetLessonStep(this.step_,this.content_mode_),C.call(this),PRODUCER.VideoExport.Progress(this.step_+1,this.steps_+1),this.Resize(null,!0)),t){var d="audio_text"==e.playback_mode||"text"==e.playback_mode,u="audio_text"==e.playback_mode||"audio"==e.playback_mode,h=WCT.ClampBoolean(d),p=WCT.ClampBoolean(u);this.ExecCommand(h?"text_on":"text_off"),this.ExecCommand(p?"audio_unmute":"audio_mute")}T.call(this)}else WCT.SetTimeout(g,HANDLER.lesson.INIT_WAIT,this);else this.Fini(!1,"Errors during lesson init!")}function y(){this.state_=HANDLER.base.STATE_FINISHED,this.RemovePanel(),this.RemoveTaskInfo(),function i(){this.slide_hdl_.Clear(),this.config_.show_stoppage&&!1!==arguments[0]?(this.state_=HANDLER.base.STATE_STOPPAGE,s.call(this,"stop")?this.topmost_&&(this.restart_topmost_=!0,this.topmost_.Hide(!1)):this.Fini()):this.Fini()}.call(this,arguments[0]);var t=this.tracking_id_,e=this.local_trackers_;e&&e[t]&&(this.tracking_data_=e[t].GetTrackingData(),e[t].Destructor(),delete e[t])}function C(){if(this.panel_){var t=HANDLER.base.STATE_MAP[this.state_],e=this.Trans(t);this.panel_.SetStatusText(e)}}function m(t,e){for(var i=t.split(";"),s=0,n=i.length;s<n;s++){var o=i[s],r=o.indexOf("."),a=o.substr(0,r),l=o.substr(r+1);switch(a){case"panel":var c=this.panel_;"show"==l||"hide"==l?this.ShowPanel("show"==l):c&&"exit"==l&&(c.VisibleCommand("play",!1),c.VisibleCommand("pause",!1),c.VisibleCommand("next",!1),c.VisibleCommand("prev",!1),c.VisibleCommand("text_on",!1),c.VisibleCommand("text_off",!1),c.VisibleCommand("audio_mute",!1),c.VisibleCommand("audio_unmute",!1),c.VisibleCommand("audio_volume",!1),c.VisibleTimeline(!1));break;case"taskinfo":this.TaskInfoVisible("show"==l,"macroset");break;case"tracking":if("end"==l){var _=this.tracking_id_,d=this.local_trackers_&&this.local_trackers_[_]||null;d&&(this.state_=HANDLER.base.STATE_STOPPAGE,this.current_slide_&&this.Track({id:"tour_end",uid:this.current_slide_.stop_}),d.Commit(),d.Destructor(),delete this.local_trackers_[_])}default:e.ExecEvent(o)}}}function T(){var t=arguments[0]||!1,e=this.lesson_.tourstops[this.step_]||null,i=this.local_trackers_[this.tracking_id_],s=this.topmost_;if(!e||this.current_slide_.stop_&&!t){this.Track({id:"tour_end",uid:this.current_slide_.stop_}),i&&i.Commit(),this.cur_macro_=null;var n=this.config_;n.feedback_enabled&&n.feedback_force_end?(this.feedback_stop_after_=!0,this.ExecCommand("feedback"),n.feedback_external_url&&y.call(this)):y.call(this)}else{var o=HANDLER.lesson.NewOrigIdx.call(this,arguments[1]);-1!=o&&(i.Commit(),this.cur_macro_=null),0<=o&&i.Progress(o);var r=function p(){var t=HANDLER.lesson.GetSlideObject();this.current_slide_=t;var e=this.lesson_,i=e.tourstops[this.step_]||null,s=this.content_tourstop_==i.uid?this.content_macro_:null,n={new_page:1,imported_page:1,new_slide:1};MANAGER.SetWindowTitle(i.title);var o=i.macros||[],r=this.renderer_ctx_;r.is_topmost=null!=this.topmost_,r.is_audio_lesson=!this.audio_.disabled_,r.scaling=e.meta&&e.meta.scaling||1;var a={};for(var l in i)"macros"!=l&&(a[l]=i[l]);try{MacroRenderer.BeginTourstop&&MacroRenderer.BeginTourstop(r,a);for(var c=0,_=null;_=o[c];c++){var d=_.macro_template;if("start_unit"==d?this.Track({id:"tour_start",uid:_.uid}):!MacroRenderer[d]||s&&!n[d]&&_.uid!=s||MacroRenderer[d](r,WCT.DeepCopy(_)),t.stop_)break}MacroRenderer.EndTourstop&&MacroRenderer.EndTourstop(r,a)}catch(u){return Log(u,!0),null}return t}.call(this)||null;if(r){r.stop_&&i.Completed(!!r.stop_),this.panel_&&this.panel_.SetTimelineText(e.title||""),s&&s.SetTitle(e.title||"");var a=HANDLER.lesson;if(r.ctl_count_&&0<r.ctl_count_){var l=this.slide_hdl_;"string"==typeof r.macro_uid_&&(PRODUCER.SetMacroUid(r.macro_uid_),this.cur_macro_=r.macro_uid_,delete r.macro_uid_),BOOKMARK.SetState(this.uid_,{hash:this.step_+1});var c=function f(t){var e=t.task_sets_,i={};for(var s in t)"_"!=s.charAt(s.length-1)&&(i[s]=t[s]);for(var n in e)for(var o=e[n].ctls,r=o.length-1;0<=r;r--)delete i[o[r]];var a=!0;for(var s in i)delete t[s],a=!1;return a?null:i}(r)||MacroRenderer.GetEmptyCommon(),_=this.renderer_ctx_.scaling||1;if(c&&c.page&&c.page.is_new_slide&&(_=1),l.SetConfig("content_scale",_),l.Play({controls:c}),s&&!this.set_topmost_css_){this.set_topmost_css_=!0;for(var d=l.GetCSS(DEBUG?null:["slide.css"]),u=0,h=d.length;u<h;u++)s.SetCSS(d[u])}v.call(this),delete r.ctl_count_}else this.continue_mode_=a.CONTINUE_MODE_TOURSTOP,E.call(this,t)}else this.Fini(!1)}}function v(){if(this.state_!=HANDLER.base.STATE_PAUSED){for(var t=this.current_slide_,e=t.start_events_||[],i=this.slide_hdl_,s=0,n=e.length;s<n;s++)m.call(this,e[s],i);delete t.start_events_}}function x(t,e){if(t){var i=t.task_sets_order_&&t.task_sets_order_[t.cur_set_]||null,s=t.task_sets_&&t.task_sets_[i]||null;if(s){for(var n=s.end_events,o=0,r=n.length;o<r;o++)m.call(this,n[o],e);for(o=0,r=(s=s.ctls||[]).length;o<r;o++){var a=t[s[o]];e.RemoveControl(a.id)}}}}function A(t){var e=HANDLER.lesson,i=this.current_slide_,s=i.task_sets_order_&&i.task_sets_order_[i.cur_set_]||null,n=i.task_sets_&&i.task_sets_[s]||null;this.continue_mode_=e.CONTINUE_MODE_TOURSTOP,n?(function f(t,e){var i=this.slide_hdl_,s=this.topmost_;if(this.quiz_timeout_&&e.is_quiz)return"string"!=typeof e.macro_uid_||e.is_skipable||function p(t,e){var i=t[e.macro_uid_],s=this.GetContext();for(var n in i._src_ctx)"_this"!=n&&s.Set(n,i._src_ctx[n]);i._src_ctx._this&&s.SetScope(i._src_ctx._this);var o=t[i.id+"_quiz_question"]?t[i.id+"_quiz_question"].text:"",r=t[i.id+"_quiz_title"]?t[i.id+"_quiz_title"].text:"";o=this.GetContext().ResolveHtmlString(o,s),this.Track({id:"quiz_information",uid:i.id,type:i.type,caption:i.type,correct_responses:[],student_responses:[],weighting:i.points,result:"timeout",description:o,title:r,latency:0,cur:0})}.call(this,t,e),void S.call(this);"string"==typeof e.macro_uid_&&(PRODUCER.SetMacroUid(e.macro_uid_),this.cur_macro_=e.macro_uid_);var n=e.ctls,o=!1;if(h=n.length)for(var r=0;r<h;r++){var a=t[n[r]];if(s&&"bubble"==a.type&&(a.mr_bubble_task||a.mr_bubble_expl)){var l=this.GetContext();for(var c in a._src_ctx)"_this"!=c&&l.Set(c,a._src_ctx[c]);a._src_ctx._this&&l.SetScope(a._src_ctx._this);var _=this.GetContext().ResolveHtmlString(a.text,l);s.SetTask(_)}else i.AddControl(a),"poi"==a.type&&(o=!0)}else s&&s.SetTask("");s&&!o&&s.ResetPOI();for(var d=i.IsIdle(),u=e.start_events,h=(r=0,u.length);r<h;r++)m.call(this,u[r],i);s&&!this.topmost_to_&&(this.topmost_to_=WCT.SetTimeout(HANDLER.lesson.SetTopmostContent,50,HANDLER.lesson,[this.uid_])),this.video_mode_ready_?0==t.cur_set_&&d&&PRODUCER.VideoExport.TickDone("play_cur_set_"):(this.video_mode_ready_=!0,PRODUCER.VideoExport.Ready())}.call(this,i,n),i.cur_set_+1<i.task_sets_order_.length&&(this.continue_mode_=e.CONTINUE_MODE_TASKSET)):"prev"==t?(this.step_=Math.max(-1,this.step_-2),E.call(this,!0)):E.call(this)}function S(){var t=this.current_slide_,e=this.slide_hdl_;x.call(this,t,e),null==t.cur_set_&&(t.cur_set_=-1),t.cur_set_++,A.call(this,"next")}function k(){var t=this.current_slide_,e=this.slide_hdl_;if(x.call(this,t,e),null!=t.cur_set_){if(t.task_sets_order_&&t.task_sets_){var i=t.cur_set_-1,s=!1;do{var n=t.task_sets_order_[i]||null,o=t.task_sets_[n]||null;o&&o.ctls.length?s=!0:i--}while(0<=i&&!s);t.cur_set_=i+1}}else t.cur_set_=1;t.cur_set_--,A.call(this,"prev")}function E(){if(this.autostop_)y.call(this,!1);else{this.state_===HANDLER.base.STATE_PAUSED&&WCT.SetTimeout(this.ExecCommand,1,this,[HANDLER.base.STATE_PLAYING]);var t=arguments[0]||!1,e=HANDLER.lesson,i=this.continue_mode_;i==e.CONTINUE_MODE_TOURSTOP?(x.call(this,this.current_slide_,this.slide_hdl_),arguments[1]&&(this.current_slide_={}),this.step_++,this.panel_&&this.panel_.SetLessonStep(this.step_,this.content_mode_),this.topmost_&&this.topmost_.SetStep(this.step_),PRODUCER.VideoExport.Progress(this.step_+1,this.steps_+1),T.call(this,t,arguments[1])):i==e.CONTINUE_MODE_TASKSET&&(t?function s(){var t=this.current_slide_,e=this.slide_hdl_;x.call(this,t,e),t.cur_set_=t.task_sets_order_&&t.task_sets_order_.length||0,k.call(this)}.call(this):S.call(this))}}return{Destructor:function(){if(arguments[0]){var t=this.local_trackers_[this.tracking_id_];t&&t.Completed(!1)}WCT.CleanupObject(this.lesson_),WCT.CleanupObject(this.current_slide_),this.lesson_=null,this.current_slide_=null,this.tracking_data_=null,this.topmost_to_&&(WCT.ClearTimeout(this.topmost_to_),this.topmost_to_=null),this.renderer_ctx_&&(this.renderer_ctx_.Destructor(),this.renderer_ctx_=null),"undefined"!=typeof MacroRenderer&&MacroRenderer&&MacroRenderer.Cleanup&&MacroRenderer.Cleanup(),this.startstop_&&(this.startstop_.Destructor(),this.startstop_=null),HANDLER.base.prototype.Destructor.call(this)},Start:function(){HANDLER.base.prototype.Start.call(this);var t=this.slide_hdl_;!{demo:1,praxis:1}[this.GetContentInfo().mode||""]||t.SetConfig("show_focus_layer",!!this.config_.show_focus_layer);var e=DATA.GetS("project!"+this.content_uid_+":lesson.js");e?(e=function r(t){var e=t.user_header,i=t.tourstops[0].macros,s=i.indexOfAtt("start_unit","macro_template"),n=1;-1!==s&&i[s].scaling&&(n=parseInt(i[s].scaling.replace("%",""))/100);var o=Number(e.mastery_score_percent);return isNaN(o)&&(o=null),{meta:{author:e.author,title:e.title,language:e.language,mastery_percent:o,macroset:e.shelftype,audio_ext:e.audio_ext,scaling:n},tourstops:WCT.DeepCopy(t.tourstops),global_params:WCT.DeepCopy(t.global_params)||{}}}.call(this,e),this.lesson_=e,WCT.SetTimeout(i,1,this),MANAGER.AddMacroset(e.meta.macroset)?a.call(this):this.Fini(!1,"Unable to include MacroRenderer")):this.Fini(!1,"Unable to load project!"+this.content_uid_+":lesson.js")},GetCompletionState:function(){var t=this.local_trackers_[this.tracking_id_],e=t?t.GetTrackingData():this.tracking_data_;if(!e)return HANDLER.base.prototype.GetCompletionState.call(this);var i=e.completed,s=null,n=null,o=null;TRACKING.SCORABLE_LESSONS[this.content_mode_]&&(n=e.cur,o=i?e.cum:e.max,s=e.passed);var r=null,a=null;return"boolean"==typeof i&&(r=i?1:0,a=1),{completed:i,passed:s,score:{cur:n,max:o},progress:{cur:r,max:a}}},ExecCommand:function(t){var e=arguments[1],i=this.state_,s=HANDLER.base;t={exit:"stop"}[t]||t,s.prototype.ExecCommand.apply(this,arguments);var n=this.panel_,o=this.slide_hdl_,r=this.renderer_ctx_,a=this.audio_,l=HANDLER.lesson;switch(t){case"help":MANAGER.OpenHelp(this.content_language_,DATA.HELP_LESSON_KEY);break;case"audio_mute":if(a.disabled_)break;this.ExecCommand("text_on"),n&&(n.VisibleCommand("audio_mute",!1),n.VisibleCommand("audio_unmute",!0)),r&&(r.internal.audio_on=!1);break;case"audio_unmute":if(a.disabled_)break;n&&(n.VisibleCommand("audio_mute",!0),n.VisibleCommand("audio_unmute",!1)),r&&(r.internal.audio_on=!0);break;case"text_on":n&&(n.VisibleCommand("text_on",!1),n.VisibleCommand("text_off",!0)),r&&(r.internal.text_on=!0),o.VisibleTaskBubble(!0),o.VisibleExplanationBubble(!0);break;case"text_off":this.ExecCommand("audio_unmute"),n&&(n.VisibleCommand("text_on",!0),n.VisibleCommand("text_off",!1)),r&&(r.internal.text_on=!1),o.VisibleTaskBubble(!1),o.VisibleExplanationBubble(!1);break;case"play":switch(i){case s.STATE_STARTPAGE:this.startstop_&&this.startstop_.Destructor(),this.startstop_=null,this.ready_to_start_=!0,g.call(this);break;case s.STATE_PAUSED:b.call(this,s.STATE_PLAYING,e);break;case s.STATE_IDLE:this.ExecCommand("next_task")}break;case"pause":i!=s.STATE_PLAYING&&i!=s.STATE_IDLE||b.call(this,s.STATE_PAUSED,e);break;case"next":switch(i){case s.STATE_STOPPAGE:this.Fini();break;case s.STATE_PLAYING:case s.STATE_PAUSED:case s.STATE_IDLE:if(e){if(e.respect_jumpable){for(var c=this.lesson_.tourstops,_=this.step_;c[++_]&&!c[_].jumpable;);this.step_=_-1}e.track&&this.cur_macro_&&this.Track({id:"tour_next",uid:this.cur_macro_})}this.continue_mode_=l.CONTINUE_MODE_TOURSTOP,E.call(this)}break;case"restart":x.call(this,this.current_slide_,o),this.startstop_&&this.startstop_.Destructor(),r&&r.CleanupInternal(),this.slide_ctx_&&this.slide_ctx_.CleanupStore(),this.topmost_&&this.topmost_.Restart(),this.ctx_config_={},this.startstop_=null,this.quiz_timeout_=!1,this.restart_=!0,g.call(this);break;case"prev":case"previous":switch(i){case s.STATE_PLAYING:case s.STATE_PAUSED:case s.STATE_IDLE:if(e&&e.respect_jumpable){for(c=this.lesson_.tourstops,_=this.step_;c[--_]&&!c[_].jumpable;);this.step_=Math.max(-1,_-1)}else this.step_=Math.max(-1,this.step_-2);e&&e.track&&this.cur_macro_&&this.Track({id:"tour_prev",uid:this.cur_macro_}),this.continue_mode_=l.CONTINUE_MODE_TOURSTOP,E.call(this,!0)}break;case"next_task":if(i==s.STATE_PLAYING||i==s.STATE_PAUSED||i==s.STATE_IDLE){var d=this.ctx_config_.next_task;if("default"==d)delete this.ctx_config_.next_task;else if(d){var u=d.indexOf("!"),h="jump_task";return 0<u&&(h="taskset"==d.substr(0,u)?"jump_task":"jump",d=d.substr(u+1)),delete this.ctx_config_.next_task,this.ExecCommand(h,d)}S.call(this)}break;case"prev_task":i!=s.STATE_PLAYING&&i!=s.STATE_PAUSED&&i!=s.STATE_IDLE||k.call(this);break;case"jump_task":i!=s.STATE_PLAYING&&i!=s.STATE_PAUSED&&i!=s.STATE_IDLE||function m(t){var e=this.current_slide_,i=this.slide_hdl_;x.call(this,e,i),e.cur_set_=e.task_sets_order_.indexOf(t),A.call(this,"next")}.call(this,e);break;case"jump":if(i==s.STATE_PLAYING||i==s.STATE_PAUSED||i==s.STATE_IDLE){var p=e;if("next"==p||"prev"==p)return this.ExecCommand(p);"string"==typeof p&&(p=this.lesson_.tourstops.indexOfAtt(p,"uid")),0<=p&&p<this.steps_?(this.step_=p-1,this.cur_macro_&&this.Track({id:"tour_jump",uid:this.cur_macro_}),this.continue_mode_=l.CONTINUE_MODE_TOURSTOP,E.call(this,!1,!0)):this.ExecCommand("next_task")}break;case"stop":if(i!=s.STATE_STOPPAGE){x.call(this,this.current_slide_,o);var f=this.local_trackers_[this.tracking_id_];f&&f.Completed(!1)}this.current_slide_={},y.call(this,!1);break;case"startstop_print":this.startstop_&&this.startstop_.Print();break;case"startstop_details":this.startstop_&&this.startstop_.Details()}},SetScores:function(t,e){var i=this.local_trackers_[this.tracking_id_];i&&i.SetScores(t,e),this.score_max_=t,this.score_pass_=e},GetMacrosByType:function(t){var e=[],i=[];i=arguments[1]?null!=(i=this.GetCurrentTourstop())?[i]:[]:this.lesson_&&this.lesson_.tourstops||[];for(var s=0,n=null;n=i[s++];)for(var o=0,r=null;r=n.macros[o++];)r.macro_template==t&&e.push(r);return e},GetLessonMasteryPercent:function(){return this.lesson_&&this.lesson_.meta&&this.lesson_.meta.mastery_percent||0},GetTrackingData:function(){var t=this.local_trackers_[this.tracking_id_];if(!t)return null;if(arguments[0]){var e=t.GetQuizTrackingData(arguments[1]);return t.ClearQuizTrackingData(),e}return t.GetTrackingData()},GetQuizScore:function(){var t=this.local_trackers_[this.tracking_id_];return t?t.GetQuizScore():null},GetCurrentTourstop:function(){var t=this.lesson_,e=t&&t.tourstops&&t.tourstops[this.step_]||null;return e&&null==e.orig_index_&&(e.orig_index_=HANDLER.lesson.GetOrigIdx.call(this)),e},GetCurrentMacro:function(){var t=this.GetCurrentTourstop();return t&&t.macros?(mac=t.macros.indexOfAtt(this.cur_macro_,"uid"),t.macros[mac]||null):null},GetTitle:function(){var t=this.lesson_.tourstops[this.step_]||null;return t&&t.title},SetConfig:function(t,e){if(HANDLER.base.prototype.SetConfig.apply(this,arguments),"stop"==t&&e){var i=this.local_trackers_[this.tracking_id_];i&&(i.Commit(),i.Completed(!0),i.Destructor(),delete this.local_trackers_[this.tracking_id_],this.state_=HANDLER.base.STATE_ENDPAGE)}},ShowDemoHelp:function(t){var e={type:HANDLER.MODE.lesson,tclass:this.content_tclass_,uid:this.content_uid_,mode:"demo",tourstop:t,macro:arguments[1]||null,autostop:!0};MANAGER.Execute(e,{force_same:!0});var i=arguments[2]||null;i&&this.slide_hdl_.ExecEvent(i+".demo_help")},OnSlideState:function(t,e,i,s,n){HANDLER.base.prototype.OnSlideState.apply(this,arguments);var o=HANDLER.base,r=this.state_;e-i!=0||s||n?r==o.STATE_IDLE&&b.call(this,o.STATE_PLAYING):r==o.STATE_PLAYING&&b.call(this,o.STATE_IDLE)},GetContentInfo:function(){var t=HANDLER.base.prototype.GetContentInfo.call(this);return t.macro=this.cur_macro_,t},GlobalQuizTimeout:function(){this.quiz_timeout_=!0},OnBookmark:function(t){var e=Number(t.hash);isNaN(e)||this.ExecCommand("jump",--e)},GetUrl:function(){var t=HANDLER.base.prototype.GetUrl.apply(this,arguments);if(t+=":"+this.content_mode_,arguments[0]){var e=this.GetCurrentTourstop();e&&(t+="#"+e.uid)}return t},onpanel_:function(t){if(null==t.cmd||"audio_volume"==t.cmd||"next"!=t.cmd&&"prev"!=t.cmd)return HANDLER.base.prototype.onpanel_.call(this,t);this.ExecCommand(t.cmd,{respect_jumpable:!0,track:!0})},onkeydown_:function(t,e,i){var s=HANDLER.base.prototype.onkeydown_.apply(this,arguments);if(s){var n=this.topmost_;switch(s[0]){case"play":case"pause":if(1==s.length)WCT.SetTimeout(this.ExecCommand,1,this,[s[0]]);else{var o=this.state_,r=HANDLER.base,a=o==r.STATE_PAUSED||o==r.STATE_STARTPAGE?"play":"pause";WCT.SetTimeout(this.ExecCommand,1,this,[a])}break;case"stop":WCT.SetTimeout(this.ExecCommand,1,this,["exit"]);break;case"back":if(n)n.IsMinimized()||WCT.SetTimeout(this.ExecCommand,1,this,["prev_task"]);else{var l={respect_jumpable:!0,track:!0};WCT.SetTimeout(this.ExecCommand,1,this,["prev",l])}break;case"next":var c=this.content_mode_;if("guided"==c||"pres"==c)WCT.SetTimeout(this.ExecCommand,1,this,["next_task"]);else if(n)n.IsMinimized()||WCT.SetTimeout(this.ExecCommand,1,this,["next_task"]);else{l={respect_jumpable:!0,track:!0};WCT.SetTimeout(this.ExecCommand,1,this,["next",l])}break;case"feedback":case"focus_bar":case"focus_content":var _={feedback:"feedback",focus_bar:"focusBar",focus_content:"focusContent"}[s[0]];WCT.SetTimeout(this.ExecCommand,1,this,[_]);break;case"show_highlight":var d=this.slide_hdl_;d&&d.ShowAllHighlights(!0)}}},onfeedback_:function(){this.feedback_stop_after_?(this.feedback_stop_after_=!1,this.feedback_&&(this.feedback_.Destructor(),this.feedback_=null),y.call(this)):HANDLER.base.prototype.onfeedback_.call(this)}}}()),HANDLER.book=function(t,e){var i;HANDLER.base.apply(this,arguments),t.bookmark&&(i=2==(i=t.bookmark.split("!")).length?i[0]+"!"+i[1]:i[0]),this.content_bookmark_=i,this.type_=HANDLER.MODE.book,this.needs_slide_renderer_=1,this.feedback_forced_=!1,this.from_socket_=!1,this.toc_=null,this.busy_=!1,this.search_=null,this.search_step_=null,this.preventNavigation_=!1},HANDLER.book.prototype=new HANDLER.base,HANDLER.book.ACTION_COMMAND_MAP={book_first:"first",book_last:"last",book_prev:"prev",book_next:"next",book_nextchapter:"next_chapter",book_prevchapter:"prev_chapter",book_index:"index",book_search:"search_keywords"},WCT.ExtendObject(HANDLER.book.prototype,function(){function u(t){if(!this.busy_){this.busy_=!0;var e=arguments[1]||"next",i=this.toc_,s=i.GetBook(t),n=i.GetSlide(t);if(s&&n){MANAGER.SetWindowTitle(n.caption),this.ctx_.slide=n.uid,this.step_=t,BOOKMARK.SetState(this.uid_,{hash:n.tclass+"!"+n.uid});var o=this.slide_hdl_;s.uid!=this.tracking_id_&&o.MediaStopBooksound(),i.MarkVisited(n.uid,n.tclass);var r=this.config_;if(this.panel_&&(this.panel_.SetBookStep(t),r.feedback_enabled&&r.feedback_force_end&&t+1==this.steps_&&!this.feedback_forced_&&(this.feedback_forced_=!0,WCT.SetTimeout(this.ExecCommand,5,this,["feedback"])),""!=r.content_slide)){var a="slide!"+n.uid==r.content_slide;this.panel_.ActiveCommand("index",a)}this.from_socket_||this.socket_.Unsync();var l="";"next"==e?r.en_transition&&(l=r.t2_transition):r.en_transition_rev&&(l=r.t2_transition_rev);var c=null,_=null;if("slide"==n.tclass)c=DATA.GetS("slide!"+n.uid+":slide.js");else if("project"==n.tclass)c=WCT.DeepCopy(DATA.GetS(r.book_project_template+":slide.js")),_=r.book_project_template.replace(/^.*?!/,"");else if("media"===n.tclass){var d=n.subType;"pdf"===d&&(d="doc");var u="book_media_template_"+d;c=WCT.DeepCopy(DATA.GetS(r[u]+":slide.js")),_=r[u].replace(/^.*?!/,"")}else c=WCT.DeepCopy(DATA.GetS(r.book_noslide_template+":slide.js")),_=r.book_noslide_template.replace(/^.*?!/,"");c&&c.controls||(c={controls:{}});var h=i.GetChapter(t),p=DATA.GetS("book!"+this.content_uid_+":entity.txt"),f=c.controls.page&&c.controls.page.skin||"standard",m=this.GetContext();h&&(h.uid==p.uid?h=null:m.Set(h.tclass,h.uid)),o.SetBookStyle(f),o.SetConfig("transition",l),o.SetConfig("book_style",p.book_style||"");var b={book:p,chapter:h,step:t+1,steps:this.steps_,slide:c,template:_,ctx:m};"slide"==n.tclass?HANDLER.slide.ShowSlide(n.uid,o,b):"project"==n.tclass?HANDLER.lesson.ShowAsSlide(n.uid,o,b):HANDLER.cdoc.ShowAsSlide(n.tclass,n.uid,o,b),o.Template(_),s.uid!=this.tracking_id_&&(this.tracking_id_&&this.local_trackers_[this.tracking_id_].Close(),this.tracking_id_=s.uid,this.local_trackers_[s.uid].Open()),this.local_trackers_[s.uid].Progress(n.uid),this.busy_=!1}else this.Fini(!1,"unable to get book or slide for step: "+t)}}function h(t){if(!t&&null!=this.search_step_)return this.ExecCommand("jump",this.search_step_),this.search_.Destructor(),this.search_=null,void(this.search_step_=null);var e=arguments[1]||null;if(e){var i=this.toc_.GetSlideOrderIdx("cur",e);null!=i&&this.ExecCommand("jump",i)}else this.search_step_=null,this.search_.Destructor(),this.search_=null}return{Destructor:function(){this.search_&&(this.search_.Destructor(),this.search_=null),this.toc_&&(this.toc_.Destructor(),this.toc_=null),HANDLER.base.prototype.Destructor.call(this)},GetTitle:function(){return(this.toc_&&this.toc_.GetSlide(this.step_)).caption||this.config_.caption},GetTocObject:function(){return{nextSlide:this.step_+1<this.steps_,previousSlide:0<this.step_,toc:this.toc_}},GetToc:function(){return this.toc_},GetSearch:function(){return this.search_||null},GetContext:function(){var t=HANDLER.base.prototype.GetContext.call(this);return this.ctx_.slide&&t.SetScope("slide"),t},GetCurrentSlide:function(){return this.toc_?this.toc_.GetSlide(this.step_):null},GetCompletionState:function(){if(!this.toc_)return HANDLER.base.prototype.GetCompletionState.call(this);for(var t=this.toc_.GetVisited(),e=0,i=0,s=null;s=t[i++];)"slide"===s.tclass&&s.visited&&e++;var n=this.steps_,o=null;return"on_completion"===this.GetConfig("scorm_decide_passed")&&(o=e===n),{completed:e===n,passed:o,score:{cur:null,max:null},progress:{cur:e,max:n}}},Start:function(){HANDLER.base.prototype.Start.call(this);var t=this.config_,e=null;if(window.BOOK_SCO_TOC)e=window.BOOK_SCO_TOC,window.BOOK_SCO_TOC=null;else{var i={book_group:t.book_show_book_group,cdoc:t.book_show_cdoc,project:t.book_show_project,media:{video:t.book_show_media_video,audio:t.book_show_media_audio,image:t.book_show_media_image,doc:t.book_show_media_doc,file:t.book_show_media_file}};e=new Toc(this.content_tclass_,this.content_uid_,i)}this.toc_=e,this.steps_=e.GetSlideCount();var s=this.CreatePanel();if(0<this.steps_){t.handler_socket&&this.socket_.Init();var n=function p(){var t=this.toc_,e=this.central_tracker_,i=e?e.GetBackendType():"none",s=this.local_trackers_,n=TRACKING.local.pageset,o=t.GetBooks(),r={};for(var a in o){var l=TRACKING.InitBook(o[a],i);if(l){var c=new n(e,l);s[a]=c,WCT.ExtendObject(r,c.GetVisited())}}for(var _ in r)t.MarkVisited(_);if(e){var d=!1;try{d=e.IsCollaborator()}catch(h){Log(h)}if(d)return r[this.config_.step]?this.config_.step:null;try{var u=e.GetBookmark();if(u==this.content_uid_||o[u])return e.GetBookmark(u)||null}catch(h){Log(h)}}return null}.call(this);if(n=n&&e.GetSlideOrderIdx("cur",n),this.content_bookmark_){var o=e.GetSlideOrderIdx("cur",this.content_bookmark_);null!=o&&(n=o)}u.call(this,n||0)}else{s&&(s.EnableCommand("index",!1),s.EnableCommand("back",!1),s.EnableCommand("play",!1),s.EnableCommand("next",!1),s.EnableCommand("previous",!1),s.EnableCommand("search_keywords",!1),s.EnableCommand("audio_play",!1),s.EnableCommand("audio_pause",!1),s.EnableCommand("audio_unmute",!1),s.EnableCommand("audio_mute",!1),s.EnableCommand("audio_volume",!1),s.EnableToc(!1),s.SetBookStep(0));var r=$$("div");r.id=this.uid_+"#main",r.style.backgroundColor="#fff",r.style.position="absolute",this.dom_.appendChild(r),this.main_=r}},PreventNavigation:function(t){this.preventNavigation_=t;var e=this.GetPanel()||null;e&&e.PreventNavigation(t)},ExecCommand:function(t){HANDLER.base.prototype.ExecCommand.apply(this,arguments);var e=this.toc_,i=this.step_,s=this.preventNavigation_;switch(t){case"help":MANAGER.OpenHelp(this.content_language_,DATA.HELP_BOOK_KEY);break;case"index":var n=this.config_.content_slide;if(""!=n)n=n.substr(6),null!=(o=e.GetSlideOrderIdx("cur",n))&&this.ExecCommand("jump",o);break;case"prev":case"previous":if(s)break;0<i&&u.call(this,i-1,"prev");break;case"next":if(s)break;i+1<this.steps_&&u.call(this,i+1);break;case"next_chapter":if(s)break;null!=(o=e.GetSlideOrderIdx("next",i))&&u.call(this,o);break;case"prev_chapter":if(s)break;var o;null!=(o=e.GetSlideOrderIdx("prev",i))&&u.call(this,o,"prev");break;case"jump":if(s)break;var r=arguments[1];0<=r&&r<this.steps_&&r!=i&&u.call(this,r,i<r?"next":"prev");break;case"jump_slide":case"jump_book":case"jump_group":case"jump_cdoc":var a=e.GetSlideOrderIdx("cur",arguments[1]);null!=a&&this.ExecCommand("jump",a);break;case"search_keywords":var l=this.skin_.search;if(l&&!this.search_){var c=e.GetKeywords();this.search_=new Popup.KeywordSearch({hdl_id:this.uid_,skin:l,callback:h,scope:this,keywords:c}),this.search_.Show()?this.search_step_=i:(this.search_.Destructor(),this.search_=null)}break;case"first":this.ExecCommand("jump",0);break;case"last":this.ExecCommand("jump",this.steps_-1);break;case"text_off":case"text_on":(d=this.panel_)&&(d.VisibleCommand("text_on","text_off"===t),d.VisibleCommand("text_off","text_on"===t));var _=this.slide_hdl_;_.SetConfig("show_tts_subtitle","text_on"===t),_.HandleSubtitle();break;case"play":case"pause":var d;(d=this.panel_)&&!this.config_.hide_play_pause_button&&(d.VisibleCommand("pause","play"===t),d.VisibleCommand("play","pause"===t)),this.slide_hdl_.UserPause("pause"===t)}},ExecAction:function(t){switch(HANDLER.base.prototype.ExecAction.apply(this,arguments),t){case"book_sound_mute":case"book_sound_unmute":var e={channel:"Pagesound",muted:"book_sound_mute"==t};this.ExecCommand("audio_c_mute",e)}},StartExecutable:function(t){var e=arguments[1]||null,i=this.config_,s=t.tclass;if(!e&&(t.type==HANDLER.MODE.slide||"cdoc"==s&&i.book_show_cdoc||"project"==s&&!t.mode&&i.book_show_project||("book"==s||"group"==s)&&i.book_show_book_group)){var n=this.toc_.GetSlideOrderIdx("cur",t.uid);if(null!=n)return void this.ExecCommand("jump",n)}HANDLER.base.prototype.StartExecutable.call(this,t,e)},CreatePanel:function(){var t=HANDLER.base.prototype.CreatePanel.apply(this,arguments);if(!t)return t;var e=this.config_;e.hide_audio_controls&&(t.VisibleCommand("audio_play",!1),t.VisibleCommand("audio_pause",!1),t.VisibleCommand("audio_unmute",!1),t.VisibleCommand("audio_mute",!1),t.VisibleCommand("audio_volume",!1)),e.hide_navigation_controls&&(t.VisibleCommand("prev_chapter",!1),t.VisibleCommand("prev",!1),t.VisibleCommand("next",!1),t.VisibleCommand("next_chapter",!1)),e.panel_nav_chapter||(t.VisibleCommand("prev_chapter",!1),t.VisibleCommand("next_chapter",!1)),!e.hide_index_page_button&&e.content_slide||t.VisibleCommand("index",!1),!e.hide_search_button&&this.skin_.search||t.VisibleCommand("search_keywords",!1),e.hide_toc_control&&t.VisibleToc(!1),e.hide_progress_control&&t.VisibleProgress(!1);var i=e.show_tts_subtitle,s=e.panel_show_subtitle;return t.VisibleCommand("text_on",s&&!i),t.VisibleCommand("text_off",s&&i),t.VisibleCommand("pause",!e.hide_play_pause_button),t.VisibleCommand("play",!1),this.Resize(null,!0),t},Resize:function(){var t=HANDLER.base.prototype.Resize.apply(this,arguments);return t&&!t.abort&&this.search_&&this.search_.Resize(),t},GetContentInfo:function(){var t=HANDLER.base.prototype.GetContentInfo.call(this);if(this.toc_){var e=this.toc_.GetSlide(this.step_);e&&(t.slide=e.uid)}return t},OnBookmark:function(t){if(t.hash){var e=this.toc_.GetSlideOrderIdx("cur",t.hash);null!=e&&u.call(this,e)}},GetUrl:function(){var t=HANDLER.base.prototype.GetUrl.apply(this,arguments);if(arguments[0]){var e=this.GetCurrentSlide();e&&(t+="#"+e.uid)}return t},onkeyup_:function(t,e,i){this.search_?i.hasToBeCancelled=!1:HANDLER.base.prototype.onkeydown_.apply(this,arguments)},onkeydown_:function(t,e,i){var s=HANDLER.base.prototype.onkeydown_.apply(this,arguments);if(s&&!this.search_){var n={stop:"exit",back:"prev",next:"next",feedback:"feedback",focus_bar:"focusBar",focus_content:"focusContent"}[s[0]];n&&WCT.SetTimeout(this.ExecCommand,1,this,[n])}else i.hasToBeCancelled=!1},onsocket_:function(t){if(HANDLER.base.prototype.onsocket_.call(this,t),t.sync){var e=t.message;if("string"==typeof e){var i=e.split("!");this.from_socket_=!0,this.ExecCommand("jump_"+i[0],i[1]),this.from_socket_=!1}}},open_share_dlg_:function(){var t=this.toc_,e=t&&t.GetSlide(this.step_)||null;(e=e?e.tclass+"!"+e.uid:null)&&HANDLER.base.prototype.open_share_dlg_.call(this,e)}}}()),HANDLER.slide=function(){HANDLER.base.apply(this,arguments),this.type_=HANDLER.MODE.slide,this.needs_slide_renderer_=1,this.generic_key_events_=!0,this.steps_=1},HANDLER.slide.prototype=new HANDLER.base,WCT.ExtendObject(HANDLER.slide,{ShowSlide:function(t,e){var i=arguments[2]||{},s=i.slide;if(!(s||(s=DATA.GetS("slide!"+t+":slide.js"))&&s.controls))return!1;var n=this.getContextMap(t,i),o="number"==typeof i.step?i.step:1,r="number"==typeof i.steps?i.steps:1;return n.pagenumber=o+"",n.pagecount=r+"",e.SetContextMap(n),e.SetBookStep(o,r),e.HideMouse(),e.SetContext("slide",t),e.SetSearchTerm(i.lib_search_term),WCT.SetTimeout(e.Play,10,e,[s]),!0},InitSlide:function(t,e,i,s,n){for(var o={init:i,ready:i,callback:s,scope:n},r=1;r<=i;r++){var a=DATA.GetSlideRendererUrl(),l=WCT.iframe.Create(a);l.id=t+"#"+r,l.setAttribute("role","region"),l.setAttribute("allowfullscreen","1"),l.style.backgroundColor="#fff",l.style.overflow="hidden",l.className="region-content",WCT.iframe.Load(l,HANDLER.slide.SlideWindowReady,o,e,[l])}},SlideWindowReady:function(t){var e=t.contentWindow,i=e&&e.Page||null,s=HANDLER.slide.OnPageComplete.bind(this);i&&i.SetPageloadSink({onPageComplete:s}),--this.init||HANDLER.slide.SlideWindowCallback(this)},OnPageComplete:function(){--this.ready||HANDLER.slide.SlideWindowCallback(this)},SlideWindowCallback:function(t){if(!(0<t.init||0<t.ready)){var e=t.callback,i=t.scope;t.callback=null,t.scope=null,e.call(i)}},getContextMap:function(t,e){for(var i=DATA.GetS((arguments[2]||"slide")+"!"+t+":entity.txt")||{},s=e.book?DATA.GetS("book!"+e.book.uid+":entity.txt"):null,n=e.chapter?DATA.GetS(e.chapter.tclass+"!"+e.chapter.uid+":entity.txt"):null,o=e.cdoc?e.cdoc:null,r=e.project?e.project:null,a={GetS:DATA.GetS.bind(DATA)},l={slide:i,book:s,chapter:n,cdoc:o,project:r},c=["cdoc","project","book","chapter","slide","da","media"],_={},d=0,u=c.length;d<u;d++){var h=c[d];if(l[h])for(var p in l[h])"assets"!==p&&(_[h+":."+p]=l[h][p]);else _[h+":.uid"]="",_[h+":.tclass"]="",_[h+":.caption"]="",_[h+":.shortdesc"]="",_[h+":.description"]=""}for(d=0,u=c.length;d<u;d++){h=c[d];var f={shortdesc:!0,description:!0};for(p in l[h])f[p]&&(_[h+":."+p]=WCT.Placeholder.Resolve(l[h][p]||"",e.ctx,a,{param_list:_}))}return a.GetS=null,_}}),WCT.ExtendObject(HANDLER.slide.prototype,{Start:function(){HANDLER.base.prototype.Start.call(this);var t=this.config_,e=t.caption,i=this.CreatePanel();if(i){i.SetStatusText(e);var s=t.show_tts_subtitle,n=t.panel_show_subtitle;i.VisibleCommand("text_on",n&&!s),i.VisibleCommand("text_off",n&&s),i.VisibleCommand("pause",!t.hide_play_pause_button),i.VisibleCommand("play",!1)}MANAGER.SetWindowTitle(e),HANDLER.slide.ShowSlide(this.content_uid_,this.slide_hdl_)||this.Fini(!1,"slide!"+this.content_uid_+":slide.js")},GetCompletionState:function(){return{completed:!0,passed:null,score:{cur:null,max:null},progress:{cur:1,max:1}}},ExecAction:function(t){var e="base";switch(t){case"book_sound_mute":case"book_sound_unmute":e="book"}HANDLER[e].prototype.ExecAction.apply(this,arguments)},ExecCommand:function(t){switch(HANDLER.base.prototype.ExecCommand.apply(this,arguments),t){case"help":MANAGER.OpenHelp(this.content_language_,DATA.HELP_BOOK_KEY);break;case"text_off":case"text_on":(i=this.panel_)&&(i.VisibleCommand("text_on","text_off"===t),i.VisibleCommand("text_off","text_on"===t));var e=this.slide_hdl_;e.SetConfig("show_tts_subtitle","text_on"===t),e.HandleSubtitle();break;case"play":case"pause":var i;(i=this.panel_)&&!this.config_.hide_play_pause_button&&(i.VisibleCommand("pause","play"===t),i.VisibleCommand("play","pause"===t)),this.slide_hdl_.UserPause("pause"===t)}}}),HANDLER.library=function(t,e){HANDLER.base.apply(this,arguments),t&&(this.content_bookmark_=t.bookmark),this.type_=HANDLER.MODE.library,this.resize_prefer_main_=!0,this.mod_ids_={},this.mvm_="vert",this.lm_="content",this.sel_=null,this.sel_caption_="",this.first_=!0,this.active_sr_=null,this.search_term_=null,this.data_side_="right",this.search_={caption:!0,shortdesc:!0,description:!0,keywords:!0,slides:!0},this.settings_={use_new_window:!1,context_my_roles:!0},this.needs_slide_renderer_=2,this.generic_key_events_=!0,this.layout_=null,this.context_=null,this.glossary_=null},HANDLER.library.prototype=new HANDLER.base,WCT.ExtendObject(HANDLER.library,{SPLIT_INIT:.2,LIST_MODES:{content:"content",search:"search",context:"context",favorites:"favorites",recent:"recent",glossary:"glossary"},GetAutostartItem:function(t){if("project"==t.tclass||"group"==t.tclass){if(t.autostart){var e=new WCT.context;return e.SetScope(t.tclass),e.Set(t.tclass,t.uid),e.Resolve(t.autostart)}for(var i=t.assets||[],s=0,n=null;n=i[s++];)if(WCT.ClampBoolean(n.autostart)){var o=n.mode||n.fileName;return o?t.tclass+"!"+t.uid+":"+o:n.tclass+"!"+n.uid}}return null}}),WCT.ExtendObject(HANDLER.library.prototype,function(){function a(t){var e=arguments[1]||null;switch(t){case"close":this.profile_.Destructor(),this.profile_=null;break;case"LibSearch":var i=this.search_;"undefined"!=typeof i[e.id]&&i[e.id]!=e.value&&(i[e.id]=e.value,WCT.store.Set(WCT.store.KEYS.lib_search+e.id,e.value));break;case"LibSettings":var s=this.settings_;"undefined"!=typeof s[e.id]&&s[e.id]!=e.value&&(s[e.id]=e.value,WCT.store.Set(WCT.store.KEYS.lib_settings+e.id,e.value));break;case"ContextRoles":this.context_&&this.context_.UpdateRole(e.id,e.value)}}function S(t){switch(t.tclass){case"book":WCT.ClampBoolean(t.single_click_opens_book)&&this.Execute("book!"+t.uid);break;case"project":case"group":var e=HANDLER.library.GetAutostartItem(t);if(e){var i=new WCT.address(e).AsObject(DATA.LESSON_MODE);if(i)return function s(t,e){if(DATA.LESSON_MODE[e.mode])this.Execute("project!"+e.uid+":"+e.mode);else if(e.fileName)this.Execute(e.tclass+"!"+e.uid+":"+e.fileName);else if(("group"==t.tclass||"project"==t.tclass)&&"slide"==e.tclass)return DATA.GetS(e.tclass+"!"+e.uid+":entity.txt");return null}.call(this,t,i)}}return null}function p(t,e){if(2==arguments.length){var i=DATA.GetS(e+":.tree_path");i=i&&i.response&&i.response.paths||[];for(var s=0,n=null;n=i[s++];)if(p.call(this,t,e,n))return!0;return!1}var o=(n=arguments[2])[s=n.length-1]||null;if(!o)return!1;var r=this.content_tclass_+"!"+this.content_uid_;do{if((o=o.type+"!"+o.uid)==r){t.Expand(o);break}o=n[s--]}while(-1<=s);for(;0<=s;){if(o=(o=n[s--]).type+"!"+o.uid,!t.Contains(o,!1))return!1;t.Expand(o)}return!(!o||!t.Contains(o,!1))&&t.Select(o)}function k(){var t=this.mod_ids_,e=this.GetModule(t.slide1),i=this.GetModule(t.slide2);this.active_&&"hor_l"!=this.mvm_?(1&this.active_sr_&&e&&e.SetVisible(!0),2&this.active_sr_&&i&&i.SetVisible(!0)):(e&&e.SetVisible(!1),i&&i.SetVisible(!1))}return{Destructor:function(){HANDLER.base.prototype.Destructor.call(this),this.layout_&&(this.layout_.Destructor(),this.layout_=null),this.context_&&(this.context_.Destructor(),this.context_=null),this.glossary_&&(this.glossary_.Destructor(),this.glossary_=null),this.mod_ids_=null},Start:function(){HANDLER.base.prototype.Start.call(this);var t=this.dom_,e=this.skin_;if(e){if(this.ManagerTracking()){var i=this.content_uid_,s=this.content_tclass_;if(this.content_bookmark_){var n=this.content_bookmark_.split("!");s=n[0],i=n[1]}TRACKING.backend.collaborator.prototype.TrackRecord({verb:{id:"open"},context:{id:s+"!"+i},object:{id:s+"!"+i,type:s,objectType:"library"}})}(function r(){var t=this.search_;for(var e in t){null!=(s=WCT.store.Get(WCT.store.KEYS.lib_search+e))&&(t[e]=WCT.ClampBoolean(s))}this.GetConfig("lib_search_slides")||(t.slides=!1);var i=this.settings_;for(var e in i){var s;null!=(s=WCT.store.Get(WCT.store.KEYS.lib_settings+e))&&(i[e]=WCT.ClampBoolean(s))}}).call(this),WCT.skin.ApplyTextFormats(t,e),function a(){var t=HANDLER.library,e=this.dom_,i=this.config_,s="right",n=i.lib_tree?t.SPLIT_INIT:0,o=i.lib_tree?null:t.SPLIT_INIT;this.rtl_&&(s="left",n=i.lib_tree?1-t.SPLIT_INIT:1,o=i.lib_tree?null:1-t.SPLIT_INIT),this.data_side_=s;var r=new t.Layout(this.uid_,this.skin_,n,o);this.layout_=r,this.main_=r.Create(e)}.call(this),function h(){var t=this.config_,e=DATA.GetS(t.library),i=!1;if(e&&e.categories)for(var s in e.categories){i=!0;break}var n=HANDLER.library,o=this.skin_,r=this.layout_,a=this.mod_ids_,l=this.data_side_,c="left"==l?"right":"left",_=this.settings_.context_my_roles;a.slide2=r.AddModule(l,"Slide",o),a.slide1=r.AddModule(l,"Slide",{}),i&&o.filter&&(a.filter=r.AddModule(c,"Filter",o.filter)),o.search&&(a.search=r.AddModule(c,"Search",o)),t.ctx&&o.context_roles&&r.AddModule(c,"ContextRoles",o.context_roles,_),o.tree&&(a.content=r.AddModule(c,"Tree",o.tree),t.lib_glossary_root&&(DATA.GetS(t.lib_glossary_root+":entity.txt")?(a.glossary=r.AddModule(c,"Tree",o.tree,!0),this.glossary_=new n.Glossary(this,a.slide2)):t.lib_glossary_root=null)),o.searchlist&&(a.searchlist=r.AddModule(c,"List",o.searchlist),a.recent=r.AddModule(c,"List",o.searchlist),t.lib_breadcrumb_trail&&(a.favorites=r.AddModule(c,"List",o.searchlist)),t.ctx&&(a.context=r.AddModule(c,"List",o.searchlist),this.context_=new n.Context(this,a.context,"lib_context_info",_)));var d=this.GetModule(a.slide2);d&&(d.SetRenderer(1),d.SetRawMode(!0));var u=this.GetModule(a.search);u&&u.SetOutputList(a.searchlist)}.call(this),function l(){var t=this.layout_.GetModule(this.mod_ids_.search);if(t){var e=this.config_,i=[];for(var s in HANDLER.library.LIST_MODES)"glossary"==s&&!e.lib_glossary_root||"favorites"==s&&!e.lib_breadcrumb_trail||"context"==s&&!e.ctx||i.push(s);t.SetNavigationOptions(i)}}.call(this),BROWSER.MOBILE&&this.Orientation();var o=this.CreatePanel();o&&(o.LogoClickable(!0),o.VisibleCommand("back",!1),o.VisibleCommand("glossary",!1),BROWSER.MOBILE&&o.VisibleCommand("exit",!1)),function c(){for(var t=this.mod_ids_,e=this.config_,i=["searchlist","favorites","recent","glossary","context"],s=0,n=null;n=i[s++];){var o=this.GetModule(t[n]);o&&o.SetVisible(!1)}e.ctx&&this.context_?e.lib_list_mode="context":e.lib_list_mode!=HANDLER.library.LIST_MODES.search||e.lib_searchstring||(e.lib_list_mode=null),this.ListMode(e.lib_list_mode);var r=this.GetModule(t[e.lib_list_mode]);if(r){var a=this.content_bookmark_||"",l=HANDLER.library.LIST_MODES;switch(e.lib_list_mode){case l.glossary:a&&r.Select(a)&&r.Expand(a);break;case l.favorites:case l.recent:case l.context:a&&r.Select(a);break;case l.search:if(e.lib_searchstring){r.Search(e.lib_searchstring);break}if(!(r=this.GetModule(t.content)))return;case l.content:a&&(TRACKING.backend.collaborator.Available()?p.call(this,r,a)||(a=null):r.Select(a)?r.Expand(a):a=null),a||(a=this.content_tclass_+"!"+this.content_uid_,r.Select(a)&&r.Expand(a))}}}.call(this),this.config_.handler_preload_lib&&DATA.GetAll(this.content_tclass_+"!"+this.content_uid_)}},Resize:function(){var t=HANDLER.base.prototype.Resize.apply(this,arguments);return!t||t.abort||this.layout_.Resize(t),t},ResizeLayout:function(){this.layout_.Resize()},GetEmbeddedPos:function(){return this.layout_.GetFramePos(this.data_side_)},GetLayoutManager:function(){return this.layout_},GetModule:function(t){var e=this.layout_;return e?e.GetModule(t)||e.GetModule(this.mod_ids_[t]):null},GetSearchInfo:function(){return this.search_},GetListMode:function(){return this.lm_},GetContextHelp:function(){return this.context_},SetActive:function(t){this.active_!==t&&(HANDLER.base.prototype.SetActive.apply(this,arguments),k.call(this))},StartExecutable:function(t){var e=arguments[1]||null;if(!(e||t.external||t.filename||t.mode||t.type!=HANDLER.MODE.library&&t.type!=HANDLER.MODE.slide)){var i=this.GetModule(this.mod_ids_.content);if(i){var s=t.tclass+"!"+t.uid,n=HANDLER.library.LIST_MODES.content;if(this.lm_==n){if(TRACKING.backend.collaborator.Available()){if(p.call(this,i,s))return}else if(i.Select(s))return void i.Expand(s)}else if(i.Contains(s))return void this.ListMode(n,s)}}HANDLER.base.prototype.StartExecutable.call(this,t,e)},ExecCommand:function(t){switch(HANDLER.base.prototype.ExecCommand.apply(this,arguments),t){case"logoclick":this.ListMode();var e=this.content_tclass_+"!"+this.content_uid_;this.GetModule(this.mod_ids_.content).Select(e);break;case"context_roles":var i=arguments[1];this.context_&&this.settings_.context_my_roles!=i&&(this.settings_.context_my_roles=i,this.context_.UseMyRoles(i),WCT.store.Set(WCT.store.KEYS.lib_settings+"context_my_roles",i));break;case"settings":if(this.skin_.profile&&!this.profile_){var s=new Profile(this.uid_,a),n=this.GetConfig("ctx");s.Enable("LibSearch","LibSettings"),n&&this.context_&&(s.Enable("ContextRoles"),s.Configure("ContextRoles",this.context_.GetRoles())),s.Configure("LibSearch",this.search_),s.Configure("LibSettings",this.settings_),s.Show(n?"ContextRoles":"LibSearch",this.dom_),this.profile_=s}break;case"help":MANAGER.OpenHelp(this.content_language_,DATA.HELP_LIBRARY_KEY);break;case"prev":case"next":var o=this.lm_==HANDLER.library.LIST_MODES.search?"searchlist":this.lm_,r=this.GetModule(this.mod_ids_[o]);r&&r["prev"==t?"SelectPrev":"SelectNext"]();break;case"back":this.MobileViewMode("hor_l");break;case"feedback":this.feedback_&&this.feedback_.SetZIndex(1)}},ExecAction:function(t){var e=this.GetModule(this.mod_ids_.slide),i=e&&e.IsVisible()?"slide":"base";HANDLER[i].prototype.ExecAction.apply(this,arguments)},ListMode:function(){var t=arguments[0]||HANDLER.library.LIST_MODES.content;if(t!=this.lm_){this.lm_=t;var e=this.mod_ids_,i=this.GetModule(e.content),s=this.GetModule(e.searchlist);if(i){var n=this.GetModule(e.search);n&&n.SetNavigationState(t),this.first_=!0;var o=HANDLER.library,r=o.LIST_MODES;if(s){var a=this.GetModule(e.search);t==r.search?(this.Select(null),arguments[1]&&(this.search_term_=arguments[1]),s.Reselect(),s.SetVisible(!0),a&&a.ResetSearchFieldValue()):(s.SetVisible(!1),a&&a.Clean())}else t==r.search&&(t=null);for(var l=["Favorites","Recent","Glossary","Context"],c=0,_=null;_=l[c++];){var d=this.GetModule(e[_.toLowerCase()]);o[_].Configure(this,d)||(t=null)}if(t==r.content){var u=arguments[1]||this.sel_||this.content_tclass_+"!"+this.content_uid_;if(this.sel_=null,this.sel_caption_=null,i.SetVisible(!0),TRACKING.backend.collaborator.Available()){d=this.GetModule(this.lm_);p.call(this,d,u)||i.Reselect()}else i.Select(u)||i.Reselect()}else i.SetVisible(!1);this.SetBookmark(),this.layout_.Resize()}}},Orientation:function(){var t=MANAGER.handler.GetOrientation();this.MobileViewMode("portrait"==t?"hor_l":"vert"),HANDLER.base.prototype.Orientation.call(this)},MobileViewMode:function(t){if(this.mvm_==t)return!1;this.mvm_=t;var e=this.rtl_,i=this.layout_;i.SetFrameVisibility(e?"right":"left","hor_r"!=t),i.SetFrameVisibility(e?"left":"right","hor_l"!=t);var s=this.panel_;return s&&s.VisibleCommand("back","hor_r"==t),k.call(this),!0},Select:function(t){if(this.active_){var e=this.layout_,i=this.mod_ids_,s=this.GetModule(i.slide1),n=this.GetModule(i.slide2),o=this.panel_,r=this.GetConfig("lib_caption");if(!t)return this.sel_=null,s&&s.SetVisible(!1),n&&n.SetVisible(!1),void(o&&o.SetStatusText(r||""));var a=t.tclass+"!"+t.uid;this.sel_=a,this.SetBookmark();var l=this.lm_==HANDLER.library.LIST_MODES.glossary&&"group"==t.tclass,c=l?null:S.call(this,t),_=!1,d=!1,u=!1,h=!1,p=!1,f=!1,m=!1;switch(t.tclass){case"group":if(c&&"slide"==c.tclass){h=p=!0;break}case"cdoc":d=!0,u=p=f=!l;break;case"project":if(c&&"slide"==c.tclass){h=p=!0;break}case"book":_=d=u=p=f=!0;break;case"slide":h=p=!0;break;case"media":d=p=f=_=m=!0}u=u&&this.GetConfig("lib_assets"),p=p&&this.GetConfig("lib_breadcrumb_trail"),f=f&&this.GetConfig("lib_entity_caption");var b=HANDLER.library.LIST_MODES;if(this.lm_!=b.content&&!t.breadcrumb_trail){var v=this.GetModule(this.lm_==b.glossary?i.glossary:i.content);if(t.breadcrumb_trail=v?v.GetPath(t.tclass+"!"+t.uid):null,!t.breadcrumb_trail){var g=function(t){if(!TRACKING.backend.collaborator.Available())return null;var e=DATA.GetS(t.tclass+"/"+t.uid+"/.tree_path"),i=e.response&&e.response.paths&&e.response.paths[0];if(i){for(var s=[],n=0,o=null;o=i[n++];)s.push(o.type+"!"+o.uid+":entity.txt");var r=DATA.GetSM(s)||[];r.reverse(),r.pop();for(var a=[],l=(n=0,null);l=r[n++];)a.push({caption:l.caption,tclass:l.tclass,uid:l.uid});return a}return null}(t);if(g)t.breadcrumb_trail=g;else{var y=DATA.GetS(t.tclass+"!"+t.uid+":entity.txt");y&&(t.breadcrumb_trail=[{caption:y.caption,tclass:y.tclass,uid:y.uid}])}}}if(s&&(c&&(c=DATA.GetS(c.tclass+"!"+c.uid+":entity.txt"),t.breadcrumb_trail&&(c.breadcrumb_trail=WCT.DeepCopy(t.breadcrumb_trail),c.breadcrumb_trail.push({caption:t.caption,tclass:t.tclass,uid:t.uid}))),s.SetVisible(h),h&&(s.SetContent(c||t),this.active_sr_=1)),n){var C=_||d||u||p||f||m||l;n.Configure({buttons:_,description:d,assets:u,glossary:l,breadcrumb:p,caption:f,media:m}),n.SetVisible(C),C?(l?(n.SetContent({}),this.glossary_.Show([{lst:t.assets||[],idx:0}])):n.SetContent(t),this.active_sr_=s&&h?3:2):n.SetContent(null)}var T=r||t.caption||"";if(o&&o.SetStatusText(T),this.sel_caption_=T,MANAGER.SetWindowTitle(T||"trainer",!1),BROWSER.MOBILE&&(this.first_?(this.first_=!1,k.call(this)):"vert"==this.mvm_||this.MobileViewMode("hor_r")||k.call(this)),e.Resize(),this.ManagerTracking()&&("slide"===t.tclass||"cdoc"===t.tclass||"media"===t.tclass)){var x=t.tclass+"!"+t.uid,A={id:x,name:t.caption||null,language:t.language,objectType:t.tclass};"media"===t.tclass&&(A.type=t.sub_type),TRACKING.backend.collaborator.prototype.TrackRecord({verb:{id:"start"},context:{id:x},object:A})}}},GetTitle:function(){return this.config_.title||this.sel_caption_||""},SetFilter:function(t){var e=DATA.GetS(this.config_.library);e&&e.categories&&e.categories[t]||(t=null);var i=this.layout_,s=this.mod_ids_,n=this.GetModule(s.content);if(n){var o=this.sel_;this.ListMode();var r=this.GetModule(s.search);if(r&&r.Search(""),n.SetFilter(t),n.Recreate(),i.Resize(),o||!n.Select(o)){var a=n.GetRootNode();a&&n.Select(a)}}},OnSlidePropChange:function(t,e,i){var s=this.GetModule(this.mod_ids_.slide2);s&&s.OnSlidePropChange(t,e,i)},GetContentInfo:function(){var t=HANDLER.base.prototype.GetContentInfo.call(this),e=this.lm_,i=HANDLER.library.LIST_MODES,s=this.sel_;if(s){var n=DATA.GetS(s+":entity.txt");n&&(t.selection_rtl=WCT.IsLanguageRTL(n.language)),t.selection=s;for(var o=e==i.content,r=o?this.GetModule(this.mod_ids_.content):null,a=["slide","project","group","book","cdoc","da","media"],l=0,c=null;c=a[l++];)if(o){var _=r.SearchSelectionBottomUp(c);t["selection_"+c]=_||null}else t["selection_"+c]=c==n.tclass?n.uid:null}return t.lib_list_mode=e,t.lib_search_term=e==i.search&&this.search_term_||null,t},Execute:function(t){var e=this.GetSlideCtx(0);if(t.indexOf(":")<0){"book"!=(i=t.split("!"))[0]&&"project"!=i[0]||HANDLER.library.Recent.Add({tclass:i[0],uid:i[1]})}else{var i,s=(i=t.split("!")).pop().split(":");DATA.LESSON_MODE[s[1]]&&HANDLER.library.Recent.Add({tclass:i[0],uid:s[0]})}this.settings_.use_new_window&&!1!==arguments[1]?e.cfg_show(t,!0,"force=1"):e.cfg_show(t)},SetBookmark:function(){var t=HANDLER.library.LIST_MODES,e=this.lm_,i=this.sel_;(e==t.search||e==t.content&&i==this.content_tclass_+"!"+this.content_uid_)&&(i=null);var s=(e==t.search?this.search_term_:null)||null;e==t.content&&(e=null),BOOKMARK.SetState(this.uid_,{lib_list_mode:e,lib_searchstring:s,hash:i||null})},OnBookmark:function(t){var e=this.mod_ids_,i=t.lib_list_mode;if(i==HANDLER.library.LIST_MODES.search){if(t.lib_searchstring){var s=this.GetModule(e.search);return void(s&&s.Search(decodeURI(t.lib_searchstring),!0))}i=null}if(i&&(this.ListMode(i),0<=["content","favorites","recent","glossary"].indexOf(i)&&t.hash)){var n=this.GetModule(e[i]);n&&n.Select(t.hash)}},GetUrl:function(){var t=HANDLER.base.prototype.GetUrl.apply(this,arguments),e=[],i=this.config_,s=i.library;s!==DEFAULTS.library.d&&e.push("library="+s);var n=i.style;n!==DEFAULTS.style.d&&e.push("style="+n);var o=!1,r=HANDLER.library.LIST_MODES;this.lm_==r.search&&this.search_term_&&(e.push("lib_list_mode="+this.lm_),e.push("lib_searchstring="+this.search_term_),o=!0);var a="";return arguments[0]&&(this.lm_==r.glossary&&e.push("lib_lib_mode="+r.glossary),this.sel_&&!o&&(a="#"+this.sel_)),t+(e=e.length?"&"+e.join("&"):"")+a},open_share_dlg_:function(){HANDLER.base.prototype.open_share_dlg_.call(this,this.sel_)}}}()),HANDLER.file=function(){HANDLER.base.apply(this,arguments),this.content_addr_=this.content_tclass_+"!"+this.content_uid_+":"+this.content_filename_,this.type_=HANDLER.MODE.file,this.generic_key_events_=!0},HANDLER.file.prototype=new HANDLER.base,WCT.ExtendObject(HANDLER.file,{ACCEPTED_EXT:["jpg","jpeg","gif","png","bmp","tif","tiff"],IMAGES:["jpg","jpeg","gif","png","bmp","tif","tiff"],GetFileExtension:function(t){var e=t.split(".");return 1<e.length?e.top().toLowerCase():""},IsAcceptedExt:function(t){var e=this.GetFileExtension(t);return 0<=this.ACCEPTED_EXT.indexOf(e)},IsAcceptedImage:function(t){var e=this.GetFileExtension(t);return 0<=this.IMAGES.indexOf(e)}}),WCT.ExtendObject(HANDLER.file.prototype,{GetCompletionState:HANDLER.slide.prototype.GetCompletionState,Start:function(){HANDLER.base.prototype.Start.call(this);var t=this.dom_;t.style.backgroundColor="#FFFFFF",PLATFORM.IOS&&(t.style.zIndex=1,t.style.opacity=1);var e=this.CreatePanel(),i=this.config_;if(e&&i.caption){for(var s=this.content_filename_,n=i.assets||[],o=n.length-1;0<=o;o--)if(n[o].fileName==s){s=n[o].caption;break}e.SetStatusText(s)}var r=$$("div");if(r.id=this.uid_+"#main",r.style.position="absolute",r.style.overflow="auto",this.skin_.main&&WCT.skin.Apply(r,this.skin_.main),this.main_=r,t.appendChild(r),HANDLER.file.IsAcceptedImage(this.content_filename_)){var a=DATA.context.ToAbsPath(this.content_addr_),l=$$("img");l.src=a,r.appendChild(l)}},GetUrl:function(){return HANDLER.base.prototype.GetUrl.apply(this,arguments)+":"+this.content_filename_}}),HANDLER.cdoc=function(){HANDLER.library.apply(this,arguments)},HANDLER.cdoc.prototype=new HANDLER.library,HANDLER.cdoc.ShowAsSlide=function(t,e,i,s){var n=DATA.GetS(t+"!"+e+":entity.txt")||{};s.cdoc=n;var o={GetS:DATA.GetS.bind(DATA)},r={};for(var a in n)switch(a){case"shortdesc":case"description":r[t+":."+a]=WCT.Placeholder.Resolve(n[a]||"",s.ctx,o);break;case"assets":continue;default:r[t+":."+a]=n[a]}i.SetContextMap(r);var l=new WCT.context(s.ctx);l.Set(t,e),l.SetScope(t);var c={caption:1,shortdesc:1,description:1},_={video:1,audio:1,image:1,doc:1,file:1},d={video:"src",audio:"src",html:"src",hrefarea:"href",link_document:"link_to"};if(i.Template()==s.template){var u=HANDLER.slide.getContextMap(e,s,t);i.SetContextMap(u);var h=i.GetApi("Controls")||{};for(var p in h){if(c[g=(v=h[p]).GetName()]){var f=l.ResolveHtmlString(n[g]||"",l);i.UpdateControl(p,"text",f)}if(_[g]){var m=t+"!"+e+":"+n.original_stream;if({video:1,audio:1,doc:1,file:1}[g]){var b=d[v.GetType()]||!1;i.UpdateControl(p,b,m)}else"image"===g&&i.UpdateControl(p,"image",{w:n.media_original_size.x||100,h:n.media_original_size.y||100,id:m})}h[p].RTFireTrigger("update_placeholder")}}else{h=s.slide.controls;for(var p in h){var v,g;if(c[g=(v=h[p]).name]&&(v.text=l.ResolveHtmlString(n[g]||"",l)),_[g]){m=t+"!"+e+":"+n.original_stream;if({video:1,audio:1,doc:1,file:1}[g])(b=d[v.type]||!1)&&(v[b]=m);else"image"===g&&(v.image={w:n.media_original_size.x||100,h:n.media_original_size.y||100,id:m})}}HANDLER.slide.ShowSlide(s.template,i,s)}},HANDLER.cdoc.prototype.GetCompletionState=HANDLER.slide.prototype.GetCompletionState,HANDLER.lesson.RendererCtx=function(t,e,i,s,n,o){this.uid_=t,this.src_ctx_=null,this.obj_=s,this.internal={text_on:!0,audio_on:!0},this.defaults={},this.builtins={},this.global_params={},this.uid=e,this.mode=i,this.is_topmost=!1,this.audio_ext=n,this.audio_vol=o,this.is_audio_lesson=!1,this.video_mode=null,this.scores_set_=!1,this.taskinfo_ori_="NW"},HANDLER.lesson.RendererCtx.prototype={Destructor:function(){WCT.CleanupObject(this.src_ctx_),WCT.CleanupObject(this.internal),WCT.CleanupObject(this.defaults),WCT.CleanupObject(this.builtins),WCT.CleanupObject(this.global_params),this.src_ctx_=null,this.internal=null,this.defaults=null,this.builtins=null,this.global_params=null},GetConfig:function(t){return MANAGER.handler.Get(this.uid_).GetConfig(t)},LoadFile:function(t){var e=MANAGER.handler.Get(this.uid_).GetContext().Resolve(t);return WCT.DeepCopy(DATA.GetS(e))},CleanupInternal:function(){WCT.CleanupObject(this.internal),this.internal={}},GetContext:function(){var t=MANAGER.handler.Get(this.uid_);return t?t.GetContext():null},GetContentInfo:function(){var t=MANAGER.handler.Get(this.uid_);return t?t.GetContentInfo():null},SetVideoMode:function(t){this.video_mode=t},SetDefaults:function(t){this.defaults=t},SetGlobalParams:function(t){this.global_params=t},SetTaskInfoOrientation:function(t){this.taskinfo_ori_=t},Trans:function(t){var e=MANAGER.handler.Get(this.uid_);return e?e.Trans(t):t},SetSourceContext:function(t){this.src_ctx_=t},GetPageCtl:function(){var t=MANAGER.handler.Get(this.uid_),e=t&&t[this.obj_]||{};return"undefined"!=typeof e.page&&e.page},AddControl:function(t){var e=MANAGER.handler.Get(this.uid_),i=e&&e[this.obj_]||null;i&&(this.src_ctx_&&(t._src_ctx=this.src_ctx_),i[t.id]=t,i.ctl_count_||(i.ctl_count_=0),i.ctl_count_++)},AddStartEvent:function(t){var e=MANAGER.handler.Get(this.uid_),i=e&&e[this.obj_]||null;i&&(i.start_events_||(i.start_events_=[]),i.start_events_.push(t))},SetMacroUid:function(t){var e=MANAGER.handler.Get(this.uid_),i=e&&e[this.obj_]||null;i&&(i.macro_uid_=t)},AddTaskSet:function(t){var e=MANAGER.handler.Get(this.uid_),i=e&&e[this.obj_]||null;i&&(i.task_sets_||(i.task_sets_={}),i.task_sets_[t]||(i.task_sets_order_||(i.task_sets_order_=[]),i.task_sets_order_.push(t),i.task_sets_[t]={ctls:[],start_events:[],end_events:[]}))},TaskSetSetQuiz:function(t,e){var i=MANAGER.handler.Get(this.uid_),s=i&&i[this.obj_]||null,n=s&&s.task_sets_&&s.task_sets_[t];n&&(n.is_quiz=!0,n.is_skipable=e)},TaskSetAddControl:function(t,e){var i=MANAGER.handler.Get(this.uid_),s=i&&i[this.obj_]||null;s&&s.task_sets_&&s.task_sets_[t]&&s.task_sets_[t].ctls.push(e)},TaskSetAddStartEvent:function(t,e){var i=MANAGER.handler.Get(this.uid_),s=i&&i[this.obj_]||null;s&&s.task_sets_&&s.task_sets_[t]&&s.task_sets_[t].start_events.push(e)},TaskSetAddEndEvent:function(t,e){var i=MANAGER.handler.Get(this.uid_),s=i&&i[this.obj_]||null;s&&s.task_sets_&&s.task_sets_[t]&&s.task_sets_[t].end_events.push(e)},TaskSetSetMacroUid:function(t,e){var i=MANAGER.handler.Get(this.uid_),s=i&&i[this.obj_]||null;s&&s.task_sets_&&s.task_sets_[t]&&(s.task_sets_[t].macro_uid_=e)},EndLesson:function(t){var e=MANAGER.handler.Get(this.uid_);e&&(e[this.obj_].stop_=t)},SetTaskInfo:function(t){var e=MANAGER.handler.Get(this.uid_);if(e){var i=e.GetConfig("panel_taskinfo_toggle"),s=e.GetConfig("hide_panel");i&&!s&&(t.close_msg=!1),e.SetTaskInfo(t)}},SetScores:function(t,e){if(!this.scores_set_){var i=MANAGER.handler.Get(this.uid_);i&&(i.SetScores(t,e),this.scores_set_=!0)}},GetMacrosByType:function(t){var e=MANAGER.handler.Get(this.uid_);return e?e.GetMacrosByType(t,arguments[1]):[]},GetFreeHighlights:function(t){var e=MANAGER.handler.Get(this.uid_),i=e&&e[this.obj_]||null;if(!i)return null;var s=new RegExp("^"+t),n=[];for(var o in i)o.match(s)&&n.push(i[o]);return n.length?n:null},GetCurTourstopMacroCount:function(){var t=MANAGER.handler.Get(this.uid_),e=(t&&t.GetCurrentTourstop()||{}).macros||[];if(arguments[0]&&MacroRenderer&&MacroRenderer.AUDIO_MACROS){for(var i=MacroRenderer.AUDIO_MACROS,s=0,n=0,o=null;o=e[n++];)i[o.macro_template]&&s++;return s}return e.length},LessonPassed:function(){var t=MANAGER.handler.Get(this.uid_),e=t?t.local_trackers_[t.tracking_id_]:null;return!!e&&e.GetTrackingData(arguments[0]).passed},GetSkinAddr:function(){var t=MANAGER.handler.Get(this.uid_);return t?"adaptable!"+t.GetConfig("skin"):""},ShowPanel:function(t){var e=MANAGER.handler.Get(this.uid_);e&&e.ShowPanel(t)}},HANDLER.lesson.StartStop=function(t,e){this.hdl_uid_=t,this.mode_=e,this.details_=!1},WCT.ExtendObject(HANDLER.lesson.StartStop,{STOP_PADDING:8,B_DETAIL_W:200,CMD_MAP:{play:"page.lesson_play",replay:"page.lesson_restart",exit:"page.lesson_exit",print:"page.lesson_startstop_print",details:"page.lesson_startstop_details"}}),HANDLER.lesson.StartStop.prototype=function(){function k(t,e,i,s,n){return n&&(t="-0"===t?0:-t),t<0||"-0"===t?s-e+Number(t):t}function E(t){for(var e={},i=["bg","bg_h","bg_a"],s=0,n=null;n=i[s++];){var o=WCT.DeepCopy(t[n]);if(o){var r=o.m,a=o.l,l=o.r;r&&a&&l&&(r.id||(r.id=t.src),r.repeat||(r.repeat="x"),a.id||(a.id=t.src),l.id||(l.id=t.src),e[n]={frame:{body:{image:r},w:{image:a},e:{image:l},w_w:a.w||0,e_w:l.w||0,n_h:0,s_h:0},content:{outer_spacing_l:t.bg.l.w||0}})}}i=["image","image_h","image_a"];for(s=0,n=null;n=i[s++];)t[n]&&(e[n]=WCT.DeepCopy(t[n]),e[n].id||(e[n].id=t.src),e[n].w=t.img_w||0,e[n].h=t.img_h||0);return e}return{Destructor:function(){},Show:function(t){var e=MANAGER.handler.Get(this.hdl_uid_),i=e.GetSlideHandler(),s=e.GetSkin("start_stop_page");if(!(i&&s&&s.frame&&s.caption&&s.text))return!1;var n=s.w||800,o=s.h||600,r=s.frame,a=s.caption,l=s.text,c={frame:{body:{background_color:l.background_color||"#FFFFFF"},nw:r.nw,ne:r.ne,sw:r.sw,se:r.se,n:r.n,s:r.s,w:r.w,e:r.e,w_w:r.w_w,e_w:r.e_w,n_h:r.n_h,s_h:r.s_h},title:{font_family:a.font_family,text_color:a.text_color,font_style:"bold"==a.font_weight?"bold":null,font_size:a.font_size,outer_spacing_l:a.x,outer_spacing_r:a.x,outer_spacing_t:a.y,h:r.n_h-a.y},content:{outer_spacing_l:r.w.w||r.w_w,outer_spacing_r:r.e.w||r.e_w,outer_spacing_t:r.n_h,outer_spacing_b:r.s_h}},_=HANDLER.lesson.START_STOP_TEXTKEY[this.mode_],d={type:"text",id:"bo",title:_=e.Trans(_.toUpperCase()+"_START"),text:function S(t,e){var i=HANDLER.lesson.START_STOP_TEXTKEY[this.mode_],s=MANAGER.handler.Get(this.hdl_uid_),n='<div class="start-stop-text" style="line-height:18px;padding:'+HANDLER.lesson.StartStop.STOP_PADDING+'px">';switch(this.mode_){case"demo":case"pres":case"guided":case"praxis":case"uebung":var o=i.toUpperCase();n+='<div style="margin-bottom:20px">'+("start"==t?s.Trans(o+"_START1")+"</div><div>"+s.Trans(o+"_START2"):s.Trans(o+"_STOP"))+"</div>";break;case"test":"start"==t?n=(n+='<div style="margin-bottom:20px">'+[s.Trans("TEST_START1"),s.Trans("TEST_START2"),s.Trans("TEST_START3"),s.Trans("TEST_START4")].join('</div><div style="margin-bottom:20px">')+"</div>").replace(/\[res_mastery_percent\]/,s.GetLessonMasteryPercent()):n+=HANDLER.lesson.DetailStop.Test(s,e.test_details)}return n+"</div>"}.call(this,t,s),hidden:0,custom_style:c,background_color:l.background_color||"#FFFFFF",font_family:l.font_family,font_size:l.font_size?l.font_size+"px":null,align:"start",valign:"top",border_color:"#666666",border:0,padding:0,x:0,y:0,w:n,h:o,z:1};MANAGER.SetWindowTitle(_);var u={type:"page",id:"page",image:{id:"",w:0,h:0},background_image_centered:1,canvas_color:s.background_color||"#9F9F9F",background_color:s.background_color||"#9F9F9F",show_toc:0,fontsizeInPt:0,version:"8.3.0",shadow_show:!1,w:n,h:o},h=MANAGER.GetCentralTracker(),p=h?h.GetBackendType():null,f="scorm"==p||"aicc"==p?e.GetConfig(p+"_allow_restart"):e.GetConfig("allow_restart"),m={controls:{page:u,bo:d}},b=e.GetContentInfo().rtl,v="test"==this.mode_,g=s[t+"page_controls"],y=HANDLER.lesson.StartStop;if(g)for(var C in g){var T=g[C];if(("print"!=C||v)&&("replay"!=C||f))if("details"==C){if(!v)continue;var x=E(T),A=e.Trans(T.text1||"");m.controls["ctl_"+C]={type:"imagebutton",id:"ctl_"+C,custom_style:x.bg,custom_style_mouseover:x.bg_h,custom_style_mousedown:x.bg_a,image:x.image,image_h:x.image_h,image_a:x.image_a,image_align:"left",image_padding_r:T.img_text_spacing,align:T.text_align||"center",text:A,tooltip:A,font_family:T.font_family,font_size:T.font_size,bold:"bold"==T.font_weight,text_color:T.text_color,text_color_h:T.text_color_h,text_color_a:T.text_color_a,line_height:T.h,white_space:"nowrap",text_overflow:"ellipsis",overflow:"hidden",href:"trigger!"+y.CMD_MAP[C],x:k(T.x,y.B_DETAIL_W,0,u.w,b),y:k(T.y,T.h,0,u.h),w:T.w||y.B_DETAIL_W,h:T.h,z:100}}else m.controls["ctl_"+C]={type:"sprite",id:"ctl_"+C,image:T.image,image_mouseover:T.image_h,image_mousedown:T.image_a,tooltip:e.Trans(T.tooltip||""),href:"trigger!"+y.CMD_MAP[C],x:k(T.x,T.w,0,u.w,b),y:k(T.y,T.h,0,u.h),w:T.w,h:T.h,z:100}}return i.Play(m),e.Resize(null,!0),!0},Print:function(){var t=this.hdl_uid_,e=MANAGER.handler.Get(t),i=e.GetSlideHandler().GetWindow(),s=$(t+"#detailstop",i&&i.document||null).parentNode.cloneNode(!0),n=e.GetSkin("start_stop_page");(n=n&&n.stoppage_controls&&n.stoppage_controls.details||null)&&(n.font_size&&(s.style.fontSize=n.font_size+"px"),n.font_family&&(s.style.fontFamily=n.font_family),n.text_color&&(s.style.textColor=n.text_color)),Print.Open(e,s)},Details:function(){var t=this.hdl_uid_,e=MANAGER.handler.Get(t),i=e.GetSlideHandler(),s=i.GetWindow(),n=s&&s.document||null,o=!this.details_;this.details_=o;var r,a=$(t+"#detailstop",n);if(a&&(a.style.display=o?BROWSER.IE&&BROWSER.VERSION<8?"block":"table":"none"),r=(r=e.GetSkin("start_stop_page"))&&r.stoppage_controls&&r.stoppage_controls.details||null){var l=e.Trans((o?r.text2:r.text1)||"");i.UpdateControl("ctl_details","text",l),i.UpdateControl("ctl_details","tooltip",l)}}}}(),HANDLER.lesson.DetailStop=function(){var m={puzzlequiz:1,mchoice:1,fibquiz:1,sqmaquiz:1,gridquiz:1,matchquiz:1,connquiz:1,mixquiz:1,scalequiz:1,hotspotquiz:1,quiz_shuffle_on:1,quiz_shuffle_off:1,quiz_eval:1};function b(t,e){var i="image_";switch(t=t.toLowerCase()){case"user_action_correct_action":case"user_action_wrong_action":case"user_action_help":case"user_action_goon":case"user_action_goon_auto":case"correct_response":case"student_response":case"latency":i+=t;break;case"tour_start":case"tour_stop":case"tour_end":case"tour_play":case"tour_jump":case"tour_prev":case"tour_next":i+=t.substr(5);break;case"slide_user_action_textbox_open":case"slide_user_action_textbox_close":i+=t.substr(18);break;case"quiz_information":i+="quiztype_"+e;break;default:i+="task"}return i}function v(t){var e=t.length;return 50<e?t.substring(0,38)+"..."+t.substring(e-10):t}function g(t,e){var i=t.skin.image_detail_head||{},s="background:#E2E2E2 url('"+(i.id||"")+"') "+(i.x||0)+"px "+(i.y||0)+"px repeat-x;border:1px solid #B9B9B9;height:20px;",n=t.skin[e.icon]?function b(t){var e=t.x||0,i=t.y||0;return'<div style="margin:0 auto;width:'+(t.w||0)+"px;height:"+(t.h||0)+"px;background:transparent url('"+(t.id||"")+"') "+e+"px "+i+'px no-repeat"></div>'}(t.skin[e.icon]):"",o="padding:2px;",r=o+"text-align:center;",a=r+"width:20px;",l="width:20px;",c="overflow:hidden;",_="width:60px;",d="display:inline-block;box-sizing:border-box;padding:4px 2px;vertical-align:top;",u=t.hdl,h=u&&u.GetContentInfo().rtl?"text-align:right;":"text-align:left;",p=WCT.PreventXSS(e.text),f=t.table;if(f.push("<tr>"),e.header)f.push('<th role="presentation" scope="col" style="'+l+o+s+'">'+n+'</th><th scope="col" colspan="2" style="'+c+o+s+'border-left:none;border-right:none;" title="'+p+'">'+v(p)+'</th><th scope="col" style="'+_+o+s+'">&nbsp;</th>');else if(e.info)f.push('<td role="presentation" style="width:16px;vertical-align:top;'+r+'">'+n+'</td><td colspan="2" style="'+c+o+'">'+e.text+'</td><td style="'+_+r+'">&nbsp;</td>');else if(e.tourstop)f.push('<th scope="col" style="'+l+h+o+s+'font-weight:normal;">'+e.nbr+'</th><th scope="col" colspan="2" style="'+c+h+o+s+'font-weight:normal;" title="'+e.text+'">'+v(e.text)+'</th><th scope="col" style="'+_+h+o+s+'font-weight:normal;">'+e.time+"</th>");else if(e.macro_header)f.push('<td role="presentation" style="width:16px;vertical-align:top;'+a+'">'+n+'</td><td colspan="2" style="'+c+o+'">'+p+"</td>"+(e.score?'<td style="text-align:center;vertical-align:top;width:50px;">'+e.score+"</td>":'<td style="width:50px;">&nbsp;</td>'));else if(e.macro_modern_header){var m=u&&u.Trans("SLIDE_MOREINFO");f.push('<th role="presentation" style="vertical-align:middle;'+s+a+'">'+n+'</th><th colspan="2" '+e.dir+'style="overflow:hidden;'+s+o+h+'"><span title="'+e.tt+'" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:calc(100% - 60px);'+d+'">'+p+'</span><span style="text-align:center;'+_+d+'">'+e.score+'</span></th><th id="row#exp#'+e.cnt+'" role="button" tabindex="1" title="'+m+'" style="cursor:pointer;'+s+a+'">'+(PLATFORM.ANDROID?"&#8744;":"&#x2c5;")+"</th>")}else f.push('<td style="width:16px;vertical-align:top;">&nbsp;</td><td colspan="2" style="overflow:hidden;'+o+'"><table><tr><td role="presentation" style="'+l+a+'">'+n+'</td><td style="'+c+o+'" class="dgo_text_container">'+e.text+'</td></tr></table></td><td style="width:50px;">&nbsp;</td>');f.push("</tr>")}function h(t,e,i,s){if(!i.order_||!i.order_.length)return"";var n=s,o=t.GetContentInfo().rtl,r="width:100%;border:0;border-spacing:0;border-collapse:collapse;font-size:"+("number"==typeof e.font_size?e.font_size:10)+"px;table-layout:fixed;";s||(r+="display:none;");var a=['<table tabindex="1" '+(o?'dir="rtl"':'dir="ltr"')+' id="'+(t.GetUid()+"#detailstop")+'" style="'+r+'"><tbody>'],l={hdl:t,skin:e,table:a};if("et_full"!==n){g(l,{header:!0,icon:"image_tour_test",text:i.title});var c=i.tourstops[i.order_[0]],_=c&&c.start_time||"0",d=new Date(_).toGMTString().split(" ");d.splice(4,2);var u=WCT.TimestampToTimeString(_,!0);g(l,{info:!0,icon:"image_datetime",text:d=d.join(" ")+" "+u.substr(0,u.indexOf("."))})}return function f(t,e){for(var i=arguments[2],s=1,n="et_full"===i,o=0,r=null;r=e.order_[o++];){var a=e.tourstops[r];if(!n){var l=WCT.TimestampToTimeString(a.start_time,!0);g(t,{tourstop:!0,time:l.substr(0,l.indexOf(".")),nbr:a.index+1,text:a.title})}if(a.macros)for(var c=null,_=0,d=null;d=a.macros.order_[_++];){var u=a.macros[d];if(m[u.caption]&&0<u.events.length)n?T(t,u.events[0],i,s++):C(t,u.events[0],i);else if(!i)if("branch_on"==u.caption||"form_on"==u.caption)c=[];else if("branch_off"==u.caption||"form_off"==u.caption){if(u.events&&u.events.length){var h=u.events.indexOfAtt("tour_jump","id"),p=0<=h?u.events.splice(h,1)[0]:null;u.events=u.events.concat(c),p&&u.events.push(p)}else u.events=c;c=null,g(t,{icon:b(u.caption),text:u.description||u.caption,score:y(u),macro_header:!0}),x(t,u)}else u.events&&u.events.length&&(c?c=c.concat(u.events):(u.caption&&"end_unit"!=u.caption&&g(t,{icon:b(u.caption),text:u.description||u.caption,score:y(u),macro_header:!0}),x(t,u)))}}}(l,i,n),a.push("</tbody></table>"),"<br/>"+a.join("")}function y(t){if("branch_off"==t.caption||"form_off"==t.caption){for(var e=[],i=0,s=null;s=t.events[i++];)"number"==typeof s.action_score&&e.push(s.action_score),"number"==typeof s.max_score&&(t.cum=s.max_score);t.cur=Math.min.apply(null,e)}return"number"==typeof t.cur&&"number"==typeof t.cum?t.cur+" / "+t.cum:""}function u(t){return t.replace(/<img/gi,"[img").replace(/<br\/>/gi,"[br]").replace(/<[^>]*>|\r|\n/g," ").replace(/&nbsp;|  /g," ").replace(/ \./g,".").replace(/\[br\]/gi,"<br/>").replace(/\[img/gi,"<img")}function p(t){for(var e=t.split(",,,"),i=[],s=0,n=e.length;s<n;s++){var o=e[s];i.push(o.split("\\|").join("</td><td>&nbsp;</td><td>"))}return'<table style="line-height:18px;text-align:center;"><tr><td>'+i.join("</td></tr><tr><td>")+"</td></tr></table>"}function C(t,e,i){var s=i||"et_full_old",n=t.hdl,o="timeout"==e.result;g(t,{icon:b("quiz_information",e.type),text:n.Trans("QUIZTYPE_"+e.type.toUpperCase()),score:("correct"==e.result?e.weighting+" / ":"0 / ")+e.weighting,macro_header:!0}),o||g(t,{text:'<div style="color:darkgray">'+e.description+"</div>"});if(!{puzzlequiz:1,hotspotquiz:1}[e.type]&&"et_full_old"==s&&!o){var r="connquiz"==e.type?p(u(e.correct_responses)):u(e.correct_responses.replace(/,,,/g,"<br/>"));if(g(t,{icon:b("correct_response"),text:n.Trans("QUIZ_CORRECT_RESPONSE")}),g(t,{text:'<div style="color:darkgray">'+r+"</div>"}),"correct"!==e.result){var a=e.student_responses.replace(/,,,/g,"<br/>");g(t,{icon:b("student_response"),text:n.Trans("QUIZ_STUDENT_RESPONSE")}),g(t,{text:'<div style="color:darkgray">'+u(a)+"</div>"})}}g(t,o?{icon:b("tour_next"),text:n.Trans("QUIZ_TIMEOUT_REACHED")}:{icon:b("latency"),text:n.Trans("QUIZ_LATENCY")+": "+e.latency+"s"})}function T(t,e,i,s){var n=t.hdl,o="timeout"===e.result,r={table:function d(t,e){return['<table tabindex="1" style="display:none"'+(t.hdl.GetContentInfo().rtl?'dir="rtl"':'dir="ltr"')+' id="'+("row#details#"+e)+'" style="'+("width:100%;border:0;border-spacing:0;border-collapse:collapse;font-size:"+("number"==typeof t.skin.font_size?t.skin.font_size:10)+"px;table-layout:fixed;")+'"><tbody>']}(t,s),skin:t.skin},a=t.hdl.GetContentInfo().rtl?'dir="rtl"':'dir="ltr"',l=WCT.RemoveHTMLTags(e.description);g(t,{icon:b("correct"==e.result?"user_action_correct_action":"user_action_wrong_action",e.type),icex:"image_expand",icco:"image_collapse",text:l,score:("correct"==e.result?e.weighting+" / ":"0 / ")+e.weighting,tt:l,macro_modern_header:!0,cnt:s,dir:a}),g(r,{icon:b("quiz_information",e.type),text:n.Trans("QUIZTYPE_"+e.type.toUpperCase()),score:" ",macro_header:!0});if(!{puzzlequiz:1,hotspotquiz:1}[e.type]&&!o){var c="connquiz"==e.type?p(u(e.correct_responses)):u(e.correct_responses.replace(/,,,/g,"<br/><br/>"));if(g(r,{icon:b("correct_response"),text:n.Trans("QUIZ_CORRECT_RESPONSE")}),g(r,{text:'<div style="color:darkgray">'+c+"</div>"}),"correct"!==e.result){var _=e.student_responses.replace(/,,,/g,"<br/><br/>");g(r,{icon:b("student_response"),text:n.Trans("QUIZ_STUDENT_RESPONSE")}),g(r,{text:'<div style="color:darkgray">'+u(_)+"</div>"})}}g(r,o?{icon:b("tour_next"),text:n.Trans("QUIZ_TIMEOUT_REACHED")}:{icon:b("latency"),text:n.Trans("QUIZ_LATENCY")+": "+e.latency+"s"}),r.table.push("</tbody></table>"),t.table.push("<tr><td colspan=4>"+r.table.join("")+"</td></tr>")}function x(t,e){for(var i=t.hdl,s=0,n=null;n=e.events[s++];){var o="",r={icon:b(n.id)};switch(n.id){case"user_action_correct_action":o=i.Trans("USER_ACTION_CORRECT_ACTION");break;case"user_action_wrong_action":o=i.Trans("USER_ACTION_WRONG_ACTION")+" "+i.Trans("SCORE_REDUCED")+": "+n.action_score;break;case"user_action_help":o=i.Trans("USER_ACTION_HELP");break;case"user_action_goon":o=i.Trans("USER_ACTION_GOON"+(n.auto?"_AUTO":""));break;case"tour_start":case"tour_stop":case"tour_end":case"tour_play":case"tour_jump":case"tour_prev":case"tour_next":o=i.Trans(n.id.toUpperCase()),r.macro_header=!0;break;case"slide_user_action_textbox_open":case"slide_user_action_textbox_close":o=i.Trans(n.id.toUpperCase());break;default:o='"'+n.id+'" not implemented'}r.text=o,g(t,r)}}return{Test:function(t,e){var i=t.GetTrackingData()||{};return i.passed?(i.image="image_right",i.message="TEST_OK1"):(i.image="image_wrong",i.message="TEST_FAILED1"),function d(t,e,i){var s="",n=e&&e[i.image];n&&(s+='<div role="presentation" style="text-align:center;border-bottom:1px solid #B9B9B9;padding:10px 0;margin-bottom:20px"><div style="background-image:url('+n.id+");background-position:"+n.x+"px "+n.y+"px;width:"+n.w+"px;height:"+n.h+'px;margin:0 auto"></div></div>');var o=t.Trans(i.message);s+='<div style="margin-bottom:20px">'+(o=o.replace(/\[res_mastery_percent\]/,t.GetLessonMasteryPercent()))+"</div>";var r=t.GetContentInfo().rtl,a=["text-align:"+(r?"left":"right"),"padding-"+(r?"left":"right")+":10px","width:50%",r?"":"border-right:1px solid #B9B9B9"].join(";"),l=["padding-"+(r?"right":"left")+":10px",r?"border-right:1px solid #B9B9B9":""].join(";"),c=r?'dir="rtl"':'dir="ltr"',_=i.completed?i.cum:i.max;return(s+="<table "+c+' style="width:100%;border:0;border-spacing:0;border-collsapse:collapse"><tbody><tr><th style="border-top:1px solid #808080;border-bottom:1px solid #B9B9B9;background-color:#F2F2F2;'+a+'">'+t.Trans("LESSON")+':</th><td style="border-top:1px solid #808080;border-bottom:1px solid #B9B9B9;background-color:#F2F2F2;'+l+'">'+WCT.CleanupHTMLString(i.title)+'</td></tr><tr><th style="border-bottom:1px solid #B9B9B9;'+a+'">'+t.Trans("TEST_RESULT")+':</th><td style="border-bottom:1px solid #B9B9B9;'+l+'">'+Math.floor(0<_?i.cur/_*100:100)+'%</td></tr><tr><th style="border-bottom:1px solid #808080;background-color:#F2F2F2;'+a+'">'+t.Trans("ACQUIRED_SCORE")+':</th><td style="border-bottom:1px solid #808080;background-color:#F2F2F2;'+l+'">'+i.cur+" "+t.Trans("OF")+" "+_+"</td></tr></tbody></table>")+h(t,e,i)}(t,e,i)},Quiz:function(t,e,i,s,n){var o=t.GetTrackingData(!0,i)||{};o.passed=o.cur>=o.pass,o.is_quiz=!0;var r="et_full"!=s,a=r?function l(t,e){var i=t.GetContentInfo().rtl;return['<table width="100%" cellspacing="0" cellpadding="0" style="font-weight: bold; margin: 30px 0;"><tr>','<td style="vertical-align:top;text-align:',i?"right":"left",';">',t.Trans("QUIZ_SCORE"),": ",e.cur,"</td>",'<td style="vertical-align:top;text-align:center;">',t.Trans("QUIZ_REQ_SCORE"),": ",e.pass,"</td>",'<td style="vertical-align:top;text-align:',i?"left":"right",';">',t.Trans("QUIZ_MAX_SCORE"),": ",e.max,"</td>","</tr></table>"].join("")}(t,o):function u(t,e,i,s){if(!e.order_||!e.order_.length)return"";var n=t.GetContentInfo().rtl,o=e.tourstops[e.order_[0]],r=o&&o.start_time||"0",a=new Date(r).toGMTString().split(" "),l=WCT.TimestampToTimeString(r,!0);a.splice(4,2),a=a.join(" ")+" "+l.substr(0,l.indexOf("."));var c=s.image_datetime,_='<table><tr><td role="presentation"><div style="text-align:center;"><div style="background-image:url('+c.id+");background-position:"+c.x+"px "+c.y+"px;width:"+c.w+"px;height:"+c.h+'px;margin:0 auto"></div></div></td><td colspan="3" style="font-size:12px;font-weight:normal;vertical-align:top;text-align:'+(n?"right":"left")+';">'+a+"</td></tr></table>",d=e.passed?s.image_right:s.image_wrong;return['<table width="100%" cellspacing="0" cellpadding="0" style="font-weight:bold;margin-top:30px;"><tr>','<td role="presentation" rowspan=2 style="vertical-align:top"><div style="text-align:center;"><div style="background-image:url('+d.id+");background-position:"+d.x+"px "+d.y+"px;width:"+d.w+"px;height:"+d.h+'px;margin:0 auto"></div></div></td>','<td colspan="3" style="vertical-align:top;text-align:',n?"right":"left",';">',i.enable?e.passed?i.pass:i.fail:"","<br></td></tr>",'<tr style="vertical-align:bottom;">','<td style="text-align:',n?"right":"left",";padding-bottom:2px;",n?"padding-left:4px;":"",'">',t.Trans("QUIZ_SCORE"),": ",e.cur,"</td>",'<td style="text-align:center;padding-bottom: 2px;">',t.Trans("QUIZ_REQ_SCORE"),": ",e.pass,"</td>",'<td style="text-align:',n?"left":"right",";padding-bottom:2px;",n?"":"padding-right:4px;",'">',t.Trans("QUIZ_MAX_SCORE"),": ",e.max,"</td></tr>",'<tr><td colspan=4 style="padding-top:10px;">'+_+"</td></tr></table>"].join("")}(t,o,n,e);return n.enable&&r&&(a+=function c(t,e){var i=[],s=t[(e?"pass":"fail")+"_icon"];if(s)if("image"===s.type)i.push("<td>",'<img style="width:',s.w,"px;height:",s.h,'px;overflow:hidden;opacity:1;visibility:visible;display:block;z-index:21;border:0;" ','src ="',DATA.context.ToAbsPath(s.image.id),'"></img>',"</td>");else if(s.image&&s.image.id){var n=s.offset_left||0,o=s.offset_top||0;0<n&&(n*=-1),0<o&&(o*=-1),i.push('<td style="width:',s.w,'px;">','<div class="SpriteControl" ','style="overflow:hidden;opacity:1;visibility:visible;display:block;z-index:21; ',"background-position: ",n,"px ",o,"px; width: ",s.w,"px; height: ",s.h,"px; ","background-image: url(",DATA.context.ToAbsPath(s.image.id),'); border-style:none;border-width:0;background-repeat:no-repeat;"></div>',"</td>")}return['<table style="background-color:#eee;border:1px solid #808080;width:100%;">',"<tr>",i.join(""),"<td>",e?t.pass:t.fail,"</td>","</tr>","</table>"].join("")}(n,o.passed)),a+="et_minimal"===s?"":h(t,e,o,s)}}}(),HANDLER.library.Layout=function(t,e,i){this.hdl_id_=t,this.skin_=e,this.dim_=null,this.ani_d_=null,this.split_=i,this.split_last_=arguments[3]||null,this.tabindex_=0,this.v_={l:!0,r:!0},this.w_={l:0,r:0,s:0},this.h_={l:0,r:0,s:0,i:0,lh:0,rh:0},this.m_={l:[],r:[]},this.mt_={},this.splitter_={hdl:null,x:0,y:0}},HANDLER.library.Layout.AnimationEnd=function(){WCT.dom.RemoveCssTransition(this,HANDLER.library.Layout.AnimationEnd);var t=this.id.split("#")[0],e=MANAGER.handler.Get(t).GetLayoutManager();if(e){var i=e.ani_d_<0;e.SetFrameVisibility("left",!i),e.SetFrameVisibility("right",i),e.ani_d_=null,WCT.dom.CssTransform(this,"translate3d",0,0,0),this.style.left="",this.style.right="0",this.style.zIndex=1,this.style.zIndex=0}},HANDLER.library.Layout.prototype=function(){function _(){var t=this.dim_,e=this.w_,i=this.h_,s=Math.max(0,t.w-e.l),n=Math.max(0,t.w-e.r),o=Math.max(0,t.h-i.l),r=Math.max(0,t.h-i.r),a=this.v_;if(a.l&&a.r){var l="number"==typeof arguments[0]?arguments[0]:this.split_,c=Math.max(0,t.w-e.l-e.r-e.s);s=Math.floor(c*l),n=Math.max(0,c-s)}return{lw:s,rw:n,lh:o,rh:r}}function v(t,e){switch(e){case"move":a.call(this,t,arguments[2]);break;case"click":o.call(this),r.call(this);break;case"begin":var i=this.mt_;for(var s in i)if("Search"==i[s]){var n=this.GetModule(s);n&&n.Blur()}break;case"end":r.call(this)}}function o(){if(null==this.split_last_){var t=this.hdl_id_,e=MANAGER.handler.Get(t).GetContentInfo().rtl,i=this.split_;a.call(this,null,e?this.dim_.w:this.w_.l),this.split_last_=i}else{var s=_.call(this,this.split_last_).lw;a.call(this,null,s),this.split_last_=null}}function r(){PLATFORM.ANDROID&&!BROWSER.CHROME&&this.Resize()}function a(t,e){var i=this.w_,s=(e-i.l)/(this.dim_.w-i.l-i.r-i.s);this.split_=Math.max(0,Math.min(s,1)),this.split_last_=null,this.Resize(null,PLATFORM.ANDROID&&!BROWSER.CHROME)}function n(t,e,i){var s=this.m_[t],n=this.h_["l"==t?"lh":"rh"];i-=n;for(var o={},r={},a=0,l=0,c=0,_=0,d=null;d=s[_++];)if(d.IsVisible()){var u=d.GetUid(),h=d.GetFixedHeight();h?c+=r[u]=h:(o[u]=1,a++),l++}var p=0;0<a?p=Math.floor((i-c)/a):1==l&&(o=r,p=i);for(_=0,d=null;d=s[_++];)if(d.IsVisible()){var f=o[u=d.GetUid()]?p:r[u],m=d.SetPosition(0,n,e,f);m&&(n+=m.h,i-=m.h)}}function d(t,e,i,s){n.call(this,"l",t,e),n.call(this,"r",i,s)}return{Destructor:function(){this.hdl_id_=null,this.skin_=null,this.dim_=null,this.v_=null,this.w_=null,this.h_=null;for(var t=this.m_,e=0,i=t.l.length;e<i;e++)t.l[e].Destructor(),t.l[e]=null;for(e=0,i=t.r.length;e<i;e++)t.r[e].Destructor(),t.r[e]=null;this.m_=null,this.mt_=null,this.splitter_.hdl&&this.splitter_.hdl.Destructor(),this.splitter_=null},Resize:function(){if(arguments[0])this.dim_=arguments[0];else if(!this.dim_)return;var t=this.hdl_id_+"#content#",e=$(t+"left"),i=$(t+"right");if(e&&i){var s=_.call(this),n=this.v_,o=this.splitter_.hdl;if(n.l&&n.r){var r=this.dim_,a=this.w_,l=this.h_;e.style.width=s.lw+"px",e.style.height=s.lh+"px",i.style.width=s.rw+"px",i.style.height=s.rh+"px",o&&(o.SetPosition({x:s.lw+a.l,y:0,h:r.h-l.s}),o.SetVisible(!0))}else e.style.width=s.lw+"px",e.style.height=s.lh+"px",i.style.width=s.rw+"px",i.style.height=s.rh+"px",o&&o.SetVisible(!1);if(arguments[1]){var c=t.split("#")[0];MANAGER.handler.Get(c).GetContentInfo().rtl?d.call(this,0,0,s.rw,s.rh):d.call(this,s.lw,s.lh,0,0)}else d.call(this,s.lw,s.lh,s.rw,s.rh)}},Create:function(t){var e=this.hdl_id_+"#content",i=this.skin_,s=this.w_,n=this.h_,o=this.tabindex_,r=MANAGER.handler.Get(this.hdl_id_),a=r.GetContentInfo().rtl,l=$$("div");l.id=e,WCT.skin.ApplyTextFormats(l,i),l.style.position="absolute",l.style.overflow="hidden";var c=r.Trans("CONTENT"),_=r.Trans("PANEL"),d=$$("div");d.id=e+"#left",d.tabIndex=o,d.className=a?"region-content":"region-sidebar",d.setAttribute("role","region"),d.setAttribute("aria-label",a?c:_),d.style.position="absolute",d.style.left="0",d.style.top="0",l.appendChild(d);var u=$$("div");if(u.id=e+"#right",u.tabIndex=o,u.className=a?"region-sidebar":"region-content",u.setAttribute("role","region"),u.setAttribute("aria-label",a?_:c),u.style.backgroundColor="transparent",u.style.position="absolute",u.style.right="0",u.style.top="0",l.appendChild(u),i.frames){WCT.skin.ApplyTextFormats(d,i.frames),WCT.skin.ApplyTextFormats(u,i.frames),WCT.skin.ApplyBorder(d,i.frames),WCT.skin.ApplyBorder(u,i.frames);var h=WCT.skin.GetBorderWidth(i.frames),p=WCT.skin.GetBorderHeight(i.frames);s.l=h,s.r=h,n.l=p,n.r=p}var f=$$("div");f.style.overflow="hidden",f.style.textOverflow="ellipsis",d.appendChild(f);var m=$$("div");if(m.style.overflow="hidden",m.style.textOverflow="ellipsis",u.appendChild(m),i.headers){WCT.skin.ApplyPosition(f,i.headers),WCT.skin.ApplyPosition(m,i.headers),WCT.skin.ApplyTextFormats(f,i.headers),WCT.skin.ApplyTextFormats(m,i.headers),WCT.skin.ApplyBorder(f,i.headers),WCT.skin.ApplyBorder(m,i.headers),f.style.position="static",m.style.position="static";p=WCT.skin.GetBorderHeight(i.headers);n.lh=(i.headers.h||0)+p,n.rh=n.lh}if(i.splitter){var b=new WCT.Splitter.Vert(e+"#splitter",null,null,{callback_f:v,callback_s:this},{title:r.Trans("PANEL_TOGGLE"),cover_z:5},i.splitter);b.Create(l),this.splitter_.hdl=b,s.s=(i.splitter.w||0)+WCT.skin.GetBorderWidth(i.splitter),n.s=WCT.skin.GetBorderHeight(i.splitter)}return t.firstChild?t.insertBefore(l,t.firstChild):t.appendChild(l),l},AddModule:function(t,e,i){var s=this.hdl_id_,n=$(s+"#content#"+t);if(n&&i){var o=new HANDLER.library["Module"+e](s,i,t,arguments[3]);if(o){var r="left"==t?"l":"r";o.Create(n),this.m_[r].push(o);var a=o.GetUid();return this.mt_[a]=e,a}return null}},GetModuleType:function(t){var e=this.m_;for(var i in{l:1,r:1})for(var s=0,n=null;n=e[i][s++];)if(n.GetType()===t)return n},GetModule:function(t){var e=this.m_;for(var i in{l:1,r:1})for(var s=0,n=null;n=e[i][s++];)if(n.GetUid()==t)return n;return null},GetFramePos:function(t){var e=t.charAt(0);if(!this.v_[e])return null;var i=$(this.hdl_id_+"#content#"+t),s=WCT.dom.GetPosition(i),n=_.call(this);return{x:s.left,y:s.top,w:n[e+"w"],h:n[e+"h"]}},CollapseLeft:function(){this.split_last_=null,o.call(this)},SetFrameVisibility:function(t,e){var i="left"==t?"l":"r",s=this.v_;if(s[i]!=e){s[i]=e;var n=this.hdl_id_+"#content#",o=$(n+t);o&&(o.style.display=e?"block":"none");var r=$(n+"splitter");r&&(r.style.display=s.l&&s.r?"block":"none"),this.Resize()}},AnimateFrames:function(t,e){var i=this.v_;if(t==e||i.l==i.r)return this.SetFrameVisibility("left",t),void this.SetFrameVisibility("right",e);if(i.l!=t||i.r!=e){var s=this.hdl_id_+"#content#",n=$(s+"left"),o=$(s+"right");if(n&&o){var r=e?-n.offsetWidth:o.offsetWidth;this.ani_d_=r,e?(o.style.left=-r+"px",o.style.display="block"):o.style.left="0px",o.style.right="",o.style.display="block",n.style.display="block",WCT.SetTimeout(this.animate_,1,this)}}},animate_:function(){var t=$(this.hdl_id_+"#content#right");t&&(WCT.dom.CssTransition(t,"transform","300ms","linear","0s",HANDLER.library.Layout.AnimationEnd),WCT.dom.CssTransform(t,"translate3d",this.ani_d_,0,0))}}}(),HANDLER.library.Search=function(){function u(t,e){var i=t+"!"+e,s=this.loaded;s[i]||(s[i]={}),s[i].etxt||(s[i].etxt=1,DATA.GetA(i+":entity.txt",n,this)),this.settings.slides&&"slide"==t&&!s[i].sjs&&(s[i].sjs=1,DATA.GetA(i+":slide.js",o,this))}function n(t){if(t&&HANDLER.library.Search.STORE[this.uid]){r.call(this,t);var e=HANDLER.library.GetAutostartItem(t);if(e&&!e.indexOf("slide!")&&e.indexOf(":")<0&&(this.autostart[e]||(this.autostart[e]=[]),this.autostart[e].push(t)),t.assets)for(var i=0,s=null;s=t.assets[i++];)"Ref"==s.type?u.call(this,s.tclass,s.uid):r.call(this,s,t)}}function o(t,e){var i=t&&t.controls||null;if(i){if(i.page&&i.page.template){var s=DATA.GetS(i.page.template+":slide.js");if(s=s&&s.controls?WCT.DeepCopy(s.controls):null)for(var n in i)for(var o in s[n]||(s[n]={}),i[n])s[n][o]=i[n][o];i=s}var r=e.split(":")[0];r=DATA.GetS(r+":entity.txt"),function c(t,e){var i=this.search,s=this.lsearch,n=s.length;if(0===n)return;for(var o in e){var r=e[o].text;if(r){if(WCT.HasHtmlString(r,i))return void _.call(this,t);for(var a=!0,l=n;0<=l;l--)if(!WCT.HasHtmlString(r,s[l])){a=!1;break}if(a)return void _.call(this,t)}}}.call(this,r,i)}}function r(t){if(HANDLER.library.Search.STORE[this.uid]&&"da"!==t.tclass){var e=this.settings,i=this.search,s=this.lsearch,n=s.length;for(var o in e)if(e[o]&&"string"==typeof t[o]){var r=t[o].toLowerCase();if(0<=r.indexOf(i))return void _.call(this,t,arguments[1]);for(var a=!0,l=n;0<=l;l--)if(r.indexOf(s[l])<0){a=!1;break}if(a)return void _.call(this,t,arguments[1])}}}function _(t){var e=arguments[1],i="Ref"==t.type||t.type==undefined?1:e?2:0;if(i){var s=1==i?t.tclass+"!"+t.uid:e.tclass+"!"+e.uid,n=this.autostart;if(1==i&&n[s]){n=n[s];for(var o=0,r=null;r=n[o++];)_.call(this,r)}else{var a=this.reported;a[s]||(a[s]=1,this.on_found.call(this.scope,1==i?t:e))}}}return{STORE:{},Cleanup:function(){for(var t in this.STORE)this.Stop(t);this.STORE={}},Start:function(t,e,i,s,n,o,r,a){var l=WCT.uid.Generate(8,"HLS_SRCH_"),c=t.toLowerCase(),_={uid:l,search:c,lsearch:c.split(" "),settings:s,on_found:n,setSearchInfo:o,scope:r,loaded:{},reported:{},autostart:{},queue:[]};return this.STORE[l]=_,TRACKING.backend.collaborator.isHana()?function d(t,e,i){var s=DATA.context.ToAbsPath(t+"!"+e)+"/.library_search?",n=this.settings;s+=JSON.stringify({search:WCT.GetEncodedSearchString(this.search),scope:function(){var t=[];for(var e in n)n.hasOwnProperty(e)&&n[e]&&t.push(e);return t}()});var o=DATA.GetS(s);if(o=o&&o.response){if("collaborator"===DATA.GetConfig().tracking_backend){var r=t+"!"+e,a=i.selection;TRACKING.backend.collaborator.prototype.TrackRecord({verb:{id:"search"},context:{id:r},object:{id:a,objectType:"library:search",language:i.language,search:WCT.GetEncodedSearchString(this.search),results:o.entities&&o.entities.length||0}})}var l=o.entities;o.search_tokens&&this.setSearchInfo.call(this.scope,o.search_tokens);for(var c=0,_=null;_=l[c++];)"da"!==_.tclass&&this.on_found.call(this.scope,_)}}.call(_,e,i,a):u.call(_,e,i),l},Stop:function(t){var e=this.STORE[t];e&&(e.lsearch=[],e.settings=null,e.on_found=null,e.setSearchInfo=null,e.scope=null,e.loaded=null,e.reported=null,e.autostart=null,e.queue=null,delete this.STORE[t])}}}(),HANDLER.library.Favorites={Add:function(t){var e=WCT.store.KEYS.lib_favorites,i=WCT.store.Get(e),s=t.tclass+"!"+t.uid;i?(i=(i=i.replace(/#+/g,"#").replace(/^#/,"")).split("#")).indexOf(s)<0&&(i.push(s),WCT.store.Set(e,i.join("#"))):WCT.store.Set(e,s)},Remove:function(t){var e=WCT.store.KEYS.lib_favorites,i=WCT.store.Get(e),s=t.tclass+"!"+t.uid;if(i){var n=(i=(i=i.replace(/#+/g,"#").replace(/^#/,"")).split("#")).indexOf(s);0<=n&&(i.splice(n,1),WCT.store.Set(e,i.join("#")))}},Is:function(t){var e=t.tclass+"!"+t.uid,i=WCT.store.Get(WCT.store.KEYS.lib_favorites);return 0<=(i=i?i.split("#"):[]).indexOf(e)},Show:function(t,e){for(var i=WCT.store.KEYS.lib_favorites,s=(WCT.store.Get(i)||"").split("#"),n=[],o=[],r=0,a=null;a=s[r++];){var l=DATA.GetS(a+":entity.txt");l&&(o.push(l),n.push(a))}for(n.length?WCT.store.Set(i,n.join("#")):(WCT.store.Remove(i),t.Select(null)),o.sort(function(t,e){var i=t.caption.toLowerCase(),s=e.caption.toLowerCase();return i<s?-1:s<i?1:0}),e.Clean();o[0];)e.Add(o.shift())},Configure:function(t,e){var i=HANDLER.library.LIST_MODES,s=t.GetListMode();if(e)s==i.favorites?(e.SetVisible(!0),this.Show(t,e)):(e.SetVisible(!1),e.Clean());else if(s==i.favorites)return!1;return!0}},HANDLER.library.Recent={Add:function(t){var e=WCT.store.KEYS.lib_recent,i=WCT.store.Get(e),s=t.tclass+"!"+t.uid;if(i){var n=(i=(i=i.replace(/#+/g,"#").replace(/^#/,"")).split("#")).indexOf(s);0<=n&&i.splice(n,1),i.push(s),WCT.store.Set(e,i.join("#"))}else WCT.store.Set(e,s)},Show:function(t,e){var i=WCT.store.KEYS.lib_recent,s=(WCT.store.Get(i)||"").split("#");e.Clean();for(var n=[],o=s.length-1,r=null;r=s[o--];){var a=DATA.GetS(r+":entity.txt");a&&(e.Add(a),n.unshift(r))}n.length?WCT.store.Set(i,n.join("#")):(WCT.store.Remove(i),t.Select(null))},Configure:function(t,e){var i=HANDLER.library.LIST_MODES,s=t.GetListMode();if(e)s==i.recent?(e.SetVisible(!0),this.Show(t,e)):(e.SetVisible(!1),e.Clean());else if(s==i.recent)return!1;return!0}},HANDLER.library.Context=function(t,e,i,s){this.hdl_=t,this.mid_=e,this.sid_=i,this.use_my_=s,this.scan_={},this.loaded_=!1,this.show_=!1,this.lc_=0,this.roles_=new WCT.map(null,i),this.roles_.Set("no_roles_",!this.roles_.InStore()),this.init_()},HANDLER.library.Context.Configure=function(t,e){var i=HANDLER.library.LIST_MODES,s=t.GetListMode();if(e)s==i.context?(e.SetVisible(!0),t.GetContextHelp().Show()):(e.SetVisible(!1),e.Clean());else if(s==i.context)return!1;return!0},HANDLER.library.Context.prototype=function(){function _(t){if(t){for(var e=this.roles_,i=t.roles?t.roles.split(","):[],s=e.InStore(),n=i.length-1;0<=n;n--){var o=i[n].trim();o&&!e.HasKey(o)&&e.Set(o,!s)}var r=t.context_id||t.context_info;if(r){var a=r.toLowerCase().split(",").toMap({delimiter:"=",multi_map_delimiter:",",trim_keys:!0,trim_values:!0});i=i.toMap({fallback_value:!0,trim_keys:!0}),this.scan_[t.tclass+"!"+t.uid]={k:a,r:i}}if(t.assets){n=0;for(var l=null;l=t.assets[n++];)if("Ref"==l.type){var c=l.tclass+"!"+l.uid;this.scan_[c]||(this.lc_++,DATA.GetA(c+":entity.txt",_,this))}}this.lc_--,this.lc_||(this.loaded_=!0),this.loaded_&&this.show_&&this.Show()}else!this.lc_&&this.show_&&this.Show()}return{Destructor:function(){this.hdl_=null,this.scan_=null,this.roles_&&(this.roles_.Destructor(),this.roles_=null)},Show:function(){var t=this.hdl_,e=t.GetModule(this.mid_);if(e&&t.GetListMode()==HANDLER.library.LIST_MODES.context&&(this.show_=!0,this.loaded_)){for(var i=[],s=t.GetConfig("ctx"),n=function b(t){var e;this.use_my_?e=this.roles_.Get():((f=this.roles_.Copy()).Set(null,!0),e=f.Get(),f.Destructor());var i={};for(var s in e)e[s]&&(i[s]=!0);e=i;var n=0,o=this.scan_,r={};for(var s in o){var a=o[s],l=!1,c=0;for(var _ in a.r)if(c++,e[_]){l=!0;break}if(l||!c&&e.no_roles_)for(var d in t){var u=a.k[d];if(u)for(var h=(u=u.split(",")).length-1,p=t[d];0<=h;h--){var f,m="*"==(f=u[h]).charAt(f.length-1);f=f.replace(/\*/g,""),f=new RegExp("^"+f+(m?".*":"$")),p.search(f)||(r[s]||(r[s]=0),++r[s]>n&&(n=r[s]))}}}for(var s in e=[],r)r[s]==n&&e.push(s);return e}.call(this,s);n&&n[0];){var o=DATA.GetS(n.shift()+":entity.txt");o&&i.push(o)}for(i.sort(function(t,e){var i=t.caption.toLowerCase(),s=e.caption.toLowerCase();return i<s?-1:s<i?1:0}),t.Select(null),e.Clean();i[0];)e.Add(i.shift())}},UseMyRoles:function(t){this.use_my_!=t&&(this.use_my_=t,this.Show())},GetRoles:function(){return this.roles_.Get()},UpdateRole:function(t,e){var i=this.roles_;i.HasKey(t)&&i.Get(t)!=e&&(i.Set(t,e),i.ToStore(),this.Show())},init_:function(){this.roles_.InStore()&&this.roles_.FromStore(!0),this.lc_++;var t=this.hdl_.GetContentInfo();DATA.GetA(t.tclass+"!"+t.uid+":entity.txt",_,this)}}}(),HANDLER.library.Glossary=function(t,e){this.hdl_=t,this.mid_=e,this.tid_=null,this.tmr_=null},HANDLER.library.Glossary.Configure=function(t,e){var i=HANDLER.library.LIST_MODES,s=t.GetListMode();if(e)s==i.glossary?(t.Select(null),e.SetVisible(!0),e.Reselect()):e.IsVisible()&&(t.Select(null),e.SetVisible(!1));else if(s==i.glossary)return!1;return!0},HANDLER.library.Glossary.GetRootLanguage=function(t){var e=t.GetContentInfo(),i=DATA.GetS(e.tclass+"!"+e.uid+":entity.txt"),s=i&&i.language||null;return"mul"==s?null:s},HANDLER.library.Glossary.prototype={Destructor:function(){this.Cancel(),this.hdl_=null},Show:function(t){var e=arguments[1];if(e){if(e!=this.tid_)return}else e=WCT.uid.Generate(),this.tid_=e;this.Cancel();var i=this.hdl_,s=i.GetModule(this.mid_),n=i.GetListMode();if(s&&n==HANDLER.library.LIST_MODES.glossary){for(var o=i.GetConfig("lib_glossary_rootlang")?HANDLER.library.Glossary.GetRootLanguage(i):null,r=null;!r&&t.length;){var a=t[0];(r=a.lst[a.idx])?(r=DATA.GetS(r.tclass+"!"+r.uid+":entity.txt"))&&(null==o||"mul"==r.language||r.language==o)||(r=null,a.idx++):t.shift()}if(r){if(t[0].idx++,"group"==r.tclass)return t.unshift({lst:r.assets||[],idx:0}),void(this.tmr_=WCT.SetTimeout(this.Show,5,this,[t,e]));if("cdoc"==r.tclass&&"glossary_entry"==r.doc_type){var l='<h3 class="glossary_caption">'+(r.caption||"")+"</h3>",c='<div class="glossary_shortdesc">'+(r.shortdesc||"")+"</div>",_='<div class="glossary_description">'+(r.description||"")+"</div>";s.ExtendRawDescription({tclass:r.tclass,uid:r.uid,description:l+c+_+'<div style="border-bottom:1px solid #333333;font-size:1px;margin:15px 0"></div>'})}this.tmr_=WCT.SetTimeout(this.Show,5,this,[t,e])}}},Cancel:function(){this.tmr_&&(WCT.ClearTimeout(this.tmr_),this.tmr_=null)}},HANDLER.library.SlideControl=function(t,e,i,s){this.hdl_id_=t,this.sub_id_=e,this.shl_id_=i,this.skin_=s,this.id_=t+"#"+e,this.mid_=null,this.tid_=null,this.set_pos_=null,this.data_=null,this.rtl_=!1,this.btns_=[],this.bwidths_={},this.v_={space:!0,content:!0}},HANDLER.library.SlideControl.prototype={Destructor:function(){var t=MANAGER.handler.Get(this.hdl_id_),e=t?t.GetSlideCtx(this.shl_id_):null;e&&e.CleanupTriggers(this.id_),this.skin_=null,this.set_pos_=null,this.data_=null,this.btns_=null,this.bwidths_=null},Create:function(t){this.data_=t;var e=MANAGER.handler.Get(this.hdl_id_);return this.rtl_=e.GetContentInfo().selection_rtl,null},Update:function(t){this.data_=t;var e=MANAGER.handler.Get(this.hdl_id_),i=arguments[1]||{};if(i.rtl){var s=e.GetContentInfo().selection_rtl;s!=this.rtl_&&(this.rtl_=s,this.mid_&&this.update_sr_control_(this.mid_,{direction:this.rtl_?"rtl":"ltr"}),this.tid_&&this.update_sr_control_(this.tid_,{direction:this.rtl_?"rtl":"ltr"}))}if(i.trigger){var n=e.GetSlideCtx(this.shl_id_);n&&n.CleanupTriggers(this.id_)}},SetPosition:function(t,e,i,s){var n=MANAGER.handler.Get(this.hdl_id_),o=n&&n.GetSlideHandler(this.shl_id_)||null;if(!o)return 0;var r=this.GetFixedHeight()||s,a=this.mid_;if(a){var l=this.update_sr_control_(a,{x:t,y:e,w:i,h:r});l&&null!=l.x&&(t=l.x)}var c=this.get_outer_spacing_(),_=this.get_border_(),d={shl:o,os:c,bo:_,x:this.rtl_?t+c.r:t+c.l,y:e+c.t+_.t,w:i-c.w,h:s-c.h-_.h,fh:r-c.h-_.h};this.set_pos_=d;var u=this.tid_;return u&&this.update_sr_control_(u,{x:d.x,y:d.y,w:d.w,h:d.fh}),r},GetFixedHeight:function(){var t=this.skin_;if(!t.h)return 0;var e=t.outer_spacing_t||0,i=t.outer_spacing_b||0,s=t.border_top,n=t.border_bottom;return s=s?Number(s.split("px")[0]):0,n=n?Number(n.split("px")[0]):0,isNaN(s)&&(s=0),isNaN(n)&&(n=0),t.h+e+i+s+n},OnSlidePropChange:function(t,e,i){},SetVisibility:function(t){this.set_visibility_(t,"content",!0)},IsVisible:function(){return this.v_.content},get_border_:function(){var t=this.skin_,e={l:t.border_left,r:t.border_right,t:t.border_top,b:t.border_bottom},i={l:null,r:null,t:null,b:null};for(var s in e){var n=e[s];"string"==typeof n?(i[s]=n.split(" ")[2]||null,n=Number(n.split("px")[0]),isNaN(n)&&(n=0)):"number"!=typeof n&&(n=0),e[s]=n}return e.w=e.l+e.r,e.h=e.t+e.b,e.colors=i,e.c=i.l||i.r||i.t||i.b,e},get_outer_spacing_:function(){var t=this.skin_,e={l:t.outer_spacing_l||0,r:t.outer_spacing_r||0,t:t.outer_spacing_t||0,b:t.outer_spacing_b||0};return e.w=e.l+e.r,e.h=e.t+e.b,e},get_padding_:function(){var t=arguments[0]||this.skin_,e=t.padding||0,i={l:null!=t.padding_left?t.padding_left:e,r:null!=t.padding_right?t.padding_right:e,t:null!=t.padding_top?t.padding_top:e,b:null!=t.padding_bottom?t.padding_bottom:e};return i.w=i.l+i.r,i.h=i.t+i.b,i},generate_background_:function(){var t=arguments[0]||this.id_,e=this.get_border_();return{id:this.mid_=t,type:"text",padding:0,border:0,text:"",background_color:this.skin_.background_color||"#FFFFFF",border_color:e.c||"transparent",border_t:e.t,border_b:e.b,hide_scrollbars:!1,x:0,y:0,w:100,h:100,z:1}},set_visibility_:function(t){var e=arguments[1]||"space";if(this.v_[e]!=t||arguments[2]){this.v_[e]=t;var i=MANAGER.handler.Get(this.hdl_id_);if(i&&i.GetSlideHandler(this.shl_id_)||null){var s=!t;if(this.mid_&&this.update_sr_control_(this.mid_,{hidden:s}),this.tid_&&this.update_sr_control_(this.tid_,{hidden:s}),this.fid_&&this.update_sr_control_(this.fid_,{hidden:s}),this.mediaId_){var n=this.mediaId_;this.remove_sr_control_(n),this.remove_sr_control_(n+"#stop"),this.remove_sr_control_(n+"#play"),this.mediaId_=null}for(var o=this.btns_,r=0,a=null;a=o[r++];)this.update_sr_control_(a,{hidden:s})}}},update_sr_control_:function(t,e){var i=MANAGER.handler.Get(this.hdl_id_),s=i&&i.GetSlideHandler(this.shl_id_)||null;if(!s)return null;var n=s.GetControl(t);if(!n)return null;var o={},r=0;for(var a in e)"object"!=typeof e[a]&&"object"!=typeof n[a]&&e[a]==n[a]||(o[a]=e[a],r++);if(1==r)for(var a in o)return s.UpdateControl(t,a,o[a]);else if(1<r)return s.UpdateControl(t,o);return null},add_sr_control_:function(t){var e=MANAGER.handler.Get(this.hdl_id_),i=e&&e.GetSlideHandler(this.shl_id_)||null;i&&i.AddControl(t)},remove_sr_control_:function(t){var e=MANAGER.handler.Get(this.hdl_id_),i=e&&e.GetSlideHandler(this.shl_id_)||null;i&&i.RemoveControl(t)}},HANDLER.library.SlideDescription=function(t,e,i,s){HANDLER.library.SlideControl.apply(this,arguments),this.id_+="#description",this.tid_=this.id_+"#text",this.txt_="",this.force_=!1},HANDLER.library.SlideDescription.prototype=new HANDLER.library.SlideControl,WCT.ExtendObject(HANDLER.library.SlideDescription.prototype,{Create:function(t){var e=this.skin_;if(!e)return null;HANDLER.library.SlideControl.prototype.Create.call(this,t),this.force_=arguments[1]||!1;var i={},s=this.generate_text_(),n=""==s,o=(MANAGER.handler.Get(this.hdl_id_),this.generate_background_());o.hidden=n,i[o.id]=o;var r=this.tid_,a={id:r,type:"text",text:s,padding:0,border:0,background_color:e.background_color||"#FFFFFF",direction:this.rtl_?"rtl":"ltr",hidden:n,hide_scrollbars:!1,align:"start",valign:"top",shadow_show:!1,opacity:100,font_family:"Arial",tabindex:0,role:"region",x:1,y:1,w:500,h:300,z:2};return i[r]=a,this.v_.content=!n,"bold"==e.font_weight&&(a.bold=1),e.font_size&&(a.font_size=e.font_size),e.text_color&&(a.text_color=e.text_color),e.line_height&&(a.line_height=e.line_height),i},Update:function(t){HANDLER.library.SlideControl.prototype.Update.call(this,t,{rtl:!0});var e=this.generate_text_(t);this.update_sr_control_(this.tid_,{text:e}),this.set_visibility_(""!=e,"content")},Extend:function(t){var e=MANAGER.handler.Get(this.hdl_id_);if(e){var i=e.GetContext();i.Set(t.tclass,t.uid),i.SetScope(t.tclass);var s=this.txt_+i.ResolveHtmlString(t.description||""),n=""!=(this.txt_=s);if(this.v_.content!=n){this.set_visibility_(""!=s,"content");var o=e.GetModule(this.sub_id_);o&&o.ReAlignControls()}this.update_sr_control_(this.tid_,{text:s})}},SetPosition:function(t,e,i,s){var n=HANDLER.library.SlideControl.prototype.SetPosition.apply(this,arguments);if(!n)return 0;var o=this.get_outer_spacing_();return this.set_visibility_(s>=o.h+20),this.v_.space?n:0},generate_text_:function(){var t="",e=this.data_,i=MANAGER.handler.Get(this.hdl_id_),s="string"==typeof e.shortdesc&&e.shortdesc&&i.GetConfig("lib_shortdesc"),n=this.force_||"string"==typeof e.description&&e.description&&i.GetConfig("lib_desc");if(s||n){var o=this.skin_;if(s&&(t+=e.shortdesc,n)){var r=o.short_desc_splitter||{};t+=['<div style="clear: both;"></div><div style="',"width:100%;","height:1px;","background-color:",r.color||"#CCCCCC",";","margin-top:",r.outer_spacing_t||0,"px;","margin-bottom:",r.outer_spacing_b||0,"px;",'"></div>'].join("")}n&&(t+=e.description||"");var a=i.GetContext();a.Set(e.tclass,e.uid),a.SetScope(e.tclass);var l={ci_:i.GetContentInfo(),GetS:function(t){return DATA.GetS(t)},GetEntityList:function(){for(var t=["group","book","slide","cdoc","project","da","media"],e={},i=this.ci_,s=0,n=null;n=t[s++];)e[n]=i["selection_"+n];return e}},c={},_={tclass:!0,assets:!0,breadcrumb_trail:!0,clone_master:!0,clone_src:!0},d=e.tclass;for(var u in e)_[u]||(c[d+":."+u]=e[u]);if(t=WCT.Placeholder.Resolve(t,a,l,{param_list:c}),t=a.ResolveHtmlString(t),l.ci_=null,l.help_=null,l.GetS=null,o.iframe_padding_right)t='<div style="padding-'+(this.rtl_?"left:":"right:")+o.iframe_padding_right+'px;">'+t+"</div>"}return this.txt_=t}}),HANDLER.library.SlideButtons=function(t,e,i,s){HANDLER.library.SlideControl.apply(this,arguments),this.id_+="#buttons",this.ctl_h_=0},HANDLER.library.SlideButtons.prototype=new HANDLER.library.SlideControl,HANDLER.library.SlideButtons.GenerateCustomStyle=function(t){for(var e={},i=["bg","bg_h","bg_a"],s=0,n=null;n=i[s++];){var o=WCT.DeepCopy(t[n]);if(o){var r=o.m,a=o.l,l=o.r;if(r){r.id||(r.id=t.src),r.repeat||(r.repeat="x");var c={body:{image:r},w_w:0,e_w:0,n_h:0,s_h:0};t.button_h&&(c.h=t.button_h),e[n]={frame:c,content:{}},a&&(a.id||(a.id=t.src),e[n].frame.w={image:a},e[n].frame.w_w=a.w||0),l&&(l.id||(l.id=t.src),e[n].frame.e={image:l},e[n].frame.e_w=l.w||0)}}}return t.image&&(e.image=WCT.DeepCopy(t.image),e.image.id||(e.image.id=t.src),null==e.image.w&&(e.image.w=t.img_w||0),null==e.image.h&&(e.image.h=t.img_h||0)),e},WCT.ExtendObject(HANDLER.library.SlideButtons.prototype,function(){function o(t,e){var i=t.caption,s=e.caption;return s!=i&&s.isPrefix(i)?s.substr(i.length).trim():s}function r(t,e){return t+="_"+e,MANAGER.handler.Get(this.hdl_id_).GetSlideCtx(this.shl_id_).RegisterTrigger(this.uid_,t,i,this),"page.trainer#"+t}function a(t){var e=WCT.uid.Generate(20,"TR_"),i=[];if("book"==t.tclass)i.push({icon:WCT.Tree.GetIconImage(t,"btn"),icon_over:WCT.Tree.GetIconImage(t,"btn","h"),icon_down:WCT.Tree.GetIconImage(t,"btn","a"),text:o(t,t),href:r.call(this,e,"book")});else if(t.assets)for(var s=0,n=null;n=t.assets[s];s++)n.type!=DATA.LESSON_TOUR_KEY||(BROWSER.IE6||BROWSER.METRO)&&"praxis"==n.mode||i.push({icon:WCT.Tree.GetIconImage(n,"btn"),icon_over:WCT.Tree.GetIconImage(n,"btn","h"),icon_down:WCT.Tree.GetIconImage(n,"btn","a"),text:o(t,n),href:r.call(this,e,n.mode)});return i}function i(t){var e=MANAGER.handler.Get(this.hdl_id_);if(e){var i=t.split("_").top();i="book"==i?"book!"+this.data_.uid:"project!"+this.data_.uid+":"+i,e.Execute(i)}}function l(t){var e=function l(){var t=WCT.DeepCopy(this.skin_.button);return t.bg={m:t.image,r:WCT.DeepCopy(t.image)},t.bg_h={m:t.image_h,r:WCT.DeepCopy(t.image_h)},t.bg_a={m:t.image_a,r:WCT.DeepCopy(t.image_a)},t.bg.r&&(t.bg.r.w=8),t.bg_h.r&&(t.bg_h.r.w=8),t.bg_a.r&&(t.bg_a.r.w=8),delete t.image_a,delete t.image_h,t.icons.padding_r=4,t.button_h=t.h,t}.call(this),i=function c(t){for(var e=HANDLER.library.SlideButtons.GenerateCustomStyle(t),i=["","_h","_a"],s=0,n=i.length;s<n;s++){var o=i[s],r="bg"+o;if(e[r]){e[r].image=t.icons;var a=t["text_color"+o]||t.text_color;a&&e[r].frame&&e[r].frame.body&&(e[r].frame.body.text_color=a)}}return e}.call(this,e),s=this.generate_background_(),n=e.border_left||e.border_right;if(n){var o=Number((e.border_left||"").split("px")[0]),r=Number((e.border_right||"").split("px")[0]);s.button_border_style=n.split(" ")[1],s.button_border_color="#"+n.split("#")[1],s.button_border_l=isNaN(o)?0:o,s.button_border_r=isNaN(r)?0:r}var a=this.skin_;return WCT.ExtendObject(s,{type:"buttonarea",padding_t:a.outer_spacing_t||0,padding_r:a.outer_spacing_r||0,padding_b:a.outer_spacing_b||0,padding_l:a.outer_spacing_l||0,button_padding_r:e.outer_spacing_r||0,button_padding_b:e.outer_spacing_b||0,buttons:JSON.stringify(t),button_style:i.bg,button_style_over:i.bg_h,button_style_down:i.bg_a,box_shadow:e.box_shadow,font_size:e.font_size||12,font_family:e.font_family||"arial, sans-serif",direction:this.rtl_?"rtl":"ltr",z:3}),delete s.text,s}return{Create:function(t){var e=this.skin_;if(!e||!e.button)return null;HANDLER.library.SlideControl.prototype.Create.call(this,t);var i=a.call(this,t),s=l.call(this,i),n=0<i.length;s.hidden=!n,this.v_.content=n;var o={};return o[s.id]=s,o},Update:function(t){HANDLER.library.SlideControl.prototype.Update.call(this,t,{rtl:!0,trigger:!0});var e=a.call(this,t);this.update_sr_control_(this.id_,{buttons:JSON.stringify(e)}),this.set_visibility_(0<e.length,"content")},SetPosition:function(t,e,i,s){var n=HANDLER.library.SlideControl.prototype.SetPosition.apply(this,arguments);return this.ctl_h_&&(n=this.ctl_h_),this.set_visibility_(n<=s),this.v_.space?n:0},OnSlidePropChange:function(t,e,i){if(i=Number(i),"h"==e&&!isNaN(i)&&this.ctl_h_!=i){this.ctl_h_=i;var s=MANAGER.handler.Get(this.hdl_id_),n=s&&s.GetModule(this.sub_id_)||null;n&&n.ReAlignControls()}}}}()),HANDLER.library.SlideAssets=function(t,e,i,s){HANDLER.library.SlideControl.apply(this,arguments),this.id_+="#assets",this.tid_=this.id_+"#text",this.txt_=""},HANDLER.library.SlideAssets.prototype=new HANDLER.library.SlideControl,WCT.ExtendObject(HANDLER.library.SlideAssets.prototype,function(){function _(){var t=this.data_,e=this.skin_;if(!t.assets)return null;for(var i=WCT.uid.Generate(20,"TR_"),s=MANAGER.handler.Get(this.hdl_id_).GetSlideCtx(this.shl_id_),n=this.id_,o=e.asset.icons||{},r=[],a=0,l=null;l=t.assets[a];a++)if("Ref"!=l.type&&l.type!=DATA.LESSON_TOUR_KEY&&l.fileName){var c={};r.push(c);var _=WCT.Tree.GetIconImage(l);_.id&&(c.icon={id:_.id,off_x:_.x,off_y:_.y,x:o.x||0,y:o.y||0,w:o.w||_.w||0,h:o.h||_.h||0}),c.text=WCT.CleanupHTMLString(l.caption||l.fileName);var d=i+"_"+a;s.RegisterTrigger(n,d,u,this),c.link="page.trainer#"+d}return r.length?JSON.stringify(r):null}function u(t){var e=Number(t.split("_").top()),i=this.data_,s=i&&i.assets&&i.assets[e]||null,n=MANAGER.handler.Get(this.hdl_id_);s&&n&&n.Execute(i.tclass+"!"+i.uid+":"+s.fileName)}return{Create:function(t){var e=this.skin_&&this.skin_.asset||null;if(!e)return null;HANDLER.library.SlideControl.prototype.Create.call(this,t);var i=MANAGER.handler.Get(this.hdl_id_),s=e.icons||{},n=_.call(this),o=null==n,r=e.text_color||"#000000",a={id:this.tid_,type:"linklist",items:n,hidden:o,border:0,padding:0,item_padding:e.outer_spacing_b||0,text_color:r,text_color_over:e.text_color_h||r,text_color_down:e.text_color_a||r,line_height:e.h||12,font_size:e.font_size||12,direction:this.rtl_?"rtl":"ltr",underline:"underline"==e.text_decoration,white_space:"nowrap",tabindex:0,role:"region",arialabel:i.Trans("SLIDE_ATTACH"),valign:"top",x:(s.x||0)+(s.w||e.w||0)+3,y:0,w:100,h:e.h||12,z:2},l=this.generate_background_();l.hidden=o,this.v_.content=!o;var c={};return c[l.id]=l,c[a.id]=a,c},Update:function(t){HANDLER.library.SlideControl.prototype.Update.call(this,t,{rtl:!0,trigger:!0});var e=_.call(this);this.update_sr_control_(this.tid_,{items:e}),this.set_visibility_(null!=e,"content")},SetPosition:function(t,e,i,s){var n=HANDLER.library.SlideControl.prototype.SetPosition.apply(this,arguments);return this.set_visibility_(n<=s),this.v_.space?n:0}}}()),HANDLER.library.SlideBreadcrumbTrail=function(t,e,i,s){HANDLER.library.SlideControl.apply(this,arguments),this.id_+="#breadcrumb",this.tid_=this.id_+"#items",this.fid_=this.id_+"#fav",this.tabindex_=0,this.fav_=!1},HANDLER.library.SlideBreadcrumbTrail.prototype=new HANDLER.library.SlideControl,WCT.ExtendObject(HANDLER.library.SlideBreadcrumbTrail.prototype,function(){function c(t,e,i){var s=this.rtl_,n=this.skin_.item,o=n.border||"",r=Number(o.split("px")[0]),a=o.split(" ")[2]||"#CCCCCC",l=this.get_padding_(n);isNaN(r)&&(r=0);var c={dir:e?s?"c_left":"c_right":s?"b_left":"b_right",border:r,border_color:a,padding_l:s?l.r:l.l,padding_r:s?l.l:l.r,visual_over:0,visual_down:0,text:WCT.CleanupHTMLString(t),tabindex:this.tabindex_,h:n.h};return n.font_size&&(c.font_size=n.font_size),n.background_color&&(c.background_color=n.background_color),n.text_color&&(c.text_color=n.text_color),i?((n.background_color_h||n.text_color_h)&&(c.visual_over=1,c.background_color_over=n.background_color_h||n.background_color||"#ccc",c.text_color_over=n.text_color_h||n.text_color||"#000"),(n.background_color_a||n.text_color_a)&&(c.visual_down=1,c.background_color_down=n.background_color_a||n.background_color||"#ccc",c.text_color_down=n.text_color_a||n.text_color||"#000")):(n.background_color_d&&(c.background_color=n.background_color_d),n.text_color_d&&(c.text_color=n.text_color_d)),c}function _(){for(var t=this.id_,e=MANAGER.handler.Get(this.hdl_id_).GetSlideCtx(this.shl_id_),i=t.replace(/#/g,"-")+"-",s=this.data_,n=s.breadcrumb_trail||[],o=[],r=0,a=null;a=n[r];r++){var l=c.call(this,a.caption,!r,!0);e.RegisterTrigger(t,i+r,d,this),l.href="page.trainer#"+i+r,o.push(l)}return o.push(c.call(this,s.caption,!r,!1)),o}function d(t){var e=MANAGER.handler.Get(this.hdl_id_);if(e){var i=Number(t.split("-").top());if(!isNaN(i)){var s=this.data_,n=s&&s.breadcrumb_trail||null,o=n&&n[i]||null;o&&("book"===o.tclass?e.ListMode("content",o.uid):e.Execute(o.tclass+"!"+o.uid,!1))}}}function u(){var t=HANDLER.library.Favorites,e=this.data_,i=!t.Is(e);t[i?"Add":"Remove"](e);var s=this.skin_.favorite,n=s[i?"image_a":"image"];this.update_sr_control_(this.fid_,{image:{id:n.id,w:s.w,h:s.h},offset_left:-n.x||0,offset_top:-n.y||0})}return{Create:function(t){var e=this.skin_;if(!e||!e.item)return null;HANDLER.library.SlideControl.prototype.Create.call(this,t);var i=MANAGER.handler.Get(this.hdl_id_).GetContentInfo().rtl;this.rtl_=i;var s=_.call(this),n={id:this.tid_,type:"breadcrumb_trail",items:JSON.stringify(s),direction:i?"rtl":"ltr",spacing:e.item_spacing||0,x:0,y:0,w:100,h:e.h,z:2},o=this.generate_background_();o.h=e.h;var r=e.favorite&&e.favorite.image?function l(){var t=this.skin_.favorite,e=MANAGER.handler.Get(this.hdl_id_),i=e.GetSlideCtx(this.shl_id_),s=this.id_.replace(/#/g,"-")+"-fav";i.RegisterTrigger(this.id_,s,u,this);var n=HANDLER.library.Favorites.Is(this.data_);n=t[n?"image_a":"image"];var o={id:this.fid_,type:"sprite",border:0,image:{id:n.id,w:t.w,h:t.h},offset_left:-n.x||0,offset_top:-n.y||0,repeat_x:0,repeat_y:0,href:"trigger!page.trainer#"+s,tooltip:t.tooltip?e.Trans(t.tooltip):"",hidden:!1,shadow_show:!1,opacity:100,tabindex:this.tabindex_,x:0,y:0,w:t.w,h:t.h,z:2};return this.fav_=!0,o}.call(this):null,a={};return a[o.id]=o,a[n.id]=n,r&&(a[r.id]=r),a},Update:function(t){HANDLER.library.SlideControl.prototype.Update.call(this,t);var e=_.call(this);this.update_sr_control_(this.tid_,{items:JSON.stringify(e)});var i=this.skin_.favorite;if(i){var s=HANDLER.library.Favorites.Is(t);s=i[s?"image_a":"image"],this.update_sr_control_(this.fid_,{offset_left:-s.x||0,offset_top:-s.y||0,image:{id:s.id,w:i.w,h:i.h}})}},SetPosition:function(t,e,i,s){var n=HANDLER.library.SlideControl.prototype.SetPosition.apply(this,arguments);if(this.set_visibility_(n<=s),!this.v_.space)return 0;if(this.fav_){var o=this.skin_,r=o.favorite,a=this.set_pos_,l=this.rtl_,c=l?a.x+(r.outer_spacing_r||0):a.x+a.w-(r.outer_spacing_r||0)-r.w,_=e+(o.h-r.h>>1);this.update_sr_control_(this.fid_,{x:c,y:_});var d=l?a.x+r.w:a.x;this.update_sr_control_(this.tid_,{x:d,w:a.w-r.w})}return n}}}()),HANDLER.library.SlideCaption=function(t,e,i,s){HANDLER.library.SlideDescription.apply(this,arguments),this.id_=this.id_.replace(/description/,"caption"),this.tid_=this.id_+"#text"},HANDLER.library.SlideCaption.prototype=new HANDLER.library.SlideDescription,WCT.ExtendObject(HANDLER.library.SlideCaption.prototype,{Create:function(t){var e=HANDLER.library.SlideDescription.prototype.Create.call(this,t,!0),i=(MANAGER.handler.Get(this.hdl_id_),e&&e[this.tid_]);return i&&(i.hide_scrollbars=1,i.white_space="nowrap",i.text=WCT.CleanupHTMLString(i.text)),e},SetPosition:function(t,e,i,s){var n=HANDLER.library.SlideControl.prototype.SetPosition.apply(this,arguments);return this.set_visibility_(n<=s),this.v_.space?n:0},generate_text_:function(){var t=WCT.DeepCopy(this.data_);return t.description=WCT.CleanupHTMLString(t.caption),delete t.shortdesc,this.data_=t,HANDLER.library.SlideDescription.prototype.generate_text_.call(this)}}),HANDLER.library.SlideMedia=function(t,e,i,s){HANDLER.library.SlideControl.apply(this,arguments),this.id_+="#media",this.mediaId_=this.id_+"#element",this.force_=!1,this.type_=null},HANDLER.library.SlideMedia.prototype=new HANDLER.library.SlideControl,WCT.ExtendObject(HANDLER.library.SlideMedia.prototype,{Create:function xvb(t){HANDLER.library.SlideControl.prototype.Create.call(this,t),this.force_=arguments[1]||!1;var e={},i=this.generate_background_();e[i.id]=i;var s="media!"+t.uid+":"+t.original_stream,n=this._getControl(t,s);return n&&(e[n.id]=n,this.type_=n.type),this.v_.content=!0,e},Update:function yvb(t){HANDLER.library.SlideControl.prototype.Update.call(this,t),this.mediaId_||(this.mediaId_=t.uid+":"+t.original_stream);var e="media!"+t.uid+":"+t.original_stream,i=this.mediaId_;this.remove_sr_control_(i);var s=this._getControl(t,e);s&&this.add_sr_control_(s),this.type_=s&&s.type||"unknown"},SetPosition:function zvb(t,e,i,s,n){var o=MANAGER.handler.Get(this.hdl_id_),r=o&&o.GetSlideHandler(this.shl_id_)||null;if(!r)return 0;var a=this.GetFixedHeight()||s;if(n&&a&&(a=parseInt(a/1.25)),u=this.mid_){var l=this.update_sr_control_(u,{x:t,y:e,w:i,h:a});l&&null!=l.x&&(t=l.x)}var c=this.get_outer_spacing_(),_=this.get_border_(),d=this.tid_,u=this.mediaId_,h={shl:r,os:c,bo:_,x:this.rtl_?t+c.r:t+c.l,y:e+c.t+_.t,w:i-c.w,h:s-c.h-_.h,fh:a-c.h-_.h},p=(this.set_pos_=h).fh,f=h.y;return d&&u&&(f+=p/=2),d&&this.update_sr_control_(d,{x:h.x,y:h.y,w:h.w,h:p}),u&&this.update_sr_control_(u,{x:h.x,y:f,w:h.w,h:p}),a?(c=this.get_outer_spacing_(),this.set_visibility_(s>=c.h+20),this.v_.space?a:0):0},_getControl:function Avb(t,e){var i=this.skin_;if(!i)return null;var s=this.mediaId_,n={audio:"audio",video:"video",image:"image",doc:"text",pdf:"html",file:"text"}[t.sub_type];if(!n)return null;var o={id:s,type:n,name:"MediaObject",background_color:i.background_color||"#FFFFFF",border:0,padding:0,w:i.w||500,h:i.h||400,x:1,y:1,z:2,valign:"top"};switch(n){case"image":o.image={id:e,w:null,h:null},o.keep_aspect=1;break;case"video":o.src=e,o.loop=0,o.playonstart=0,o.showControls=1;break;case"html":o.src=e;break;case"text":var r=t.original_filename.split(/\\/);o.text="<p><a href=\"javascript:ctx.cfg_show('"+e+"',true, null)\">"+r[r.length-1]+"</a></p>";break;case"audio":o.src=e,o.loop=0,o.playonstart=0,o.soundchannel="Pagesound",o.showControls=1,o.showOnScreen=1;break;default:return null}return o}}),HANDLER.library.Module=function(t,e,i){this.hdl_id_=t,this.skin_=e,this.frame_id_=i,this.uid_=WCT.uid.Generate(8,"LM_"+(this.mod_type_?this.mod_type_+"_":"")),this.fixed_w_=null,this.fixed_h_=null,this.v_=!0},HANDLER.library.Module.prototype={Destructor:function(){this.skin_=null;var t=this.GetDom();t&&t.parentNode.removeChild(t),this.hdl_id_=null,this.uid_=null},GetUid:function(){return this.uid_},GetType:function(){return this.mod_type_},GetFixedWidth:function(){return this.fixed_w_},GetFixedHeight:function(){return this.fixed_h_},GetDom:function(){return $(this.hdl_id_+"#"+this.uid_)},CalcReservedWidth:function(){var t=this.skin_;return WCT.skin.GetBorderWidth(t)+(t.outer_spacing_l||0)+(t.outer_spacing_r||0)},CalcReservedHeight:function(){var t=this.skin_;return WCT.skin.GetBorderHeight(t)+(t.outer_spacing_t||0)+(t.outer_spacing_b||0)},SetPosition:function(t,e,i,s){var n=this.GetDom();if(!n||!this.v_)return null;var o={w:i,h:s,v:!0};n.style.left=t+"px",n.style.top=e+"px";var r=this.fixed_w_;r?i<(o.w=r)&&(r=i):(r=Math.max(0,i-this.CalcReservedWidth()),n.style.width=r+"px");var a=this.fixed_h_;return a?s<(o.h=a)&&(a=s):(a=Math.max(0,s-this.CalcReservedHeight()),n.style.height=a+"px"),r<=0||a<=0?(n.style.display="none",o.v=!1):n.style.display="block",o},SetVisible:function(t){if(t!=this.v_){this.v_=t;var e=this.GetDom();e&&(e.style.display=t?"block":"none")}},IsVisible:function(){return this.v_},Create:function(t){var e=this.skin_;e.w&&(this.fixed_w_=e.w+this.CalcReservedWidth()),e.h&&(this.fixed_h_=e.h+this.CalcReservedHeight());var i=$$("div");return i.id=this.hdl_id_+"#"+this.uid_,WCT.skin.ApplyTextFormats(i,e),WCT.skin.ApplyBorder(i,e),i.style.position="absolute",i.style.overflow="hidden",i.style.left="0",i.style.top="0",this.v_||(i.style.display="none"),e.w&&(i.style.width=e.w+"px"),e.h&&(i.style.height=e.h+"px"),e.outer_spacing_l&&(i.style.paddingLeft=e.outer_spacing_l+"px"),e.outer_spacing_r&&(i.style.paddingRight=e.outer_spacing_r+"px"),e.outer_spacing_t&&(i.style.paddingTop=e.outer_spacing_t+"px"),e.outer_spacing_b&&(i.style.paddingBottom=e.outer_spacing_b+"px"),t.appendChild(i),i}},HANDLER.library.ModuleFilter=function(){this.mod_type_="FILT",HANDLER.library.Module.apply(this,arguments),this.val_=null},HANDLER.library.ModuleFilter.prototype=new HANDLER.library.Module,HANDLER.library.ModuleFilter.STYLE={mt:3,mr:3,mb:3,ml:3,bw:1,br:0,pt:1,pr:3,pb:1,pl:1},WCT.ExtendObject(HANDLER.library.ModuleFilter.prototype,function(){function k(){var t=this.id.split("#"),e=MANAGER.handler.Get(t[0]),i=e&&e.GetModule(t[1]);if(i){var s=this[this.selectedIndex];id=s.id.split("#").top(),id=s?id:null,-1!=id&&"FLT_"==id.substr(0,4)||(id=null),id!=i.val_&&(i.val_=id,e.SetFilter(id))}}return{Destructor:function(){var t=$(this.hdl_id_+"#"+this.uid_+"#sel");t&&(t.onclick=null,t.onchange=null,t.onkeyup=null),HANDLER.library.Module.prototype.Destructor.call(this)},SetPosition:function(t,e,i,s){var n=HANDLER.library.Module.prototype.SetPosition.apply(this,arguments),o=$(this.hdl_id_+"#"+this.uid_+"#sel");if(o){function r(t,e){return void 0!==t?t:e}var a=HANDLER.library.ModuleFilter.STYLE,l=this.skin_,c=r(l.margin_t,a.mt),_=r(l.margin_l,a.ml),d=r(l.margin_r,a.mr),u=r(l.margin_b,a.mb),h=Math.min(Math.max(0,n.h+c-u-o.offsetHeight>>1),n.h);i=Math.max(0,n.w-_-d);o.style.top=h+"px",o.style.width=i+"px"}return n},Create:function(t){var e=this.hdl_id_,i=MANAGER.handler.Get(e),s=i.GetContentInfo().rtl,n=i.GetConfig("library");n=(n=n?DATA.GetS(n):null)&&n.categories;function o(t,e){return void 0!==t?t:e}var r=this.skin_,a=HANDLER.library.ModuleFilter.STYLE,l=e+"#"+this.uid_+"#sel",c=WCT.dom.CreateElementMSIE("select",null,l),_=o(r.padding_t,a.pt),d=o(r.padding_l,a.pl),u=o(r.padding_r,a.pr),h=o(r.padding_b,a.pb),p=o(r.margin_l,a.ml),f=o(r.input_border_w,a.bw),m=o(r.input_border_radius,a.br);c.id=l,c.size=1,c.style.position="absolute",c.style.left=p+"px",c.style.borderWidth=f+"px",s&&(c.style.direction="rtl"),!BROWSER.SAFARI&&m&&(c.style.borderRadius=m+"px"),c.style.padding=_+"px "+u+"px "+h+"px "+d+"px",r.input_font_size&&(c.style.fontSize=r.input_font_size+"px",c.style.lineHeight=r.input_font_size+"px"),r.input_border_color&&(c.style.borderColor=r.input_border_color),r.input_border_style&&(c.style.borderStyle=r.input_border_style),c.onclick=k,c.onchange=k,c.onkeyup=k;var b=$$("option"),v=i.Trans("LIB_NOFILTER");b.id=l+"#-1",b.value=v,b.innerHTML=v,c.appendChild(b);var g=[];for(var y in n)g.push({id:y,name:n[y].name.toLowerCase()});var C=g.length;if(C){g.sort(function(t,e){return t.name>e.name?1:t.name<e.name?-1:0});for(var T=0;T<C;T++){var x=g[T].id,A=n[x];(b=$$("option")).id=l+"#"+x,b.value=A.name,b.innerHTML=WCT.CleanupHTMLString(A.name),c.appendChild(b)}}var S=HANDLER.library.Module.prototype.Create.apply(this,arguments);S.setAttribute("aria-label",i.Trans("FILTER")),S.appendChild(c)}}}()),HANDLER.library.ModuleSearch=function(t,e,i){this.mod_type_="SRCH",HANDLER.library.Module.apply(this,arguments),this.nav_items_=[],this.search_=null,this.old_=null,this.sf_=null,this.dd_=null,this.list_id_=null,this.nav_skin_=this.skin_.navigation,this.skin_=this.skin_.search},HANDLER.library.ModuleSearch.prototype=new HANDLER.library.Module,HANDLER.library.ModuleSearch.STYLE={margin_left:3,margin_right:3,margin_top:3,margin_bottom:3,border_width:1,border_radius:0},HANDLER.library.ModuleSearch.GetStyle=function(t){var e=WCT.DeepCopy(t),i=this.STYLE,s={l:"left",r:"right",t:"top",b:"bottom"};for(var n in s)null!=e["outer_spacing_"+n]?(e["margin_"+s[n]]=e["outer_spacing_"+n],delete e["outer_spacing_"+n]):e["margin_"+s[n]]=i["margin_"+s[n]];return"undefined"==typeof e.border_width&&(e.border_width=i.border_width),"undefined"==typeof e.border_radius&&(e.border_radius=i.border_radius),e},WCT.ExtendObject(HANDLER.library.ModuleSearch.prototype,function(){function r(t){var e=MANAGER.handler.Get(this.hdl_id_);if(e){var i=e.GetSlideHandler(1);i&&i.SetSearchTerm(t,!0)}}function a(t){var e=MANAGER.handler.Get(this.hdl_id_);if(e&&(e.GetSearchInfo().slides||"slide"!=t.tclass)){var i=e.GetModule(this.list_id_);i&&i.Add(t)}}function o(t){var e=MANAGER.handler.Get(this.hdl_id_);e&&e.ListMode(t)}function l(){if(this.nav_skin_){this.dd_&&this.dd_.Destructor();var t=this.hdl_id_,e=MANAGER.handler.Get(t),i=$(this.hdl_id_+"#"+this.uid_),s=this.nav_items_,n=new DropDown({hdl_id:t,id:t+"#"+this.uid_,skin:this.nav_skin_,rtl:e.GetContentInfo().rtl});n.SetCallback(o,this),n.SetOptions(s),n.SetDefault(s[0]),n.Create(i,!0),this.dd_=n}}return{Destructor:function(){this.search_&&(HANDLER.library.Search.Stop(this.search_),this.search_=null),this.sf_&&(this.sf_.Destructor(),this.sf_=null),this.dd_&&(this.dd_.Destructor(),this.dd_=null),this.nav_items_=null,HANDLER.library.Module.prototype.Destructor.call(this)},SetPosition:function(t,e,i,s){var n=HANDLER.library.Module.prototype.SetPosition.apply(this,arguments);if(n&&n.v){var o=this.sf_,r=this.dd_;i=n.w-this.CalcReservedWidth(),s=n.h-this.CalcReservedHeight();if(o&&r){var a=this.nav_skin_,l=a.outer_spacing_l||0,c=s-a.h>>1,_=(a.w||0)+l+(a.outer_spacing_r||0);o.SetWH(Math.max(0,i-_),s),o.SetXY(_,0),r.SetXY(l,c)}else o&&o.SetWH(i,s);return n}return null},Create:function(t){var e=HANDLER.library.Module.prototype.Create.apply(this,arguments),i=HANDLER.library.ModuleSearch.GetStyle(this.skin_);l.call(this);var s=this.hdl_id_,n=MANAGER.handler.Get(s).GetContentInfo().rtl;this.sf_=new Searchfield({hdl_id:s,id:this.uid_+"#sf",skin:i,dom:e,onsearch:this.Search,scope:this,rtl:n})},SetOutputList:function(t){this.list_id_=t},SetNavigationOptions:function(t){this.nav_items_=t,l.call(this)},SetNavigationState:function(t){this.dd_&&this.dd_.Select(t)},ResetSearchFieldValue:function(){this.sf_&&this.old_&&this.sf_.SetValue(this.old_)},Blur:function(){this.sf_&&this.sf_.Blur()},Clean:function(){this.search_&&(HANDLER.library.Search.Stop(this.search_),this.search_=null),this.sf_&&this.sf_.SetValue("")},Search:function(t,e){if(this.old_!=t||e){this.old_=t,function o(){this.search_&&(HANDLER.library.Search.Stop(this.search_),this.search_=null);var t=MANAGER.handler.Get(this.hdl_id_);if(t){t.ListMode();var e=t.GetModule(this.list_id_);e&&e.Clean();var i=t.GetSlideHandler(1);i&&i.SetSearchTerm([],!0)}}.call(this);var i=MANAGER.handler.Get(this.hdl_id_);if(i){this.dd_&&this.dd_.Select("content"),this.sf_&&this.sf_.SetValue(t);var s=i.GetContentInfo();if(s&&t){var n=i.GetSearchInfo();i.ListMode(HANDLER.library.LIST_MODES.search,t),this.search_=HANDLER.library.Search.Start(t,s.tclass,s.uid,n,a,r,this,s)}else i.ListMode()}}}}}()),HANDLER.library.ModuleTree=function(t,e,i){this.mod_type_="TRE",HANDLER.library.Module.apply(this,arguments),this.tree_=null,this.tree_dim_=null,this.filter_=null,this.gloss_mode_=arguments[3]||!1,HANDLER.library.ModuleTree.STORE[this.uid_]=this},HANDLER.library.ModuleTree.STORE={},HANDLER.library.ModuleTree.prototype=new HANDLER.library.Module,WCT.ExtendObject(HANDLER.library.ModuleTree.prototype,function(){function b(t){if("select"==t.event&&this.v_&&"select"==t.event&&"Ref"==t.type){var e=DATA.GetS(t.tclass+"!"+t.uid+":entity.txt");if(!e)return;t.path.length&&((e=WCT.DeepCopy(e)).breadcrumb_trail=t.path);var i=MANAGER.handler.Get(this.hdl_id_);i&&i.Select(e)}}return{Destructor:function(){delete HANDLER.library.ModuleTree.STORE[this.uid_],this.tree_&&(this.tree_.Destructor(),this.tree_=null),this.tree_dim_=null,HANDLER.library.Module.prototype.Destructor.call(this)},Reselect:function(){return!!this.tree_&&this.tree_.Reselect()},Expand:function(t){return!!this.tree_&&this.tree_.Expand(t)},Select:function(t){return!!this.tree_&&this.tree_.Select(t)},SelectPrev:function(){this.tree_&&this.tree_.SelectPrev()},SelectNext:function(){this.tree_&&this.tree_.SelectNext()},SearchSelectionBottomUp:function(t){return this.tree_?this.tree_.SearchSelectionBottomUp(t):null},SetPosition:function(t,e,i,s){var n=HANDLER.library.Module.prototype.SetPosition.apply(this,arguments),o=this.tree_;if(n.v)if(o){var r=o.GetDom();r.style.width=n.w+"px",r.style.height=n.h+"px"}else this.tree_dim_=n},SetFilter:function(t){this.filter_=t},Create:function(t){arguments[1]||(t=HANDLER.library.Module.prototype.Create.apply(this,arguments)),t.setAttribute("role","navigation");var e=this.hdl_id_,i=MANAGER.handler.Get(e),s=i.GetContentInfo().rtl,n=i.GetConfig("lib_full_expand_check"),o=i.GetConfig("lib_glossary_root"),r=this.gloss_mode_,a=r?o:i.content_tclass_+"!"+i.content_uid_,l=r&&i.GetConfig("lib_glossary_rootlang")?HANDLER.library.Glossary.GetRootLanguage(i):null,c=this.skin_,_=WCT.DeepCopy(c.tree);!_.font_size&&c.font_size&&(_.font_size=c.font_size);var d=e+"#"+this.uid_+"#tree",u={root:a,src_1_gif:DATA.context.ToAbsPath("trainer:1.gif"),as_list:!0,show_nonref:!1,expand_slides:!1,expand_projects:!1,expand_books:!1,full_expand_check:n,auto_select_root:!!r,expand_on_select:!0,collapse_on_select:!0,rtl:s,filter:this.filter_},h={GetS:DATA.GetS.bind(DATA),GetSM:DATA.GetSM.bind(DATA),Localize:function(t){return"["+t+"]"},RefreshIE:function m(){var t=MANAGER.handler.Get(this.hdl_id_),e=t&&t.GetPanel();e&&e.RefreshIE()}.bind(this)},p=new WCT.EntityTree(d,DATA.context,h,{callback_f:b,callback_s:this},u,_);o&&p.SetLimit(o,{self:!1,book:!1,slide:!1,project:!1,cdoc:!1,language:l});var f=p.Create(t);f&&(f.style.position="static",f.style.overflowX="hidden",f.style.overflowY="auto",this.tree_dim_&&(f.style.width=this.tree_dim_.w+"px",f.style.height=this.tree_dim_.h+"px",this.tree_dim_=null),p.Expand(a),this.tree_=p)},Recreate:function(){var t=this.tree_;if(t){t.Destructor(),this.tree_=null;var e=$(this.hdl_id_+"#"+this.uid_);this.Create(e,!0)}},GetTree:function(){return this.tree_},GetPath:function(t){return this.tree_?this.tree_.GetPath(t):null},GetRootNode:function(){return this.tree_?this.tree_.GetRootNode():null},Contains:function(t){return!!this.tree_&&this.tree_.Contains(t,arguments[1])}}}()),HANDLER.library.ModuleList=function(){this.mod_type_="LST",HANDLER.library.Module.apply(this,arguments),this.sel_=null,this.idx_=0,this.data_=[]},HANDLER.library.ModuleList.prototype=new HANDLER.library.Module,WCT.ExtendObject(HANDLER.library.ModuleList.prototype,function(){function n(t){var e=this.id.split("#"),i=MANAGER.handler.Get(e[0]),s=i&&i.GetModule(e[1]);if(s){var n="img"==(t=WCT.event.Standardize(t)).targetName||"span"==t.targetName?t.target.parentNode:t.target;if(n.id.isPrefix(this.id)&&n.id!=this.id&&(e=Number(n.id.split("#").top()),!isNaN(e)))if("click"==t.type)_.call(s,e);else{var o=s.skin_,r=null,a=null;a="mouseover"==t.type?(r=e==s.sel_&&o.selected_text_color_h?o.selected_text_color_h:o.text_color_h,e!=s.sel_&&o.background_color_h?o.background_color_h:null):(r=e==s.sel_&&o.text_color_a?o.text_color_a:o.text_color,e!=s.sel_&&o.background_color),r&&(n.style.color=r),a&&(n.style.backgroundColor=a)}}}function _(t){if(t!=this.sel_||arguments[1]){var e=this.hdl_id_+"#"+this.uid_+"#",i=this.skin_;if(null!=this.sel_){var s=$(e+this.sel_);s&&(s.style.backgroundColor=i.background_color||"#fff",s.style.color=i.text_color||"#000",s.style.fontWeight=i.font_weight||"normal")}var n=$(e+(this.sel_=t));n&&(i.background_color_a&&(n.style.backgroundColor=i.background_color_a),i.text_color_a&&(n.style.color=i.text_color_a),i.font_weight_a&&(n.style.fontWeight=i.font_weight_a));var o=MANAGER.handler.Get(this.hdl_id_),r=this.data_[t],a=DATA.GetS(r.tclass+"!"+r.uid+":entity.txt");a&&o.Select(a)}}return{Destructor:function(){var t=$(this.hdl_id_+"#"+this.uid_);t&&(t.onclick=null,t.onmouseover=null,t.onmouseout=null),this.data_=null,HANDLER.library.Module.prototype.Destructor.call(this)},Create:function(t){var e=this.skin_;if(e.item){var i=MANAGER.handler.Get(this.hdl_id_).GetContentInfo().rtl,s=HANDLER.library.Module.prototype.Create.call(this,t);s.setAttribute("role","navigation"),s.style.overflow="auto",s.style.userSelect="none",s.style.WebkitUserSelect="none",e.font_size&&(s.style.lineHeight=e.font_size+4+"px"),i&&(s.style.direction="rtl"),s.onclick=n,s.onmouseover=n,s.onmouseout=n}},Select:function(t){for(var e=t.split("!"),i=0,s=null,n=this.data_;s=n[i];i++)if(s.tclass==e[0]&&s.uid==e[1]){_.call(this,i);break}},SelectPrev:function(){0<this.sel_&&_.call(this,this.sel_-1)},SelectNext:function(){this.data_&&this.sel_<this.data_.length-1&&_.call(this,this.sel_+1)},Reselect:function(){null!=this.sel_&&_.call(this,this.sel_,!0)},Clean:function(){var t=$(this.hdl_id_+"#"+this.uid_);t&&(t.innerHTML=""),this.idx_=0,this.sel_=null,this.data_=[]},Add:function(t){var e=this.hdl_id_+"#"+this.uid_,i=$(e);if(i){this.data_[this.idx_]=t;var s=this.skin_.item;e+="#";var n=MANAGER.handler.Get(this.hdl_id_),o=!!n&&n.GetContentInfo().rtl,r=$$("div");r.id=e+this.idx_++,r.setAttribute("role","listitem"),WCT.skin.ApplyTextFormats(r,s),WCT.skin.ApplyPadding(r,s),WCT.skin.ApplyBorder(r,s),r.style.overflow="hidden",r.style.textOverflow="ellipsis",r.style.whiteSpace="nowrap",r.style.cursor="pointer",r.onclick=function(){};var a=WCT.Tree.GetIconImage(t,null,null,n.GetContext()),l=$$("img");l.src=DATA.context.ToAbsPath("trainer:1.gif"),a&&(WCT.skin.ApplyBgImage(l,a),l.style.width=a.w+"px",l.style.height=a.h+"px"),l.setAttribute("role","presentation"),l.style.verticalAlign="middle",l.style[o?"marginLeft":"marginRight"]="4px",r.appendChild(l);var c=$$("span");c.appendChild($$2(t.caption)),l.setAttribute("role","link"),c.title=t.caption,c.tabIndex=0,r.appendChild(c),i.appendChild(r),1==this.idx_&&_.call(this,0)}}}}()),HANDLER.library.ModuleSlide=function(){this.mod_type_="SLD",HANDLER.library.Module.apply(this,arguments),this.ridx_=0,this.conf_={},this.data_=null,this.raw_=!1,this.w_=null,this.h_=null},HANDLER.library.ModuleSlide.prototype=new HANDLER.library.Module,HANDLER.library.ModuleSlide.INFO={breadcrumb:{c:"SlideBreadcrumbTrail",s:"breadcrumb_trail"},caption:{c:"SlideCaption",s:"caption"},buttons:{c:"SlideButtons",s:"buttons"},description:{c:"SlideDescription",s:"description"},media:{c:"SlideMedia",s:"libMedia"},assets:{c:"SlideAssets",s:"assets"}},WCT.ExtendObject(HANDLER.library.ModuleSlide.prototype,function(){function y(){var t=this.raw_;if(t){for(var e in t)t[e].Destructor();this.raw_=null}}function _(t,e){var i=this.raw_;if(i){var s=MANAGER.handler.Get(this.hdl_id_),n=s&&s.GetSlideHandler(this.ridx_)||null;if(n){var o=n.GetControl("page");if(o){var r=null;o.w!=t&&o.h!=e?r={w:t,h:e}:o.w!=t?r={w:t}:o.h!=e&&(r={h:e}),r&&n.UpdateControl("page",r);for(var a={x:0,y:0,w:t,h:e},l=["breadcrumb","caption","assets","buttons","media","description"],c=0,_=null;_=l[c++];){var d=i[_];if(d&&d.IsVisible())switch(_){case"assets":var u=d.GetFixedHeight();a.h-=d.SetPosition(a.x,e-u,a.w,Math.min(u,a.h));break;case"breadcrumb":case"buttons":case"caption":case"description":case"media":u=d.GetFixedHeight();if("media"===_){var h=i.description||null,p=""!==(h&&h.data_&&(h.data_.description||h.data_.shortdesc)||"").trim();u=d.SetPosition(a.x,a.y,a.w,Math.min(u||a.h,a.h),p)}else u=d.SetPosition(a.x,a.y,a.w,Math.min(u||a.h,a.h));a.y+=u,a.h-=u}}}}}}return{Destructor:function(){y.call(this),this.data_=null,HANDLER.library.Module.prototype.Destructor.call(this)},GetDom:function(){var t=MANAGER.handler.Get(this.hdl_id_);return t&&t.GetSlideRendererIFrame(this.ridx_)||null},GetFixedHeight:function(){var t=this.raw_;if(t){var e=!0,i=0;for(var s in t)if(t[s].IsVisible()){var n=t[s].GetFixedHeight();if(!n){e=!1;break}i+=n}if(e&&i)return i}return HANDLER.library.Module.prototype.GetFixedHeight.call(this)},Configure:function(t){var e=this.conf_;for(var i in t)e[i]=t[i]},Create:function(t){},SetVisible:function(t){if(this.v_!=t){this.v_=t;var e=this.GetDom();if(e&&(e.style.visibility=t?"visible":"hidden",e.style.zIndex=t?1:BROWSER.IE7||PLATFORM.IOS&&7<=PLATFORM.VERSION||PLATFORM.ANDROID?-1:0,PLATFORM.IOS&&(e.style.opacity=t?1:0)),this.raw_)t&&this.ReAlignControls();else if(t)this.SetContent(this.data_);else{var i=MANAGER.handler.Get(this.hdl_id_),s=i&&i.GetSlideHandler(this.ridx_)||null;s&&s.Clear()}}},SetPosition:function(t,e,i,s){var n=this.GetDom();if(!n)return null;n.style.zIndex=0,PLATFORM.IOS&&(n.style.opacity=0);var o=HANDLER.library.Module.prototype.SetPosition.apply(this,arguments);if(!o.v)return null;var r=MANAGER.handler.Get(this.hdl_id_),a=r&&r.GetLayoutManager()||null;if(a){var l=a.GetFramePos(this.frame_id_);l&&(n.style.left=l.x+t+"px",n.style.top=l.y+e+"px")}var c=n.contentWindow;return c&&c.hdl_onresize&&c.hdl_onresize(null,o.w,o.h),this.w_=o.w,this.h_=o.h,_.call(this,o.w,o.h),n.style.zIndex=1,PLATFORM.IOS&&(n.style.opacity=1),o},ReAlignControls:function(){this.w_&&this.h_&&_.call(this,this.w_,this.h_)},SetRenderer:function(t){this.ridx_=t},SetContent:function(t){!1===this.raw_?function l(t){this.data_=t;var e=MANAGER.handler.Get(this.hdl_id_),i=e&&e.GetSlideHandler(this.ridx_)||null;if(i)if(t){if("slide"==t.tclass){for(var s=null,n=t.breadcrumb_trail||[],o=n.length-1;0<=o;o--){var r=n[o];if("group"==r.tclass||"project"==r.tclass){s=r;break}}var a={lib_search_term:e.GetContentInfo().lib_search_term||""};s&&(s=DATA.GetS(s.tclass+"!"+s.uid+":entity.txt"),a.chapter=s),i.SetLanguage(t.language),HANDLER.slide.ShowSlide(t.uid,i,a),MANAGER.HandleFocus(),this.raw_=!1}}else i.Clear()}.call(this,t):function g(t){if(this.data_=t){var e=this.hdl_id_,i=this.ridx_,s=MANAGER.handler.Get(e),n=s&&s.GetSlideHandler(i)||null;if(n){var o=this.conf_,r=this.skin_,a=this.uid_,l=s.GetContentInfo(),c=HANDLER.library.ModuleSlide.INFO,_=this.raw_;if(_){for(var d in n.SetContext(t.tclass,t.uid),n.SetSearchTerm(l.lib_search_term),c)if(_[d]){var u="description"==d&&o.glossary;o[d]||u?(_[d].SetVisibility(!0),_[d].Update(t)):_[d].SetVisibility(!1)}}else{_={},this.raw_=_;var h=r.frames&&r.frames.background_color||"#FFFFFF",p={page:{id:"page",type:"page",prevent_mobile_scale:1,prevent_clamping:1,canvas_color:h,background_color:h,background_image_centered:0,image:{id:"",w:0,h:0},fontsizeInPt:0,version:"8.3.0",hide_scrollbars:1,ignore_fallbacks:!0,w:600,h:600}},f=[];for(var d in c){u="description"==d&&o.glossary;if(r[(v=c[d]).s]){var m=new HANDLER.library[v.c](e,a,i,r[v.s]),b=m.Create(t,u||undefined);b?(WCT.ExtendObject(p,b),_[d]=m):m.Destructor(),o[d]||u||f.push(d)}}n.SetSearchTerm(l.lib_search_term),n.HideMouse(),n.SetLanguage(l.language),n.SetContext(t.tclass,t.uid),n.Play({controls:p});var v=0;for(d=null;d=f[v++];)_[d].SetVisibility(!1)}MANAGER.HandleFocus()}else y.call(this)}else y.call(this)}.call(this,t)},SetRawMode:function(t){this.raw_=!!t&&null},ExtendRawDescription:function(t){var e=this.raw_,i=e&&e.description||null;i&&i.Extend(t)},OnSlidePropChange:function(t,e,i){var s=this.raw_;for(var n in s)s[n].OnSlidePropChange(t,e,i)}}}()),HANDLER.library.ModuleContextRoles=function(t,e,i,s){this.mod_type_="CTXRLS",this.cb_on_=s?1:0,HANDLER.library.Module.apply(this,arguments)},HANDLER.library.ModuleContextRoles.prototype=new HANDLER.library.Module,WCT.ExtendObject(HANDLER.library.ModuleContextRoles.prototype,function(){function _(t){var e=this.id.split("#"),i=MANAGER.handler.Get(e[0]),s=i&&i.GetModule(e[1]);if(s)if("input"==this.nodeName.toLowerCase())s.cb_on_!=this.checked&&(s.cb_on_=this.checked,i.ExecCommand("context_roles",!!this.checked));else{if(!s.cb_on_){s.cb_on_=1;var n=$(e[0]+"#"+e[1]+"#cb");n&&(n.checked=1),i.ExecCommand("context_roles",!0)}i.ExecCommand("settings")}}return{Destructor:function(){var t=this.hdl_id_+"#"+this.uid_,e=$(t+"#cb");e&&(e.onclick=null,e.onkeyup=null);var i=$(t+"#ln");i&&(i.onclick=null),HANDLER.library.Module.prototype.Destructor.call(this)},Create:function(t){var e=HANDLER.library.Module.prototype.Create.apply(this,arguments);WCT.dom.NotSelectable(e);var i=this.hdl_id_,s=MANAGER.handler.Get(i),n=s.GetContentInfo().rtl,o=this.skin_,r=$$("div");n&&(r.style.direction="rtl"),r.style.lineHeight=(o.h||0)+"px",r.style.marginLeft=(o.padding_left||0)+"px",r.style.marginRight=(o.padding_right||0)+"px",e.appendChild(r);var a=i+"#"+this.uid_,l=WCT.dom.CreateInputElement("checkbox",a+"#cb");l.id=a+"#cb",l.style.verticalAlign="middle",l.style[n?"marginLeft":"marginRight"]="3px",l.checked=this.cb_on_,r.appendChild(l);var c=$$("span");c.id=a+"#ln",c.style.cursor="pointer",c.appendChild($$2(s.Trans("CONTEXT_MY_ROLES"))),r.appendChild(c),l.onclick=_,l.onkeyup=_,c.onclick=_}}}()),HANDLER.slide.Ctx=function(t,e){this.uid_=t,this.shl_id_=e,this.store_={},this.state_={t_total:0,t_system:0,audio:0,video:0},this.audio_={},this.video_={},this.triggers_={}},WCT.ExtendObject(HANDLER.slide.Ctx,{SLIDE_COMMAND:{next:"book_next",previous:"book_prev",first:"book_first",last:"book_last",content:"book_index"},CHAPTER_COMMAND:{previous:"book_prevchapter",next:"book_nextchapter"},EXECUTABLE:{project:HANDLER.MODE.lesson,book:HANDLER.MODE.book,slide:HANDLER.MODE.slide,group:HANDLER.MODE.library,cdoc:HANDLER.MODE.library}}),HANDLER.slide.Ctx.prototype={Destructor:function(){WCT.CleanupObject(this.store_),this.store_=null,WCT.CleanupObject(this.state_),this.state_=null,WCT.CleanupObject(this.audio_),this.audio_=null,WCT.CleanupObject(this.video_),this.video_=null;var t=this.triggers_;for(var e in t)this.CleanupTriggers(e);this.triggers_=null},CleanupStore:function(){WCT.CleanupObject(this.store_),this.store_={}},RegisterTrigger:function(t,e,i,s){var n=this.triggers_;n[t]||(n[t]={}),n[t][e]={f:i,s:s}},CleanupTrigger:function(t,e){var i=this.triggers_[t];i&&i[e]&&(i[e].f=null,i[e].s=null,delete i[e])},CleanupTriggers:function(t){var e=this.triggers_[t];if(e){for(var i in e)e[i].f=null,e[i].s=null;delete this.triggers_[t]}},cfg_show:function(t,e,i){var s=MANAGER.handler.Get(this.uid_);if(s){var n=HANDLER.slide.Ctx,o=s.GetContext().Expand(t),r={tclass:o.class_id,uid:o.local_id,external:o.is_external?t:null},a="filename";if("book"===o.class_id&&o.sub_local_id)r.bookmark=o.sub_local_id;else if("project"===o.class_id&&DATA.LESSON_MODE[o.sub_path])a="mode",r.tourstop=o.sub_local_id;else if("project"===o.class_id&&"dnt"==o.sub_path)o.sub_path=function y(){if(TRACKING.backend.collaborator.Available()){var t=DATA.GetS("mgr:server/supported_features","JSON");if(0<=(t=t&&t.response&&t.response.feature||[]).indexOf("navigator"))return".inav"}return"project.dnt"}(),r.tourstop=o.sub_local_id;else if("action"===o.class_id)a="param";else if("search"===o.class_id){var l=o.local_id;switch(s.GetType()){case"library":var c=s.GetLayoutManager().GetModuleType("SRCH");c&&c.Search(l,!0);break;default:r.lib_searchstring=l,e=!0}}r[a]=o.sub_path,!r.external&&BROWSER.MOBILE&&(e=!1,i=null);var _=null;if(e){_={window_cfg_force:1};for(var d={top:1,left:1,width:1,height:1,orientation:1,name:1,force:1},u=(i=i&&"null"!=i?i.split(","):[]).length-1;0<=u;u--){var h=i[u].split("="),p=(d[h[0]]?"window_cfg_":"window_cfg_features_")+h[0],f=DEFAULTS.Clamp(p,h[1].trim());void 0!==f&&(_[p]=f)}_.window_cfg_features_fullscreen&&(delete _.window_cfg_left,delete _.window_cfg_top,delete _.window_cfg_width,delete _.window_cfg_height),null!=_.window_cfg_orientation||null==_.window_cfg_left&&null==_.window_cfg_top||(_.window_cfg_orientation="NW")}if(s.ManagerTracking()){var m=r.tclass;if("trigger"!==m&&"action"!==m&&"tourstop"!==m){var b=r.external||r.tclass+"!"+r.uid;TRACKING.backend.collaborator.prototype.TrackRecord({verb:{id:"followed"},context:{id:b},object:{id:b,objectType:"link"}})}}if(r.external)BROWSER.MOBILE?s.StartExecutable(r,_):WCT.SetTimeout(s.StartExecutable,1,s,[r,_]);else if("slide"==r.tclass&&n.SLIDE_COMMAND[r.uid]?r={tclass:"action",uid:n.SLIDE_COMMAND[r.uid]}:"chapter"==r.tclass&&n.CHAPTER_COMMAND[r.uid]&&(r={tclass:"action",uid:n.CHAPTER_COMMAND[r.uid]}),r.filename)WCT.SetTimeout(s.StartFile,1,s,[r,_]);else if(n.EXECUTABLE[r.tclass]||r.lib_searchstring)r.type=r.lib_searchstring||"project"==r.tclass&&!r.mode?HANDLER.MODE.library:n.EXECUTABLE[r.tclass],WCT.SetTimeout(s.StartExecutable,1,s,[r,_]);else switch(r.tclass){case"action":WCT.SetTimeout(s.ExecAction,1,s,[r.uid,r.param,arguments[3]||window.event]);break;case"trigger":var v=s.GetSlideHandler(this.shl_id_);v&&WCT.SetTimeout(v.ExecEvent,1,v,[r.uid]);break;case"tourstop":var g=Number(r.uid);WCT.SetTimeout(s.ExecCommand,1,s,["jump",isNaN(g)?r.uid:g])}}},track:function(t){var e=MANAGER.handler.Get(this.uid_);e&&e.Track(t)},track_completion:function(){var t=MANAGER.handler.Get(this.uid_);t&&t.TrackCompletion()},cfg_tr:function(t){var e=MANAGER.handler.Get(this.uid_);return e?e.Trans(t):t},getToc:function(){var t=MANAGER.handler.Get(this.uid_);return t&&t.GetTocObject&&t.GetTocObject()||null},gotoNextSlide:function(){this.cfg_show("slide!next")},gotoPrevSlide:function(){this.cfg_show("slide!previous")},gotoSlide:function(t){this.cfg_show("slide!"+t)},gotoNextTask:function(){this.cfg_show("action!next_task")},gotoPrevTask:function(){this.cfg_show("action!prev_task")},gotoTask:function(t){this.cfg_show("action!jump_task:"+t)},gotoTourstop:function(t){this.cfg_show("action!jump:"+t)},lessonAction:function(t){switch(t){case"lesson_end":t="action!stop";break;case"lesson_restart":case"lesson_exit":case"lesson_startstop_print":case"lesson_startstop_details":t="action!"+t.replace(/lesson_/,"");break;default:t="action!"+t}this.cfg_show(t)},onMute:function(t){var e=MANAGER.handler.Get(this.uid_),i={channel:t,muted:!0};e&&WCT.SetTimeout(e.ExecCommand,1,e,["audio_c_mute",i])},onUnmute:function(t){var e=MANAGER.handler.Get(this.uid_),i={channel:t,muted:!1};e&&WCT.SetTimeout(e.ExecCommand,1,e,["audio_c_mute",i])},onVolume:function(t,e){var i=MANAGER.handler.Get(this.uid_),s={channel:t,volume:e};i&&WCT.SetTimeout(i.ExecCommand,1,i,["audio_volume",s])},onAudioPlay:function(t,e){var i=this.audio_;e?i[t]=!0:delete i[t];var s=0;for(var n in i)s++;var o=this.state_;o.audio=s;var r=MANAGER.handler.Get(this.uid_);r&&r.OnSlideState&&WCT.SetTimeout(r.OnSlideState,1,r,["audio",o.t_total,o.t_system,s,o.video])},onVideoPlay:function(t,e){var i=this.video_;e?i[t]=!0:delete i[t];var s=0;for(var n in i)s++;var o=this.state_;o.video=s;var r=MANAGER.handler.Get(this.uid_);r&&r.OnSlideState&&WCT.SetTimeout(r.OnSlideState,1,r,["video",o.t_total,o.t_system,o.audio,s])},onTicker:function(t,e,i){var s=this.state_;s&&(s.t_total=e,s.t_system=i);var n=MANAGER.handler.Get(this.uid_);n&&n.OnSlideState&&WCT.SetTimeout(n.OnSlideState,1,n,["ticker_"+t,e,i,s.audio,s.video])},onTrainerTrigger:function(t){var e=this.triggers_;for(var i in e)for(var s in e[i])if(s==t){var n=e[i][s];return void n.f.call(n.s,s)}},setStore:function(t,e){this.store_[t]=e},getStore:function(t){return this.store_[t]},remStore:function(t){delete this.store_[t]},getQuizTrackingHtml:function(t,e,i){var s=MANAGER.handler.Get(this.uid_),n=s&&s.skin_&&s.skin_.start_stop_page&&s.skin_.start_stop_page.test_details;return n?HANDLER.lesson.DetailStop.Quiz(s,n,t,e,i):""},getQuizScore:function(){var t=MANAGER.handler.Get(this.uid_);return t&&t.GetQuizScore?t.GetQuizScore():null},setConfig:function(t,e){var i=MANAGER.handler.Get(this.uid_);i&&i.SetConfig(t,e)},scrollToPOI:function(t,e,i,s){var n=MANAGER.handler.Get(this.uid_);n&&n.ScrollToPOI(t,e,i,s)},showPanel:function(t){var e=MANAGER.handler.Get(this.uid_);e&&e.ShowPanel(t)},showDemoHelp:function(t){var e=MANAGER.handler.Get(this.uid_);e&&e.ShowDemoHelp&&WCT.SetTimeout(e.ShowDemoHelp,1,e,arguments)},globalQuizTimeout:function(){var t=MANAGER.handler.Get(this.uid_);t&&t.GlobalQuizTimeout&&t.GlobalQuizTimeout()},OnVideoAudio:function(t,e){var i=MANAGER.handler.Get(this.uid_);i&&i.OnVideoAudio&&i.OnVideoAudio(t,e)},registerEventListener:function(t){t.slide_id=this.shl_id_,t.handler_id=this.uid_,MANAGER.event.RegisterListener(t)},unregisterEventListener:function(t){t.slide_id=this.shl_id_,t.handler_id=this.uid_,MANAGER.event.UnregisterListener(t)}},HANDLER.slide.Sink=function(t){this.uid_=t},HANDLER.slide.Sink.prototype={LoadFile:function(t){return DATA.GetS(t,"string")||null},OnHotkey:function(t){WCT.event.hotkey.Fired(t)},ObserveHotkey:function(t,e,i,s){return WCT.event.hotkey.Observe(t,e,i,s)},StopObservingHotkey:function(t,e){WCT.event.hotkey.StopObserving(t,e)},CancelHotkey:function(t){WCT.event.hotkey.CancelBrowserHotkey(t)},GetConfig:function(t){var e=MANAGER.handler.Get(this.uid_);return e?e.GetConfig(t):null},setAccessibilityMode:function(t){MANAGER.handler.Get(this.uid_).setAccessibilityMode(t)},enterOrSpaceInUse:function(){var t=MANAGER.handler.Get(this.uid_),e=!1,i=!1;if(t){var s=t.GetType(),n=["keys_back","keys_next","keys_feedback"];"book"===s||"library"===s||n.push("keys_play","keys_stop","keys_pause");for(var o,r=0;o=n[r++];){var a=t.GetConfig(o);if(-1!==a.search(/space/)&&(i=!0),-1!==a.search(/enter/)&&(e=!0),e&&i)break}}return{enter:e,space:i}},onPropChange:function(t,e,i){var s=MANAGER.handler.Get(this.uid_);s&&s.OnSlidePropChange&&WCT.SetTimeout(s.OnSlidePropChange,1,s,[t,e,i])},Print:function(t){var e=MANAGER.handler.Get(this.uid_);e&&Print.Open(e,t,arguments[1]||!1)},VideoMode:function(){return PRODUCER&&PRODUCER.VideoExport&&PRODUCER.VideoExport.Enabled()},PreventNavigation:function(t){var e=MANAGER.handler.Get(this.uid_);e&&e.PreventNavigation&&e.PreventNavigation(t)},ControlAdded:function(){},ControlDeleted:function(){}},HANDLER.slide.Handler=function(t,e){this.uid_=t,this.slide_=e,this.template_=null,this.content_language_=null,this.step_=0,this.steps_=0,this.search_term_=null},HANDLER.slide.Handler.prototype={Destructor:function(){this.slide_=null},GetWindow:function(){return this.slide_&&this.slide_.contentWindow||null},GetApi:function(t){var e=this.GetWindow();return e&&e[t]||null},SetSlide:function(t){this.slide_=t},SetBookStep:function(t,e){this.step_=t,this.steps_=e},HideMouse:function(){var t=this.GetApi("Mouse");t&&t.Hide()},Clear:function(){var t=this.GetApi("Page"),e=this.GetApi("Mouse");t&&t.ClearSlide(),e&&e.Hide()},Log:function(t){var e=this.GetWindow();e&&e.Log&&e.Log(t)},Create:function(t){var e=this.GetApi("Page");if(e){var i=MANAGER.handler.Get(this.uid_),s=i&&i.GetContentInfo()||{},n=this.content_language_||s.language||DATA.DEFAULT_LANGUAGE;e.SetVariable("text_styles",DATA.TEXT_STYLES),e.SetVariable("content_language",n),e.setHtmlLang(n),e.Create(t)}},SetConfig:function(t,e){var i=this.GetApi("Page");i&&i.SetConfig(t,e)},Play:function(){var t=this.GetApi("Page");t&&(arguments[0]&&this.Create(arguments[0]),t.Play(),t.RTFireTrigger("page.book_progress#"+this.step_+"#"+this.steps_))},Pause:function(t){var e=this.GetApi("Page");e&&e.Pause(t,"user"===arguments[1])},GetControlPreloadStreams:function(t){var e=this.GetApi("Page");if(!e)return[];var i=[];for(var s in t)i=i.concat(e.GetControlPreloadStreams(t[s]));return i},GetTextRect:function(t){var e=this.GetApi("Page");return e?e.GetTextRect(t):null},MediaStop:function(){var t=this.GetApi("Media");t&&t.Stop()},MediaPlay:function(t){var e=this.GetApi("Media");if(e){var i=arguments[1]||null,s=t?arguments[2]||!1?"Resume":"Play":"Pause";i?e.audio&&e.audio[s](i):e[s](!0)}},MediaPlaying:function(t){var e=this.GetApi("Media");return!(!e||!e.audio)&&e.audio.Playing(t)},MediaVolume:function(t,e){var i=this.GetApi("Media");i&&i.audio&&("Master"==t?i.Volume(e,!0):i.audio.Volume(t,e,!0))},MediaMute:function(t,e){var i=this.GetApi("Media");i&&i.audio&&("Master"==t?i[e?"Mute":"Unmute"](!0):i.audio[e?"Mute":"Unmute"](t,!0))},MediaPlayPagesound:function(){var t=this.GetApi("Media");t&&t.audio&&(t.audio.StopPagesound(),t.audio.PlayPagesound())},MediaStopPagesound:function(){var t=this.GetApi("Media");t&&t.audio&&t.audio.StopPagesound()},MediaStopBooksound:function(){var t=this.GetApi("Media");t&&t.audio&&t.audio.Stop("Booksound")},SetLanguage:function(t){this.content_language_=t},SetContext:function(t,e){var i=this.GetApi("Context");i&&i.Set(t,e)},SetBookStyle:function(t){var e=this.GetApi("Page");e&&e.SetBookStyle(t)},SetPlaceholder:function(t,e){var i=this.GetApi("Page");i&&i.SetPlaceholderValue(t,e)},BroadcastEvent:function(t){var e=this.GetApi("Page");e&&e.HandleEnvEvent(t)},SetContextMap:function(t){var e=this.GetApi("Page");e&&e.SetContextMap(t)},SetConfig:function(t,e){var i=this.GetApi("Page");i&&i.SetConfig(t,e)},AddControl:function(t){var e=this.GetApi("Page");e&&e.AddControl(t)},RemoveControl:function(t){var e=this.GetApi("Page");e&&e.DeleteControl(t)},AddControls:function(t){var e=this.GetApi("Page");if(e)for(var i in t)e.AddControl(t[i])},RemoveAllControls:function(){var t=this.GetApi("Page");t&&t.DeleteAllControls()},UpdateControl:function(t,e){var i=this.GetApi("Page");return i?i.UpdateControl(t,e,arguments[2]):null},GetControl:function(t){var e=this.GetApi("Page");return e?e.GetControlProperties(t):null},GetCSS:function(){var t=this.GetApi("document").getElementsByTagName("head")[0];if(!t)return[];var e=MANAGER.handler.Get(this.uid_),i=e&&e.GetContext();if(i){i.SetScope("trainer");var s=[],n=arguments[0];if(n)for(var o=0,r=null;r=n[o++];)s.push(i.ToAbsPath(r));for(var a=t.getElementsByTagName("link"),l=(o=0,a.length);o<l;o++){var c=a[o].href;c&&(c=i.ToAbsPath(c),s.push(c))}return s}},ExecEvent:function(t){var e=this.GetApi("Page");e&&e.RTFireTrigger(t)},InsertCssFile:function(t){var e=this.slide_&&this.slide_.contentWindow||null;e&&WCT.ExtendHeadByCSS(t,null,e)},VisibleTaskBubble:function(t){var e=this.GetApi("Page");e&&e.SetTaskBubbleVisibility(t)},VisibleExplanationBubble:function(t){var e=this.GetApi("Page");e&&e.SetExplanationBubbleVisibility(t)},HandleSubtitle:function(){var t=this.GetApi("Page");t&&t.HandleSubtitle()},UserPause:function(t){var e=this.GetApi("Page");e&&e.Pause(t,!0)},SetMouseSkin:function(t){var e=this.GetApi("Mouse");e&&e.SetSkin(t)},IsIdle:function(){var t=this.GetApi("Ticker");return!t||t.IsIdle(arguments[0])},Template:function(){return"undefined"!=typeof arguments[0]&&(this.template_=arguments[0]),this.template_},VideoTick:function(){var t=this.GetApi("Page");t&&t.VideoTick()},SetupVideoMode:function(t){var e=this.GetApi("Page");e&&e.SetupVideoMode(t)},SetSearchTerm:function(t){var e=arguments[1];if(e||this.search_term_!=t){var i=this.GetApi("Page");i&&(e||(this.search_term_=t),i.SetVariable(e?"lib_searchinfo":"lib_searchstring",t),i.UpdateAllTextControls())}},ShowAllHighlights:function(t){var e=this.GetApi("Page");e&&e.ShowHighlights(t)}};