function Log(t){if(window.DEBUG){if(Log2Box(t),top.console&&top.console.log?(arguments[1]&&top.console.trace&&top.console.trace(),top.console.log(t)):"undefined"!=typeof opera&&opera.postError&&opera.postError(t),arguments[1])throw t="string"==typeof t?t:"ABNORMAL PROGRAM TERMINATION!",new Error(t)}else window.EDIT_MODE&&Log2Box(t)}function Log2Box(t){if(window.MANAGER&&MANAGER.handler){var e=MANAGER.handler.GetActive();if(e=e&&e.GetSlideHandler&&e.GetSlideHandler(0)||null)return void e.Log(t)}try{"object"==typeof t&&(t=JSON.stringify(t))}catch(o){}var i=$("Log2Box");i||((i=$$("div")).id="Log2Box",i.style.position="fixed",i.style.width="500px",i.style.height="800px",i.style.bottom="2px",i.style.right="2px",i.style.overflow="auto",i.style.fontSize="12pt",i.style.fontFamily="Lucida Sans",i.style.border="1px solid #888888",i.style.backgroundColor="#eeeeee",i.style.cursor="pointer",i.style.opacity="0.95",document.body.appendChild(i),drg=$$("div"),drg.id="logdragger",drg.style.position="absolute",drg.style.top=0,drg.style.left=0,drg.style.width="100%",drg.style.height="20px",i.ondblclick=function(){var t=$("Log2Box");""!=t.innerHTML?t.innerHTML="":t.parentNode.removeChild(t)},i.onmousedown=function(t){t=t||event||window.event,window.drag_logbox=!0,WCT.event.Cancel(t)},i.onmousemove=function(t){if((t=t||event||window.event)&&window.drag_logbox){var e=$("Log2Box");e.style.left=t.clientX-150+"px",e.style.top=t.clientY-150+"px",WCT.event.Cancel(t)}},i.onmouseup=function(t){t=t||event||window.event,window.drag_logbox=!1,WCT.event.Cancel(t)}),i.firstChild?(i.insertBefore($$("br"),i.firstChild),i.insertBefore($$2("-- "+t),i.firstChild)):i.appendChild($$2("-- "+t))}function ClearLog(){var t=$("Log2Box");t&&(t.innerHTML="")}function Log2Win(t){var e=window.p_Log2Win_,i=null;e&&"unknown"==typeof e.document&&(e=null),e?i=e.document.body:(e=window.open("about:blank",WCT.uid.Generate(10)),(i=(window.p_Log2Win_=e).document.body).style.fontFamily="Lucida Sans"),i.innerHTML="-- "+t+"<br/>"+i.innerHTML}function $(t){return(arguments[1]||document).getElementById(t)}function $$(t){return BROWSER.IE&&BROWSER.VERSION<9&&0<=["article","header","footer"].indexOf(t.toLowerCase())&&(t="div"),(arguments[1]||document).createElement(t)}function $$2(t){return(arguments[1]||document).createTextNode(t)}!function(){var request_headers_={},before_=null,after_=null,error_=null,count_=0,track_=!1,store_={},_token=null;function execute_action_(t){"before"===t?1==++count_&&before_&&before_.f.call(before_.s):0==--count_&&after_&&after_.f.call(after_.s)}function generate_uid_(){for(var t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],e=t.length,i=[],o=12;0<o--;){var r=Math.floor(Math.random()*e);i.push(t[r])}return i.join("")}window.XHR={LastStatus:null,LastResponseText:null,LastResponseXML:null,Cleanup:function(){this.LastStatus=null,this.LastResponseText=null,this.LastResponseXML=null,store_={},_token=error_=after_=before_=null},HasActiveX:function(){try{if(new ActiveXObject("Msxml2.XMLHTTP.3.0"))return!0}catch(t){try{if(new ActiveXObject("Msxml2.XMLHTTP"))return!0}catch(t){try{if(new ActiveXObject("Microsoft.XMLHTTP"))return!0}catch(t){}}}return!1},Create:function(){if(!BROWSER.IE&&window.XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){if(window.XMLHttpRequest)return new XMLHttpRequest}}}return null},SetRequestHeaders:function(t){if(arguments[1]){var e=request_headers_;for(var i in e)t.setRequestHeader(i,e[i]);request_headers_={}}else request_headers_=t},Request:function(t,e){var i=arguments[2],o=arguments[3]||null,r="function"==typeof arguments[4]?arguments[4]:function(){},n=arguments[5],s=!1!==arguments[6],a=arguments[7]||null;"GET"===t&&(i=null),i&&"string"!=typeof i&&"{}"!==JSON.stringify(i)&&(i=JSON.stringify(i));var _=arguments[8]||this.Create();if(!_)return null;if("GET"===t?"JSON"===a&&-1===e.search(/\.txt$/)&&(request_headers_["X-CSRF-Token"]="Fetch"):_token&&(request_headers_["X-CSRF-Token"]=_token),s){var l;track_&&(l=generate_uid_(),store_[l]=_);try{_.open(t,e,!0),this.SetRequestHeaders(_,!0),_.onreadystatechange=function(){if(4===_.readyState){var t=_.getResponseHeader("X-CSRF-Token");t&&t!==_token&&(window.XHR2&&XHR2.SetToken(t),_token=t),_.onreadystatechange=function(){},track_&&delete store_[l],execute_action_("after"),XHR.Eval(_,o,r,n,a,e),l=a=n=r=o=_=null}},execute_action_("before"),_.send(i)}catch(h){}return _}try{execute_action_("before"),_.open(t,e,!1),this.SetRequestHeaders(_,!0),_.send(i);var d=_.getResponseHeader("X-CSRF-Token");d&&d!==_token&&(window.XHR2&&XHR2.SetToken(d),_token=d),execute_action_("after")}catch(h){}return this.Eval(_,o,r,n,a,e)},Eval:function(xhr,scope,success,error,type,url){var r=null,p=url.replace(/(.*?):.*$/,"$1");if(p=WCT.context.PROTOCOLS[p]?p:"file",XHR.LastStatus=xhr.status,XHR.LastResponseText=xhr.responseText,XHR.LastResponseXML=xhr.responseXML,200===xhr.status||"file"===p&&0===xhr.status){switch(type){case"JSON":try{r=xhr.responseText.replace(/\r|\n|\t/g,""),r=JSON.parse(r)}catch(e){r=null}break;case"XML":r=xhr.responseXML;break;case"eval":try{r=eval("("+xhr.responseText+")")}catch(e){r=null}break;case"string":try{r=eval("("+xhr.responseText+")")}catch(e){r=xhr.responseText}break;case"raw":default:r=xhr.responseText}success.call(scope,r)}else error?error.call(scope,xhr.status,xhr.statusText,xhr.responseText):error_&&error_.f.call(error_.s,xhr.status,xhr.statusText,xhr.responseText);return r},Abort:function(t){for(var e in t.onreadystatechange=function(){},4!=t.readyState&&execute_action_("after"),t.abort(),store_)if(store_[e]===t){delete store_[e];break}},AbortAll:function(){var t=store_;for(var e in store_={},t){var i=t[e];this.Abort(i)}},TrackAsyncRequests:function(t){(track_=t)||(store_={})},SetBeforeAction:function(t){before_=t?{f:t,s:arguments[1]}:null},SetAfterAction:function(t){after_=t?{f:t,s:arguments[1]}:null},SetDefaultErrorHandler:function(t){error_=t?{f:t,s:arguments[1]}:null},GetA:function(t){return this.Request("GET",WCT.GetEncodedURI(t),null,arguments[1],arguments[2],arguments[3],!0,arguments[4])},GetS:function(t){return this.Request("GET",WCT.GetEncodedURI(t),null,null,null,null,!1,arguments[1])},PostA:function(t,e){return this.Request("POST",t,e,arguments[2],arguments[3],arguments[4],!0,arguments[5])},PostAXMLHttpRequest:function(t){return this.Request("POST",t.url,t.data,t.scope,t.onSuccess,t.onError,!0,"JSON",t.requestObject)},PostS:function(t,e){return this.Request("POST",t,e,null,null,null,!1,arguments[2])},PutA:function(t,e){return this.Request("PUT",t,e,arguments[2],arguments[3],arguments[4],!0,arguments[5])},PutS:function(t,e){return this.Request("PUT",t,e,null,null,null,!1,arguments[2])},DelA:function(t,e){return this.Request("DELETE",t,e,arguments[2],arguments[3],arguments[4],!0,arguments[5])},DelS:function(t,e){return this.Request("DELETE",t,e,null,null,null,!1,arguments[2])},SetToken:function(t){_token=t},GetToken:function(){return _token},RequestToken:function(){this.SetToken("");var t=DATA.context.GetServerBase();this.GetS(t+"/!/about","JSON")}}}(),function(){var t=navigator.appVersion,e=navigator.platform,i=navigator.userAgent;if(window.BROWSER={},BROWSER.EDGE=0<t.indexOf("Edge")||"5.0 (Windows NT 10.0; Win64; x64)"===t,BROWSER.EDGECHR=0<t.indexOf("Edg/"),BROWSER.IE=!(BROWSER.EDGE||!document.all&&!window.MSStream),BROWSER.FIREFOX=!1,BROWSER.CHROME=!BROWSER.EDGE&&!BROWSER.EDGECHR&&0<t.indexOf("Chrome"),BROWSER.SAFARI=!BROWSER.CHROME&&!BROWSER.EDGECHR&&!BROWSER.EDGE&&0<t.indexOf("Safari"),BROWSER.IPAD=null!=i.match(/iPad/i),BROWSER.IPHONE=null!=i.match(/iPhone/i)||null!=i.match(/iPod/i),BROWSER.EDGE)/.*[Edge\/](\d\d)/.exec(t),BROWSER.VERSION=parseInt(RegExp.$1)||12;else if(BROWSER.IE){if(0<=t.indexOf("like Gecko")){var o=t.match(/rv:\d+/);(o=o&&Number(o[0].substr(3)))&&!isNaN(o)||(o=11),BROWSER.VERSION=o,BROWSER["IE"+o]=!0}else{var r=t.indexOf("MSIE "),n=0<=r?parseInt(t.substr(r+5)):9,s=document.documentMode||(document.compatMode&&"CSS1Compat"==document.compatMode?7:5);s&&n!=s&&(BROWSER.COMPAT_VIEW=!0,n=s),BROWSER.VERSION=n,BROWSER["IE"+n]=!0}BROWSER.ACTIVE_X=function l(){try{if(new ActiveXObject("Msxml2.XMLHTTP.3.0"))return!0}catch(t){try{if(new ActiveXObject("Msxml2.XMLHTTP"))return!0}catch(t){try{if(new ActiveXObject("Microsoft.XMLHTTP"))return!0}catch(t){}}}return!1}()}else BROWSER.SAFARI||BROWSER.CHROME||(BROWSER.FIREFOX=!0);if((BROWSER.FIREFOX||BROWSER.CHROME||BROWSER.SAFARI)&&!BROWSER.EDGE){var a=i.match(BROWSER.FIREFOX?/Firefox\//:BROWSER.CHROME?/Chrome\//:/Version\//),_=a?a.index+a[0].length:0;_&&(BROWSER.VERSION=parseInt(i.substr(_))||1)}if(window.PLATFORM={WINDOWS:0<=e.indexOf("Win"),WINTABLET:!(!navigator.msPointerEnabled||null==t.match(/Tablet PC/)),LINUX:0<=e.indexOf("Linux"),MAC:0<=e.indexOf("Mac"),WINCE:0<=e.indexOf("WinCE"),IOS:BROWSER.IPAD||BROWSER.IPHONE,ANDROID:null!=i.match(/android/i)},PLATFORM.IOS){n=t.match(/OS (\d+)_\d+/)[1];"number"==typeof(n=parseInt(n,10))&&0!=n&&(PLATFORM.VERSION=n)}if(PLATFORM.ANDROID){n=t.match(/Android\s([0-9\.]*)/)[1].replace(/\./g,"");"number"==typeof(n=parseInt(n,10))&&0!=n&&(PLATFORM.VERSION=n)}if(BROWSER.METRO=!1,BROWSER.IE&&9<BROWSER.VERSION)try{new ActiveXObject("htmlfile");null,PLATFORM.WINTABLET=!1}catch(d){BROWSER.METRO=!0}PLATFORM.MOBILE=PLATFORM.IOS||PLATFORM.ANDROID||PLATFORM.WINTABLET,BROWSER.MOBILE=PLATFORM.MOBILE,BROWSER.PHONE=BROWSER.IPHONE,BROWSER.TABLET=BROWSER.IPAD||PLATFORM.WINTABLET}(),Array.prototype.top||(Array.prototype.top=function(){var t=this.length;return t?this[t-1]:undefined}),Array.prototype.max||(Array.prototype.max=function(){return Math.max.apply(Math,this)}),Array.prototype.min||(Array.prototype.min=function(){return Math.min.apply(Math,this)}),Array.prototype.sum||(Array.prototype.sum=function(){if("function"==typeof this.reduce)return this.reduce(function(t,e){return t+e},0);for(var t=0,e=this.length;e--;)t+=this[e];return t}),Array.prototype.shuffle||(Array.prototype.shuffle=function(){for(var t=[],e=this.length;e--;){var i=Math.round(Math.random()*e),o=this.splice(i,1)[0];t.push(o)}return t.reverse()}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=this.length,i=Number(arguments[1]);for(isNaN(i)?i=0:i<0?(i=Math.ceil(i),i+=e):i=Math.floor(i);i<e;i++)if(this[i]===t)return i;return-1}),Array.prototype.indexOfAtt=function(t,e){var i=this.length,o=Number(arguments[2]),r=arguments[3]||null;for(isNaN(o)?o=0:o<0?(o=Math.ceil(o),o+=i):o=Math.floor(o);o<i;o++){var n=null,s=Array.prototype.slice.call(arguments,3);if(r)for(var a=0,_=null;(_=s[a++])&&!(n=this[o][_]););else n=this[o];if(n[e]===t)return o}return-1},Array.prototype.indexOfAttCase=function(t,e){var i=this.length,o=Number(arguments[2]);for(isNaN(o)?o=0:o<0?(o=Math.ceil(o),o+=i):o=Math.floor(o);o<i;o++){var r=this[o][e];if(r&&r.toUpperCase()==t.toUpperCase())return o}return-1},Array.prototype.toRangedString=function(){var t=this.length;if(!t)return"";if(1==t)return this[0];for(var e=arguments[0]||"~",i=arguments[1]||";",o=[],r=0;r<t;r++){if("number"!=typeof this[r])return"";o[r]=this[r]}o.sort(function(t,e){return t-e});var n=[],s=o[0],a=[s];for(r=1;r<t;r++){var _=o[r];_!=s&&(_==s+1?a[1]=_:a.length&&(n.push(a.join(e)),a=[_]),s=_)}return a.length&&n.push(a.join(e)),n.join(i)},Array.prototype.unique=function(){for(var t=this.length,e={},i=[],o=0;o<t;o++){var r=this[o];e[r]||(e[r]=1,i.push(r))}return i},Array.prototype.toMap=function(){for(var t=arguments[0]||{},e=t.delimiter,i=t.multi_map_delimiter,o=t.fallback_value,r=t.trim_keys||!1,n=t.trim_values||!1,s={},a=this.length-1;0<=a;a--){var _="string"==typeof e?this[a].split(e):[this[a]],l="undefined"==typeof _[1]&&void 0!==o?o:_[1],d=_[0];r&&(d=d.trim()),n&&"string"==typeof l&&(l=l.trim()),s[d]="string"==typeof s[d]&&"string"==typeof i?s[d]+i+l:l}return s},Array.prototype.isArray=!0,Array.prototype.move||(Array.prototype.move=function(t,e){this.splice(e,0,this.splice(t,1)[0])}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),String.prototype.toMaxLength||(String.prototype.toMaxLength=function(t){if(this.length>t){var e=arguments[1]||"";return t-=e.length,this.substr(0,t)+e}return this}),String.prototype.isPrefix||(String.prototype.isPrefix=function(t){return t.length<=this.length&&this.substr(0,t.length)===t}),String.prototype.toFirstUpperCase||(String.prototype.toFirstUpperCase=function(){return this.charAt(0).toUpperCase()+this.substr(1).toLowerCase()}),String.prototype.rangedToArray=function(){if(""==this)return[];del1=arguments[0]||"~",del2=arguments[1]||";";for(var t=[],e=this.split(del2),i=0,o=e.length;i<o;i++){var r=e[i].split(del1);if(1==r.length)t.push(Number(r[0]));else for(var n=Number(r[0]),s=Number(r[1]);n<=s;)t.push(n++)}return t},String.prototype.html2txt=function(){return this.replace(/\n/g," ").replace(/<br>/gi,"\n").replace(/<li>/gi,"\n").replace(/<\/p>/gi,"\n").replace(/<\/h[0-9]>/gi,"\n").replace(/<[^>]*>/g,"").replace(/&nbsp;/gi," ").replace(/&lt;/gi,"<").replace(/&gt;/gi,">")},String.prototype.html2txtSimple=function(){return this.replace(/\n/g," ").replace(/<br>/gi,"\n").replace(/<li>/gi,"\n").replace(/<\/p>/gi,"\n").replace(/<\/h[0-9]>/gi,"\n").replace(/&nbsp;/gi," ")},String.prototype.decodeHTMLEntities=function(){return(new DOMParser).parseFromString("<!doctype html><body>"+this,"text/html").body.textContent},Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");function e(){}function i(){return r.apply(this instanceof e&&t?this:t,o.concat(Array.prototype.slice.call(arguments)))}var o=Array.prototype.slice.call(arguments,1),r=this;return e.prototype=this.prototype,i.prototype=new e,i}),window.JSON||(JSON={}),"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){var t=this.getUTCFullYear(),e=this.getUTCMonth()+1,i=this.getUTCDate(),o=this.getUTCHours(),r=this.getUTCMinutes(),n=this.getUTCSeconds();return e<10&&(e="0"+e),i<10&&(i="0"+i),o<10&&(o="0"+o),r<10&&(r="0"+r),n<10&&(n="0"+n),t+"-"+e+"-"+i+"T"+o+":"+r+":"+n+"Z"},String.prototype.toJSON=function(){return this.valueOf()},Number.prototype.toJSON=function(){return this.valueOf()},Boolean.prototype.toJSON=function(){return this.valueOf()}),"function"!=typeof JSON.stringify&&(JSON.stringify=function(t){function l(t){var e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return e.lastIndex=0,'"'+(e.test(t)?t.replace(e,function(t){return"string"==typeof i[t]?i[t]:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}):t)+'"'}var d=function(t,e){var i=e[t];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(t)),typeof i){case"string":return l(i);case"number":return isFinite(i)?i+"":"null";case"boolean":return i.toString();case"object":if(!i)return"null";var o=[],r="{",n="}";if("[object Array]"==Object.prototype.toString.apply(i)){r="[",n="]";for(var s=0,a=i.length;s<a;s++)o.push(d(s,i)||"null")}else for(var t in i)if(Object.hasOwnProperty.call(i,t)){var _=d(t,i);_&&o.push(l(t)+":"+_)}return r+o.join(",")+n;case"undefined":case"unknown":return}};return d("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text){return eval("("+text+")")}),window.PLATFORM&&PLATFORM.WINCE||'"null"'!==JSON.stringify(document.createElement("input").value)||function(){var e=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value").get;Object.defineProperty(HTMLInputElement.prototype,"value",{get:function(){var t=e.call(this);return""===t?"":t}})}();var WCT={Cleanup:function(){WCT.timeout&&WCT.timeout.Cleanup(),WCT.image_watcher&&WCT.image_watcher.Cleanup(),WCT.event&&(WCT.event.hotkey&&WCT.event.hotkey.Cleanup(),WCT.event.touches&&WCT.event.touches.Cleanup()),WCT.dnd&&WCT.dnd.Cleanup(),WCT.transition&&WCT.transition.Cleanup(),WCT.iframe&&WCT.iframe.Cleanup(),WCT.Fader&&WCT.Fader.Cleanup(),WCT.QrCode&&WCT.QrCode.Cleanup(),WCT.Tree&&WCT.Tree.Cleanup(),WCT.Select&&WCT.Select.Cleanup(),WCT.PicView&&WCT.PicView.Cleanup(),WCT.Propsheet&&WCT.Propsheet.Cleanup(),WCT.SplitterButton&&WCT.SplitterButton.Cleanup(),WCT.AdaptableClasses&&WCT.AdaptableClasses.Cleanup(),WCT.XHR&&WCT.XHR.Cleanup(),window.XHR&&XHR.Cleanup(),WCT.Controls&&WCT.Controls.Cleanup()},ExtendObject:function(t,e){for(var i in e)t[i]=e[i];return t}};WCT.ExtendObject(WCT,{$:window.$,$$:window.$$,$$2:window.$$2,BROWSER:window.BROWSER,PLATFORM:window.PLATFORM,GetEncodedURI:function(t){var e=t.match(/\?(.*)/);return e?t.replace(e[1],encodeURI(e[1])):t},GetEncodedSearchString:function(t){return t.replace(/#/g,"%23")},SetNodeText:function(t,e){t.innerHTML="",doc=arguments[2]||document,t.appendChild(doc.createTextNode(e))},IsImage:function(t){return!!t.match(/\.(gif|jpg|png|bmp|jpeg)$/i)},IsPng:function(t){return!!t.match(/\.(png)$/i)},IsHtml5VideoFormat:function(t){return!!t.match(/\.(mp4|ogg|webm)$/i)},IsHtml5AudioFormat:function(t){return!!t.match(/\.(mp3|ogg|wav)$/i)},IsArchive:function(t){return!!t.match(/\.(dkp)$/i)},isContent:function(t){var e=new RegExp((!!arguments[1]?"^":".")+"(pdf|html|htm|doc|docx|xls|xlsx|ppt|pptx)$","i");return!!t.match(e)},ClampBoolean:function(t){return"boolean"==typeof t?t:"number"==typeof t?1===t:"true"===t||"1"===t||"yes"===t||!(!arguments[1]||"false"===t||"0"===t||"no"===t)&&null},ReverseBoolean:function(t,e){return"BOOL_0_1"===e?t=t?"1":"0":"BOOL_YES_NO"===e?t=t?"yes":"no":"BOOL_TRUE_FALSE"===e&&(t=t?"true":"false"),t},CleanupObject:function(t){if("object"==typeof t&&t)if(t.isArray)for(var e=t.length-1;0<=e;e--)this.CleanupObject(t[e]),t[e]=null;else for(var e in t)this.CleanupObject(t[e]),delete t[e]},ReverseObject:function(t){var e={};for(var i in t)e[t[i]]=i;return e},ObjectToArray:function(t,e){var i=[];if((arguments[2]||{}).not_null)for(var o in t)null!=t[o]&&i.push(o+e+t[o]);else for(var o in t)i.push(o+e+t[o]);return i},DeepEquals:function(t,e){if(t===e)return!0;var i="object"==typeof t,o="object"==typeof e;if(!i&&!o||!t||!e)return t==e;if(i&&o){if(t.isArray!=e.isArray)return!1;if(t.isArray){var r=t.length;if(r!==e.length)return!1;for(var n=r-1;0<=n;n--)if(s=t[n],a=e[n],"object"!=typeof s&&"object"!=typeof a||!s||!a){if(s!=a)return!1}else if(!this.DeepEquals(s,a))return!1}else{var s,a;for(var n in t)if(s=t[n],a=e[n],"object"!=typeof s&&"object"!=typeof a||!s||!a){if(s!=a)return!1}else if(!this.DeepEquals(s,a))return!1;for(var n in e)if(!t.hasOwnProperty(n))return!1}return!0}return!1},GetEntityList:function(t,e){var i={group:null,book:null,project:null,cdoc:null,slide:null},o=".tree_path";if("undefined"!=typeof WEB_EDITOR&&WEB_EDITOR){var r="project",n=e.Get(r);n||(r="slide",n=e.Get(r)),o=r+"!"+n+":"+o}var s=t.GetS(o,null,e);if(s.response&&(s=s.response),!(s=(s=s&&s.paths||[])[0]||null))return i;for(var a=0,_=null,l=0;(_=s[a++])&&(null!=i[_.type]||(i[_.type]=_.uid,5!=++l)););return i},ExtendHeadByJS:function(t,e){var i=arguments[2]||window.top,o=arguments[3]||null,r=i.document,n=r.getElementsByTagName("head")[0],s=null;if(n){if((s=$$("script",r)).setAttribute("type","text/javascript"),o&&s.setAttribute("name",o),t)s.setAttribute("src",t),s.async=!0,s.defer=!0;else if(e)try{s.innerHTML=e}catch(a){s.text=e}n.appendChild(s)}return s},ExtendHeadByJSList:function(t,e){if(t.length){var i=e.document,o=i.getElementsByTagName("head")[0],r=$$("script",i);r.setAttribute("type","text/javascript"),r.setAttribute("src",t.shift()),r.async=!0,r.defer=!0,r.onload=function(){WCT.ExtendHeadByJSList(t,e)},o.appendChild(r)}},ExtendHeadByCSS:function(t,e){var i=arguments[2]||window.top,o=arguments[3]||null,r=i.document,n=r.getElementsByTagName("head")[0],s=null;if(n)if(t)r.createStyleSheet?(s=WCT.dom.CreateElementMSIE("style","text/css",null,r),n.appendChild(s),(a=r.styleSheets[r.styleSheets.length-1]).addImport(t)):((s=r.createElement("link")).type="text/css",s.rel="stylesheet",s.href=t,o&&s.setAttribute("name",o),n.appendChild(s));else if(e&&e.length){var a;if((s=r.createElement("style")).setAttribute("type","text/css"),o&&s.setAttribute("name",o),n.appendChild(s),(a=r.styleSheets[r.styleSheets.length-1]).insertRule)for(var _=e.length-1;0<=_;_--){var l=e[_].selector+"{"+e[_].rule+"}";a.insertRule(l,0)}else if(a.addRule)for(_=e.length-1;0<=_;_--)a.addRule(e[_].selector,e[_].rule,0)}return s},ArabicToRoman:function(t){if(0<t&&t<8e3){var e=Math.floor(t/1e3);t%=1e3;var i=Math.floor(t/100);t%=100;var o=Math.floor(t/10);return["","M","MM","MMM","MMMM","MMMMM","MMMMMM","MMMMMMM"][e]+["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM"][i]+["","X","XX","XXX","XL","L","LX","LXX","LXXX","XC"][o]+["","I","II","III","IV","V","VI","VII","VIII","IX"][t%=10]}return t+""},ArabicToLetters:function(t){for(var e="";27<=t;){var i=Math.floor(t/27);e+=String.fromCharCode(i+64),t%=26}return e+=String.fromCharCode(t+64)},GetTimeZoneOffset:function(){var t=(new Date).getTimezoneOffset().toString();return arguments[0]?t:"-"===t.substr(0,1)?t.substr(1):"-"+t},ConvertUTCToLocal:function(t){var e=WCT.GetTimeZoneOffset(arguments[1]),i=new Date("July 05, 2017 "+t.time),o=i.getDay();i.setMinutes(i.getMinutes()+parseInt(e));var r=i.getDay()-o,n=t.date,s=!1;if(r&&n){n.isArray||(s=!0,n=[n]);for(var a=0,_=n.length;a<_;a++){var l,d,h=n[a];if(~h.search("/")){var c=h.split("/");if(isNaN(parseInt(c[1])))continue;l=c[0],h=c[1],d=c[2]}else if(isNaN(parseInt(h)))continue;switch(t.pattern){case"weekly":0===(h=parseInt(h)+r)&&(h=7),8===h&&(h=1);break;case"monthly":h=parseInt(h)+r,l&&(0===h&&(h=7),8===h&&(h=1));break;case"yearly":if(d)h=parseInt(h)+r;else{var p=(new Date).getFullYear(),u=new Date(p,parseInt(l)-1,parseInt(h)+r);l=u.getMonth()+1,h=u.getDate()}}if(t.learnerCert){var f=new Date(l+" "+h+", "+d+" "+t.time);f.setMinutes(f.getMinutes()+parseInt(e));function m(t){return(t.toString().length<2?"0":"")+t}return t.date=[f.getFullYear(),m(f.getMonth()+1),m(f.getDate())].join("-"),void(t.time=[m(f.getHours()),m(f.getMinutes()),m(f.getSeconds())].join(":"))}n[a]=(l?l+"/":"")+h,d&&(n[a]+="/"+d)}}var g=i.getHours(),y=i.getMinutes();g<10&&(g="0"+g),y<10&&(y="0"+y),t.time=g+":"+y,n&&(t.date=s?n[0]:n)},ConvertLocalToUTC:function(t){WCT.ConvertUTCToLocal(t,!0)},TimestampToTimeString:function(t){var e=new Date(t),i=arguments[1];e=e[i?"toLocaleTimeString":"toGMTString"]().split(" "),i||(e=e.splice(4,1));var o=t%1e3;return e[0]+"."+o},IsLanguageRTL:function(t){if(!t)return!1;var e=t.substr(0,2);return"ar"==e||"he"==e},IsEmptyObject:function(t){if("object"!=typeof t||!t)return!0;if(window.Object&&Object.keys)return 0===Object.keys(t).length;for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},DecToHex:function(t){if("number"!=typeof t)return t;for(var e={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},i="";t;){var o=t%16;i+=e[o]||o,t=Math.floor(t/16)}return"#"+i.split("").reverse().join("")},ToRGBColor:function(t){return"number"!=typeof t?t:"rgb("+(255&t)+", "+((65280&t)>>8)+", "+((16711680&t)>>16)+")"},RgbToHex:function(t){if(t.match(/^rgb\(.+,.+,.+\)$/)){for(var e=t.substring(4,t.length-1).split(","),i=[],o=0,r=e.length;o<r;o++){var n=Number(e[o].trim());if(isNaN(n))return t;var s=n.toString(16);s=1==s.length?"0"+s:s,i.push(s)}return"#"+i.join("")}return t.match(/^#[0-9A-Fa-f]+/)?t.toUpperCase():t},HexToRgb:function(t){var e=[];3==(t=t.substr(1).split("")).length?e.push(t[0]+t[0],t[1]+t[1],t[2]+t[2]):6==t.length&&e.push(t[0]+t[1],t[2]+t[3],t[4]+t[5]);var i=3==e.length?{r:parseInt(e[0],16),g:parseInt(e[1],16),b:parseInt(e[2],16),a:1}:{r:0,g:0,b:0,a:1},o=arguments[1];return"number"==typeof o&&0<=o&&o<=1?"rgba("+i.r+","+i.g+","+i.b+","+o+")":"rgb("+i.r+","+i.g+","+i.b+")"},RemoveHTMLTags:function(t){return t.replace(/(<([^>]+)>)/gi,"")},HTML_WHITELIST:{caption:1,categories:1,content_categories:1,keywords:1,context_id:1,roles:1,foreign_uid:1,da_context_id:1,description:1,shortdesc:1,g_linktextpraxis:1,bubbletext:1,explanation_d:1,explanation_p:1,bookdescription:1,slidetitle:1,slidedescription:1,chaptertitle:1,chapterdescription:1,quiz_correct_answers:1,da_info_desc:1},REGEX_JS_PROTOCOL:/("|')\s*?javascript\s*?:.*?\1/gi,REGEX_JS_PROTOCOL_SIMPLE:/(javascript\s*?:)/gi,REPLACEMAP:[{reg:/&/g,rep:"&amp;"},{reg:/</g,rep:"&lt;"},{reg:/>/g,rep:"&gt;"},{reg:/"/g,rep:"&quot;"},{reg:/'/g,rep:"&#x27;"},{reg:/\//g,rep:"&#x2F;"}],EncodeTagBrackets:function(t){if(!t||"string"!=typeof t)return t;for(var e=WCT.REPLACEMAP.slice(1,3),i=0,o=null;o=e[i++];)t=t.replace(o.reg,o.rep);return t},CleanupHTMLString:function(t){if(!t||"string"!=typeof t)return t;var e=arguments[1]||"";if(e&&0<=e.indexOf(".")&&(e=e.split(".")[1]),!WCT.HTML_WHITELIST[e])for(var i=WCT.REPLACEMAP,o=0,r=null;r=i[o++];)t=t.replace(r.reg,r.rep);return t},PreventXSS:function(t){return t?(t=this.RemoveEventHandler(t,arguments[1]),t=this.RemoveJavascriptCalls(t),t=this.RemoveIFrameJavascriptProtocol(t)):t},RemoveJavascriptCalls:function(t){function h(t){if(!(t=t.trim()))return"";var e="",i=0,o=!1,r=t.indexOf("(");if(-1===r)return"";for(t=t.substr(r);!o;){var n=t.charAt(0);if(!n)break;"("===n?(i++,e+=n):")"===n?(e+=n,0===--i&&(o=!0)):e+=n,t=t.substr(1)}return e}var c=t.match(this.REGEX_JS_PROTOCOL),p=this.REGEX_JS_PROTOCOL_SIMPLE;return t.replace(/<[^>]+/g,function(t){if(c)for(l=0;l<c.length;l++){var e=c[l],i=e.charAt(0),o=e.substr(0,e.length-1).substr(1);o.search(p);var r=RegExp.$1,n=(o=o.substr(r.length)).indexOf("ctx.cfg_show");if(-1===n)o="javascript:void(0);";else{0!==n&&(o=o.substr(n));var s=o.match(/\(.*\)/),a=s?h(s[0]):null;o=a?"javascript:ctx.cfg_show"+a+";":""}t=t.replace(e,i+o+i)}else{var _=t.match(p);if(_)for(var l=0,d=null;d=_[l++];)t=t.replace(d,'""')}return t})},RemoveEventHandler:function(t){for(var e=new RegExp(arguments[1]?"son[error|load]\\w+=('[^']*'|\"[^\"]*\"|\\S*)":"son\\w+=('[^']*'|\"[^\"]*\"|\\S*)","gi");0<=t.search(e);)t=t.slice(0,t.search(e)+2)+"&#8205;"+t.slice(t.search(e)+2);return t.replace(/<[^>]+/g,function(t){return t.replace(e,"")})},RemoveIFrameJavascriptProtocol:function(t){var e=new RegExp(/javascript:/gi);return t.replace(/<iframe[^>]+/gi,function(t){return t.replace(e,"")})}}),function(){function n(t){for(var e,i=t.length,o=new Array(i),r=i-1;0<=r;r--)e=t[r],o[r]="object"==typeof e&&e?e.isArray?n(e):s(e):e;return o}function s(t){var e,i={};for(var o in t)e=t[o],i[o]="object"==typeof e&&e?e.isArray?n(e):s(e):e;return i}WCT.DeepCopy=function(t){if("object"!=typeof t||!t)return t;var e,i=arguments[1];return"object"!=typeof i&&(i=null),t.isArray?(e=n(t),i&&i.isArray&&(e=e.concat(i))):(e=s(t),i&&!i.isArray&&WCT.ExtendObject(e,i)),e},WCT.FullDeepCopy=function(t){var e=arguments[1]||(t.isArray?[]:{});for(var i in t)"object"==typeof t[i]&&null!==t[i]?(e[i]=e[i]||(t[i].isArray?[]:{}),WCT.FullDeepCopy(t[i],e[i])):e[i]=t[i];return e},WCT.indexOfAtt=function(t,e,i){for(var o=0,r=t.length;o<r;o++)if(t[o][e]===i)return o;return-1},WCT.indexOfAttCase=function(t,e,i){if(!i)return-1;for(var o=0,r=t.length;o<r;o++){var n=t[o][e];if(n&&n.toLowerCase()===i.toLowerCase())return o}return-1}}(),function(){var c="WCT_HL_N_ID";function p(t){for(var e=t.childNodes,i=[],o=0,r=null;r=e[o++];)r.nodeType==WCT.dom.ELEMENT_NODE?i.push(p(r)):r.nodeType==WCT.dom.TEXT_NODE&&i.push(r.nodeValue);return i.join("")}function i(t){var e=t.getAttribute(c);return null!=e?Number(e):-1}function h(t){var e=i(t);return 0<=e&&t.childNodes[e]||null}function u(t){var e=i(t);return t.setAttribute(c,++e),t.childNodes[e]}function f(t){do{for(var e=u(t);e;){if(e.nodeType==WCT.dom.TEXT_NODE)return t;var i=f(e);if(i)return i;e=u(t)}t=t.parentNode}while(t);return null}function m(t,e){var i=e.length;do{if(!(t=f(t)))return null;var o=h(t).nodeValue.length;if(i<o)return{d:t,o:i};i-=o}while(i);return(t=f(t))?{d:t,o:0}:null}function g(t,e,i,o){var r=h(t),n=null,s=r.nodeValue;if(e){var a=$$2(s.substr(0,e));return n=$$2(s.substr(e)),t.replaceChild(n,r),t.insertBefore(a,n),u(t),g(t,0,i,o)}var _=$$("span");_.className=o;var l=s.length,d=i.length;if(l<=d){if(_.appendChild($$2(s)),t.replaceChild(_,r),l<d)return(t=f(t))?g(t,0,i.substr(l),o):null}else n=$$2(s.substr(d)),_.appendChild($$2(s.substr(0,d))),t.replaceChild(n,r),t.insertBefore(_,n);return t}WCT.HighlightHtmlString=function(t,e,i){if(!t)return t;var o=$$("div");o.innerHTML=t;for(var r=new RegExp(e,"i"),n=p(o),s=n.search(r),a=e.length,_=[];0<=s;)_.push(n.substr(0,s)),_.push(n.substr(s,a)),s=(n=n.substr(s+a)).search(r);if(!_.length)return t;var l=o;do{var d=m(l,_.shift());if(!d)return t;if(!(l=g(d.d,d.o,_.shift(),i)))return t}while(_.length);return function h(t){for(var e=0,i=t.childNodes,o=null;o=i[e++];)o.nodeType==WCT.dom.ELEMENT_NODE&&(o.removeAttribute(c),h(o))}(o),o.innerHTML},WCT.HasHtmlString=function(t,e){var i=$$("div");i.innerHTML=t;var o=new RegExp(e,"i");return 0<=p(i).search(o)}}(),function(){var h={Duration:"number",IconID:"number",BOOL_0_1:"boolean",BOOL_YES_NO:"boolean",BOOL_TRUE_FALSE:"boolean",INTEGER:"number",IMAGE_WH:"image_wh",RELPOS:"relpos",RELPOS_ELEMREF:"relpos",RELPOS_RECT:"relpos",SIZE:"size",POSSIZE:"possize",POSITION:"position"};WCT.ReverseTypedValue=function(t,e){switch(h[e]||e){case"boolean":return WCT.ReverseBoolean(t,e);case"relpos":case"relpos_rect":case"relpos_elemref":if(!t)return t;var i={};return t.frame&&(i.frame=WCT.DeepCopy(t.frame)),t.element&&(i.element=WCT.DeepCopy(t.element)),t.XY&&(i.posElement=WCT.DeepCopy(t.XY)),t.XY2&&(i.rectElement=WCT.DeepCopy(t.XY2)),t.DocXY&&(i.posDocument=WCT.DeepCopy(t.DocXY)),t.DocXY2&&(i.rectDocument=WCT.DeepCopy(t.DocXY2)),t.offsetX&&(i.offsetX=t.offsetX),t.offsetY&&(i.offsetY=t.offsetY),i;default:return t}},WCT.ClampTypedValue=function(t,e){var i=Context.Get("macroset"),o=e&&(h[e]||e).toLowerCase();switch(o){case"boolean":return WCT.ClampBoolean(t);case"duration":case"number":var r=parseFloat(t);return isNaN(r)?null:"duration"===o?Math.abs(r):r;case"image_wh":return{id:(t=t||{}).id||"",w:Number(t.w)||0,h:Number(t.h)||0};case"size":return null!=(t=t||{}).x||null!=t.y?{x:Number(t.x)||0,y:Number(t.y)||0}:{width:Number(t.width)||0,height:Number(t.height)||0};case"possize":return null!=(t=t||{}).x||null!=t.y||null!=t.cx||null!=t.cy?{x:Number(t.x)||0,y:Number(t.y)||0,cx:Number(t.cx)||0,cy:Number(t.cy)||0}:"standard"===i?{left:Number(t.left)||0,top:Number(t.top)||0,width:Number(t.width)||0,height:Number(t.height)||0}:{left:Number(t.left)||0,top:Number(t.top)||0,bottom:Number(t.bottom)||0,right:Number(t.right)||0};case"position":return null!=(t=t||{}).x||null!=t.y?{x:Number(t.x)||0,y:Number(t.y)||0}:{left:Number(t.left)||0,top:Number(t.top)||0};case"relpos":case"relpos_rect":case"relpos_elemref":var n={};(t=t?WCT.DeepCopy(t):{}).elem||(t.elem={id:""}),t.XY||(t.XY={x:0,y:0}),t.XY2||(t.XY2={x:0,y:0}),t.DocXY||(t.DocXY={x:0,y:0});var s="string"==typeof t.FP?t.FP:"";n.FP=s,(s=t.elem||null)?((s=WCT.DeepCopy(s)).idx=Number(s.idx)||0,s.subidx=Number(s.subidx)||0,n.elem=s):n.elem="";for(var a="RELPOS"!==e.toUpperCase()?["XY","XY2"]:["XY","DocXY"],_=0;_<2;_++){var l=a[_],d="XY2"===l?1:0;(s=t[l]||null)&&(n[l]={x:Number(s.x)||d,y:Number(s.y)||d})}return(s=t.Off||null)&&(n.Off={x:Number(s.x)||0,y:Number(s.y)||0}),t.frame&&(n.frame=WCT.DeepCopy(t.frame),n.FP=n.frame.path),(s=t.element)&&((s=WCT.DeepCopy(s)).elementIndex=Number(s.elementIndex)||0,s.subElementIndex=Number(s.subElementIndex)||0,n.element=s),t.posDocument&&(n.DocXY=WCT.DeepCopy(t.posDocument)),t.posElement&&(n.XY=WCT.DeepCopy(t.posElement)),t.rectElement&&(n.XY2=WCT.DeepCopy(t.rectElement)),t.rectDocument&&(n.DocXY2=WCT.DeepCopy(t.rectDocument)),"undefined"!=typeof t.offsetX&&(n.offsetX=Number(t.offsetX)||0),"undefined"!=typeof t.offsetY&&(n.offsetY=Number(t.offsetY)||0),n;case"debug":Log("WCT.ClampTypedValue: "+e)}return t}}(),WCT.timeout={d_:[],i_:null,n_:null,f_:[],r_:!0,ios_scroll_callback_:!1,Cleanup:function(){this.i_&&clearTimeout(this.i_),this.i_=null,this.n_=null,this.ios_scroll_callback_&&(this.ios_scroll_callback_=!1,window.removeEventListener("scroll",WCT.timeout.callback_)),this.d_=[],this.f_=[],this.r_=!0},Set:function(t,e){var i=WCT.uid.Generate(24,"TIME_"),o=(new Date).getTime();return this.d_.push({id:i,cb:t,scope:arguments[2],args:arguments[3],start:o,end:o+e,dur:e,r:arguments[4]}),this.start_(o,e),i},Clear:function(t){var e=this.d_.indexOfAtt(t,"id");0<=e&&this.d_.splice(e,1)},start_:function(t,e){e<=0&&(e=1),PLATFORM.IOS&&!this.ios_scroll_callback_&&(this.ios_scroll_callback_=!0,window.addEventListener("scroll",WCT.timeout.ios_scoll_));var i=t+e;this.i_?i<this.n_&&(clearTimeout(this.i_),this.i_=setTimeout(WCT.timeout.callback_,e),this.n_=i):(this.i_=setTimeout(WCT.timeout.callback_,e),this.n_=i)},callback_:function(){WCT.timeout.i_=null;for(var t=(new Date).getTime(),e=null,i=WCT.timeout.f_,o=0,r=null;r=WCT.timeout.d_[o];o++)r.end<=t?(r.r?(r.end+=r.dur,(!e||r.end<e)&&(e=r.end)):WCT.timeout.d_.splice(o--,1),i.push(r)):(!e||r.end<e)&&(e=r.end);WCT.timeout.r_&&i.length&&(WCT.timeout.r_=!1,setTimeout(WCT.timeout.fire_,1)),e&&(t=(new Date).getTime(),WCT.timeout.start_(t,e-t))},fire_:function(){var t=WCT.timeout.f_;if(t.length){for(;t.length;){var e=t.shift();if(e&&"function"==typeof e.cb&&e.cb){var i=typeof e.scope,o="object"!=i&&"function"!=i||!e.scope?null:e.scope;e.cb.apply(o,e.args||[])}}WCT.timeout.r_=!0}else WCT.timeout.r_=!0},ios_scroll_:function(){WCT.timeout.i_&&clearTimeout(WCT.timeout.i_),WCT.timeout.g_&&clearTimeout(WCT.timeout.g_),WCT.timeout.i_=null,WCT.timeout.g_=null,WCT.timeout.r_=!0,WCT.timeout.callback_()}},WCT.SetTimeout=function(t,e){return WCT.timeout.Set(t,e,arguments[2],arguments[3],!1)},WCT.SetInterval=function(t,e){return WCT.timeout.Set(t,e,arguments[2],arguments[3],!0)},WCT.ClearTimeout=function(t){WCT.timeout.Clear(t)},WCT.ClearInterval=function(t){WCT.timeout.Clear(t)},WCT.dom={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,DOCUMENT_NODE:9,SCROLLBAR_W:null,SCROLLBAR_H:null,isLink:function(t){for(;t;){if("a"===this.GetNodeName(t))return!0;t=t.parentNode}return!1},GetNodeName:function(t){return t&&t.nodeName?t.nodeName.toLowerCase():""},isNodeName:function(t,e){if(!t||!e)return!1;var i=this.GetNodeName(t);return e.isArray&&(e=e.map(function(t){return t.toLowerCase()})),e.isArray?0<=e.indexOf(i):i===e.toLowerCase()},CreateElementMSIE:function(t){var e=arguments[1]||null,i=arguments[2]||null,o=arguments[3]||document,r=null;if(BROWSER.IE&&BROWSER.VERSION<11){var n=null!=e?' type="'+e+'"':"",s=null!=i?' name="'+i+'"':"";try{r=$$("<"+t+n+s+">",o)}catch(a){try{r=$$(t,o),null!=e&&(r.type=e),null!=i&&(r.name=i)}catch(a){}}}else r=$$(t,o),null!=e&&(r.type=e),null!=i&&(r.name=i);return r},PreviousSibling:function(t){if(BROWSER.IE&&BROWSER.VERSION<9){for(var e=0,i=t.parentNode.childNodes,o=0,r=null;r=i[o];o++)if(t===r){e=o-1;break}return i[e]}return t.previousSibling},NextSibling:function(t){if(BROWSER.IE&&BROWSER.VERSION<9){for(var e=0,i=t.parentNode.childNodes,o=0,r=null;r=i[o];o++)if(t===r){e=o+1;break}return i[e]}return t.nextSibling},CreateInputElement:function(){var t=arguments[0]||"text",e=this.CreateElementMSIE("input",t,arguments[1],arguments[2]);return e||"text"==t||(e=this.CreateElementMSIE("input","text",arguments[1],arguments[2])),e},GetPosition:function(t){var e;if(PLATFORM.IOS&&"none"==t.style.display){var i=t.style.visibility;t.style.visibility="hidden",t.style.display="block",e=t.getBoundingClientRect(),t.style.display="none",t.style.visibility=i}else e=t.getBoundingClientRect();var o=t.ownerDocument,r=o.documentElement,n=r.clientLeft||o.body.clientLeft||0,s=r.clientTop||o.body.clientTop||0,a=e.left-n,_=e.top-s;if(arguments[1]){var l=o.defaultView||o.parentWindow;a+=l.pageXOffset||r.scrollLeft,_+=l.pageYOffset||r.scrollTop}if(arguments[2]){var d=this.GetPosition(arguments[2],arguments[1]);a-=d.left,_-=d.top}return{left:a,top:_}},RemoveCssTransition:function(t){this.CssTransition(t,"","0s"),arguments[1]&&(t.removeEventListener("webkitTransitionEnd",arguments[1],!1),t.removeEventListener("transitionend",arguments[1],!1),t.removeEventListener("oTransitionEnd",arguments[1],!1))},CssTransition:function(t){var e=arguments[1]||"",i=arguments[2]||"1s",o=arguments[3]||"ease",r=arguments[4]||"0s",n=arguments[5]||null;t.style.transitionProperty=e,t.style.transitionDuration=i,t.style.transitionTimingFunction=o,t.style.transitionDelay=r,t.style.MozTransitionProperty="transform"==e?"-moz-transform":e,t.style.MozTransitionDuration=i,t.style.MozTransitionTimingFunction=o,t.style.MozTransitionDelay=r,t.style.WebkitTransitionProperty="transform"==e?"-webkit-transform":e,t.style.WebkitTransitionDuration=i,t.style.WebkitTransitionTimingFunction=o,t.style.WebkitTransitionDelay=r,t.style.OTransitionProperty=e,t.style.OTransitionDuration=i,t.style.OTransitionTimingFunction=o,t.style.OTransitionDelay=r,n&&(t.addEventListener("webkitTransitionEnd",n,!1),t.addEventListener("transitionend",n,!1),t.addEventListener("oTransitionEnd",n,!1))},CssZoom:function(t,e){t.style.zoom=e},CssTransform:function(t,e,i,o,r){var n=e+"("+i+"px,"+o+"px,"+r+"px)";t.style.transform=n,t.style.msTransform=n,t.style.MozTransform=n,t.style.WebkitTransform=n,t.style.OTransform=n},CssTransformScale:function(t,e){var i="scale("+e+")";t.style.Transform=i,t.style.msTransform=i,t.style.MozTransform=i,t.style.WebkitTransform=i,t.style.OTransform=i;var o=(null!=arguments[2]?arguments[2]:"50%")+" "+(null!=arguments[3]?arguments[3]:"50%");t.style.TransformOrigin=o,t.style.msTransformOrigin=o,t.style.MozTransformOrigin=o,t.style.WebkitTransformOrigin=o,t.style.OTransformOrigin=o},CssTransformScaleString:function(t){var e="scale("+t+")",i=[];i.push("Transform:"+e),i.push("msTransform:"+e),i.push("MozTransform:"+e),i.push("WebkitTransform:"+e),i.push("OTransform:"+e);var o=(null!=arguments[2]?arguments[2]:"50%")+" "+(null!=arguments[3]?arguments[3]:"50%");return i.push("TransformOrigin:"+o),i.push("msTransformOrigin:"+o),i.push("MozTransformOrigin:"+o),i.push("WebkitTransformOrigin:"+o),i.push("OTransformOrigin:"+o),i.join(";")},ApplyBackgroundStyle:function(t,e){var i=e.gradient||"";switch(BROWSER.IE&&BROWSER.VERSION<9&&(i=""),i){case"gradient_0":case"gradient_45":case"gradient_90":case"gradient_135":case"gradient_180":case"gradient_225":case"gradient_270":case"gradient_315":case"gradient_1":var o=i.substr(9),r=180<=o?o-180:o+180,n=BROWSER.SAFARI?"-webkit-linear-gradient("+r+"deg, ":"linear-gradient("+o+"deg, ",s=e.background_color+", "+e.background_color2+")",a=arguments[2]||"";PLATFORM.IOS&&"select"===a||(t.style.background=n+s),t.style.backgroundColor=e.background_color;break;case"gradient_flat":default:t.style.backgroundColor=e.background_color||""}},ApplyShadowStyle:function(t,e){if(e.shadow_show){var i=e.shadow_h||0,o=e.shadow_v||0,r=e.shadow_blur||0,n=e.shadow_spread||0,s="number"==typeof e.shadow_trans?e.shadow_trans:100,a=WCT.HexToRgb(e.shadow_color||"#888888",s/100);t.style.boxShadow=i+"px "+o+"px "+r+"px "+n+"px "+a}},NotSelectable:function(t){var e=arguments[1]||!1,i=e?"text":"none",o=e?"off":"on";t.style.MozUserSelect=i,t.style.WebkitTouchCallout=i,t.style.WebkitUserSelect=i,t.style.KhtmlUserSelect=i,t.style.msUserSelect=i,t.style.OUserSelect=i,t.style.userSelect=i,t.setAttribute("unselectable",o),t.unselectable=!e},GetWindowHeight:function(){var t=arguments[0]||window;return t.innerHeight?t.innerHeight:t.document.documentElement.clientHeight||t.document.body.offsetHeight},GetWindowWidth:function(){var t=arguments[0]||window;return t.innerWidth?t.innerWidth:t.document.documentElement.clientWidth||t.document.body.offsetWidth},GetScrollbarWidth:function(){if(null==this.SCROLLBAR_W){var t=$$("div");arguments[0]&&(t.className=arguments[0]),t.style.height="100px",t.style.width="100px",t.style.overflow="scroll",t.style.visibility="hidden",t.style.position="absolute",t.style.top="0",t.style.left="0",document.body.appendChild(t),this.SCROLLBAR_W=100-t.clientWidth,this.SCROLLBAR_H=100-t.clientHeight,document.body.removeChild(t)}return this.SCROLLBAR_W},GetScrollbarHeight:function(){if(null==this.SCROLLBAR_H){var t=$$("div");arguments[0]&&(t.className=arguments[0]),t.style.height="100px",t.style.width="100px",t.style.overflow="scroll",t.style.visibility="hidden",t.style.position="absolute",t.style.top="0",t.style.left="0",document.body.appendChild(t),this.SCROLLBAR_W=100-t.clientWidth,this.SCROLLBAR_H=100-t.clientHeight,document.body.removeChild(t)}return this.SCROLLBAR_H},HasVerticalScrollbar:function(t){return t.offsetHeight<t.scrollHeight},HasHorizontalScrollbar:function(t){return t.offsetWidth<t.scrollWidth},SwapNode:function(t,e){if(t.swapNode)t.swapNode(e);else{var i=$$("div");t.parentNode.replaceChild(i,t),e.parentNode.replaceChild(t,e),i.parentNode.replaceChild(e,i)}},IOSOpacitySwitch:function(t){if(PLATFORM.IOS&&t){var e=t.style.opacity;t.style.opacity=1==e?"0.999":"1",t.style.WebkitOverflowScrolling="touch"}},AndroidOpacitySwitch:function(t){if(PLATFORM.ANDROID&&t){t.style.opacity="0.999";t.offsetHeight;t.style.opacity="1"}},GetZoomLevel:function(){if(BROWSER.IE){if(BROWSER.VERSION<=7){var t=document.body,e=t.getBoundingClientRect();return Math.round((e.right-e.left)/t.clientWidth*100)}return Math.round(screen.deviceXDPI/screen.logicalXDPI*100)}if(null!=document.body.style.webkitTextSizeAdjust){if(null!=window.ontouchstart)return Math.round(document.documentElement.clientWidth/window.innerWidth*100);var i=$$("div");i.style.position="absolute",i.style.visibility="hidden",i.style.overflow="hidden",i.style.width=0,i.style.height=0,document.body.appendChild(i);var o=$$("div");o.style.overflow="visible",o.style.padding=0,o.style.width="1em",o.style.height="auto",o.style.WebkitTextSizeAdjust="none",o.style.font="100px/1em sans-serif",o.innerHTML="1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>0",i.appendChild(o);var r=Math.round(1e3/o.clientHeight*100);return document.body.removeChild(i),r}if(BROWSER.FIREFOX)return Math.ceil(100*window.devicePixelRatio);if(BROWSER.CHROME){var n=document.width,s=document.documentElement.clientWidth;return Math.round(100*(1+(n-s)/s))}return 100},SupportsHtml5Video:function(){if(document.createElement("video").canPlayType){var t=document.createElement("video"),e=t.canPlayType('video/ogg; codecs="theora, vorbis"');if(e)return"probably"==e?1:2;for(var i=["42E01E","58A01E","4D401E"],o=null,r=0,n=i.length;r<n;r++)if(o=t.canPlayType('video/mp4; codecs="avc1.'+i[r]+', mp4a.40.2"'))return"probably"==o?1:2}return 0},GetLatestTextNode:function(t){for(var e=t.childNodes,i=e.length-1;0<=i;i--){var o=e[i];if(o.nodeType==this.TEXT_NODE)return o;var r=this.GetLatestTextNode(o);if(r)return r}return null},GetFirstTextNode:function(t){for(var e=0,i=null,o=t.childNodes;i=o[e];e++){if(i.nodeType==this.TEXT_NODE)return i;var r=this.GetLatestTextNode(i);if(r)return r}return null},Empty:function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},TextContent:function(t){if(t.nodeType==this.TEXT_NODE)return t.textContent||t.nodeValue||"";if(t.textContent)return t.textContent;if(t.childNodes.length){for(var e="",i=t.childNodes,o=0,r=null;r=i[o];o++)e+=this.TextContent(r);return e}return""},GetNodeName:function(t){return t&&t.nodeName?t.nodeName.toLowerCase():""},GetComputedStyle:function(t,e,i){var o="";return e.getComputedStyle?(t.nodeType==WCT.dom.TEXT_NODE&&(t=t.parentNode),o=e.getComputedStyle(t,null).getPropertyValue(i)):t.currentStyle?o=t.currentStyle[i]:t.parentNode&&t.parentNode.currentStyle&&(o=t.parentNode.currentStyle[i]),o},IndexInParent:function(t){for(var e=t.parentNode.childNodes,i=0,o=null;o=e[i];i++)if(o==t)return i},InsertAfter:function(t,e){e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t)},AddClass:function(t,e){for(var i=1,o=null;i<arguments.length;i++)o=arguments[i],this.HasClass(t,o)||(t.className+=" "+o)},RemoveClass:function(t,e){var i=new RegExp("\\b"+e+"\\b","g");t.className=t.className.replace(i,"").replace(/\s\s/g," ").replace(/\s$/g,"")},HasClass:function(t,e){var i=["^","$|^"," | ","$| "," "].join(e);return new RegExp(i).test(t.className)},ToggleClass:function(t,e){this.HasClass(t,e)?this.RemoveClass(t,e):this.AddClass(t,e)},GetStyles:function(t){var e=t.getAttribute("style"),i={};if(e&&"object"==typeof e&&(e=e.cssText||null),"string"==typeof e)for(var o=(e=e.split(";")).length-1;0<=o;o--){var r=e[o].split(":"),n=r[0],s=r[1];"string"==typeof n&&"string"==typeof s&&(i[n.trim()]=s.trim())}return i},GetAttributes:function(t){for(var e=t.attributes,i={},o=!1,r=0,n=null;n=e[r];r++){var s=n.nodeValue;null!=s&&""!=s&&("style"==this.GetNodeName(n)&&(o=!0),i[n.nodeName.toLowerCase()]=s)}if(!o){var a=t.getAttribute("style");(a=a&&(a.cssText||null))&&(i.style=a)}return i},CreateFromHtml:function(t){var e=$$("div");return e.innerHTML=t,e.firstChild},RemoveFromDom:function(t){var e=t&&t.parentNode;return t&&e?(e.removeChild(t),null):t}},WCT.Transform={ConvertFontSizeToPx:function(t){switch(t){case"xx-small":case"1":return"11px";case"x-small":case"2":return"13px";case"small":case"3":return"16px";case"medium":case"4":return"19px";case"large":case"5":return"24px";case"x-large":case"6":return"32px";case"xx-large":case"7":return"48px";default:return null}},ConvertFontSizeToPt:function(t){switch(t){case"xx-small":case"1":return"8pt";case"x-small":case"2":return"10pt";case"small":case"3":return"12pt";case"medium":case"4":return"14pt";case"large":case"5":return"18pt";case"x-large":case"6":return"24pt";case"xx-large":case"7":return"36pt";default:return null}},ConvertPxToFontSize:function(t){return(t=parseInt(t))<12?"1":t<15?"2":t<18?"3":t<22?"4":t<28?"5":t<40?"6":40<=t?"7":null},IsValidSize:function(t){return!isNaN(parseInt(t))},IsWebkitSize:function(t){switch(t){case"xx-small":case"x-small":case"small":case"medium":case"large":case"x-large":case"xx-large":return!0;default:return!1}},ConvertPtToPx:function(t){return Math.min(80,Math.max(6,Math.ceil(1.3333333*parseInt(t))))+"px"}},WCT.address=function(t){this.is_external=!1,this.is_file=!1,this.src="",this.class_id=null,this.local_id=null,this.sub_class_id=null,this.sub_local_id=null,this.sub_path=null,"string"==typeof t?this.FromString(t):t&&"object"==typeof t&&this.CopyObject(t)},WCT.address.IsExternal=function(t){return!("/"!=t.charAt(0)&&!t.match(/^\\\\/)&&!t.match(/^(.|https?|ftps?|notes|file|tel|adt|mailto|javascript):/))},WCT.address.IsFile=function(t){return 0<=t.split(":").top().indexOf(".")},WCT.address.AddDownloadFlag=function(t){var e=t.split("."),i=1<e.length?e.top().toLowerCase():"";return-1===["html","htm","pdf"].indexOf(i)},WCT.address.prototype={CopyObject:function(t){this.is_external=t.is_external||!1,this.is_file=t.is_file||!1,this.src=t.src||"",this.class_id=t.class_id||null,this.local_id=t.local_id||null,this.sub_class_id=t.sub_class_id||null,this.sub_local_id=t.sub_local_id||null,this.sub_path=t.sub_path||null},FromString:function(t){if(this.src=t,WCT.address.IsExternal(t))this.is_external=!0;else{var e=t.split(":"),i=e.length,o=e.top();if(this.is_file=0<=o.indexOf("."),this.sub_path=o,1==i)2==(e=o.split("!")).length&&(this.class_id=e[0],this.local_id=e[1],this.sub_path=null);else if(2<=i){var r=e[0].split("!"),n=r.length;if(1==n){var s=WCT.context.TCLASS_SHORTCUTS,a=e[0];for(var _ in this.class_id=a,s)if(a.isPrefix(s[_])){this.class_id=_,this.local_id=a;break}}else 2==n&&(this.class_id=r[0],this.local_id=r[1]);if(3==i){var l=e[1].split("!"),d=l.length;0<d&&(this.sub_class_id=l[0],2==d&&(this.sub_local_id=l[1]))}}if("macro"==this.class_id)this.class_id="project",this.sub_class_id="macro",this.sub_local_id=this.local_id,this.local_id=null;else if("book"===this.class_id&&this.sub_path&&0===this.sub_path.search("slide!"))this.sub_class_id="slide",this.sub_local_id=this.sub_path.replace("slide!",""),this.sub_path=null;else if("project"===this.class_id&&this.sub_path&&-1!==this.sub_path.search("#")){var h=this.sub_path.split("#");this.sub_path=h[0],this.sub_local_id=h[1]}}},AsUrl:function(){if(this.is_external)return this.src;var t=[];return this.class_id&&(t.push(this.class_id),this.local_id&&t.push(this.local_id)),this.sub_class_id&&(t.push(this.sub_class_id),this.sub_local_id&&t.push(this.sub_local_id)),this.sub_path&&t.push(this.sub_path),"/"+t.join("/")},AsString:function(){if(this.is_external)return this.src;var t="";return this.class_id&&(t+=this.class_id,this.local_id&&(t+="!"+this.local_id)),this.sub_class_id&&(t.length&&(t+=":"),t+=this.sub_class_id,this.sub_local_id&&(t+="!"+this.sub_local_id)),this.sub_path&&(t.length&&(t+=":"),t+=this.sub_path),!this.sub_class_id&&"project"===this.class_id&&this.sub_local_id&&(t+="#"+this.sub_local_id),t},AsObject:function(){if(this.is_external)return null;var t={tclass:this.class_id,uid:this.local_id};return arguments[0]&&arguments[0][this.sub_path]?t.mode=this.sub_path:this.sub_path&&(t.fileName=this.sub_path),t}},WCT.context=function(){this.atts_={},this.sbase_="",this.base_="",this.protocol_="file",this.this_="",this.st_="/",this.features_=null;var t=arguments[0];if(t&&"object"==typeof t){for(var e in t.atts_)this.atts_[e]=t.atts_[e];this.sbase_=t.sbase_,this.base_=t.base_,this.protocol_=t.protocol_,this.this_=t.this_}else{var i=document.getElementsByTagName("BASE");i&&i[0]&&(this.base_=i[0].href,this.check_base_(),this.sbase_=this.base_)}},WCT.ExtendObject(WCT.context,{PROTOCOLS:{http:!0,https:!0,res:!0,file:!0},TCLASS_SHORTCUTS:{slide:"SL_",project:"PR_",group:"GR_",book:"BO_",cdoc:"CD_",da:"DA_",media:"M_"},RemoveImgIds:function(t){var e=$$("div");e.style.display="none",e.style.visibility="hidden",e.innerHTML=t.replace(/<img([^>]*) src=/gi,"<img$1 data-dgo-src=");for(var i=e.getElementsByTagName("img"),o=0,r=null;r=i[o++];)r.id="";return e.innerHTML.replace(/<img([^>]*)  data-dgo-src=/gi,"<img$1 src=")}}),WCT.context.prototype={Destructor:function(){return this.atts_=null},Stringify:function(){return JSON.stringify({atts:this.atts_,sbase:this.sbase_,base:this.base_,proto:this.protocol_,scope:this.this_,st:this.st_})},Parse:function(t){t=JSON.parse(t),this.atts_=t.atts,this.sbase_=t.sbase,this.base_=t.base,this.protocol_=t.proto,this.this_=t.scope,this.st_=t.st},SetBase:function(t){var e=t.split(":")[0];this.protocol_=WCT.context.PROTOCOLS[e]?e:"file",t=t.replace(/\/$/,""),this.base_=t;var i=WCT.context.TCLASS_SHORTCUTS;for(var o in i)if(i.hasOwnProperty(o)){var r=new RegExp("[/|\\\\]+"+o+"[/|\\\\]+"+i[o]),n=t.search(r);if(0<n){this.base_=t.substr(0,n),this.this_=o,r=new RegExp("[/|\\\\]+.*$"),t=t.substr(n+2+o.length).replace(r,""),this.atts_[o]=t;break}}this.check_base_(),this.sbase_=this.base_},SetServerBase:function(t){var e=this.base_;e&&(t=t.replace(/\/$/,"").replace(/[\/\\]/g,this.st_),e.indexOf(t)||(this.sbase_=t))},SetSlashType:function(t){this.st_=t},GetSlashType:function(){return this.st_},Get:function(t){return this.atts_?this.atts_[t]:null},GetScope:function(){return this.this_},GetBase:function(){return this.base_},GetServerBase:function(){return this.sbase_},GetProtocol:function(){return this.protocol_},SetScope:function(t){this.this_=t},Set:function(t,e){this.atts_[t]=e},SetFeature:function(t){this.features_=t},HasFeature:function(t){return-1<this.features_.indexOf(t)},Resolve:function(t){if(!t)return t;var e=this.atts_;for(var i in e){var o=new RegExp("^"+i+":","g"),r=0<=e[i].indexOf("!")?e[i]:i+"!"+e[i];t=t.replace(o,r+":")}return t},Expand:function(t){var e=new WCT.address(t);if(e.is_external)return e;e.class_id||("macro"==this.this_||"tourstop"==this.this_?(e.class_id="project",e.sub_class_id||(e.sub_class_id=this.this_)):e.class_id=this.this_);var i=this.atts_;if(!e.local_id&&i[e.class_id])if(0<=i[e.class_id].indexOf("!")){var o=i[e.class_id].split("!");e.class_id=o[0],e.local_id=o[1]}else e.local_id=i[e.class_id];return!e.sub_local_id&&i[e.sub_class_id]&&(e.sub_local_id=i[e.sub_class_id]),e},ToEntityPath:function(){var t=this.Expand("");t.sub_path=arguments[0]||"";var e=this;return t.sub_class_id&&(e=new WCT.context(this)).SetScope(t.class_id),t.class_id="",{entity_path:e.ToAbsPath(""),sub_path:e.ToRelPath(t.AsString())}},ToRelPath:function(t){t=t.replace(/:\//g,"**/"),t=this.Resolve(t).replace(/:\/([^\/]+)/g,"/$1").replace(/:\\([^\\]+)/g,"/$1").replace(/:([^\/]+)/g,"/$1").replace(/:([^\\]+)/g,"/$1").replace(/!/g,"/");var e=this.st_;return-1!=t.indexOf(":")&&(t=".."+e+".."+e+t),t=t.replace(/\*\*\//g,":/").replace(/[\/\\]/g,e)},ToAbsPath:function(t){var e=!1;t.indexOf("mgr:")||(t=t.substr(4),e=!0);var i=new WCT.address(t.replace(/\\/g,"/"));if(!e&&i.is_external)return t;var o=i;if(!e)if(arguments[1]){var r=WCT.DeepCopy(arguments[1]),n=this.atts_;for(var s in n)null==r.Get(s)&&r.Set(s,n[s]);o=r.Expand(i)}else o=this.Expand(i);var a=this.st_,_=o.AsUrl().replace(/[\/\\]/g,a);return e?(new RegExp("^"+a+"(ou|group|user)").exec(_)&&(_=a+"!"+_),this.sbase_+_):this.base_+this.escape_(_)},ResolveHtmlString:function(t,e){if(!t)return t;var i=$$("div");i.style.display="none",i.style.visibility="hidden";var o=this.ToAbsPath("trainer:1.gif"),r=t.match(/background-image: *url\(.*?\)/gi),n=[];if(r){for(var s=0,a=null;a=r[s];s++){var _=/url\((.*?)\)/.exec(a)[1]||"",l=_.charAt(0);'"'!=l&&"'"!=l||(_=_.substr(1,_.length-2)),n.push(this.ToAbsPath(unescape(_),e))}t=t.replace(/background-image: *url\((.*?)\)/gi,"background-image:url("+o+")")}i.innerHTML=t.replace(/<(img|video)([^>]*) src=/gi,"<$1$2 data-dgo-src=").replace(/<video([^>]*) poster=/gi,"<video$1 data-dgo-poster=");for(var d=i.getElementsByTagName("img"),h=(s=0,null);h=d[s++];){var c=h.getAttribute("data-dgo-src")||"";WCT.address.IsExternal(c)||h.setAttribute("data-dgo-src",this.ToAbsPath(unescape(c),e)),h.id||(h.id="img_"+Math.random().toString().substr(2,10))}for(var p=i.getElementsByTagName("video"),u=(s=0,null);u=p[s++];){c=u.getAttribute("data-dgo-src")||"";WCT.address.IsExternal(c)||u.setAttribute("data-dgo-src",this.ToAbsPath(unescape(c),e));var f=u.getAttribute("data-dgo-poster")||"";f&&!WCT.address.IsExternal(f)&&u.setAttribute("data-dgo-poster",this.ToAbsPath(unescape(f),e))}for(var m=i.getElementsByTagName("a"),g=(s=0,null);g=m[s++];){var y=g.getAttribute("href")||g.getAttribute("data-dgo-href")||"";if(y){if(y.indexOf("javascript:void(0)")<0){if(y.indexOf("ctx.cfg_show")<0)if(0<=y.indexOf("mailto:"))y='javascript:ctx.cfg_show("'+unescape(y)+'", null, null);';else{if(WCT.address.IsExternal(y)){g.setAttribute(g.getAttribute("href")?"href":"data-dgo-href",unescape(y));continue}y='javascript:ctx.cfg_show("'+this.ToAbsPath(unescape(y),e)+'", null, null);'}else{var b=y.lastIndexOf(")"),v=y.substring(24,b);b=v.indexOf(v.charAt(0),1);var x=(v=v.substring(1,b)).length;y='javascript:ctx.cfg_show("'+(v=WCT.address.IsExternal(v)?unescape(v):e?e.Expand(unescape(v)).AsString():this.Expand(unescape(v)).AsString())+'"'+y.substr(x+26)}y=(y=y.replace(/\[/g,"%5B").replace(/\]/g,"%5D")).replace(/ctx\.cfg_show\(\'trigger!/,"Page.RTFireTrigger('"),g.setAttribute("href","javascript:void(0);"),g.setAttribute("onclick",y)}}else g.setAttribute("href","javascript:void(0);")}for(var w=i.getElementsByTagName("span"),C=(s=0,null);C=w[s++];){var T=C.getAttribute("gloss_id");if(T){var S='ctx.cfg_show("action!glossref:#1", null, null, event);'.replace(/#1/,T),k="onclick";PLATFORM.IOS&&(k="ontouchend",S+="event.preventDefault();"),C.setAttribute(k,S),C.style.cursor="help"}}var E=(E=i.innerHTML).replace(/<img([^>]*) data-dgo-src=/gi,"<img$1 src=").replace(/<video([^>]*) data-dgo-src=/gi,"<video$1 src=").replace(/<video([^>]*) data-dgo-poster=/gi,"<video$1 poster="),R=new RegExp("background-image: *url\\(.?"+o+".?\\)","i");for(s=0,a=null;a=n[s];s++)E=E.replace(R,"background-image:url("+a+")");return E},ExpandHtmlString:function(t){var e=document.createElement("DIV");e.style.display="none",e.style.visibility="hidden",e.innerHTML=t.replace(/<(img|video)([^>]*) src=/gi,"<$1$2 data-dgo-src=").replace(/<video([^>]*) poster=/gi,"<video$1 data-dgo-poster=").replace(/<a([^>]*) href=/gi,"<a$1 data-dgo-href=");for(var i=e.getElementsByTagName("img"),o=0,r=null;r=i[o];o++){var n=r.getAttribute("data-dgo-src");n&&!WCT.address.IsExternal(n)&&r.setAttribute("data-dgo-src",this.Expand(n).AsString())}for(var s=e.getElementsByTagName("a"),a=(o=0,null);a=s[o];o++){var _=a.getAttribute("data-dgo-href");_&&a.setAttribute("data-dgo-href",this.Expand(_).AsString())}return e.innerHTML.replace(/<(img|video)([^>]*) src=/gi,"<$1$2 data-dgo-src=").replace(/<video([^>]*) data-dgo-poster=/gi,"<video$1 poster=").replace(/<a([^>]*) data-dgo-href=/gi,"<a$1 href=")},OpenFile:function(t){var e=window.location.href;-1<e.indexOf("#")&&(e=e.substring(0,e.indexOf("#")));var i=e.lastIndexOf("/"),o=t.split("?"),r=WCT.address.AddDownloadFlag(o[0]);if(t=o[0]+(r?"?download=1":"")+(o[1]?(r?"&":"?")+o[1]:""),0<=i){var n=WCT.uid.Generate(16),s=this.sbase_;window[n]=[(arguments[1]?s:this.base_)+"/"+t.replace(/^\//,""),Env.Localize("openFileLinkMessageTitle"),Env.Localize("openFileLinkMessage"),Env.Localize("openFileLinkHeadline")].join(";;;");var a=s+"/resources/open_file.html?id="+n;window.open(a)}else window.open(t)},ExpandSlideControl:function(t){t.image&&t.image.id?(t.image.id=this.Expand(t.image.id).AsString(),t.image_mouseover&&t.image_mouseover.id&&(t.image_mouseover.id=this.Expand(t.image_mouseover.id).AsString()),t.image_mousedown&&t.image_mousedown.id&&(t.image_mousedown.id=this.Expand(t.image_mousedown.id).AsString())):t.background_image&&t.background_image.id?t.background_image.id=this.Expand(t.background_image.id).AsString():t.src?t.src=this.Expand(t.src).AsString():t.text?t.text=this.ExpandHtmlString(t.text):t.pagesound&&(t.pagesound=this.Expand(t.pagesound).AsString())},escape_:function(t){if(-1==(t=escape(t)).search("%u"))return t;for(var e=t.split("%"),i=1,o=e.length;i<o;i++)"u"==e[i].charAt(0)?e[i]=unescape("%"+e[i]):e[i]="%"+e[i];return e.join("")},check_base_:function(){this.base_=this.escape_(this.base_.replace(/\\/g,"/")).replace(/%3A/g,":"),"file"==this.protocol_&&(":"==this.base_.charAt(1)?this.base_="file:///"+this.base_:"//"==this.base_.substr(0,2)&&(this.base_="file:"+this.base_)),this.base_=this.base_.replace(/[\/\\]/g,this.st_)}},WCT.Placeholder=function(){this.context_=arguments[0]||new WCT.context,this.env_=arguments[1]||{};var t=arguments[2]||{};this.config_={edit_mode:!!t.edit_mode},this.data_={}},function(){function p(t,e,i,o){t[e]="string"==typeof i?i:o}WCT.Placeholder.GetParamList=function(t,e,i){for(var o=["group","book","slide","cdoc","project","da","media"],r=t.GetEntityList?t.GetEntityList(e):{},n=!!i.edit_mode,s={},a=0,_=null;_=o[a++];){var l=r[_]||null,d={};if(l){var h=_+"!"+l;d=(d=t.GetS(h+":entity.txt"))||{}}var c=n?null:"";p(s,_+":.uid",l,c),p(s,_+":.tclass",d.tclass,c),p(s,_+":.caption",d.caption,c),p(s,_+":.shortdesc",d.shortdesc,c),p(s,_+":.description",d.description,c)}return s}}(),WCT.Placeholder.Resolve=function(t){if(!t)return t;var e,i=new WCT.context(arguments[1]),o=arguments[2]||{},r=arguments[3]||{},n=WCT.Placeholder.GetParamList(o,i,r);WCT.ExtendObject(n,r.param_list||{});for(var s=["group","book","cdoc","project","chapter","da","media"];e=s.shift();){var a=n[e+":.uid"],_="chapter"==e?n["chapter:.tclass"]||"group":e;if(a&&_){i.Set(_,a),i.SetScope(_);var l=e+":.shortdesc";n[l]&&(n[l]=i.ExpandHtmlString(n[l])),n[l=e+":.description"]&&(n[l]=i.ExpandHtmlString(n[l])),"chapter"==e&&n.chapterdescription?n.chapterdescription=i.ExpandHtmlString(n.chapterdescription):"book"==e&&n.bookdescription&&(n.bookdescription=i.ExpandHtmlString(n.bookdescription))}}var d=new WCT.Placeholder(arguments[1],o,r);return d.SetList(n),t=d.Resolve(t,i),i.Destructor(),d.Destructor(),t},WCT.Placeholder.prototype=function(){function resolve_(key,ctx,skip){var cfg=this.config_,env=this.env_,rex=/(\w+)(!(\w+))?:\.(\w+)$/;rex.exec(key);var tclass=RegExp.$1,uid=RegExp.$2,att=RegExp.$4;"!"===uid.charAt(0)&&(uid=uid.substr(1));var ret="";if(!att||this.data_[key])ret=this.data_[key];else if(env.GetS||XHR.GetS){var addr=key.replace(/:\.(\w+)$/,":entity.txt");addr=ctx.Expand(addr),addr=addr.class_id&&addr.local_id?addr.AsString():null;var data=addr?env.GetS?env.GetS(addr):XHR.GetS(ctx.ToAbsPath(addr)):null;if(data&&"string"==typeof data)try{data=eval("("+data+")")}catch(e){data=null}ret=data&&data[att]||""}return"string"!=typeof ret&&(ret=cfg.edit_mode?null:""),uid&&ctx.Get(tclass)!==uid&&(ret=resolve_image_(ret,tclass,uid)),skip[key]={txt:ret},this.Resolve(ret,ctx,skip)}function resolve_image_(t,e,i){for(var o=/<img([^<>]+?)src=("|')(.+?)\2/gi,r=t.match(o)||[],n=0,s=r.length;n<s;n++){var a=r[n];-1===a.search(/\w+[:!]/)&&(t=t.replace(a,a.replace(o,"<img$1src=$2"+e+"!"+i+":$3$2")))}return t}return{Destructor:function(){this.context_=null,this.env_=null,this.config_=null,this.data_=null},SetList:function(t){var e=this.data_;for(var i in t)t[i]&&(e[i]=t[i]+"")},Resolve:function(t){if(!t)return t;for(var e=arguments[1]||this.context_,i=arguments[2]||{},o=[{x:"\\$%\\{([^\\}]*?)\\}"},{x:"\\$#\\{([^\\}]*?)\\}",t:"text"},{x:"\\$L[%]?\\{([^\\}]*?)\\}",t:"text"},{x:"\\$I\\{([^\\}]*?)\\}",t:"img"},{x:"\\$\\{([^\\}]*?)\\}"},{x:"\\$([a-zA-Z_]*?)\\$"}],r=0,n=null;n=o[r++];){var s=new RegExp(n.x,"g"),a=t.match(s);if(a)for(s=new RegExp(n.x),a=a.unique();a.length;){var _=a.shift(),l=s.exec(_)[1],d=i[l];if(d)d.txt&&(t=_replaceTxt(t,d.txt,_,n));else{var h=resolve_.call(this,l,e,i);null!==h&&(t=_replaceTxt(t,h,_,n))}}}return t}};function _replaceTxt(t,e,i,o){for(;0<=e.indexOf(i);)e=e.replace(i,"");e&&"img"===o.t&&(e='<img src="'+e+'" />');do{var r=t;0<=t.indexOf(i)&&(e=e.replace(/\$/g,"$$$$"),t=t.replace(i,"text"===o.t?WCT.CleanupHTMLString(e):e))}while(r!==t);return t}}(),WCT.skin=function(){function i(t,e,i,o){"number"!=typeof e?"-0"==e?t.style[o]="0":"string"==typeof e&&(t.style[i]=e):0<=e?t.style[i]=e+"px":t.style[o]=-e+"px"}function o(t,e,i){"number"==typeof e?t.style[i]=e+"px":"string"==typeof e&&(t.style[i]=e)}function r(t,e,i,o){var r=o||"",n=e.split("_");e=n[0];for(var s=1,a=n.length;s<a;s++)e+=n[s].toFirstUpperCase();t.style[e]=i+r}function e(t,e,i){if("number"==typeof t[e])return 2*t[e];for(var o=0,r=i.length-1;0<=r;r--){var n=Number(t[i[r]]);isNaN(n)||(o+=n)}return o}return{ConvertXToRtl:function(t){return"number"==typeof t?t?-t:"-0":"-0"==t?0:t},ApplyBgImage:function(t,e){var i=!e.repeat||"x"!=e.repeat&&"y"!=e.repeat?"no-repeat":"repeat-"+e.repeat;e.id&&(t.style.backgroundImage='url("'+e.id+'")'),t.style.backgroundPosition=(e.x||0)+"px "+(e.y||0)+"px",t.style.backgroundRepeat=i},ApplyPosition:function(t,e){"undefined"==typeof e.x&&"undefined"==typeof e.y&&"undefined"==typeof e.w&&"undefined"==typeof e.h||(t.style.position=e.pos||"absolute",i(t,e.x,"left","right"),i(t,e.y,"top","bottom"),o(t,e.w,"width"),o(t,e.h,"height"),arguments[2]||(t.style.fontSize="1px")),"undefined"!=typeof e.max_w&&o(t,e.max_w,"maxWidth"),"undefined"!=typeof e.min_w&&o(t,e.min_w,"minWidth"),"undefined"!=typeof e.max_h&&o(t,e.max_h,"maxHeight"),"undefined"!=typeof e.min_h&&o(t,e.min_h,"minHeight")},ApplyBorder:function(t,e){for(var i in e)switch(i){case"border":t.style.border=e[i];break;case"border_color":case"border_style":case"border_left":case"border_right":case"border_top":case"border_bottom":case"box_shadow":r(t,i,e[i]);break;case"border_width":case"border_radius":case"border_top_left_radius":case"border_top_right_radius":case"border_bottom_left_radius":case"border_bottom_right_radius":r(t,i,e[i],"px")}},ApplyPadding:function(t,e){for(var i in e)switch(i){case"padding":t.style.padding=e[i]+"px";break;case"padding_left":case"padding_top":case"padding_right":case"padding_bottom":r(t,i,e[i],"px")}},ApplyMargin:function(t,e){for(var i in e)switch(i){case"margin":t.style.margin=e[i]+"px";break;case"margin_left":case"margin_top":case"margin_right":case"margin_bottom":r(t,i,e[i],"px")}},ApplyTextFormats:function(t,e){for(var i in e)switch(i){case"font_family":case"font_variant":case"font_weight":case"text_align":case"background_color":case"white_space":case"text_overflow":case"text_decoration":case"overflow_x":case"overflow_y":r(t,i,e[i]);break;case"line_height":case"font_size":r(t,i,e[i],"px");break;case"text_color":t.style.color=e[i];break;case"overflow":t.style[i]=e[i]}},Apply:function(t,e){var i=arguments[2]||"image";this.ApplyPosition(t,e),e[i]&&this.ApplyBgImage(t,e[i]),this.ApplyBorder(t,e),this.ApplyPadding(t,e),this.ApplyMargin(t,e),this.ApplyTextFormats(t,e),e.cursor&&(t.style.cursor=e.cursor)},GetPaddingWidth:function(t){return e(t,"padding",["padding_left","padding_right"])},GetPaddingHeight:function(t){return e(t,"padding",["padding_top","padding_bottom"])},GetMarginWidth:function(t){return e(t,"margin",["margin_left","margin_right"])},GetMarginHeight:function(t){return e(t,"margin",["margin_top","margin_bottom"])},GetPaddingMargin:function(t){var e=arguments[1]||"",i=e+"padding",o=e+"margin",r=0,n=0;"number"==typeof t[i]?r=t[i]:"number"==typeof t.padding&&(r=t.padding),"number"==typeof t[o]?n=t[o]:"number"==typeof t.margin&&(n=t.margin);var s={padding:{l:r,r:r,t:r,b:r},margin:{l:n,r:n,t:n,b:n}},a=s.padding,_=s.margin,l={left:"l",right:"r",top:"t",bottom:"b",l:"l",r:"r",t:"t",b:"b"};for(var d in l){var h=l[d],c="padding_"+d,p=e+c,u="margin_"+d,f=e+u;"number"==typeof t[p]?a[h]=t[p]:"number"==typeof t[c]&&(a[h]=t[c]),"number"==typeof t[f]?_[h]=t[f]:"number"==typeof t[u]&&(_[h]=t[u])}return a.w=a.l+a.r,a.h=a.t+a.b,_.w=_.l+_.r,_.h=_.t+_.b,a.s=[a.t,a.r,a.b,a.l].join("px ")+"px",_.s=[_.t,_.r,_.b,_.l].join("px ")+"px",s},GetSpacingWidth:function(t){return e(t,"outer_spacing",["outer_spacing_l","outer_spacing_r"])},GetSpacingHeight:function(t){return e(t,"outer_spacing",["outer_spacing_t","outer_spacing_b"])},GetBorderWidth:function(t){if(t.border_style&&"none"!=t.border_style&&"number"==typeof t.border_width)return 2*t.border_width;if(t.border&&(3==(r=t.border.split(" ")).length&&"none"!=r[1]&&"number"==typeof(r=parseInt(r[0]))))return 2*r;for(var e=0,i=["left","right"],o=i.length-1;0<=o;o--){var r,n=t["border_"+i[o]];if(n)3==(r=n.split(" ")).length&&"none"!=r[1]&&"number"==typeof(r=parseInt(r[0]))&&(e+=r)}return e},GetBorderHeight:function(t){if(t.border_style&&"none"!=t.border_style&&"number"==typeof t.border_width)return 2*t.border_width;if(t.border&&(3==(r=t.border.split(" ")).length&&"none"!=r[1]&&"number"==typeof(r=parseInt(r[0]))))return 2*r;for(var e=0,i=["top","bottom"],o=i.length-1;0<=o;o--){var r,n=t["border_"+i[o]];if(n)3==(r=n.split(" ")).length&&"none"!=r[1]&&"number"==typeof(r=parseInt(r[0]))&&(e+=r)}return e},GetBorder:function(t){for(var e=t.border_w||0,i=t.border_color||"",o={l_w:e,l_c:i,r_w:e,r_c:i,t_w:e,t_c:i,b_w:e,b_c:i},r=["l","r","t","b"],n=0,s=null;s=r[n++];){var a="border_"+s+"_w",_="border_"+s+"_color";"number"==typeof t[a]&&(o[s+"_w"]=t[a]),"string"==typeof t[_]&&(o[s+"_c"]=t[_])}return o.w=o.l_w+o.r_w,o.h=o.t_w+o.b_w,o.ws=[o.t_w,o.r_w,o.b_w,o.l_w].join("px ")+"px",o.cs=[o.t_c,o.r_c,o.b_c,o.l_c].join(" "),o},Merge:function(t){var e=arguments[2]?t:WCT.DeepCopy(t),i=arguments[3]||!1,o=arguments[1],r=arguments[4]||!1;if(!o)return e;for(var n in o)"undefined"!=typeof e[n]?"object"==typeof o[n]?!o[n]||o[n].isArray?e[n]=o[n]:this.Merge(e[n],o[n],!0,i):e[n]=r?o[n]||e[n]:o[n]:i&&(e[n]=WCT.DeepCopy(o[n]));return e},ExtendUrls:function(t,e){var i=arguments[2];for(var o in t)t[o]&&"object"==typeof t[o]?this.ExtendUrls(t[o],e,i):"string"!=typeof t[o]||!t[o].match(/\.gif$/)&&!t[o].match(/\.png$/)||WCT.address.IsExternal(t[o])||(i&&(0<=t[o].indexOf("!")||0<=t[o].indexOf(":"))?t[o]=i.ToAbsPath(t[o]):t[o]=e+t[o])}}}(),WCT.event={Element:function(t){var e=t.target||t.srcElement;return e&&3==e.nodeType&&(e=e.parentNode),e},Button:function(t){if(null!=t.which)return t.which;if(null!=t.button)switch(t.button){case 1:return 1;case 4:return 2;case 2:return 3}return null},Cancel:function(t){if(!t&&!(t=window.event))return!1;if(t._orig_&&(t=t._orig_),BROWSER.IE&&("keydown"==t.type||"keyup"==t.type||"keypress"==t.type))try{t.keyCode=0}catch(e){}return t.cancelBubble=!0,t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),!1},Standardize:function(t){var e=arguments[1]||window;if(!(t=t||e.event))return null;var i=this.Element(t),o=this.Button(t);return{button:BROWSER.MOBILE||PLATFORM.WINCE?1:o,altKey:t.altKey||!1,clientX:t.clientX||0,clientY:t.clientY||0,ctrlKey:t.ctrlKey||!1,keyCode:t.which||t.keyCode||null,modifiers:t.modifiers,screenX:t.screenX,screenY:t.screenY,shiftKey:t.shiftKey||!1,target:i||null,targetName:WCT.dom.GetNodeName(i),targetType:i?i.nodeType:null,type:t.type||null,_orig_:t}},Observe:function(t,e){var i=arguments[2]||null,o=i||window,r=arguments[3]?o:i?i.nodeType==WCT.dom.ELEMENT_NODE?i:i.document||i:window.document||window,n=arguments[4]||!1;"function"==typeof o.addEventListener?o.addEventListener(t,e,n):"function"!=typeof r.attachEvent&&"object"!=typeof r.attachEvent||(r.attachEvent("on"+t,e),n&&r.setCapture())},StopObserving:function(t,e){var i=arguments[2]||null,o=i||window,r=arguments[3]||!1;try{var n=i?i.nodeType==WCT.dom.ELEMENT_NODE?i:i.document||i:window.document||window;"function"==typeof o.removeEventListener?o.removeEventListener(t,e,r):"function"!=typeof n.detachEvent&&"object"!=typeof n.detachEvent||(n.detachEvent("on"+t,e),r&&n.releaseCapture())}catch(s){}},CreateAndDispatchEvent:function(t,e,i){if(i){var o=null;if(window[t]&&!BROWSER.IE)o=new window[t](e,{view:window,bubbles:!0,cancelable:!0});else{var r="TouchEvent"==t?"initTouchEvent":"initMouseEvent";o=document.createEvent(t),"initMouseEvent"==r?o[r](e,!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null):o[r](e,!0,!0)}i.dispatchEvent(o)}},GetWheelDirection:function(t){return BROWSER.FIREFOX?0<t.detail?"down":"up":t.wheelDelta<0?"down":"up"}},WCT.event.hotkey={NATIONAL_KEY_CODES:{es_ES:{"Ñ":192,"Ç":191,"¡":221,"¿":221},nb:{"Ø":192,"Æ":222,"Å":221}},KEYS:{3:["break","rollen-feststell","pause_break"],8:["back"],9:["tab"],13:["enter"],16:["shift"],17:["ctrl"],18:["alt"],19:["pause"],20:["capslock"],27:["esc"],32:["space","blank"],33:["pgup"],34:["pgdown"],35:["end"],36:["home"],37:["left"],38:["up"],39:["right"],40:["down"],45:["ins"],46:["del"],48:["0"],49:["1"],50:["2"],51:["3"],52:["4"],53:["5"],54:["6"],55:["7"],56:["8"],57:["9"],59:[";"],61:[],63:[],65:["a"],66:["b"],67:["c"],68:["d"],69:["e"],70:["f"],71:["g"],72:["h"],73:["i"],74:["j"],75:["k"],76:["l"],77:["m"],78:["n"],79:["o"],80:["p"],81:["q"],82:["r"],83:["s"],84:["t"],85:["u"],86:["v"],87:["w"],88:["x"],89:["y"],90:["z"],91:["win","cmd"],92:["rwin"],93:["start","cmd"],96:["num0"],97:["num1"],98:["num2"],99:["num3"],100:["num4"],101:["num5"],102:["num6"],103:["num7"],104:["num8"],105:["num9"],106:["numx","*"],107:["numplus"],109:["numminus"],110:["numcomma"],111:["numdiv"],112:["f1"],113:["f2"],114:["f3"],115:["f4"],116:["f5"],117:["f6"],118:["f7"],119:["f8"],120:["f9"],121:["f10"],122:["f11"],123:["f12"],144:["numlock"],145:["roll"],171:[],173:[],186:[],187:["=","+"],188:[","],189:["-"],190:["."],191:["/"],192:["`"],219:["["],220:["\\","^"],221:["'","]","�"],222:[],226:["<"]},NONE_INPUT_KEYS:{pause:!0,esc:!0,f1:!0,f2:!0,f3:!0,f4:!0,f5:!0,f6:!0,f7:!0,f8:!0,f9:!0,f10:!0,f11:!0,f12:!0,numlock:!0}},function(){var t=WCT.event.hotkey.KEYS;t[186].push("_252"),t[191].push("_35"),t[192].push("_246"),t[219].push("_223"),t[222].push("_228"),t[222].push("_222"),BROWSER.IE||(t[59].push("_252"),t[61].push("+"),t[63].push("_223"),t[109].push("-"),t[171].push("+"),t[173].push("-"));var d={},s=!1,r={},n=!1,a=!1,_=t=null;function e(t){t=WCT.event.Standardize(t),WCT.event.hotkey.CancelBrowserHotkey(t);var e=WCT.event.hotkey.IsBackKey(t);return!(!WCT.event.hotkey.Fired(t)||e)||WCT.event.Cancel(t)}function l(){if(_){try{_.close()}catch(t){}_=null}}function h(t,e){var i=t||!1,o=e||!1;try{var r="left="+3*screen.availWidth+",top="+3*screen.availHeight+",width=10,height=10,fullscreen=false,location=false,menubar=false,titlebar=false",n=window.open("about:blank","_blank",o?r:"");n.focus(),setTimeout("try {top.focus()} catch(e) {}",100),setTimeout("try {top.focus()} catch(e) {}",250),setTimeout("try {top.focus()} catch(e) {}",500),setTimeout("try {top.focus()} catch(e) {}",750),i||n.close()}catch(s){}i&&(_=n,WCT.SetTimeout(l,750,this))}WCT.ExtendObject(WCT.event.hotkey,{SetIgnoreHotkey:function(t){a=t},CancelBrowserHotkey:function(t){if(!(!a||16<=t.keyCode&&t.keyCode<=18||!t.ctrlKey&&!t.altKey&&(t.keyCode<112||123<t.keyCode))){if(BROWSER.IE){if(!n){n=!0;for(var e=this.KEYS,i=65;i<=90;i++){var o=e[i],r=$$("A");r.id="access_key_"+o,r.href="#",r.accessKey=o,document.body.appendChild(r)}}36==t.keyCode&&t.altKey&&h(!0,!0),115==t.keyCode&&t.altKey&&h(BROWSER.IE8,!0),115==t.keyCode&&t.ctrlKey&&h(!BROWSER.IE8,BROWSER.IE8)}WCT.event.Cancel(t)}},Cleanup:function(){for(var t in d){for(var e=d[t].length-1;0<=e;e--)d[t][e].callback=null,d[t][e].scope=null;delete d[t].id_,delete d[t]}var i=this.KEYS;for(e=65;e<=90;e++){var o=$("access_key_"+i[e]);o&&o.parentNode.removeChild(o)}n=!1,l(),s=a=!1,r={}},Start:function(){WCT.event.Observe("keydown",e,arguments[0]),WCT.event.Observe("keyup",e,arguments[0])},Stop:function(){WCT.event.StopObserving("keydown",e,arguments[0]),WCT.event.StopObserving("keyup",e,arguments[0])},Observe:function(t,e,i,o){var r=0<=t.indexOf("shift_"),n=0<=t.indexOf("ctrl_"),s=0<=t.indexOf("cmd_"),a=0<=t.indexOf("alt_");t=t.replace(/shift_|alt_|ctrl_|cmd_/g,""),d[t]||(d[t]=[]),d[t].id_||(d[t].id_=0);var _="";r&&(_+="shift_"),n&&(_+="ctrl_"),s&&(_+="cmd_"),a&&(_+="alt_"),_+=t;var l=++d[t].id_;return d[t].push({id:l,type:e,callback:i,scope:o,shift:r,ctrl:n,alt:a,full:_}),l},StopObserving:function(t,e){t=t.replace(/shift_|alt_|ctrl_|cmd_/g,"");var i=d[t]||null;if(i){var o=i.indexOfAtt(e,"id");0<=o&&(i[o].callback=null,i[o].scope=null,i.splice(o,1)),i.length||(delete i.id_,delete d[t])}},Fired:function(t){var e=t.type.substr(3);if(!s){for(var i in d)if("ALL"!=i)for(var o=0,r=null;r=d[i][o++];)r.type==e&&this.IsKey(t,r.full)&&r.callback.call(r.scope,r.full,e,t,r.id);var n=d.ALL||null;if(n)for(o=0,r=null;r=n[o++];)r.type==e&&r.callback.call(r.scope,e,t,r.id)}return!t.hasToBeCancelled},GetKey:function(t){var e,i="";t.shiftKey&&(i+="shift_"),t.ctrlKey&&(i+="ctrl_"),t.cmdKey&&(i+="cmd_"),t.altKey&&(i+="alt_");var o=this.KEYS[t.keyCode];return e=o&&o.length?"_"==o[0].charAt(0)?String.fromCharCode(o[0].substr(1)-0):o[0]:String.fromCharCode(t.keyCode).toLowerCase(),(e=(i=i.split(e+"_").join(""))+e).replace(/shift|ctrl|cmd|alt/g,"").replace(/_{2,}/g,"").replace(/^_/,"")&&e},IsKey:function(t,e){var i="";t.shiftKey&&(i+="shift_"),t.ctrlKey&&(i+="ctrl_"),t.cmdKey&&(i+="cmd_"),t.altKey&&(i+="alt_");var o=this.KEYS[t.keyCode];if(!o||!o.length)return(s=String.fromCharCode(t.keyCode).toLowerCase())+"_"==i&&s==e||i+s==e;for(var r=0,n=null;n=o[r++];){var s;if((s="_"==n.charAt(0)?String.fromCharCode(n.substr(1)-0):n)+"_"==i&&s==e||i+s==e)return!0}return!1},IsBackKey:function(t){if(!this.IsKey(t,"back"))return!1;var e=t.targetName,i={text:1,password:1}[t.target.type];return"textarea"!==e&&("input"!==e||!i)},Suspend:function(t,e){if(e)r[t]=1,s=!0;else{delete r[t];var i=!0;for(var t in r){i=!1;break}i&&(s=!1)}}})}(),WCT.image_watcher={list_:{},external_:{},callbacks_:{},Cleanup:function(){for(var t in this.StopObserving(),this.list_){var e=$(t);e&&(e.onload=null,e.onerror=null)}this.list_={},this.external_={}},Remove:function(t){var e=$(t);e&&(e.onload=null,e.onerror=null),delete this.list_[t]},Add:function(t){return!!t.id&&(!!this.list_[t.id]||(this.list_[t.id]=!0,t.onload=function(){WCT.image_watcher.done_(this)},void(t.onerror=function(){WCT.image_watcher.done_(this)})))},AddExternal:function(t){this.external_[t]=!0},RemoveExternal:function(t){delete this.external_[t],this.done_()},AddImagesInside:function(t){var e=t.getElementsByTagName("img");if(e.length){for(var i=0,o=null;o=e[i];i++)this.Add(o);return!0}return!1},RemoveImagesInside:function(t){for(var e=t.getElementsByTagName("img"),i=0,o=null;o=e[i];i++)this.done_(o)},Observe:function(t,e){var i=WCT.uid.Generate(8,"IL_");return this.callbacks_[i]={f:t,s:e},this.is_loading_()||WCT.SetTimeout(WCT.image_watcher.done_,1,WCT.image_watcher),i},StopObserving:function(){var t=arguments[0],e=this.callbacks_;if(t)e[t]&&(e[t].f=null,e[t].s=null,delete e[t]);else{for(var t in e)e[t].f=null,e[t].s=null,e[t]=null;this.callbacks_={}}},done_:function(t){if(t&&t.id&&(delete this.list_[t.id],t.onload=null,t.onerror=null),!this.is_loading_()){var e=this.callbacks_;for(var i in e)e[i].f.call(e[i].s)}},is_loading_:function(){for(var t in this.list_)return!0;for(var t in this.external_)return!0;return!1}},function(){function t(t){this._fader=null,this._preview=null,this._dom=t}function s(){this._preview&&(this._preview.destructor(),this._preview=null)}function e(t){this._uid=t.uid,this._dom=t.dom,this._node=t.node,this._fader=null}function a(t){if((t=WCT.event.Standardize(t)).target){var e=t.target,i=new Image;i.src=e.src;var o=e.parentNode,r=i.width,n=i.height,s=.9*WCT.dom.GetWindowWidth(),a=.9*WCT.dom.GetWindowHeight();if(s<r||a<n){var _=s,l=n*(1-(r-_)/r);o.style.width=a<l?r*(1-(n-(l=a))/n)+"px":_+"px"}else e.style.width="",e.style.height="";delete i}}WCT.ExtendObject(t.prototype,{closePreview:s,showPreview:function i(t){if(!(t=WCT.event.Standardize(t)).target)return;this._dom=this._dom||document.body,(this._preview=new e({uid:WCT.uid.Generate(8),node:t.target,dom:this._dom})).createFrame(),WCT.event.Cancel(t)},setPreviewForTag:function _(t,e){for(var i=t.getElementsByTagName(e),o=this.showPreview.bind(this),r=0,n=null;n=i[r++];)n.getAttribute("data-zoomable")&&WCT.event.Observe("click",o,n);s.call(this)},setPreview:function o(t){var e=this.showPreview.bind(this);WCT.event.Observe("click",e,t)}}),WCT.ExtendObject(e.prototype,{destructor:function r(){this._fader&&(this._fader.Destructor(),this._fader=null);var t=$(this._uid+"#m");if(t){var e=t.querySelector("video");if(e){var i=this._node;i.currentTime=e.currentTime,e.paused||i.play()}t.parentNode.removeChild(t)}this._dom=null,this._node=null},createFrame:function l(){(function r(t){var e={callback_f:this.destructor,callback_s:this},i=new WCT.Fader(WCT.uid.Generate(8),{src:"",opacity:.33,iframe:!0,bgcolor:"#004990",z:10},e);i.Create(t),this._fader=i}).call(this,this._dom);var t=null,e=this._node,i=WCT.dom.GetNodeName(e),o=function n(t){var e=$$("div");return e.id=this._uid+"#m",e.className="wct-previewer-frame",e.style.zIndex=100,t.appendChild(e),e}.call(this,this._dom);switch(i){case"img":(t=$$("img")).style.width="100%",t.style.height="100%",WCT.event.Observe("load",a,t);break;case"video":(t=$$("video")).style.verticalAlign="top",t.controls=!0,e.paused||(e.pause(),t.autoplay=!0),t.addEventListener("canplay",function s(){t.removeEventListener("canplay",s),t.currentTime=e.currentTime})}o.appendChild(t),t.src=e.src}}),WCT.Previewer=new t(document.body)}(),WCT.Fader=function(t){this.uid_=t;var e=arguments[1]||{};this.config_={opacity:e.opacity||.3,bgcolor:e.bgcolor||"#000000",src:null!=e.src?e.src:"about:blank",cursor:e.cursor||"default",use_iframe:"boolean"!=typeof e.iframe||e.iframe,x:e.x||0,y:e.y||0,w:e.w||"",h:e.h||"",z:"number"==typeof e.z?e.z:1},this.connectors_=arguments[2]||{},WCT.Fader.STORE[t]=this},WCT.Fader.STORE={},WCT.Fader.Cleanup=function(){for(var t in WCT.Fader.STORE)WCT.Fader.STORE[t].Destructor()},WCT.Fader.prototype=function(){function n(t){var e=this.id.replace(/#cover$/,""),i=WCT.Fader.STORE[e];if(i){var o=i.connectors_;o.callback_f&&o.callback_f.call(o.callback_s)}}function s(t){var e=null;try{e=t.contentWindow.document.body}catch(i){}e&&(e.style.backgroundColor=this.config_.bgcolor)}return{Destructor:function(){delete WCT.Fader.STORE[this.uid_];var t=$(this.uid_);t&&t.parentNode.removeChild(t);var e=$(this.uid_+"#cover");e&&(e.onclick=null,e.ontouchend=null,e.parentNode.removeChild(e)),this.config_=null,this.connectors_=null},Create:function(t){if(!$(this.uid_)){var e=this.config_;"number"==typeof e.w&&(e.w+="px"),"number"==typeof e.h&&(e.h+="px");var i=PLATFORM.ANDROID&&!BROWSER.CHROME;if(e.use_iframe){var o=WCT.iframe.Create(e.src);o.id=this.uid_,o.tabIndex=-1,o.setAttribute("role","presentation"),o.className="wct-controls-fader frame",e.w&&(o.style.width=e.w||"100%"),e.h&&(o.style.height=e.h||"100%"),o.style.left=e.x+"px",o.style.top=e.y+"px",o.style.backgroundColor="#fff",o.style.opacity=e.opacity,o.style.zIndex=e.z,i||WCT.iframe.Load(o,s,this,t,[o])}var r=$$("div");r.id=this.uid_+"#cover",WCT.dom.AddClass(r,"wct-controls-fader","cover",arguments[1]||""),r.style.left=e.x+"px",r.style.top=e.y+"px",r.style.width=e.w||"100%",r.style.height=e.h||"100%",r.style.overflow="hidden",r.style.position="absolute",i||(r.style.backgroundColor="#fff"),r.style.opacity=e.opacity,r.style.cursor=e.cursor,r.style.zIndex=e.z,t.appendChild(r),this.connectors_.callback_f&&(BROWSER.MOBILE?(r.onclick=function(){},r.ontouchend=n):r.onclick=n)}},GetDim:function(){var t=$(this.uid_)||$(this.uid_+"#cover");return t?{w:t.offsetWidth,h:t.offsetHeight}:null},SetZIndex:function(t){var e=this.uid_,i=$(e);i&&(i.style.zIndex=t);var o=$(e+"#cover");o&&(o.style.zIndex=t)},Resize:function(t){var e=this.uid_,i=$(e);i&&(i.style.left=t.x+"px",i.style.top=t.y+"px",i.style.width=t.w+"px",i.style.height=t.h+"px");var o=$(e+"#cover");o&&(o.style.left=t.x+"px",o.style.top=t.y+"px",o.style.width=t.w+"px",o.style.height=t.h+"px")}}}(),WCT.state=function(t){this.hdl_=t,this.state_=null,this.states_={},this.events_={}},WCT.state.prototype={Destructor:function(){return this.Cleanup(),null},Cleanup:function(){if(this.hdl_=null,this.state_=null,this.events_=null,this.states_){for(var t in this.states_){for(var e in this.states_[t])this.states_[t][e].fun=null,this.states_[t][e].scope=null,delete this.states_[t][e];delete this.states_[t]}this.states_=null}},SetStartState:function(t){this.states_[t]&&(this.state_=t)},GetState:function(){return this.state_},AddState:function(t){for(var e=arguments.length-1;0<=e;e--)this.states_[arguments[e]]={}},AddEvent:function(t){for(var e=arguments.length-1;0<=e;e--)this.events_[arguments[e]]=1},AddTransition:function(t,e,i,o){var r=null,n=arguments[4]||null;if(n){r={};for(var s=n.length-1;0<=s;s--)r[n[s]]=1}if(this.events_[t])if("*"==e)for(var a in this.states_)this.states_[a][t]={fun:i||function(){},scope:o||null,dest:r};else this.states_[e]&&(this.states_[e][t]={fun:i||function(){},scope:o||null,dest:r})},Exec:function(t,e){var i=this.state_||null,o=(null!=i&&this.states_[i]||{})[t]||null;if(o){var r=o.fun.call(o.scope,i,e);if(null!=r&&this.states_[r]){if(o.dest&&!o.dest[r])throw new Error("INVALID STATE CHANGE!");this.state_=r}}}},WCT.transition={callback_:null,scope_:null,to_:null,Cleanup:function(){this.callback_=null,this.scope_=null,this.Clear()},Clear:function(){this.to_=null;var t=this.get_frame_();t&&(t.style.filter="",t.style.removeAttribute("filter")),this.callback_&&this.callback_.call(this.scope_),this.callback_=null,this.scope_=null},Set:function(t){var e=this.get_frame_();if(t&&e){var i=BROWSER.IE6?"":" progid:DXImageTransform.Microsoft.Matrix(M11=1,M22=1)";""==e.style.filter?e.style.filter=t+i:i&&e.style.filter.lastIndexOf(i)<0&&(e.style.filter+=i)}},Apply:function(){this.has_()&&this.get_frame_().filters[0].Apply()},Play:function(t,e){this.callback_=t,this.scope_=e;var i=this.get_dur_();this.to_=WCT.SetTimeout(WCT.transition.Clear,i,WCT.transition),this.has_()&&this.get_frame_().filters[0].Play()},Stop:function(){this.to_&&(WCT.ClearTimeout(this.to_),this.to_=null)},get_frame_:function(){var t=BROWSER.IE&&BROWSER.VERSION<10?document.documentElement:null;return t&&"unknown"!=typeof t.filters?t:null},get_dur_:function(){var t=this.get_frame_(),e=1;if(t&&t.filters&&t.filters[0]){var i=Number(t.filters[0].duration)||0;i&&(e=isNaN(i)?1e3:1e3*i)}return e},has_:function(){var t=this.get_frame_();return!!(t&&t.filters&&t.filters[0]&&""!=t.style.filter)}},WCT.Ease={None:function(t){return t},SineInOut:function(t){return-.5*(Math.cos(Math.PI*t)-1)},SineIn:function(t){return 1-Math.cos(t*Math.PI/2)},SineOut:function(t){return Math.sin(t*Math.PI/2)},QuadInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},QuadIn:function(t){return t*t},QuadOut:function(t){return-t*(t-2)},CubeIn:function(t){return t*t*t},CubeOut:function(t){return(t-=1)*t*t+1},CubeInOut:function(t){return(t*=2)<1?t*t*t/2:((t-=2)*t*t+2)/2},Bounce:function(t){for(var e=0,i=1;;){if((7-4*e)/11<=t)return-Math.pow((11-6*e-11*t)/4,2)+Math.pow(i,2);e+=i,i/=2}}},function(){WCT.uid={Generate:function c(){for(var t="number"==typeof arguments[0]?arguments[0]:_,e="string"==typeof arguments[1]?arguments[1]:l,i=arguments[3]?d:h,o=i.length,r=[],n=t;0<n--;){var s=Math.floor(Math.random()*o);r.push(i[s])}var a=e+r.join("");return arguments[2]?a.toUpperCase():a},CreateUniqueStringMap:function g(t){var e={},i=0,o={},r=null;for(var n in t)o[r=n]=n.length-1,i++;if(1==i)return e[r]=r.charAt(0),e;var s=0;for(;i;){var a={},_={},l=!0;for(var n in t){var d=n.charAt(s);o[n]==s&&(l=!1),a[d]||(a[d]=0),_[d]||(_[d]=[]),a[d]++,_[d].push(n)}s++;var h=!0;for(var d in a){if(h&&l&&a[d]==i){0;break}if(1==a[d]){n=_[d][0];e[n]=""!=d?d:n,delete t[n],i--,h=!1}else{var c={},p={},u=0;for(n=null;n=_[d][u];u++){""==(f=n.substr(s))?(e[n]=d,delete t[n],i--):(c[f]=n,p[f]=1)}for(var f in p=this.CreateUniqueStringMap(p)){n=c[f];var m=d+p[f];e[n]=m,delete t[n],i--}h=!1}}}return e}};var _=16,l="",d=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","a","b","c","d","e","f"],h=d.concat(["G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"])}(),WCT.POI=function(){var c={};return{Focus:{Simple:function(t,e){var i=null;t.x>e.w+e.x?i=t.x+t.w-e.w+WCT.dom.GetScrollbarWidth():t.x<e.x&&(i=t.x-t.w);var o=null;return t.y>e.h+e.y?o=t.y+t.h-e.h+WCT.dom.GetScrollbarHeight():t.y<e.y&&(o=t.y-t.h),{x:i,y:o}},Centered:function(t,e){return{x:t.x-(e.w>>1),y:t.y-(e.h>>1)}}},Animate:function(t,e,i,o,r){var n=arguments[5]||50,s=arguments[6]||function(){},a=arguments[7],_=arguments[8]||!1,l=i.x-e.x,d=i.y-e.y;if(l||d){if(PLATFORM.WINCE)return _?(t.style.left=i.x+"px",t.style.top=i.y+"px"):(t.scrollLeft=i.x,t.scrollTop=i.y),void s.call(a);var h=WCT.uid.Generate();return c[h]={uid:h,dom:t,start_x:e.x,start_y:e.y,end_x:i.x,end_y:i.y,delta_x:l/r,delta_y:d/r,type:o,time:r,interval:n,callback:s,scope:a,by_css:_,cur_time:0},WCT.SetTimeout(WCT.POI.animate_,n,WCT.POI,[h]),h}s.call(a)},StopAnimation:function(t){delete c[t]},animate_:function(t){var e=c[t];if(e)if((e.cur_time+=e.interval)>=e.time||arguments[1])delete c[t],e.by_css?(e.dom.style.left=e.end_x+"px",e.dom.style.top=e.end_y+"px"):(e.dom.scrollLeft=e.end_x,e.dom.scrollTop=e.end_y),e.callback.call(e.scope);else{var i=WCT.Ease[e.type](e.cur_time/e.time)*e.time,o=Math.round(e.delta_x*i),r=Math.round(e.delta_y*i),n=e.start_x+o,s=e.start_y+r;isNaN(n)||isNaN(s)?WCT.POI.animate_.call(WCT.POI,t,!0):(e.by_css?(e.dom.style.left=n+"px",e.dom.style.top=s+"px"):(e.dom.scrollLeft=n,e.dom.scrollTop=s),WCT.SetTimeout(WCT.POI.animate_,e.interval,WCT.POI,[t]))}}}}(),WCT.iframe={IFRAME_ID:"WCT_IFR",STORE:{},Cleanup:function(){if(arguments[0])(e=this.STORE[arguments[0]])&&(e.d=null,e.f=null,e.s=null,e.a=null,delete this.STORE[arguments[0]]);else for(var t in this.STORE){var e;(e=this.STORE[t]).d=null,e.f=null,e.s=null,e.a=null,delete this.STORE[t]}},Create:function(){var t=null,e=!!arguments[1],i=arguments[2]||"";if(BROWSER.IE&&(e||i)){var o=e?'allowTransparency="true"':"",r=i?[' id="','" name="','"'].join(i):"";if(BROWSER.VERSION<11)try{t=$$("<iframe "+o+r+">")}catch(n){t=$$("iframe"),e&&t.setAttribute("allowTransparency","true"),i&&(t.id=i,t.name=i)}}return t||(t=$$("iframe"),e&&t.setAttribute("allowTransparency","true"),i&&(t.id=i,t.name=i)),t.frameBorder="0",t.style.borderWidth="0",t.style.width="100%",t.style.height="100%",t.style.overflow="hidden",t.style.position="absolute",t.style.backgroundColor="transparent",arguments[0]&&(t.src=arguments[0]),t},Load:function(t,e,i){var o=WCT.uid.Generate(12,this.IFRAME_ID);this.STORE[o]={d:t,f:e,s:i,a:arguments[4]||[]},t.setAttribute(this.IFRAME_ID,o);var r=arguments[3]||document.body;BROWSER.IE&&BROWSER.VERSION<11?(r.appendChild(t),t.onreadystatechange=this.iframe_ready_):(t.onload=this.iframe_ready_,r.appendChild(t))},Eval:function(t,e){!e.eval&&e.execScript&&e.execScript("null"),e.eval&&e.eval(t)},iframe_ready_:function(){var t=this.getAttribute(WCT.iframe.IFRAME_ID),e=WCT.iframe.STORE[t];if(BROWSER.IE&&BROWSER.VERSION<11){try{if("complete"!=this.readyState)return;this.onreadystatechange=null,this.removeAttribute(WCT.iframe.IFRAME_ID)}catch(i){try{this.onreadystatechange=null,this.removeAttribute(WCT.iframe.IFRAME_ID)}catch(i){}}}else try{this.onload=null,this.removeAttribute(WCT.iframe.IFRAME_ID)}catch(i){}e&&e.f&&e.f.apply(e.s,e.a),WCT.iframe.Cleanup[t]}},WCT.geometry={IntersectRect:function(t,e){return e.x<=t.x+t.w&&e.x+e.w>=t.x&&e.y<=t.y+t.h&&e.y+e.h>=t.y},IncludesRect:function(t,e){return t.x<=e.x&&t.x+t.w>=e.x+e.w&&t.y<=e.y&&t.y+t.h>=e.y+e.h},ExciseRect:function(t,e){if(!this.IntersectRect(t,e))return[t];var i={x:Math.max(t.x,e.x),y:Math.max(t.y,e.y)};i.w=Math.min(t.x+t.w,e.x+e.w)-i.x,i.h=Math.min(t.y+t.h,e.y+e.h)-i.y;var o={x:t.x,y:t.y,w:t.w,h:i.y-t.y},r={x:t.x,y:i.y,w:i.x-t.x,h:i.h},n={x:i.x+i.w,y:i.y,w:t.x+t.w-i.x-i.w,h:i.h},s={x:t.x,y:i.y+i.h,w:t.w,h:t.y+t.h-i.y-i.h},a=r.w*r.h,_=n.w*n.h,l=s.w*s.h,d=[];return 0<o.w*o.h&&d.push(o),0<a&&d.push(r),0<_&&d.push(n),0<l&&d.push(s),d},ExciseRects:function(t,e){for(var i=[t];e.length&&i.length;){for(var o=e.shift(),r=[],n=i.length-1;0<=n;n--)r=r.concat(this.ExciseRect(i[n],o));i=r}return i},GetBiggestRect:function(t){for(var e=[],i=0,o=null;o=t[i];i++)e.push(o.w*o.h);if(e.length){var r=e.max();return t[e.indexOf(r)]}return null},CombineRects:function(t){for(var e=[],i=[],o=[],r=[],n=0,s=null;s=t[n++];)e.push(s.x),i.push(s.y),o.push(s.x+s.w),r.push(s.y+s.h);return e.length?{x:e=Math.min.apply(null,e),y:i=Math.min.apply(null,i),w:(o=Math.max.apply(null,o))-e,h:(r=Math.max.apply(null,r))-i}:null}},WCT.geometry.Point=function(t,e){this.x=t,this.y=e},WCT.geometry.Point.CreatePoints=function(){for(var t=[],e=0,i=arguments.length;e<i;)t.push(new WCT.geometry.Point(arguments[e++],arguments[e++]));return t},WCT.geometry.Point.prototype={Copy:function(){return new WCT.geometry.Point(this.x,this.y)},SubstractPoint:function(t){return new WCT.geometry.Point(this.x-t.x,this.y-t.y)},Round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},Len:function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},Move:function(t,e){return this.x+=t,this.y+=e,this},Scale:function(t,e){return this.x*=t,this.y*=e,this},Rotate:function(t,e){var i=this.x;return this.x=t*i-e*this.y,this.y=e*i+t*this.y,this},ToLen:function(t){if(0==t)this.x=0,this.y=0;else{var e=t/this.Len();this.x*=e,this.y*=e}return this},Draw:function(t){t.lineTo(this.x,this.y)}},WCT.geometry.Edge=function(t,e,i,o,r){this.x1=t,this.y1=e,this.x2=i,this.y2=o,this.r=r},WCT.geometry.Edge.FromPoints=function(t,e,i){return new WCT.geometry.Edge(t.x,t.y,e.x,e.y,i)},WCT.geometry.Edge.prototype={Copy:function(){return new WCT.geometry.Edge(this.x1,this.y1,this.x2,this.y2,this.r)},GetPoints:function(){return{x:[this.x1,this.x2],y:[this.y1,this.y2]}},Move:function(t,e){return this.x1+=t,this.y1+=e,this.x2+=t,this.y2+=e,this},Round:function(){return this.x1=Math.round(this.x1),this.y1=Math.round(this.y1),this.x2=Math.round(this.x2),this.y2=Math.round(this.y2),this.r=Math.round(this.r),this},Rotate:function(t,e){var i=this.x1,o=this.x2;return this.x1=t*i-e*this.y1,this.y1=e*i+t*this.y1,this.x2=t*o-e*this.y2,this.y2=e*o+t*this.y2,this},Scale:function(t,e,i){return this.x1*=t,this.y1*=e,this.x2*=t,this.y2*=e,this.r*=i,this},Draw:function(t){BROWSER.IE&&BROWSER.VERSION<9||arguments[2]?"quadratic"==arguments[1]?t.quadraticCurveTo(this.x1,this.y1,this.x2,this.y2):t.bezierCurveTo(this.x1,this.y1,this.x1,this.y1,this.x2,this.y2):t.arcTo(this.x1,this.y1,this.x2,this.y2,this.r)}},WCT.geometry.Circle=function(t,e,i){this.x=t,this.y=e,this.r=i},WCT.geometry.Circle.FromObject=function(t){return new WCT.geometry.Circle(t.x,t.y,t.r)},WCT.geometry.Circle.prototype={Move:function(t,e){return this.x+=t,this.y+=e,this},HasPoint:function(t,e){return Math.pow(t-this.x,2)+Math.pow(e-this.y,2)<=Math.pow(this.r,2)}},WCT.geometry.Ellipse=function(t,e,i,o){this.x=t,this.y=e,this.rx=i,this.ry=o;var r=Math.max(0,Math.min(i,o)),n=i/r,s=o/r;n==s&&BROWSER.IE&&BROWSER.VERSION<=9&&(n-=.02,s-=.02),this.r=r,this.sx=n,this.sy=s},WCT.geometry.Ellipse.prototype={Copy:function(){return new WCT.geometry.Ellipse(this.x,this.y,this.rx,this.ry)},Move:function(t,e){return this.x+=t,this.y+=e,this},HasPoint:function(t,e){return Math.pow((t-this.x)/this.rx,2)+Math.pow((e-this.y)/this.ry,2)<=1},CalcPaths:function(){var t=arguments[0]||this.sx,e=arguments[1]||this.sy,i=this.r,o=new WCT.geometry.Point(this.x/t,this.y/e),r=o.Copy().Move(-i,-i),n=o.Copy().Move(i,-i),s=o.Copy().Move(i,i),a=o.Copy().Move(-i,i),_=o.Copy().Move(-i,0),l=o.Copy().Move(0,-i),d=o.Copy().Move(i,0),h=o.Copy().Move(0,i),c=WCT.geometry.Edge;return{lt:c.FromPoints(r,l,i),rt:c.FromPoints(n,d,i),rb:c.FromPoints(s,h,i),lb:c.FromPoints(a,_,i),ilb:c.FromPoints(a,h,i),irb:c.FromPoints(s,d,i),irt:c.FromPoints(n,l,i),ilt:c.FromPoints(r,_,i)}},Draw:function(t,e){var i=arguments[3];t.save(),t.scale(this.sx,this.sy),t.beginPath(),i&&(t[e+"Style"]=i);var o=this.CalcPaths();t.moveTo(o.lb.x2,o.lb.y2),o.lt.Draw(t,"quadratic"),o.rt.Draw(t,"quadratic"),o.rb.Draw(t,"quadratic"),o.lb.Draw(t,"quadratic");var r=arguments[2];r&&(o=r.CalcPaths(this.sx,this.sy),t.moveTo(o.ilt.x2,o.ilt.y2),o.ilb.Draw(t,"quadratic"),o.irb.Draw(t,"quadratic"),o.irt.Draw(t,"quadratic"),o.ilt.Draw(t,"quadratic")),t[e](),t.closePath(),t.restore()}},WCT.geometry.Vector=function(t,e){this.o=t,this.r=e},WCT.geometry.Vector.FromPoints=function(t,e){var i=new WCT.geometry.Point(e.x-t.x,e.y-t.y);return i.ToLen(1),new WCT.geometry.Vector(t,i)},WCT.geometry.Vector.prototype={Intersect:function(t){var e=this.Cross(t);return this.Coordinates(e.t)},Normal:function(t){if(0==t)return this;var e=-1,i=1,o=this.r.Len();0!=o&&(e=-this.r.y/o,i=this.r.x/o);var r=new WCT.geometry.Point(this.o.x+e*t,this.o.y+i*t),n=this.r.Copy();return new WCT.geometry.Vector(r,n)},Cross:function(t){var e=this.o,i=this.r,o=t.o,r=t.r,n=0,s=0;return i.y*r.x!=0||i.x*r.y!=0?n=(e.x*r.y+o.y*r.x-o.x*r.y-e.y*r.x)/(i.y*r.x-i.x*r.y):0!=r.x&&(s=(e.x-o.x+n*i.x)/r.x),!isFinite(n)||isNaN(n)?n=0:isFinite(s)&&!isNaN(s)||(s=0),{t:n,s:s}},Coordinates:function(t){var e=this.o.x+this.r.x*t,i=this.o.y+this.r.y*t;return new WCT.geometry.Point(e,i)}},WCT.geometry.RoundedRect=function(t,e,i,o,r,n,s,a){this.p1=t,this.e1=e,this.p2=i,this.e2=o,this.p3=r,this.e3=n,this.p4=s,this.e4=a},WCT.ExtendObject(WCT.geometry.RoundedRect,{FromRect:function(t,e,i){var o,r;r=5==arguments.length?(o=arguments[3],arguments[4]):o=i;var n=WCT.geometry,s=new n.Point(e.x-o,t.y),a=new n.Edge(e.x,t.y,e.x,t.y+r,i),_=new n.Point(e.x,e.y-r),l=new n.Edge(e.x,e.y,e.x-o,e.y,i),d=new n.Point(t.x+o,e.y),h=new n.Edge(t.x,e.y,t.x,e.y-r,i),c=new n.Point(t.x,t.y+r),p=new n.Edge(t.x,t.y,t.x+o,t.y,i);return new n.RoundedRect(s,a,_,l,d,h,c,p)},FromInvertedRect:function(t,e,i){var o,r;r=5==arguments.length?(o=arguments[3],arguments[4]):o=i;var n=WCT.geometry,s=new n.Point(t.x+o,t.y),a=new n.Edge(t.x,t.y,t.x,t.y+r,i),_=new n.Point(t.x,e.y-r),l=new n.Edge(t.x,e.y,t.x+o,e.y,i),d=new n.Point(e.x-o,e.y),h=new n.Edge(e.x,e.y,e.x,e.y-r,i),c=new n.Point(e.x,t.y+r),p=new n.Edge(e.x,t.y,e.x-o,t.y,i);return new n.RoundedRect(s,a,_,l,d,h,c,p)}}),WCT.geometry.RoundedRect.prototype={Copy:function(){return new WCT.geometry.RoundedRect(this.p1.Copy(),this.e1.Copy(),this.p2.Copy(),this.e2.Copy(),this.p3.Copy(),this.e3.Copy(),this.p4.Copy(),this.e4.Copy())},GetPoints:function(){var t=this.e1.GetPoints(),e=this.e2.GetPoints(),i=this.e3.GetPoints(),o=this.e4.GetPoints(),r=t.x.concat(e.x.concat(i.x.concat(o.x)));r.push(this.p1.x,this.p2.x,this.p3.x,this.p4.x);var n=t.y.concat(e.y.concat(i.y.concat(o.y)));return n.push(this.p1.y,this.p2.y,this.p3.y,this.p4.y),{x:r,y:n}},GetEdges:function(){return{lt:{x:this.e4.x1,y:this.e4.y1,r:this.e4.r},rt:{x:this.e1.x1,y:this.e1.y1,r:this.e1.r},rb:{x:this.e2.x1,y:this.e2.y1,r:this.e2.r},lb:{x:this.e3.x1,y:this.e3.y1,r:this.e3.r}}},Move:function(t,e){return this.p1.Move(t,e),this.p2.Move(t,e),this.p3.Move(t,e),this.p4.Move(t,e),this.e1.Move(t,e),this.e2.Move(t,e),this.e3.Move(t,e),this.e4.Move(t,e),this},Scale:function(t,e,i){return this.p1.Scale(t,e),this.p2.Scale(t,e),this.p3.Scale(t,e),this.p4.Scale(t,e),this.e1.Scale(t,e,i),this.e2.Scale(t,e,i),this.e3.Scale(t,e,i),this.e4.Scale(t,e,i),this},Rotate:function(t,e){return this.p1.Rotate(t,e),this.p2.Rotate(t,e),this.p3.Rotate(t,e),this.p4.Rotate(t,e),this.e1.Rotate(t,e),this.e2.Rotate(t,e),this.e3.Rotate(t,e),this.e4.Rotate(t,e),this},Draw:function(t,e){var i=arguments[3];t.save(),t.beginPath(),i&&(t[e+"Style"]=i);for(var o=[this,arguments[2]],r=0,n=null;n=o[r++];){var s=n.p1.Copy().Round();t.moveTo(s.x,s.y),s.Draw(t),n.e1.Copy().Round().Draw(t,"quadratic",!0),n.p2.Copy().Round().Draw(t),n.e2.Copy().Round().Draw(t,"quadratic",!0),n.p3.Copy().Round().Draw(t),n.e3.Copy().Round().Draw(t,"quadratic",!0),n.p4.Copy().Round().Draw(t),n.e4.Copy().Round().Draw(t,"quadratic",!0)}t[e](),t.closePath(),t.restore()}},WCT.InputElement=function(t){this.uid_=t;var e=arguments[1]||{};if(this.config_={type:e.type||"checkbox",name:e.name||null,handle_events:"undefined"==typeof e.handle_events||e.handle_events,disabled:!!e.disabled||!1,tabindex:e.tabindex||0,ariaLabel:e.ariaLabel||"",ariaDescribe:e.ariaDescribe||"",keysInUse:e.keysInUse||null},this.connectors_=arguments[2]||{},this.skin_=WCT.skin.Merge(WCT.InputElement.SKIN,arguments[3],null,null,!0),this.cb_e_=WCT.InputElement.OnEvent.bind(this),this.cb_r_={},this.disabled_=!1,this.checked_=!1,"radio"===e.type){var i=e.name||WCT.uid.Generate(16);WCT.InputElement.STORE[i]||(WCT.InputElement.STORE[i]={}),(WCT.InputElement.STORE[i][t]=this).config_.name=i}},WCT.ExtendObject(WCT.InputElement,{SKIN:{size:16,margin:0,border_width:1,border_color:"#000000",border_style:"solid",color:"#000000",color_hover:"#000000",background_color:"#ffffff",gradient:!1,background_color2:"#ffffff",shadow_show:!1,shadow_color:"#aaaaaa",shadow_trans:50,shadow_blur:10,shadow_spread:5,shadow_h:5,shadow_v:5,checkbox:{border_radius:3,vertical_align:"middle"},radio:{border_radius:8,vertical_align:"middle"}},OnEvent:function(t){var e=this.config_.keysInUse||{},i=EDIT_MODE&&Editor.Preview(),o=t.keyCode;if(!(this.disabled_||i&&(13===o||32===o)||13===o&&e.enter||32===o&&e.space)){var r=t.type;if("click"===r||"keyup"===r&&(13===o||32===o)){this.Checked(!this.checked_);var n=this.connectors_;n.callback_f&&n.callback_f.call(n.callback_s)}else this.Hover("mouseover"===r)}},STORE:{}}),WCT.InputElement.prototype=function(){function s(t,e){WCT.event.Observe(t,this.cb_e_,e),this.cb_r_[t]=e}function t(t){var e=this.cb_r_[t];e&&(WCT.event.StopObserving(t,this.cb_e_,e),delete this.cb_r_[t])}function a(){t.call(this,"click"),t.call(this,"mouseover"),t.call(this,"mouseout"),t.call(this,"keyup")}return{Destructor:function(){this.config_.handle_events&&a.call(this);var t=$(this.uid_+"#"+this.type_);t&&t.parentNode.removeChild(t),WCT.InputElement.STORE[this.config_.name]&&delete WCT.InputElement.STORE[this.config_.name][this.uid_],this.config_=null,this.connectors_=null,this.skin_=null,this.cb_e_=null,this.cb_r_=null},Create:function(t){var e=this.skin_,i=this.config_,o=i.type,r=$$("div");r.id=this.uid_+"#input#"+o,r.tabIndex=i.disabled?"-1":i.tabindex,r.setAttribute("role",o),r.setAttribute("aria-checked",this.checked_),r.setAttribute("aria-labeldby",i.ariaLabel),r.setAttribute("aria-describedby",i.ariaDescribe),r.style.cursor=i.disabled?"default":"pointer",r.style.display="inline-block",r.style.position="relative",r.style.overflow="hidden",r.style.textAlign="center",BROWSER.IE&&9<BROWSER.VERSION&&(r.style.verticalAlign="text-middle"),r.style.width=e.size+"px",r.style.height=e.size+"px",r.style.fontSize=e.size+"px",r.style.lineHeight=e.size+"px",r.style.margin=e.margin+"px",r.style.borderWidth=e.border_width+"px",r.style.borderStyle=e.border_style,r.style.borderColor=e.border_color,r.style.color=e.color,WCT.dom.ApplyBackgroundStyle(r,e),WCT.dom.ApplyShadowStyle(r,e),r.style.borderRadius=e[o].border_radius+"px",r.style.verticalAlign=e[o].vertical_align,i.disabled&&this.Disabled(!0),i.handle_events&&function n(t){a.call(this),s.call(this,"click",t),s.call(this,"mouseover",t),s.call(this,"mouseout",t),s.call(this,"keyup",t)}.call(this,r),t.appendChild(r)},Hover:function(){var t=arguments[0],e=this.uid_,i=this.config_,o=this.skin_,r=$(e+"#input#"+i.type);r&&o.color_hover!==o.color&&(this.Checked()||(r.firstChild&&r.removeChild(r.firstChild),t&&r.appendChild(this.get_clone_(r,o.color_hover))))},Checked:function(){var t=arguments[0];if("boolean"!=typeof t)return this.checked_;var e=this.uid_,i=this.config_,o=$(e+"#input#"+i.type);if(!o)return null;var r=arguments[1];if("radio"===i.type&&!r){var n=WCT.InputElement.STORE[i.name];for(var s in n){n[s].Checked(!1,!0)}}return t="radio"===i.type&&!r||t,o.firstChild&&o.removeChild(o.firstChild),t&&o.appendChild(this.get_clone_(o)),o.setAttribute("aria-checked",t),this.checked_=t,this.checked_},get_clone_:function(t){var e=this.skin_,i=t.cloneNode(!0);i.parentNode&&i.parentNode.removeChild(i);for(var o=["id","tabIndex","role","aria-labeldby","aria-describedby"],r=0,n=o.length;r<n;r++)i.removeAttribute(o[r]);i.style.display="block",i.style.border=0,i.style.background="",i.style.pointerEvents="none";var s=e.size>>1;return i.style.width=s+"px",i.style.height=s+"px",i.style.margin=(s>>1)+"px",i.style.backgroundColor=arguments[1]||e.color,i},Disabled:function(){var t=arguments[0];if("boolean"==typeof t){this.disabled_=t;var e=$(this.uid_+"#input#"+this.config_.type);e&&(e.setAttribute("aria-disabled",""+t),e.style.cursor=t?"default":"pointer")}return this.disabled_},GetUID:function(){return this.uid_}}}(),WCT.QrCode=function(){this.mods_=null,this.cache_=null,this.bit_=null,this.byte_=null,this.math_=null,this.mod_count_=0,this.type_id_=1},WCT.QrCode.LEN_INIT_MAP={1:10,2:20,3:40,4:60,5:80,6:100,7:120,8:150,9:180,10:210,11:250,12:280,13:330,14:360,15:410,16:450,17:500,18:560,19:620,20:660,21:710,22:770,23:850,24:910,25:990,26:1050},WCT.QrCode.Cleanup=function(){WCT.QrCode.math.EXP_TABLE=null,WCT.QrCode.math.LOG_TABLE=null},WCT.QrCode.GenerateHtml=function(t){var e=new WCT.QrCode,i=e.GenerateHtml(t,arguments[1],arguments[2],arguments[3])||"";return e.Destructor(),i},WCT.QrCode.prototype=function(){var h=236,c=17,u=1335,a=7973,f=21522,m=[[1,26,16],[1,44,28],[1,70,44],[2,50,32],[2,67,43],[4,43,27],[4,49,31],[2,60,38,2,61,39],[3,58,36,2,59,37],[4,69,43,1,70,44],[1,80,50,4,81,51],[6,58,36,2,59,37],[8,59,37,1,60,38],[4,64,40,5,65,41],[5,65,41,5,66,42],[7,73,45,3,74,46],[10,74,46,1,75,47],[9,69,43,4,70,44],[3,70,44,11,71,45],[3,67,41,13,68,42],[17,68,42],[17,74,46],[4,75,47,14,76,48],[6,73,45,14,74,46],[8,75,47,13,76,48],[19,74,46,4,75,47],[22,73,45,3,74,46],[3,73,45,23,74,46],[21,73,45,7,74,46],[19,75,47,10,76,48],[2,74,46,29,75,47],[10,74,46,23,75,47],[14,74,46,21,75,47],[14,74,46,23,75,47],[12,75,47,26,76,48],[6,75,47,34,76,48],[29,74,46,14,75,47],[13,74,46,32,75,47],[40,75,47,7,76,48],[18,75,47,31,76,48]],g=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]];function n(t,e){var i=4*this.type_id_+17;this.mod_count_=i,this.mods_=function n(t){for(var e=new Array(t),i=t-1,o=i;0<=o;o--){e[o]=new Array(t);for(var r=i;0<=r;r--)e[o][r]=null}return e}(i),o.call(this,0,0),o.call(this,i-7,0),o.call(this,0,i-7),function d(){for(var t=g[this.type_id_-1],e=this.mods_,i=t.length,o=0;o<i;o++)for(var r=0;r<i;r++){var n=t[o],s=t[r];if(null==e[n][s])for(var a=-2;a<=2;a++)for(var _=2==Math.abs(a),l=-2;l<=2;l++)e[n+a][s+l]=!a&&!l||_||2==Math.abs(l)}}.call(this),function r(){for(var t=this.mods_,e=this.mod_count_-8,i=8;i<e;i++)null==t[i][6]&&(t[i][6]=i%2==0);for(var o=8;o<e;o++)null==t[6][o]&&(t[6][o]=o%2==0)}.call(this),function _(t,e){for(var i=function a(t){var e=t<<10,i=y(u);for(;0<=y(e)-i;)e^=u<<y(e)-i;return(t<<10|e)^f}(e),o=this.mod_count_,r=this.mods_,n=0;n<15;n++){var s=!t&&1==(i>>n&1);n<6?r[n][8]=s:n<8?r[n+1][8]=s:r[o-15+n][8]=s}for(n=0;n<15;n++){s=!t&&1==(i>>n&1);n<8?r[8][o-n-1]=s:8==n?r[8][15-n]=s:r[8][15-n-1]=s}r[o-8][8]=!t}.call(this,t,e),6<this.type_id_&&function s(t){for(var e=function n(t){var e=t<<12,i=y(a);for(;0<=y(e)-i;)e^=a<<y(e)-i;return t<<12|e}(this.type_id_),i=this.mod_count_-8-3,o=this.mods_,r=0;r<18;r++)o[Math.floor(r/3)][r%3+i]=!t&&1==(e>>r&1),o[r%3+i][Math.floor(r/3)]=!t&&1==(e>>r&1)}.call(this,t),null==this.cache_&&(this.cache_=function l(){var t=this.byte_,e=new WCT.QrCode.bit;e.Put(4,4),e.Put(t.GetLength(),function a(){var t=this.type_id_;{if(1<=t&&t<10)return 8;if(t<41)return 16;throw new Error("type:"+t)}}.call(this)),t.Write(e);for(var i=0,o=function _(){for(var t=m[this.type_id_-1],e=t.length/3,i=[],o=0;o<e;o++)for(var r=0,n=t[3*o];r<n;r++)i.push({total_count:t[3*o+1],data_count:t[3*o+2]});return i}.call(this),r=0,n=o.length;r<n;r++)i+=o[r].data_count;var s=e.GetLength();if(8*i<s)throw new Error("code length overflow. ("+s+">"+8*i+")");s+4<=8*i&&e.Put(0,4);for(;e.GetLength()%8!=0;)e.PutBit(!1);for(;!(e.GetLength()>=8*i||(e.Put(h,8),e.GetLength()>=8*i));)e.Put(c,8);this.bit_&&this.bit_.Destructor();return this.bit_=e,function C(t){for(var e=0,i=t.length,o=new Array(i),r=new Array(i),n=new Array(i),s=new Array(i),a=this.bit_.GetBuffer(),_=this.math_,l=0,d=0;d<i;d++){var h=t[d].data_count,c=t[d].total_count-h;l+=t[d].total_count,o[d]=h,r[d]=c,n[d]=new Array(h);for(var p=0;p<h;p++)n[d][p]=255&a[p+e];e+=h;var u=T.call(this,c),f=u.GetLength()-1,m=new WCT.QrCode.polynomial(n[d],f),g=m.Mod(u,_),y=g.GetLength();s[d]=new Array(f);for(p=0;p<s[d].length;p++){var b=p+y-s[d].length;s[d][p]=0<=b?g.Get(b):0}u.Destructor(),m.Destructor(),g.Destructor()}o.push(0),r.push(0),o=Math.max.apply(null,o),r=Math.max.apply(null,r);var v=new Array(l),x=0;for(d=0;d<o;d++)for(var w=0;w<i;w++)d<n[w].length&&(v[x++]=n[w][d]);for(d=0;d<r;d++)for(w=0;w<i;w++)d<s[w].length&&(v[x++]=s[w][d]);return v}.call(this,o)}.call(this)),function p(t,e){for(var i=-1,o=this.mod_count_,r=this.mods_,n=o-1,s=7,a=0,_=o-1;0<_;_-=2)for(6==_&&_--;;){for(var l=0;l<2;l++)if(null==r[n][_-l]){var d=!1;a<t.length&&(d=1==(t[a]>>>s&1));var h=null,c=_-l;switch(e){case 0:h=(n+c)%2==0;break;case 1:h=n%2==0;break;case 2:h=c%3==0;break;case 3:h=(n+c)%3==0;break;case 4:h=(Math.floor(n/2)+Math.floor(c/3))%2==0;break;case 5:h=n*c%2+n*c%3==0;break;case 6:h=(n*c%2+n*c%3)%2==0;break;case 7:h=(n*c%3+(n+c)%2)%2==0;break;default:throw new Error("Bad mask pattern: "+e)}h&&(d=!d),r[n][_-l]=d,-1==--s&&(a++,s=7)}if((n+=i)<0||o<=n){n-=i,i=-i;break}}}.call(this,this.cache_,e)}function s(){for(var t=0,e=0,i=0;i<8;i++){n.call(this,!0,i);var o=r.call(this);(!i||o<t)&&(t=o,e=i)}return e}function r(){for(var t=this.mod_count_,e=this.mods_,i=0,o=0,r=0;r<t;r++)for(var n=0;n<t;n++){var s=0,a=e[r][n];a&&i++;for(var _=-1;_<=1;_++)if(!(r+_<0||t<=r+_))for(var l=-1;l<=1;l++)!_&&!l||n+l<0||t<=n+l||a==e[r+_][n+l]&&s++;5<s&&(o+=s-2)}for(r=0;r<t-1;r++)for(n=0;n<t-1;n++){var d=0;e[r][n]&&d++,e[r+1][n]&&d++,e[r][n+1]&&d++,e[r+1][n+1]&&d++,d&&4!=d||(o+=3)}for(r=0;r<t;r++)for(n=0;n<t-6;n++)e[r][n]&&!e[r][n+1]&&e[r][n+2]&&e[r][n+3]&&e[r][n+4]&&!e[r][n+5]&&e[r][n+6]&&(o+=40);for(n=0;n<t;n++)for(r=0;r<t-6;r++)e[r][n]&&!e[r+1][n]&&e[r+2][n]&&e[r+3][n]&&e[r+4][n]&&!e[r+5][n]&&e[r+6][n]&&(o+=40);return o+Math.abs(100*i/t/t-50)/5*10}function o(t,e){for(var i=this.mod_count_,o=this.mods_,r=-1;r<=7;r++)if(!(t+r<=-1||i<=t+r))for(var n=-1;n<=7;n++)e+n<=-1||i<=e+n||(o[t+r][e+n]=0<=r&&r<=6&&n%6==0||0<=n&&n<=6&&r%6==0||2<=r&&r<=4&&2<=n&&n<=4)}function y(t){for(var e=0;0!=t;)e++,t>>>=1;return e}function T(t){for(var e=new WCT.QrCode.polynomial([1],0),i=this.math_,o=0;o<t;o++){var r=new WCT.QrCode.polynomial([1,i.GetExp(o)],0),n=e.Multiply(r,i);r.Destructor(),e.Destructor(),e=n}return e}function _(){var t=arguments[0]||"",e=arguments[1]||0,i=arguments[2]||{},o=arguments[3]||["#000","#fff"],r=[];for(var n in i)r.push(n+":"+i[n]+";");var s=['<table role="figure" ','aria-label="QR Code: '+t+'" ','summary="QR Code: '+t+'" style="',r," border:0;"," border-collapse:collapse;"," padding:0;direction:ltr;",'">',"<tbody>"],a=this.mod_count_,_=this.mods_;if(!(e=0<e?Math.floor(e/a):8))return"";for(var l=0;l<a;l++){s.push("<tr>");for(var d=0;d<a;d++)s.push('<td style="'," border:0;"," border-collapse:collapse;"," padding:0;margin:0;"," width:"+e+"px;"," height:"+e+"px;"," background:",_[l][d]?o[0]:o[1],';">',"</td>");s.push("</tr>")}return s.push("</tbody>","</table>"),s.join("")}return{Destructor:function(){this.mods_=null,this.cache_=null,this.bit_&&(this.bit_.Destructor(),this.bit_=null),this.byte_&&(this.byte_.Destructor(),this.byte_=null),this.math_&&(this.math_.Destructor(),this.math_=null)},GenerateHtml:function(t){var e=WCT.QrCode.LEN_INIT_MAP,i=t.length;for(var o in i=10*Math.round(i/10),e){if(!(e[o]<=i))break;this.type_id_=o}for(;;)try{return this.byte_&&this.byte_.Destructor(),this.byte_=new WCT.QrCode["byte"](t),this.math_&&this.math_.Destructor(),this.math_=new WCT.QrCode.math,this.cache_=null,n.call(this,!1,s.call(this)),_.apply(this,arguments)}catch(r){if(!(this.type_id_++<40))return"";this.mod_count_=0,this.mods_=null}}}}(),WCT.QrCode.bit=function(){this.b_=[],this.l_=0},WCT.QrCode.bit.prototype={Destructor:function(){this.b_=null},GetBuffer:function(){return this.b_},Get:function(t){var e=Math.floor(t/8);return 1==(this.b_[e]>>>7-t%8&1)},Put:function(t,e){for(var i=0;i<e;i++)this.PutBit(1==(t>>>e-i-1&1))},GetLength:function(){return this.l_},PutBit:function(t){var e=Math.floor(this.l_/8);this.b_.length<=e&&this.b_.push(0),t&&(this.b_[e]|=128>>>this.l_%8),this.l_++}},WCT.QrCode["byte"]=function(t){for(var e=t.length,i=new Array(e),o=0;o<e;o++)i[o]=255&t.charCodeAt(o);this.b_=i},WCT.QrCode["byte"].prototype={Destructor:function(){this.b_=null},GetLength:function(){return this.b_.length},Write:function(t){for(var e=0,i=this.b_,o=i.length;e<o;e++)t.Put(i[e],8)}},WCT.QrCode.polynomial=function(t,e){if("undefined"==typeof t.length)throw new Error(t.length+" / "+e);for(var i=t.length,o=0;o<i&&0==t[o];)o++;i-=o;for(var r=new Array(i+e),n=0;n<i;n++)r[n]=t[n+o];this.n_=r},WCT.QrCode.polynomial.prototype={Destructor:function(){this.n_=null},Get:function(t){return this.n_[t]},GetLength:function(){return this.n_.length},Multiply:function(t,e){for(var i=this.n_,o=t.n_,r=i.length,n=o.length,s=new Array(r+n-1),a=0;a<r;a++)for(var _=0;_<n;_++){var l=e.GetLog(i[a]),d=e.GetLog(o[_]);s[a+_]^=e.GetExp(l+d)}return new WCT.QrCode.polynomial(s,0)},Mod:function(t,e){var i=this.n_,o=t.n_,r=i.length,n=o.length;if(r-n<0)return this;for(var s=e.GetLog(i[0])-e.GetLog(o[0]),a=new Array(r),_=0;_<r;_++)a[_]=i[_];for(_=0;_<n;_++)a[_]^=e.GetExp(e.GetLog(o[_])+s);return new WCT.QrCode.polynomial(a,0).Mod(t,e)}},WCT.QrCode.math=function(){var t=WCT.QrCode.math;if(!t.EXP_TABLE){for(var e=new Array(256),i=new Array(256),o=0;o<8;o++)e[o]=1<<o;for(o=8;o<256;o++)e[o]=e[o-4]^e[o-5]^e[o-6]^e[o-8];for(o=0;o<255;o++)i[e[o]]=o;t.EXP_TABLE=e,t.LOG_TABLE=i}this.e_=WCT.DeepCopy(t.EXP_TABLE),this.l_=WCT.DeepCopy(t.LOG_TABLE)},WCT.QrCode.math.EXP_TABLE=null,WCT.QrCode.math.LOG_TABLE=null,WCT.QrCode.math.prototype={Destructor:function(){this.e_=null,this.l_=null},GetExp:function(t){for(;t<0;)t+=255;for(;256<=t;)t-=255;return this.e_[t]},GetLog:function(t){if(t<1)throw new Error("GetLog("+t+")");return this.l_[t]}};var FallbackValues={page:{w:1024,h:672,tabindex:0,pagesound:"",background_color:"#9f9f9f",border_color:"#666666",border_style:"solid",background_image_centered:!0,canvas_color:"transparent",skin:"standard",border:0,show_arrows:!1,show_toc:!1,toc_position:"window_top",toc_structure:"tabbedflat",fontsizeInPt:!1,doc_enable:!0,status_position:"top",shadow_show:!1,shadow_color:"#000000",shadow_trans:50,shadow_blur:8,shadow_spread:0,shadow_h:0,shadow_v:0},arrow:{x0:140,y0:190,x1:240,y1:190,l0:6,w0:4,l1:6,w1:4,z:100,thickness:2,color:"#000000",head0:"none",head1:"none",locked:!1,hidden:!1,fade_in_time:500,fade_out_time:500,anim_show_effect:"fade",anim_hide_effect:"fade",opacity:100,tabindex:0,doc_enable:!0},big_arrow:{x:140,y:120,w:200,h:200,z:100,text:"",dir:"right",arrow_color:"#8080FF",thickness:30,background_color:"transparent",border_color:"#666666",border:0,valign:"top",padding:0,locked:!1,hidden:!1,doc_enable:!0,fade_in_time:500,fade_out_time:500,opacity:100},shape:{x:140,y:120,w:200,h:200,z:100,text:"",dir:"right",arrow_color:"#008FD3",thickness:30,border_color:"#0076CB",border:0,align:"Center",valign:"top",padding:0,locked:!1,hidden:!1,doc_enable:!0,gradient:"gradient_flat",visual_over:!1,visual_down:!1,fade_in_time:500,fade_out_time:500,anim_show_effect:"fade",anim_hide_effect:"fade",opacity:100,tabindex:0,font_family:"Arial"},bubble:{text:"",title:"",x:100,y:140,w:200,h:200,z:100,movable:!1,closable:!1,fadeing:!1,fade_in_time:500,fade_out_time:500,locked:!1,hidden:!1,bubblestyle:"white_island",orientation:"SE",doc_enable:!0,opacity:100,tabindex:0},imagebutton:{x:80,y:80,w:100,h:30,z:100,text:"",image_align:"left",hidden:!1,align:"Center",valign:"middle",padding:0,image_padding:0,locked:!1,border_style:"",anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,tabindex:0,font_family:"Arial"},image:{x:140,y:120,w:200,h:200,z:100,alt_txt:"",border_color:"#666666",border:0,padding:0,image:"",locked:!1,hidden:!1,keep_aspect:!0,doc_enable:!0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,tabindex:0},sprite:{x:140,y:120,w:200,h:200,z:100,offset_left:0,offset_top:0,repeat_x:!1,repeat_y:!1,alt_txt:"",border_color:"#666666",border:0,href:"",locked:!1,hidden:!1,doc_enable:!0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,tabindex:0},text:{text:"",x:40,y:80,w:240,h:120,z:100,align:"start",valign:"top",border_color:"#666666",border:0,padding:4,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,locked:!1,hidden:!1,doc_enable:!0,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,tabindex:0,font_family:"Arial"},placeholder:{placeholder_text:"",x:20,y:20,w:240,h:60,z:100,align:"start",valign:"top",border_color:"#666666",border:0,padding:4,locked:!1,hidden:!1,doc_enable:!0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,tabindex:0,font_family:"Arial"},hrefarea:{text:"",href:"",x:40,y:220,w:120,h:120,z:100,hide_scrollbars:!0,align:"start",valign:"top",border_color:"#666666",border:0,padding:4,locked:!1,hidden:!1,doc_enable:!0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,tabindex:0,font_family:"Arial"},link_textBoxIcon:{text:"",textBox_type:"default",textBox_title:"",x:300,y:80,w:33,h:26,z:100,textBoxW:300,textBoxH:200,textBoxX:330,textBoxY:80,textBoxZ:1e3,align:"start",valign:"top",padding:5,fadeing:!0,locked:!1,hidden:!1,hide_textbox_in_editor:!1,doc_enable:!0,border_style:"",shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,box_shadow_show:!1,box_shadow_color:"#000000",box_shadow_trans:25,box_shadow_blur:3,box_shadow_h:3,box_shadow_v:3,box_shadow_spread:0,opacity:100,tabindex:0,tooltip:"",popup_opacity:100,font_family:"Arial",fade_in_time:500,fade_out_time:500},activity_control:{process_title:"",role:"",align:"Center",align_role:"Center",background_color_role:"#627e91",border:1,border_color:"#666666",anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,x:30,y:30,w:180,h:90,z:100,locked:!1,hidden:!1,doc_enable:!0,openInNewWindow:!0,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,tabindex:0,font_family:"Arial",font_family_role:"Arial"},connector:{points:"100,100,200,100",z:100,l0:6,w0:4,l1:6,w1:4,thickness:2,color:"#000000",head0:"none",head1:"none",locked:!1,hidden:!1,fade_in_time:500,fade_out_time:500,anim_show_effect:"fade",anim_hide_effect:"fade",opacity:100,tabindex:0,doc_enable:!0},highlight:{x:20,y:20,w:24,h:24,z:100,target:"",offset:0,border:0,hl_type:"rect",show_effect:"show",flash_effect:"pulsate",opacity:100,doc_enable:!0},hotkey:{hotkey:"",x:20,y:20,w:100,h:24,z:100,onkey:""},inputtext:{text:"",textarea:!1,password:!1,noeditcursor:!1,disabled:!1,hide_scrollbars:!1,tooltip:"",text_full:"",regexp:"",confirmation_tab:!0,confirmation_enter:!1,affirmation_button:!1,confirmation_blur:!1,font_family:"Arial",font_size:10,text_color:"#000000",align:"start",bold:!1,italic:!1,underline:!1,background_color:"#FFFFFF",border:0,set_border_color:!1,border_color:"#666666",border_style:"",padding:2,x:40,y:80,w:240,h:24,z:100,locked:!1,hidden:!1,doc_enable:!0,fire_events:!1,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,tabindex:0},inputselect:{values:"",cursorhand:!1,disabled:!1,choose_nr:-1,choose_text:"",font_family:"Arial",font_size:10,text_color:"#000000",bold:!1,italic:!1,background_color:"#FFFFFF",x:40,y:80,w:240,h:22,z:100,locked:!1,hidden:!1,doc_enable:!0,fire_events:!1,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,tabindex:0},inputradio:{x:40,y:80,w:20,h:20,z:100,radio:!1,radiogroupname:"radioGroup1",checked:!1,choose:!1,cursorhand:!1,disabled:!1,locked:!1,hidden:!1,tabindex:0,doc_enable:!0,fire_events:!1},link_demo:{x:300,y:130,w:33,h:26,link_to:"",locked:!1,hidden:!1,doc_enable:!0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,tabindex:0},link_practice:{x:300,y:180,w:33,h:26,link_to:"",locked:!1,hidden:!1,doc_enable:!0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,tabindex:0},link_test:{x:300,y:230,w:33,h:26,link_to:"",locked:!1,hidden:!1,doc_enable:!0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,tabindex:0},link_concurrent:{x:300,y:280,w:33,h:26,link_to:"",locked:!1,hidden:!1,doc_enable:!0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,tabindex:0},link_guided:{x:300,y:80,w:33,h:26,link_to:"",locked:!1,hidden:!1,doc_enable:!0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,tabindex:0},link_pres:{x:300,y:80,w:33,h:26,link_to:"",locked:!1,hidden:!1,doc_enable:!0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,tabindex:0},link_quiz:{x:300,y:330,w:33,h:26,link_to:"",locked:!1,hidden:!1,doc_enable:!0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,tabindex:0},link_slide:{x:300,y:380,w:33,h:26,link_to:"",locked:!1,hidden:!1,doc_enable:!0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,tabindex:0},link_book:{x:300,y:380,w:33,h:26,link_to:"",locked:!1,hidden:!1,doc_enable:!0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,tabindex:0},link_document:{x:300,y:430,w:33,h:26,link_to:"",locked:!1,hidden:!1,doc_enable:!1,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,tabindex:0},flash:{x:80,y:60,w:500,h:400,z:100,border:1,padding:0,border_color:"#000000",src:"",playonstart:!0,loop:!0,wmode:"transparent",background_color:"#ffffff",locked:!1,hidden:!1,tabindex:0},realplayer:{x:80,y:60,w:500,h:400,z:100,border:1,padding:0,border_color:"#000000",src:"",playonstart:!1,loop:!1,locked:!1,hidden:!1,doc_enable:!0},wmp:{x:80,y:60,w:500,h:400,z:100,border:1,padding:0,border_color:"#000000",src:"",playonstart:!1,loop:!1,showControls:!0,showStatusBar:!1,locked:!1,hidden:!1,doc_enable:!0},quicktime:{x:80,y:60,w:500,h:400,z:100,border:1,padding:0,border_color:"#000000",src:"",playonstart:!1,locked:!1,hidden:!1,scale:"ToFit",controls:!0,loop:!1,doc_enable:!0},video:{x:80,y:60,w:500,h:400,z:100,border:1,padding:0,opacity:100,border_color:"#000000",src:"",playonstart:!1,loop:!1,noDownload:!1,showControls:!0,locked:!1,hidden:!1,tabindex:0,doc_enable:!0},audio:{z:100,src:"",soundchannel:"Effects",volume:100,playonstart:!0,loop:!1},office:{x:80,y:60,w:500,h:400,z:100,border:1,padding:0,border_color:"#000000",src:"",background_color:"#ffffff",locked:!1,hidden:!1,doc_enable:!1},html:{x:80,y:60,w:500,h:400,z:100,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,border:1,padding:0,opacity:100,border_color:"#000000",src:"",background_color:"#ffffff",locked:!1,hidden:!1,tabindex:0,doc_enable:!1},x_ruler:{x:80},y_ruler:{y:80},timer:{z:100},counter:{z:100,enabled:1},progress:{start:0,max:0,align:"Center",x:60,y:100,w:120,h:40,z:100,background_color:"#FFFFFF",bar_empty_color:"#FFFFFF",bar_filled_color:"#F0AB00",bar_border_color:"#666666",bar_border:1,book_progress:0,font_family:"Arial"},collector:{z:100,enabled:1},switchboard:{z:100},jumper:{z:100,target:""},poi:{x:100,y:100,w:20,h:20,z:100},waypoint:{z:100},tracker:{max:3,cur:1,z:100},testomat:{ok_time:1e3,z:100,active:1},notifier:{url:"",values:"",z:100},animator:{x:40,y:80,w:240,h:120,z:100,debug:0},mouse:{x:50,y:50,w:24,h:24,z:100,debug:0},typist:{z:100},drop_down_ani:{z:100,choose_text:"",duration:3e3,use_mouse:!1},mchoice:{x:80,y:80,w:240,h:240,z:100,border_color:"#666666",border:0,padding:4,locked:!1,hidden:!1,tabindex:0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,font_family:"Arial",doc_enable:!0,center_quiz_h:!1,center_quiz_v:!1,action_border_color:"#009DE0",action_border_width:2,action_size:36,action_dist_to_next:8,action_color:"#009DE0",action_color_hover:"#99D8F3",action_background_color:"#FFFFFF",action_background_color2:"#C3C3C3",action_border_style:"solid",action_gradient:"gradient_flat",action_valign:"middle",action_shadow_show:0,action_shadow_color:"#000000",action_shadow_trans:25,action_shadow_blur:3,action_shadow_h:3,action_shadow_v:3,action_shadow_spread:0},sqmaquiz:{x:80,y:80,w:240,h:240,z:100,border_color:"#666666",border:0,padding:4,locked:!1,points:1,answer_type:"at_text",hidden:!1,tabindex:0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,font_family:"Arial",doc_enable:!0,center_quiz_v:!1,action_border_width:1,action_border_color:"#999999",action_padding:4,action_dist_to_next:2,action_background_color:"#FFFFFF",action_background_color2:"#E5E5E5",action_border_style:"solid",action_gradient:"gradient_flat",action_shadow_show:0,action_shadow_color:"#000000",action_shadow_trans:25,action_shadow_blur:3,action_shadow_h:3,action_shadow_v:3,action_shadow_spread:0},fibquiz:{x:80,y:80,w:240,h:240,z:100,border_color:"#666666",border:0,padding:4,locked:!1,points:1,quiz_type:"qt_text",hidden:!1,tabindex:0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,font_family:"Arial",doc_enable:!0,center_quiz_h:!1,center_quiz_v:!1,action_w:200,action_dist_to_next:0,action_border_width:1,action_border_color:"#999999",action_color:"#000000",action_background_color:"#FFFFFF",action_drop_background_color:"#E6E6E6",action_drop_background_color_highlight:"#F2F2F2",action_background_color2:"#DDDDDD",action_border_style:"solid",action_gradient:"gradient_flat",action_shadow_show:0,action_shadow_color:"#000000",action_shadow_trans:25,action_shadow_blur:3,action_shadow_h:3,action_shadow_v:3,action_shadow_spread:0},matchquiz:{x:80,y:80,w:240,h:240,z:100,border_color:"#666666",border:0,padding:4,locked:!1,points:1,quiz_type:"qt_drop_down",hidden:!1,tabindex:0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,font_family:"Arial",doc_enable:!0,center_quiz_h:!1,center_quiz_v:!1,action_h:40,action_border_width:2,action_border_color:"#009DE0",action_padding:6,action_dist_to_next:8,action_color:"#000000",action_background_color:"#FFFFFF",action_drop_background_color:"#E6E6E6",action_drop_background_color_highlight:"#F2F2F2",action_background_color2:"#DDDDDD",action_border_style:"solid",action_gradient:"gradient_flat",action_shadow_show:0,action_shadow_color:"#000000",action_shadow_trans:25,action_shadow_blur:3,action_shadow_h:3,action_shadow_v:3,action_shadow_spread:0},connquiz:{x:80,y:80,w:240,h:240,z:100,border_color:"#666666",border:0,padding:4,locked:!1,points:1,random_line_color:!1,hidden:!1,tabindex:0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,font_family:"Arial",doc_enable:!0,center_quiz_v:!1,action_border_width:2,action_dist_to_next:10,action_border_color:"#009DE0",line_color:"#009DE0",action_background_color:"#FFFFFF",action_background_color_highlight:"#99D8F3",action_background_color2:"#E5E5E5",action_border_style:"solid",action_gradient:"gradient_flat",action_shadow_show:0,action_shadow_color:"#000000",action_shadow_trans:25,action_shadow_blur:3,action_shadow_h:3,action_shadow_v:3,action_shadow_spread:0},mixquiz:{x:80,y:80,w:240,h:240,z:100,border_color:"#666666",border:0,padding:4,locked:!1,points:1,quiz_type:"qt_drop_down",quiz_alignment:"qa_horizontal",hidden:!1,tabindex:0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,font_family:"Arial",doc_enable:!0,center_quiz_h:!1,center_quiz_v:!1,action_border_width:2,action_dist_to_next:2,action_color:"#000000",border_color_dnd:"#009DE0",background_color_dnd:"#FFFFFF",action_background_color2:"#E5E5E5",action_border_style:"solid",action_gradient:"gradient_flat",action_shadow_show:0,action_shadow_color:"#000000",action_shadow_trans:25,action_shadow_blur:3,action_shadow_h:3,action_shadow_v:3,action_shadow_spread:0},scalequiz:{x:80,y:80,w:240,h:240,z:100,border_color:"#666666",border:0,padding:4,locked:!1,points:1,range:"",answer:"",init:"",hidden:!1,tabindex:0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,font_family:"Arial",doc_enable:!0,center_quiz_v:!1,slider_w:20,slider_h:40,slider_color:"#99D8F3",slider_border_color:"#009DE0",action_slider_border_width:2,action_slider_border_radius:2,scale_color:"#BFBFBF",scale_thickness:4,action_align:"Center",action_shadow_show:0,action_shadow_color:"#000000",action_shadow_trans:25,action_shadow_blur:3,action_shadow_h:3,action_shadow_v:3,action_shadow_spread:0},gridquiz:{x:80,y:80,w:240,h:240,z:100,border_color:"#666666",border:0,padding:4,locked:!1,points:1,shuffle_solutions:!1,grid_list:"",question_1:"",answer_1:"",question_2:"",answer_2:"",question_3:"",answer_3:"",font_family:"Arial",font_size:12,text_color:"#000000",bold:!0,hidden:!1,tabindex:0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,doc_enable:!0,center_quiz_h:!1,center_quiz_v:!1,action_size:36,action_align:"Center",action_border_width:2,action_border_color:"#009DE0",action_dist_to_next:8,action_color:"#009DE0",action_color_hover:"#99D8F3",action_background_color:"#FFFFFF",action_background_color2:"#E5E5E5",action_border_style:"solid",action_gradient:"gradient_flat",action_valign:"middle",action_shadow_show:0,action_shadow_color:"#000000",action_shadow_trans:25,action_shadow_blur:3,action_shadow_h:3,action_shadow_v:3,action_shadow_spread:0},puzzlequiz:{x:80,y:80,w:240,h:240,z:100,alt_txt:"",border_color:"#666666",border_color_dnd:"#999999",action_border_color:"#999999",action_background_color_highlight:"transparent",border:0,padding:4,locked:!1,points:1,qp_pieces_x:3,qp_pieces_y:3,quiz_type:"qt_oneplace_puzzle",hidden:!1,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,doc_enable:!0,center_quiz_h:!1,center_quiz_v:!1,action_dist_to_next:0},hotspotquiz:{x:80,y:80,w:240,h:240,z:100,hotspot_x:20,hotspot_y:20,hotspot_w:50,hotspot_h:50,alt_txt:"",border_color:"#666666",border:0,padding:0,locked:!1,points:1,hidden:!1,tabindex:0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,doc_enable:!0,center_quiz_h:!1,center_quiz_v:!1},quiz_template:{x:80,y:80,w:700,h:450,z:100,name:"quiz_element",border_color:"#666666",border:0,padding:4,locked:!1,hidden:!1,tabindex:0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,font_family:"Arial",center_quiz_h:!1,center_quiz_v:!1,action_background_color:"#E5E5E5",action_background_color2:"#C3C3C3",action_border_color:"#808080",action_border_style:"solid",action_border_width:1,action_gradient:"gradient_flat",action_shadow_blur:3,action_shadow_color:"#808080",action_shadow_h:3,action_shadow_show:0,action_shadow_spread:0,action_shadow_trans:25,action_shadow_v:3,action_color_hover_mchoice:"#99D8F3",action_color_mchoice:"#009DE0",action_dist_to_next_mchoice:8,action_size_mchoice:36,action_valign_mchoice:"middle",action_padding_sqmaquiz:4,action_dist_to_next_sqmaquiz:2,action_w_fibquiz:200,action_color_fibquiz:"#000000",action_drop_background_color_fibquiz:"#E6E6E6",action_drop_background_color_highlight_fibquiz:"#F2F2F2",action_color_matchquiz:"#000000",action_dist_to_next_matchquiz:8,action_drop_background_color_matchquiz:"#F2F2F2",action_h_matchquiz:40,action_padding_matchquiz:6,action_background_color_highlight_connquiz:"#99D8F3",action_dist_to_next_mixquiz:2,action_color_mixquiz:"#000000",slider_w:20,slider_h:40,slider_color:"#99D8F3",slider_border_color:"#009DE0",action_slider_border_width_scalequiz:2,action_slider_border_radius_scalequiz:2,scale_color:"#BFBFBF",scale_thickness:4,action_align_scalequiz:"Center",action_size_gridquiz:36,action_align_gridquiz:"Center",action_dist_to_next_gridquiz:8,action_color_gridquiz:"#009DE0",action_color_hover_gridquiz:"#99D8F3",action_valign_gridquiz:"middle"},group:{x:80,y:80,w:240,h:240,z:100,opacity:100,doc_enable:!0},qrcode:{data:"Enter text here...",x:40,y:220,w:100,h:100,z:100,is_link:!1,openInNewWindow:!1,text_color:"#000000",background_color:"#FFFFFF",border_color:"#666666",border:0,padding:4,locked:!1,hidden:!1,doc_enable:!0,anim_show_effect:"fade",anim_hide_effect:"fade",fade_in_time:500,fade_out_time:500,shadow_show:!1,shadow_color:"#000000",shadow_trans:25,shadow_blur:3,shadow_h:3,shadow_v:3,shadow_spread:0,opacity:100,tabindex:0}};function preload_image(){var t=$$("img"),e=this._get_el();t.style.visibility="hidden",t.style.position="absolute",e.appendChild(t),t.onerror=function(){this.onerror=null,this.onload=null,this.parentNode.removeChild(this)},t.onload=function(){this.onerror=null,this.onload=null;var t=this.parentNode,e=t&&t.id.substr(0,t.id.indexOf("#"))||"";if(e){var i=Controls[e],o=i&&i._obj&&i._obj.image||null;o&&(o.w=this.width,o.h=this.height,t.removeChild(this),i._update_dom())}},t.src=Context.ToAbsPath(this._obj.image.id,this._src_ctx)}function getNewWindowFormatString(t){for(var e=[{k:"top",t:"n"},{k:"left",t:"n"},{k:"width",t:"n",min:0},{k:"height",t:"n",min:0},{k:"fullscreen"},{k:"menubar"},{k:"toolbar"},{k:"location"},{k:"resizable"},{k:"scrollbars"},{k:"status"}],i=[],o=0,r=null;r=e[o];o++){var n="nWF_"+r.k,s=r.t||"b";"undefined"!=typeof t[n]&&("b"==s?i.push(r.k+"="+(t[n]?"yes":"no")):(null==r.min||t[n]>=r.min)&&i.push(r.k+"="+t[n]))}return i.join(",")}function Dict_get(t){return window.ctx&&ctx.cfg_tr?ctx.cfg_tr(t):"["+t+"]"}function do_general_update_(){arguments[0]&&this._rd_update_dom_rect&&this._rd_update_dom_rect(),this._draggers&&this._draggers.main.UpdatePos(),this._update_hit_areas&&this._update_hit_areas(),Editor&&this.IsGrouped()&&Editor.HandleGroupChange(this)}function set_tooltip(t,e,i){var o=this._get_el();o&&o.setAttribute("title","string"==typeof i?i:"")}function set_cursorhand(t,e,i){this._cursor=i?"pointer":""}function set_image(t,e,i,o){var r=this._get_el("#main#img");if(i&&i.id){var n=i.id.substr(i.id.lastIndexOf(".")+1);if(BROWSER.IE6&&n.match(/^png$/i)?(set_trans_bg(r,Context.ToAbsPath(i.id,this._src_ctx),!1),r.src=to_producer_resource_("1")):(WCT.image_watcher.Add(r),r.setAttribute("src",Context.ToAbsPath(i.id,this._src_ctx))),EDIT_MODE&&Editor&&!Editor.Preview()&&!Page.IsInCreate()&&!this._init){var s=this._obj;(s.w>i.w||s.h>i.h)&&(s.w=i.w,s.h=i.h,Env.onPropChange(this._id,"w",s.w),Env.onPropChange(this._id,"h",s.h),this._draggers&&this._draggers.main.UpdatePos())}}else BROWSER.IE6?set_trans_bg(r,"",!1):r.setAttribute("src","");!this._disable_dom_update&&(EDIT_MODE||i&&i.id)&&this._update_dom(null,o)}function clamp_time(t,e){e.res=Math.max(0,e.val)}function set_time(t,e,i){this._get_el().innerHTML=i}function hide_all_windowed_objects(){for(var t in Media.Pause(),Controls)switch(Controls[t]._obj.type){case"flash":case"wmp":case"realplayer":case"quicktime":case"html":case"office":var e=Controls[t]._get_el();e&&(e.style.visibility="hidden")}}function show_all_windowed_objects(){for(var t in Media.Resume(),Controls)switch(Controls[t]._obj.type){case"flash":case"wmp":case"realplayer":case"quicktime":case"html":case"office":var e=Controls[t]._get_el();e&&!Controls[t]._obj.hidden&&(e.style.visibility="")}}function pauseMedia(){Media.Pause(),"object"==typeof ctx&&ctx&&ctx.cfg_show("action!book_sound_off")}function add_snap_point(t,e,i){var o=t[e];void 0===o&&(o={},t[e]=o),"undefined"==typeof o[i]&&(o[i]=!0)}function collect_targets(t,e){if(t)for(var i=t.split(";"),o=0;o<i.length;o++){var r=i[o],n=r.search(/\./);if(-1!=n)e[r.substr(0,n)]=1}}function GenerateUid(t){for(var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),i=e.length,o="",r=t;0<r;r--){o+=e[Math.floor(Math.random()*i)]}return o}function opacity(t,e,i,o){var r=Math.round(o/100),n=0;if(i<e)for(var s=e;i<=s;s--)WCT.SetTimeout(set_opacity,n*r,null,[t,s]),n++;else if(e<i)for(s=e;s<=i;s++)WCT.SetTimeout(set_opacity,n*r,null,[t,s]),n++}function clamp_opacity(t,e){e.res=Math.min(Math.max(0,e.val-0),100)}function set_opacity(t,e){t&&(0==e?(t.style.visibility="hidden",t.setAttribute("aria-hidden","true")):(t.style.visibility="visible",t.setAttribute("aria-hidden","false"),PLATFORM.IOS&&(t.style.WebkitOverflowScrolling="touch",t.style.WebkitTransform="translate3d(0,0,0);",t.scrollTop=0)),t.style.opacity=e/100)}function set_style_delayed(t,e,i){WCT.SetTimeout(set_style,100,null,[t.id,e,i])}function set_style(t,e,i){var o=$(t);if(!o)return!1;o.style[e]=i}function set_trans_bg(t,e,i,o){t.style.backgroundColor="transparent";var r=""!=e?Context.ToAbsPath(e):"";t.style.backgroundImage=""!=r?"url("+r+")":"none"}function set_padding(t,e,i){var o=this._get_el(),r=get_padding(t);if(o.style.padding=r.t+"px "+r.r+"px "+r.b+"px "+r.l+"px",!this._disable_dom_update){var n=get_border(t),s=Math.max(n.w+r.w+1,t.w-n.w-r.w)+"px",a=Math.max(n.h+r.h+1,t.h-n.h-r.h)+"px";o.style.width=s,o.style.height=a;var _=this._get_el("#main#text");_&&(_.style.width=s)}this._rd_update_dom_rect&&this._rd_update_dom_rect()}function clamp_padding(t,e){var i=e.name,o=i.split("_")[1],r="padding_"+{l:"r",r:"l",t:"b",b:"t"}[o],n=arguments[2]||{w:"w",h:"h"},s=get_border(t),a=t[n.w]-s.w,_=t[n.h]-s.h,l=e.val-0;if("padding"==i)a<=2*l&&(l=a/2-1),_<=2*l&&(l=_/2-1),e.res=Math.max(0,l);else if(null==e.val||isNaN(l)||"number"!=typeof l)e.res=null;else{var d="number"==typeof t[r]?t[r]:t.padding||0;"l"==o||"r"==o?a<=l+d&&(l=a-d-1):_<=l+d&&(l=_-d-1),e.res=Math.max(0,l)}}function get_padding(t){var e=(arguments[1]||"")+"padding",i=parseInt(t[e])||0,o="number"==typeof t[e+"_t"]?t[e+"_t"]:i,r="number"==typeof t[e+"_r"]?t[e+"_r"]:i,n="number"==typeof t[e+"_b"]?t[e+"_b"]:i,s="number"==typeof t[e+"_l"]?t[e+"_l"]:i;return{t:o,r:r,b:n,l:s,w:s+r,h:o+n}}function set_border(t,e,i){var o=this._get_el(),r={t:"Top",r:"Right",b:"Bottom",l:"Left"},n=get_border(t);for(var s in r)0<n[s]?(o.style["border"+r[s]+"Style"]="solid",o.style["border"+r[s]+"Width"]=n[s]+"px"):(o.style["border"+r[s]+"Style"]="none",o.style["border"+r[s]+"Width"]="0px");if(!this._disable_dom_update){var a=get_padding(t);o.style.width=Math.max(n.w+a.w+1,t.w-n.w-a.w)+"px",o.style.height=Math.max(n.h+a.h+1,t.h-n.h-a.h)+"px"}this._rd_update_dom_rect&&this._rd_update_dom_rect()}function clamp_border(t,e){var i=e.name,o=i.split("_")[1],r="border_"+{l:"r",r:"l",t:"b",b:"t"}[o],n=arguments[2]||{w:"w",h:"h"},s=get_padding(t),a=t[n.w]-s.w,_=t[n.h]-s.h,l=e.val-0;if("border"==i)a<=2*l&&(l=a/2-1),_<=2*l&&(l=_/2-1),e.res=Math.max(0,l);else if(null==e.val||isNaN(l)||"number"!=typeof l)e.res=null;else{var d="number"==typeof t[r]?t[r]:t.border||0;"l"==o||"r"==o?a<=l+d&&(l=a-d-1):_<=l+d&&(l=_-d-1),e.res=Math.max(0,l)}}function get_border(t){var e=parseInt(t.border)||0,i="number"==typeof t.border_t?t.border_t:e,o="number"==typeof t.border_r?t.border_r:e,r="number"==typeof t.border_b?t.border_b:e,n="number"==typeof t.border_l?t.border_l:e;return{t:i,r:o,b:r,l:n,w:n+o,h:i+r}}!function(){for(var t=["image","link_book","link_concurrent","link_demo","link_document","link_practice","link_quiz","link_slide","link_test","link_textBoxIcon"],e=0,i=null;i=t[e];e++)FallbackValues[i]&&(FallbackValues[i].image={id:"",w:0,h:0});FallbackValues.page&&(FallbackValues.page.image={id:"book_style:page/page_image.png",w:670,h:515}),FallbackValues.text&&(FallbackValues.inputclick=WCT.DeepCopy(FallbackValues.text))}();var HEX={0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,A:1,B:1,C:1,D:1,E:1,F:1,a:1,b:1,c:1,d:1,e:1,f:1};function hex_check(t){if("transparent"==t||"#transparent"==t)return"transparent";if("string"!=typeof t||!t)return"";if(6<(t=t.replace("#","")).length)return"";for(var e=t.split(""),i=e.length-1;0<=i;i--)if(!HEX[e[i]])return"";for(;t.length<6;)t="0"+t;return"#"+t}function clamp_trans(t,e){var i=Number(e.val);isNaN(i)||100<i?i=100:i<0&&(i=0),e.res=i}function clamp_color(t,e){""!=e.val?e.res=hex_check(e.val):e.res=""}function set_background_color(t,e,i){this._get_el().style.backgroundColor=i}function set_border_color(t,e,i){this._get_el().style.borderColor=i}function clamp_input_border(t,e){var i=e.val-0;if(0<i){var o=2*t.padding,r=2*i;r+o>=t.w&&(i=(t.w-o)/2-1),(r=2*i)+o>=t.h&&(i=(t.h-o)/2-1)}else i=0;e.res=i}function clamp_input_border_color(t,e){"string"==typeof e.val&&""==e.val?e.res="":e.res=hex_check(e.val)}function set_input_border(t,e,i){if(0<=i){var o=this._get_el();o.style.borderWidth=i+"px";var r=2*(t.padding+i),n=Math.max(1,t.w-r),s=Math.max(1,t.h-r);o.style.width=n+"px",o.style.height=s+"px"}this._rd_update_dom_rect&&this._rd_update_dom_rect()}function use_input_border_color(t,e,i){i?set_input_border_color.call(this,t,e,this._obj.border_color):this._get_el().style.borderColor=""}function set_input_border_color(t,e,i){t.set_border_color&&(this._get_el().style.borderColor=i)}function set_input_border_style(t,e,i){this._get_el().style.borderStyle=i}function clamp_ctrl_opacity(t,e){e.res="number"==typeof e.val?Math.max(Math.min(100,e.val),0):100}function set_ctrl_opacity(t,e,i){handle_visibility.call(this,t.hidden,i,!!arguments[3])}function set_locked(t,e,o){if(this._draggers){var r=this._draggers;for(i in r)r[i].StateToDom()}}function setTabIndex(t,e,i){var o=this._get_el();o&&(o.tabIndex=i)}function setAccessibility(t,e,i){var o=this._get_el();o&&o.setAttribute({arialabel:"aria-label"}[e]||e,i)}function clampTabIndex(t,e){e.res=Math.max(-1,e.val)}function set_hidden(t,e,o){if(handle_visibility.call(this,o,t.opacity,!!arguments[3]),this._draggers){var r=this._draggers;for(i in r)r[i].StateToDom()}LESSON_EDIT&&this._draggers&&this._draggers.main&&this._draggers.main.SetVisible(!o),this._update_hit_areas&&this._update_hit_areas()}function handle_visibility(t,e,i){void 0===e&&(e=100);var o=e;if(this.IsGrouped()){var r=this.GetGroupId(),n=Controls[r];if(!BROWSER.IE7&&!BROWSER.IE8||!(this instanceof ImageLink||this instanceof ImageControl||this instanceof TextBox||this instanceof Bubble))o*=n.GetOpacity()/100;n.isHidden()&&(o=!EDIT_MODE||Editor.Preview()?0:o<Fader.HIDE_OPACITY?o*Fader.HIDE_OPACITY/100:Fader.HIDE_OPACITY)}var s=arguments[3]||this._fader;if(s&&!i)EDIT_MODE&&!Editor.Preview()||!t?t&&(o=o<Fader.HIDE_OPACITY?o*Fader.HIDE_OPACITY/100:Fader.HIDE_OPACITY):o=o?0:o,s.SetOpacity(e),s.SetHideOpacity(o),s[t?"Hide":"Show"]();else{var a=this._get_el(),_=o<Fader.HIDE_OPACITY?o*Fader.HIDE_OPACITY/100:Fader.HIDE_OPACITY;EDIT_MODE&&!Editor.Preview()||(_=0),set_opacity(a,t?_:o)}}function _escapeFontFamily(t){var e=function(t,e){for(var i,o=[];i=e.exec(t);)o.push({value:i[1],index:i.index,length:i[1].length});return o}(t,new RegExp('font-family:(.*?)[;|"]',"gi"));if(0===e.length)return t;e.reverse();function i(t,e,i,o){for(var r=o.split(","),n=0,s=null;s=r[n];n++)"'"===(s=s.trim()).charAt(0)&&"'"===s.charAt(s.length-1)||'"'===s.charAt(0)&&'"'===s.charAt(s.length-1)||0<s.search(/['| ]/)&&(r[n]="'"+s.trim().replace(/'/g,"\\'")+"'");return o=r.join(", "),t.substr(0,e)+o+t.substr(e+i)}for(var o=0,r=null;r=e[o++];)t=i(t,r.index+12,r.length,r.value);return t}function replace_placeholder(t){if(!t)return t;var e={GetS:Env.LoadFile.bind(Env)},i={param_list:Page.GetPlaceholderValues()},o=WCT.Placeholder.Resolve(t,Context,e,i);return e.GetS=null,o}function set_hide_scrollbars(t,e,i){var o=this._get_el();o.style.overflow=i?"hidden":"auto",this._disable_dom_update||(o.scrollTop=0,this._update_dom())}function clamp_font_family(t,e){e.res=e.val}function set_trigger_error_on_use(t,e,i){var o=this._get_el();o.trigger_error_on_use=i,(o=this._get_el("#popup#dom"))&&(o.trigger_error_on_use=!1)}function clamp_h(t,e){var i=e.val-0,o=get_padding(t),r=get_border(t),n=o.h+r.h+1,s=Canvas.h()-t.y;e.res=parseInt(Math.max(Math.min(Math.max(n,i),s),1))}function clamp_floor_h(t,e){var i=e.val-0,o=get_padding(t),r=get_border(t),n=o.h+r.h+1,s=Canvas.h()-t.y;i=Math.min(Math.max(n,i),s),e.res=Math.max(2*Math.floor(i/2),1)}function set_h(t,e,i){var o=this._get_el(),r=get_padding(t),n=get_border(t);o.style.height=Math.max(r.h+n.h+1,i-r.h-n.h)+"px",!1!==arguments[3]&&do_general_update_.call(this,!0)}function clamp_popup_w(t,e){e.res=parseInt(Math.max(0,e.val-0))}function clamp_popup_h(t,e){e.res=parseInt(Math.max(0,e.val-0))}function clamp_w(t,e){var i=e.val-0,o=get_padding(t),r=get_border(t),n=o.w+r.w+1,s=Canvas.w()-t.x;e.res=parseInt(Math.max(Math.min(Math.max(n,i),s),1))}function clamp_floor_w(t,e){var i=e.val-0,o=get_padding(t),r=get_border(t),n=o.w+r.w+1,s=Canvas.w()-t.x;i=Math.min(Math.max(n,i),s),e.res=Math.max(2*Math.floor(i/2),1)}function set_w(t,e,i){var o=this._get_el(),r=get_padding(t),n=get_border(t),s=Math.max(r.w+n.w+1,i-r.w-n.w)+"px";o.style.width=s;var a=this._get_el("#main#text");a&&(a.style.width=s),!1!==arguments[3]&&do_general_update_.call(this,!0)}function clamp_bubble_wh(t,e){var i=e.val-0;i<0&&(i=0),e.res=i}function clamp_bubble_x(t,e){var i=e.val-0;i>Canvas.w()&&(i=Canvas.w()),i<0&&(i=0),e.res=i}function clamp_bubble_y(t,e){var i=e.val-0;i>Canvas.h()&&(i=Canvas.h()),i<0&&(i=0),e.res=i}function clamp_x(t,e){var i=e.val-0;i+t.w>Canvas.w()&&(i=Canvas.w()-t.w),i<0&&(i=0),e.res=parseInt(i)}function set_x(t,e,i){this._get_el().style.left=i+"px",!1!==arguments[3]&&do_general_update_.call(this)}function clamp_y(t,e){var i=e.val-0;i+t.h>Canvas.h()&&(i=Canvas.h()-t.h),i<0&&(i=0),e.res=parseInt(i)}function set_y(t,e,i){this._get_el().style.top=i+"px",!1!==arguments[3]&&do_general_update_.call(this)}function clamp_z(t,e){e.res=Math.max(0,e.val-0)}function set_z(t,e,i){this._get_el().style.zIndex=i,this._draggers&&this._draggers.main&&this._draggers.main.UpdatePos(),EDIT_MODE&&(document.body.visibility="hidden",document.body.visibility="visible",document.body.visibility=""),this._update_hit_areas&&this._update_hit_areas()}function clamp_font_size(t,e){var i=parseInt(e.val);e.res=0<=i?i+"":""}function clamp_valign(t,e){switch(e.val){case"middle":case"bottom":e.res=e.val;break;default:e.res="top"}}function clamp_align(t,e){switch(e.val){case"1":case"center":case"Center":e.res="Center";break;case"2":case"right":case"Right":e.res="Right";break;case"3":case"start":e.res="start";break;case"4":case"end":e.res="end";break;case"0":case"left":case"Left":default:e.res="Left"}}function set_valign(t,e,i){var o=this._get_el(),r=this._get_el("#main#text")||o,n=r.offsetHeight||0;if("td"==r.tagName.toLowerCase())r.style.verticalAlign=i;else if(n<t.h)switch(i){case"top":r.style.bottom="",r.style.top=t.padding+"px";break;case"middle":r.style.bottom="",r.style.top=(t.h-2*t.border-n>>1)+"px";break;case"bottom":r.style.top="",r.style.bottom=t.padding+"px"}else if(!t.hide_scrollbars)switch(i){case"top":o.scrollTop=0;break;case"middle":o.scrollTop=-1*(t.h-2*t.border-n>>1);break;case"bottom":o.scrollTop=t.h}}function noop(){}function get_correct_align(t){if(t=t.toLowerCase(),!BROWSER.IE||"start"!=t&&"end"!=t)return t;var e=!1,i=Controls[arguments[1]];if(i&&i.IsRTL)e=i.IsRTL();else{var o=Page.GetVariable("content_language")||"";e=WCT.IsLanguageRTL(o)}return"start"==t==e?"right":"left"}function set_font_styles(t,e,i){var o=this._get_el("#main#text")||this._get_el();if(o)switch(e){case"underline":o.style.textDecoration=i?"underline":"";break;case"bold":o.style.fontWeight=i?"bold":"";break;case"italic":o.style.fontStyle=i?"italic":"";break;case"align":o.style.textAlign=get_correct_align(i);break;case"text_color":o.style.color=i;break;case"font_family":o.style.fontFamily=i;break;case"font_size":var r=window.Controls&&Controls.page&&Controls.page._obj,n=r&&r.fontsizeInPt?"pt":"px";o.style.fontSize=i?i+n:""}}function get_computed_style(t){return window.getComputedStyle?window.getComputedStyle(t,""):t.currentStyle?t.currentStyle:{}}function set_disabled(t,e,i){var o=this._get_el(),r=!!i;o.disabled=r,o.setAttribute("aria-disabled",""+r)}function clamp_boolean(t,e){var i=e.val;"boolean"==typeof i?e.res=i:"string"==typeof i?e.res="true"==i||"on"==i||"1"==i:"number"==typeof i&&(e.res=0!=i)}function set_fade_time(t,e,i){var o=this._fader;o&&("fade_in_time"==e?(o.SetTime("fade_in_time",i),o.SetTime("fly_x_in_time",i),o.SetTime("fly_y_in_time",i),o.SetTime("zoom_in_time",i),o.SetTime("bounce_in_time",i)):(o.SetTime("fade_out_time",i),o.SetTime("fly_x_out_time",i),o.SetTime("fly_y_out_time",i),o.SetTime("zoom_out_time",i),o.SetTime("bounce_out_time",i)))}function as_boolean(t){return 1==t||"1"==t||!0===t||"true"==t||"on"==t}function GetZForControls(t,e){for(var i=t.length,o="min"==e?999999:0,r=0;r<i;r++){var n=Controls[t[r]].GetZIndex();void 0!==n&&(o=Math[e](o,n))}return o}function GetRectForControls(t){for(var e=[],i={x_ruler:1,y_ruler:1},o=0,r=null;r=Controls[t[o++]];){var n=r._obj;if(!i[n.type]){if("bubble"===n.type||"arrow"===n.type||"connector"===n.type)if(_=r.GetHtmlPosSize()){if(BROWSER.IE8){var s=Page.GetScale();_.x=Math.round(_.x/s)-Canvas.x()+Math.round(Page.scrollLeft/s),_.y=Math.round(_.y/s)-Canvas.y()+Math.round(Page.scrollTop/s)}else{var a=Canvas.border();_.x=_.x-Canvas.x()+Page.scrollLeft+a,_.y=_.y-Canvas.y()+Page.scrollTop+a}n=_}null!=n.x&&null!=n.y&&null!=n.w&&null!=n.h&&e.push({x:n.x,y:n.y,w:n.w,h:n.h})}}var _;return(_=WCT.geometry.CombineRects(e))?{w:Math.round(_.w),h:Math.round(_.h),x:Math.round(_.x),y:Math.round(_.y)}:null}function to_producer_resource_(t){var e=document.location.href,i={warning_overlay:{pid:"1259",ext:"gif"},hotspot:{pid:"1264",ext:"png"},1:{pid:"1265",ext:"gif"}}[t]||{pid:t,ext:"png"};return-1==e.search(/^res:/)?e.replace(/slide\.htm/,t+"."+i.ext).replace(/[\?#].*$/,""):e.replace(/1249/,i.pid.toUpperCase()).replace(/\.html?$/gi,"")}Array.prototype.mix||(Array.prototype.mix=function(){var t=this.length;if(t<2)return this;for(var e=t-1;0<e;e--){var i=Math.floor(Math.random()*(e+1)),o=this[e];this[e]=this[i],this[i]=o}return this});var Ticker={clients_:{},clients_js_:{},system_:{},system_js_:{},num_clients_:0,num_system_:0,unregistered_:{},unregistered_js_:{},cur_time_:-1,time_off_:0,pause_time_:null,interval_:null,paused_:!1,user_paused_:!1,video_:null,tick_interval:50,Register:function(t){var e=Controls[t];e&&"function"==typeof e.Tick&&(this.init_time_(),"undefined"==typeof this.clients_[t]&&(this.num_clients_++,arguments[1]&&(this.system_[t]=1,this.num_system_++)),this.clients_[t]=this.video_?0:this.cur_time_,window.ctx&&ctx.onTicker&&ctx.onTicker("register",this.num_clients_,this.num_system_),this.start_())},RegisterJS:function(t,e){t&&"function"==typeof t.Tick&&(this.init_time_(),"undefined"==typeof this.clients_js_[e]&&(this.num_clients_++,arguments[2]&&(this.system_js_[e]=1,this.num_system_++)),this.clients_js_[e]={obj:t,tick:this.video_?0:this.cur_time_},window.ctx&&ctx.onTicker&&ctx.onTicker("register",this.num_clients_,this.num_system_),this.start_())},UnregisterAll:function(){this.stop_()},Unregister:function(t){"undefined"!=typeof this.clients_[t]&&(delete this.clients_[t],this.unregistered_[t]=!0,this.num_clients_--,this.system_[t]&&(delete this.system_[t],this.num_system_--),window.ctx&&ctx.onTicker&&ctx.onTicker("unregister",this.num_clients_,this.num_system_))},UnregisterJS:function(t){"undefined"!=typeof this.clients_js_[t]&&(this.unregistered_js_[t]=!0,delete this.clients_js_[t],this.num_clients_--,this.system_js_[t]&&(delete this.system_js_[t],this.num_system_--),window.ctx&&ctx.onTicker&&ctx.onTicker("unregister",this.num_clients_,this.num_system_))},Tick:function(){this.cur_time_=(new Date).getTime()-this.time_off_;var t=this.clients_,e=WCT.DeepCopy(t),i=this.clients_js_,o={};for(var r in i)o[r]={obj:i[r].obj,tick:i[r].tick};var n=this.user_paused_,s=this.system_,a=this.system_js_,_=this.unregistered_,l=this.unregistered_js_,d=this.video_;if(d){for(var r in d=1e3/d.fr,e)_[r]||n&&!s[r]||Controls[r]&&Controls[r].Tick(t[r]+=d);for(var r in o)l[r]||n&&!a[r]||o[r].obj.Tick(i[r].tick+=d)}else{var h=this.cur_time_;for(var r in e)_[r]||n&&!s[r]||Controls[r]&&Controls[r].Tick(h-e[r]);for(var r in o)l[r]||n&&!a[r]||o[r].obj.Tick(h-o[r].tick)}this.unregistered_={},this.unregistered_js_={},window.ctx&&ctx.onTicker&&ctx.onTicker("tick",this.num_clients_,this.num_system_),this.num_clients_<=0&&this.stop_()},Pause:function(){var t=arguments[0]||!1;t||(this.paused_=!0),this.user_paused_=!0,null==this.pause_time_&&(this.pause_time_=(new Date).getTime()),this.interval_&&!t&&(EDIT_MODE&&Editor.RuntimeInfo("Timer Paused"),WCT.ClearInterval(this.interval_),this.interval_=null),window.ctx&&ctx.onTicker&&ctx.onTicker("pause",this.num_clients_,this.num_system_)},Continue:function(){if(this.paused_=!1,this.user_paused_=!1,null!=this.pause_time_){var t=(new Date).getTime();for(var e in this.time_off_+=t-this.pause_time_,this.pause_time_=null,this.clients_js_){var i=this.clients_js_[e];-1===i.tick&&(i.tick=t-this.time_off_)}}this.start_()},IsIdle:function(){return arguments[0]?this.num_clients_-this.num_system_<=0:this.num_clients_<=0},SetVideoMode:function(t){this.video_?this.video_.fr=t:this.video_={fr:t}},VideoTick:function(){var t=this.video_;t&&t.start&&this.Tick()},start_:function(){this.interval_||this.paused_||this.num_clients_<=0||(this.video_?this.video_.start=!0:this.interval_=WCT.SetInterval(Ticker.Tick,this.tick_interval,Ticker),EDIT_MODE&&Editor.RuntimeInfo("Timer Start"),window.ctx&&ctx.onTicker&&ctx.onTicker("start",this.num_clients_,this.num_system_))},init_time_:function(){this.interval_||this.paused_||this.user_paused_||(this.time_off_=0,this.cur_time_=(new Date).getTime())},stop_:function(){this.video_?delete this.video_.start:this.interval_&&(EDIT_MODE&&Editor.RuntimeInfo("Timer Stop"),WCT.ClearInterval(this.interval_)),this.interval_=null,this.clients_={},this.clients_js_={},this.system_={},this.system_js_={},this.num_clients_=0,this.num_system_=0,this.unregistered_={},this.unregistered_js_={},this.pause_time_=null,window.ctx&&ctx.onTicker&&ctx.onTicker("stop",0,0)}};if(void 0===ctx)var ctx={cfg_show:function(t,e,i){return t.substr&&"action!"==t.substr(0,7)?this.cfg_action(t.substr(7)):t.substr&&"trigger!"==t.substr(0,8)?Page.RTFireTrigger(t.substr(8)):void Editor.RuntimeInfo("Show: "+t+", "+e+", "+i)},cfg_onplaystatechange:function(t,e){Editor.RuntimeInfo("PlayState ch ("+e+"): "+t)},track:function(t){Editor.RuntimeInfo("Track cur: "+t.cur+" / max: "+t.max)},track_completion:function(){},cfg_action:function(t){switch(t){case"book_sound_on":Media.audio.PlayPagesound();break;case"book_sound_off":Media.audio.StopPagesound();break;case"book_toggle_sound":var e=Media.audio.Playing("Pagesound");Media.audio.StopPagesound(),e||Media.audio.PlayPagesound();break;case"book_sound_mute":Media.audio.Mute("Pagesound");break;case"book_sound_unmute":Media.audio.Unmute("Pagesound");break;case"book_all_sound_off":Media.audio.StopAll();break;case"book_all_sound_mute":Media.Mute();break;case"book_all_sound_unmute":Media.Unmute();break;default:Editor.RuntimeInfo("Action: "+t)}var i=window.event;if(i)return i.cancelBubble=!0,i.returnValue=!1,i.preventDefault&&i.preventDefault(),i.stopPropagation&&i.stopPropagation(),!1},getToc:function(){return{previousSlide:!0,nextSlide:!0}},cfg_tr:function(t){return t}};var base_initialized=!1,Canvas=null,LogOn=!1,hit_manager_log=!1,inPlaceEditor=!1,Controls={},Draggers={},Editor=null,RT=null,Context=null,Mouse=null,WayPoint={},T2_BUILDNUMBER="10.0.0",EDIT_MODE=!0,T2=!1,SIM_MODE=null,LESSON_EDIT=!1,BOOK_EDIT=!0,NO_ALERT=!1,SCREENSHOT_MODE=!1,WEB_LESSON_EDITOR=!1,XRAY_WEB_LESSON_EDITOR=!1,DEBUG=!1;try{parent.DEBUG&&(DEBUG=!0)}catch(e){}function page_base(t,e){return e&&ctx.cfg_setSlideUrlString(ctx.cfg_resolve("wa:slide/"+e+"/","wa:")),ctx.cfg_resolve("slide:","wa:")}function skin_base(t,e,i){return i&&i.length&&ctx.cfg_setSlideStyle(i),ctx.cfg_resolve("slide_style:")}function LOG(t){LogOn&&Env._sink&&Env.LOG(t)}function hdl_imageloaded(t){Editor&&Editor.ImageLoaded(t)}function createSourceContext(t){var e=new WCT.context;for(var i in t)"_this"==i?e.SetScope(t[i]):e.Set(i,t[i]);return e}function setWebLessonEditor(t){WEB_LESSON_EDITOR=!0,"xray"===t&&(XRAY_WEB_LESSON_EDITOR=!0),$("frame").className+=" web-lesson-editor"}function LoadFile(t,e,i){if("undefined"!=typeof ctx.cfg_load_file_async){var o=Context.ToAbsPath(t);if("function"!=typeof e&&"object"!=typeof e){var r=ctx.cfg_load_file_sync(o),n=r.status.toString();return 3==n.length&&"2"==n.substr(0,1)||"0"==n?r.responseText:""}ctx.cfg_load_file_async(o,null,i.shift(),e,null,!1,i)}else{if("function"!=typeof e&&"object"!=typeof e)return Env.LoadFile(t);e.call(i.shift(),Env.LoadFile(t),i[0])}}function rt_hdl_mousedown(t){return RT.OnMouseDown(t||event)}function rt_hdl_mouseup(t){return RT.OnMouseUp(t||event)}function rt_hdl_mousemove(t){return RT.OnMouseMove(t||event)}function rt_hdl_mouseover(t){return RT.OnMouseMove(t||event)}function rt_hdl_mouseout(t){return RT.OnMouseMove(t||event)}function rt_hdl_mousewheel(t){return RT.OnMouseWheel(t||event)}function rt_hdl_click(t){return RT.OnMouseClick(t||event)}function rt_hdl_dblclick(t){return RT.OnMouseDblClick(t||event)}function rt_hdl_keypress(t){return RT.OnKeyPress(t||event)}function rt_hdl_keydown(t){return RT.OnKeyDown(t||event)}function rt_hdl_keyup(t){return RT.OnKeyUp(t||event)}function rt_hdl_change(t){return RT.OnChange(t||event)}function rt_hdl_touchstart(t){return RT.OnTouchStart(t||event)}function rt_hdl_touchend(t){return RT.OnTouchEnd(t||event)}function rt_hdl_touchmove(t){return RT.OnTouchMove(t||event)}function rt_hdl_ms_pointerdown(t){return RT.OnMSPointerDown(t||event)}function rt_hdl_ms_pointerup(t){return RT.OnMSPointerUp(t||event)}function rt_hdl_ms_pointermove(t){return RT.OnMSPointerMove(t||event)}function rt_hdl_focus(t){return RT.OnFocus(t||event)}function rt_hdl_blur(t){return RT.OnBlur(t||event)}function rt_hdl_context(t){return WCT.event.Cancel(t||event)}function hdl_mousedown(t){return Editor.OnMouseDown(t)}function hdl_mouseup(t){return Editor.OnMouseUp(t)}function hdl_mousemove(t){return Editor.OnMouseMove(t)}function hdl_mouseover(t){return Editor.OnMouseEnter(t)}function hdl_click(t){return Editor.OnMouseClick(t)}function hdl_mousedblclick(t){return Editor.OnMouseDblClick(t)}function hdl_mouseout(t){return Editor.OnMouseLeave(t)}function hdl_keypress(t){return Editor.OnKeyPress(t)}function hdl_touchstart(t){Editor.OnTouchStart(t)}function hdl_touchend(t){Editor.OnTouchEnd(t)}function hdl_touchmove(t){Editor.OnTouchMove(t)}function hdl_mousewheel(t){return Editor.OnMouseWheel(t)}function hdl_keydown(t){if(32==(t=WCT.event.Standardize(t)).keyCode)return document.documentElement.style.cursor="move",Editor.space_down_=!0,WCT.event.Cancel(t),!1;if(116==t.keyCode)return t.keyCode=0,t.cancelBubble=!0,t.returnValue=!1;var e=Editor.Active();return(!e||"page"==Controls[e]._obj.id||!Editor.OnKeyDown(t))&&(!Env._sink||!Env._sink.OnKeyDown||!Env._sink.OnKeyDown(t))}function hdl_keyup(t){EDIT_MODE&&32==t.keyCode&&(document.documentElement.style.cursor="",Editor.space_down_=!1),t=WCT.event.Standardize(t);var e=Editor.Active();return(!e||"page"==Controls[e]._obj.id||!Editor.OnKeyUp(t))&&(!Env._sink||!Env._sink.OnKeyUp||!Env._sink.OnKeyUp(t))}function hdl_onfocus(){window.Page&&Page.RTFireTrigger("page.focus")}function hdl_onblur(){window.Page&&Page.RTFireTrigger("page.blur")}function hdl_onscroll(t){var e=EDIT_MODE&&!BROWSER.MOBILE?BROWSER.SAFARI||BROWSER.EDGE?document.body:document.documentElement:$("frame");(window.Page||e)&&(BROWSER.CHROME&&0===e.scrollLeft&&0===e.scrollTop&&(e=document.body),Page.scrollLeft=e.scrollLeft,Page.scrollTop=e.scrollTop,PageCanvas.HandleSubtitle())}function calc_frame_wh(){var t=Page.clientWidth,e=Page.clientHeight;if(BROWSER.MOBILE)"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&(t=arguments[0],e=arguments[1]);else{var i=document.documentElement;t=i.clientWidth,e=i.clientHeight}return{w:t,h:e}}var scroll_timeout_id_=null;function hdl_onresize(t){if(window.Page){var e=arguments[1],i=arguments[2],o=Page.clientWidth,r=Page.clientHeight;if(window.Canvas){var n=e&&i?calc_frame_wh(e,i):Canvas.GetClientWH();if(n.w!=o||n.h!=r){Page.clientWidth=n.w,Page.clientHeight=n.h,Canvas.OnViewResize(n.w,n.h);var s=calc_frame_wh(arguments[1],arguments[2]);if(n.w!=s.w||n.h!=s.h)for(var a in Page.clientWidth=s.w,Page.clientHeight=s.h,Canvas.OnViewResize(s.w,s.h),Controls)"page"!=a&&Controls[a].OnViewResize(s.w,s.h)}if(BROWSER.IE8?(this.scroll_timeout_id_&&(WCT.ClearTimeout(this.scroll_timeout_id_),this.scroll_timeout_id_=null),this.scroll_timeout_id_=WCT.SetTimeout(hdl_onscroll,250)):hdl_onscroll(),RT&&RT.HasResizeControls())for(var _=RT.GetResizeControls(),l=_.length-1;0<=l;l--){var d=Controls[_[l]];d&&d.OnRTResize&&d.OnRTResize(t)}PageCanvas.HandleSubtitle()}else PLATFORM.IOS&&e&&i&&(e!=o||i!=r)&&(Page.clientWidth=e,Page.clientHeight=i)}}function hdl_forbiddrag(t){var e=t||window.event;return e.cancelBubble=!0,e.returnValue=!1,e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}function init_page(){if(!base_initialized){document.documentElement.style.overflow="auto",window.onhelp=function(){return!1},document.onhelp=function(){return!1};var t=location.search||location.hash;if(t.length)for(var e=(t=t.replace(/^\?|^#/,"").split("&")).length-1;0<=e;e--){var i=t[e].split("=");if(2==i.length)switch(i[0]){case"edit_mode":EDIT_MODE=1==i[1];break;case"no_alert":NO_ALERT=1==i[1];break;case"t2":T2=1==i[1]}}Page.Init(),Context||(CreateContext(),Context.Set("book_style","standard")),base_initialized=!0,EDIT_MODE&&void 0!==_Editor?Editor=Editor||new _Editor:RT=RT||new _RT,Env.pageComplete(),EDIT_MODE&&Editor&&!Editor.Preview()&&(document.body.className="editmode")}}function CreateContext(){if(!Context)if(EDIT_MODE||!T2)(Context=new WCT.context).Set("skin","adaptable!trainer_skin");else{var t=parent.MANAGER,e=t&&t.handler.GetActive()||null;(Context=e&&e.GetContext())||(Context=new WCT.context).Set("skin","adaptable!trainer_skin")}}function AddRTEventListener(){HandleRTEventListener("Add")}function RemoveRTEventListener(){HandleRTEventListener("Remove")}function HandleRTEventListener(t){var e="Add"==t;if(e){if(RemoveEditorEventListener(),Page.rtEvtListener)return}else if(!RT||!Page.rtEvtListener)return;RT=RT||new _RT;var i=WCT.event[e?"Observe":"StopObserving"];PLATFORM.IOS?(i("touchstart",rt_hdl_touchstart,document.body),i("touchend",rt_hdl_touchend,document.body),i("touchmove",rt_hdl_touchmove,document.body)):PLATFORM.ANDROID?(i("touchstart",rt_hdl_touchstart),i("touchend",rt_hdl_touchend),i("touchmove",rt_hdl_touchmove)):PLATFORM.WINTABLET?(i("MSPointerDown",rt_hdl_ms_pointerdown,document.body),i("MSPointerUp",rt_hdl_ms_pointerup,document.body),i("MSPointerMove",rt_hdl_ms_pointermove,document.body),i("click",rt_hdl_click)):(i("mousedown",rt_hdl_mousedown),i("mousemove",rt_hdl_mousemove),i("mouseup",rt_hdl_mouseup),i("mouseover",rt_hdl_mouseover),i("mouseout",rt_hdl_mouseout),i("mousewheel",rt_hdl_mousewheel),i("DOMMouseScroll",rt_hdl_mousewheel),i("click",rt_hdl_click),BROWSER.IE9&&i("contextmenu",rt_hdl_click)),i("dblclick",rt_hdl_dblclick),i("keypress",rt_hdl_keypress),i("keydown",rt_hdl_keydown),i("keyup",rt_hdl_keyup),i("contextmenu",rt_hdl_context),e||(RT&&RT.Cleanup(),EDIT_MODE&&(RT=null)),Page.rtEvtListener=e,document.onselectstart=""}function RemoveEditorEventListener(){if(Page.editorEvtListener){var t=WCT.event.StopObserving;PLATFORM.IOS?(t("touchstart",hdl_touchstart,document.body),t("touchend",hdl_touchend,document.body),t("touchmove",hdl_touchmove,document.body)):PLATFORM.ANDROID?(t("touchstart",hdl_touchstart),t("touchend",hdl_touchend),t("touchmove",hdl_touchmove)):(t("mousedown",hdl_mousedown),t("mousemove",hdl_mousemove),t("mouseup",hdl_mouseup),t("mouseover",hdl_mouseover),t("mouseout",hdl_mouseout),t("click",hdl_click),t("dblclick",hdl_mousedblclick),t("keypress",hdl_keypress),t("keydown",hdl_keydown),t("keyup",hdl_keyup),t("mousewheel",hdl_mousewheel),t("DOMMouseScroll",hdl_mousewheel)),Page.editorEvtListener=!1}}function AddEditorEventListener(){if(RemoveRTEventListener(),!Page.editorEvtListener){Editor=Editor||new _Editor;var t=WCT.event.Observe;PLATFORM.IOS?(t("touchstart",hdl_touchstart,document.body),t("touchend",hdl_touchend,document.body),t("touchmove",hdl_touchmove,document.body)):PLATFORM.ANDROID?(t("touchstart",hdl_touchstart),t("touchend",hdl_touchend),t("touchmove",hdl_touchmove)):PLATFORM.WINTABLET||(t("mousedown",hdl_mousedown),t("mousemove",hdl_mousemove),t("mouseup",hdl_mouseup),t("mouseover",hdl_mouseover),t("mouseout",hdl_mouseout),t("click",hdl_click),t("dblclick",hdl_mousedblclick),t("keypress",hdl_keypress),t("keydown",hdl_keydown),t("keyup",hdl_keyup),t("mousewheel",hdl_mousewheel),t("DOMMouseScroll",hdl_mousewheel)),Page.editorEvtListener=!0,document.onselectstart=function(){return!1}}}function getHtmlPosSize(t){var e={x:0,y:0,w:0,h:0};if(t&&document&&document.documentElement&&(e.w=t.offsetWidth,e.h=t.offsetHeight,t.offsetParent))for(;e.x+=t.offsetLeft,e.y+=t.offsetTop,t=t.offsetParent;);return arguments[1]||(e.x-=Page.scrollLeft,e.y-=Page.scrollTop),e}function UnionPosSize(t,e){if(!t)return e;if(!e)return t;var i=Math.max(t.x+t.w,e.x+e.w),o=Math.max(t.y+t.h,e.y+e.h);return t.x=Math.min(t.x,e.x),t.y=Math.min(t.y,e.y),t.w=i-t.x,t.h=o-t.y,t}function GetBoundingRect(t){if(!t||!Controls.page)return{left:0,top:0,right:0,bottom:0};for(var e,i,o={left:1e5,top:1e5,right:0,bottom:0},r=0;r<t.length;r++){var n=Controls[t[r]];if(n){var s=n.GetHtmlPosSize(0);s.w&&s.h&&(e=o,i={left:0+s.x,top:0+s.y,right:0+s.x+s.w,bottom:0+s.y+s.h},o=e?(i&&(e.left=Math.min(e.left,i.left),e.top=Math.min(e.top,i.top),e.right=Math.max(e.right,i.right),e.bottom=Math.max(e.bottom,i.bottom)),e):i)}}return 1e5==o.left&&(o.left=0,o.top=0),o}function ScrollIntoView(t){return Editor&&1!=Page.GetScale()?Editor.ScrollToSelection():ScrollRectIntoView(GetBoundingRect(t))}function ScrollRectIntoView(t){if(!document||!document.documentElement)return!1;var e=document.documentElement;if(!t)return e.scrollLeft=0,e.scrollTop=0,!1;var i=e.clientWidth,o=e.clientHeight,r=e.scrollLeft,n=e.scrollTop,s=r,a=n,_=r+i,l=n+o;if(t.left+=r,t.top+=n,t.right+=r,t.bottom+=n,t.left=Math.max(0,t.left-20),t.top=Math.max(0,t.top-20),t.right=Math.min(e.scrollWidth,t.right+20),t.bottom=Math.min(e.scrollHeight,t.bottom+20),t.left>=s&&t.top>=a&&t.right<=_&&t.bottom<=l)return!1;if(t.left>_){var d=t.left+(t.right-t.left)/2;e.scrollLeft=d-i/2}else t.left<s&&t.right<_?e.scrollLeft=t.left:t.left<_&&t.right>_&&(e.scrollLeft=Math.min(t.left,t.right-i));if(t.top>l){d=t.top+(t.bottom-t.top)/2;e.scrollTop=d-o/2}else t.top<a&&t.bottom<l?e.scrollTop=t.top:t.top<l&&t.bottom>l&&(e.scrollTop=Math.min(t.top,t.bottom-o));return hdl_onscroll(),!0}function on_unload(){try{ctx&&(ctx.slide_defaults=null),WCT.CleanupObject(Bubble.Styles),Media.Cleanup(),WCT.Cleanup(),HotkeyMaster.Cleanup(),EventMaster.Cleanup(),Status.Cleanup(),window.Mouse&&(Mouse.Terminate(),Mouse=null),Page&&Page.Cleanup(),window.ctx&&window.ctx.cfg_stopsound&&window.ctx.cfg_stopsound(""),RT&&RT.Cleanup(),Context&&Context.Destructor(),window.IMAGE_OBJECTS&&IMAGE_OBJECTS.Cleanup(),window.onhelp=null,document.onhelp=null}catch(e){}}function PageUpdateControl(ctl_id,prop,value,json){return json&&""!=json?(eval("var obj = "+json+";"),Page.UpdateControl(ctl_id,prop,obj)):Page.UpdateControl(ctl_id,prop,value)}function PageUnspecifyControlParam(t,e){var i=undefined,o=ctx.slide_template&&ctx.slide_template[t]&&ctx.slide_template[t][e];if(null!=o)i=o;else{var r=Controls[t];if(r&&r._obj&&ctx.slide_defaults){var n=ctx.slide_defaults[r._obj.type];n&&"undefined"!=typeof n[e]&&(i=n[e])}}return Page.UpdateControl(t,e,i)}function do_not_alert(){NO_ALERT=!0}var Env={_sink:0,_pageloadSink:null,_in_drag:!1,_pageComplete:!1,LOG:function(t){this._sink&&this._sink.LOG(t)},onSizeChange:function(t,e,i){if(this._sink){var o=Page.GetContentScale();e=parseInt(e*o),i=parseInt(i*o),this.doAlert&&Log2Win("onSizeChange :: "+[e,i].join(", ")),this._sink.onSizeChange(t,e,i)}},onPosChange:function(t,e,i){if(this._sink){var o=Page.GetContentScale();e=parseInt(e*o),i=parseInt(i*o),this.doAlert&&Log2Win("onPosChange :: "+[e,i].join(", ")),this._sink.onPosChange(t,e,i)}},onPropChange:function(t,e,i){var o=this._sink;"object"!=typeof i&&void 0!==i&&o&&o.onPropChange&&(Page.in_update=!0,o.onPropChange(t,e,i+""),Page.in_update=!1)},ControlDeleted:function(t){!this._sink||Page.IsInCreate()&&!arguments[1]||this._sink.ControlDeleted(t),window.Editor&&Editor.EvaluateSelection()},ControlAdded:function(t){this._sink&&!Page.IsInCreate()&&this._sink.ControlAdded(t)},onActivate:function(t){t=t||"page",this._sink&&this._sink.onActivate(t)},onBeginDrag:function(){this._sink&&!this._in_drag&&(this._in_drag=!0,this._sink.onBeginDrag())},onEndDrag:function(){this._sink&&this._in_drag&&(this._in_drag=!1,this._sink.onEndDrag())},onBeginInPlaceEdit:function(){this._sink&&this._sink.onBeginInPlaceEdit()},onEndInPlaceEdit:function(){this._sink&&this._sink.onEndInPlaceEdit()},onShow:function(t){this._sink&&this._sink.onShow(t)},onDoubleClick:function(t){this.onDefaultEdit(t)},onDefaultEdit:function(t){if(!EDIT_MODE)return!1;var e=this._sink;if(e&&e.onDefaultEdit&&e.onDefaultEdit(t))return!0;var i=Controls[t];return!!i&&i.OnDefaultEdit(arguments[1])},onSelectionChange:function(t){this._sink&&this._sink.onSelectionChange(t)},onSettingsChange:function(){if(this._sink){var t="{"+["LogOn:"+LogOn,"SnapDistance:"+SnapDistance,"SnapObjects:"+SnapObjects,"SnapGrid:"+SnapGrid,"SnapCenters:"+SnapCenters,"SnapRulers:"+SnapRulers,"ShowSnapTargets:"+ShowSnapTargets].join(",")+"}";this._sink.onSettingsChange(t)}},onDeviceInput:function(t){this._sink&&this._sink.setAccessibilityMode&&this._sink.setAccessibilityMode("key"===t)},OnInteractive:function(){var t=this._sink;t&&t.OnInteractive&&t.OnInteractive()},OnScreenshotReady:function(){var t=this._sink;t&&t.OnScreenshotReady&&(Page.SetReadOnly(!0),t.OnScreenshotReady())},OnHotkey:function(t){var e=this._sink;e&&e.CancelHotkey?e.CancelHotkey(t):WCT.event.hotkey.CancelBrowserHotkey(t),e&&e.OnHotkey?e.OnHotkey(t):EDIT_MODE&&WCT.event.hotkey.Fired(t)},ObserveHotkey:function(t,e,i,o){return this._sink&&this._sink.ObserveHotkey?this._sink.ObserveHotkey(t,e,i,o):EDIT_MODE?WCT.event.hotkey.Observe(t,e,i,o):void 0},StopObservingHotkey:function(t,e){this._sink&&this._sink.StopObservingHotkey?this._sink.StopObservingHotkey(t,e):EDIT_MODE&&WCT.event.hotkey.StopObserving(t,e)},GetConfig:function(t){return this._sink&&this._sink.GetConfig?this._sink.GetConfig(t):null},enterOrSpaceInUse:function(){return this._sink&&this._sink.enterOrSpaceInUse?this._sink.enterOrSpaceInUse():{enter:!1,space:!1}},pageComplete:function(){this._pageloadSink&&(this._pageComplete&&!arguments[0]||this._pageloadSink.onPageComplete()),this._pageComplete=!0},isPageComplete:function(){return this._pageComplete},getPlaceholderValue:function(t){return Page.GetPlaceholder(t)},LoadFile:function(t){if(this._sink)return this._sink.LoadFile(t)},Print:function(t){this._sink&&this._sink.Print&&this._sink.Print(t,arguments[1]||!1)},AddHistory:function(){this._sink&&this._sink.AddHistory&&this._sink.AddHistory()},SetPreviewCanvas:function(t,e,i){this._sink&&this._sink.SetPreviewCanvas&&this._sink.SetPreviewCanvas(t,e,i)},showMessageInWindow:function(t,e){this._sink&&this._sink.showMessageInWindow&&this._sink.showMessageInWindow(t,e)},edit:function(t){var e=t.ctlId,i=t.paramName,o=t.posSize;if(!EDIT_MODE)return!1;if(!this._sink||!this._sink.Edit)return!1;var r=Controls[e];if(!r)return!1;var n=t.paramW||null,s=t.paramH||null,a=t.extInfo?WCT.DeepCopy(t.extInfo):{};return n&&s&&(a.param_w=n+"",a.param_h=s+""),a[i]&&(a[i]=""),a.pos_size||(a.pos_size=o||r.GetHtmlPosSize(1)),this._sink.Edit(e,i,JSON.stringify(a))},playPageTransition:function(){this._pageloadSink&&this._pageloadSink.playPageTransition()},VideoMode:function(){return this._sink&&this._sink.VideoMode()||!1},PreventNavigation:function(t){this._sink&&this._sink.PreventNavigation(t)}},Curtain={Add:function(){if(!PLATFORM.WINCE){var t=$("page_curtain");if(!t)if(Canvas){var e=Canvas._obj;if(e&&0<Page.clientWidth&&0<Page.clientHeight){var i=e.image||null;i&&i.id&&(t=Canvas.create_image(i,!1))&&(t.style.left=Canvas.x()+"px",t.style.top=Canvas.y()+"px",t.style.width=e.w+"px",t.style.height=e.h+"px",t.style.backgroundColor=e.background_color)}var o=$("frame");t||((t=$$("div")).style.left=Canvas.x()+"px",t.style.top=Canvas.y()+"px",t.style.width=e.w+"px",t.style.height=e.h+"px",t.style.backgroundColor=Canvas.Frame().style.backgroundColor||"white");var r=$$("div");if(r.id="page_cover",r.style.backgroundColor=o.style.backgroundColor,r.style.position="absolute",r.style.zIndex=1e5,r.style.left=0,r.style.top=0,r.style.width=o.scrollWidth+"px",r.style.height=o.scrollHeight+"px",r.style.backgroundImage=o.style.backgroundImage,r.style.backgroundSize=o.style.backgroundSize,Page.GetConfig("show_focus_layer")){var n=$$("div");n.id="page_overlay";var s=Highlight.OVERLAY_DEFAULTS;WCT.ExtendObject(n.style,{width:o.scrollWidth+"px",height:o.scrollHeight+"px",top:0,left:0,position:"absolute",zIndex:100001,backgroundColor:s.color,opacity:s.opacity}),o.appendChild(n)}o.appendChild(r),t.id="page_curtain",t.style.position="absolute",t.style.zIndex=1e5,o.appendChild(t)}else BROWSER.MOBILE||((t=$$("div")).id="page_curtain",t.style.position="absolute",t.style.left=0,t.style.top=0,t.style.width=WCT.dom.GetWindowWidth()+"px",t.style.height=WCT.dom.GetWindowHeight()+"px",t.style.backgroundColor="white",t.style.zIndex=1e5,$("frame").appendChild(t))}},Remove:function(){var t=$("page_cover");t&&t.parentNode.removeChild(t);var e=$("page_overlay");e&&e.parentNode.removeChild(e);var i=$("page_curtain");i&&i.parentNode.removeChild(i)}};function TextObject(t){this.uid_=arguments[1]||WCT.uid.Generate(10,"TO_"),this.ctl_id_=t,this.style_={},this.dirty_={},this.msie5_=!1,this.observer_id_=null,this.scroll_fun_=null,this.scroll_scope_=null}function BorderObject(){this.uid_=arguments[0]||WCT.uid.Generate(10,"BO_"),this.src_ctx_=null,this.style_=null,this.custom_style_=null,this.iframe_=!1,this.cover_=!1,this.title_="",this.title_class_="",this.obj_=null,this.config_=arguments[1]||{},this.direction_="ltr",this.type_icon_=null,this.icon_states_={close:"",info:"",tip:""}}function ImageBorderObject(){BorderObject.apply(this,arguments),this.cover_=!0,this.image_=null,this.image_align_="left",this.image_padding_={l:0,t:0,r:0,b:0,w:0,h:0}}function ButtonObject(){this.uid_=arguments[0]||WCT.uid.Generate(10,"BUO_"),this.obj_=null,this.src_ctx_=null,this.custom_style_=null,this.config_={},this.direction_="ltr",this.text_="",this.image_=null}TextObject.STYLE_MAP={font_family:{t:"string",n:"fontFamily",i:"text"},font_size:{t:"fontsize",n:"fontSize",i:"text"},text_color:{t:"string",n:"color",i:"text"},align:{t:"align",n:"textAlign",i:"text"},valign:{t:"string",n:"verticalAlign",i:"text"},bold:{t:"bold",n:"fontWeight",i:"text"},italic:{t:"italic",n:"fontStyle",i:"text"},underline:{t:"underline",n:"textDecoration",i:"text"},line_height:{t:"fontsize",n:"lineHeight",i:"text"},white_space:{t:"string",n:"whiteSpace",i:["main","text"],a:["nowrap"]},overflow:{t:"string",n:"overflow",i:["main","text"],a:["hidden","scroll","auto"]},visibility:{t:"string",n:"visibility",i:"text",a:["visible","hidden"]},padding:{t:"padding"},padding_l:{t:"padding"},padding_t:{t:"padding"},padding_r:{t:"padding"},padding_b:{t:"padding"},border:{t:"border"},border_l:{t:"border"},border_t:{t:"border"},border_r:{t:"border"},border_b:{t:"border"},x:{t:"size",n:"left",i:"main"},y:{t:"size",n:"top",i:"main"},w:{t:"width"},h:{t:"height"},direction:{t:"direction",n:"direction",i:"main"},background_color:{t:"string",n:"backgroundColor",i:"main"},border_color:{t:"string",n:"borderColor",i:"main"},shadow:{t:"string",n:"boxShadow",i:"main"},selectable:{t:"selectable"},title:{t:"title"}},TextObject.UpdateFromControl=function(t,e,i){var o=this._tctl;if(o)switch(e){case"shadow_show":case"shadow_color":case"shadow_trans":case"shadow_blur":case"shadow_spread":case"shadow_h":case"shadow_v":this.CalcShadow()&&o.SetStyle({shadow:this._shadow});break;case"max_w":case"max_h":var r=e.split("_")[1];o.SetMaxWH(r,i),this.SetParam(r,t[r]);break;case"hide_scrollbars":o.HideScrollbars(i||!1);break;case"placeholder_text":TextObject.UpdateFromControl.call(this,t,"text","${"+i+"}");break;case"text":if(i=replace_placeholder(i=_escapeFontFamily(i)),i=Context.ResolveHtmlString(i,this._src_ctx),i=Page.HighlightHtmlString(i),o.SetText(i),this.ImagesLoaded&&!o.GetObserverId()){var n=WCT.image_watcher.Observe(this.ImagesLoaded,this);o.SetObserverId(n)}null==this.autosize_w&&null==this.autosize_h||(delete this.autosize_w,delete this.autosize_h,this._update_dom());break;default:var s={};s[e]=void 0!==i?i:"",o.SetStyle(s)}},TextObject.OnScroll=function(t){var e=(t=WCT.event.Standardize(t)).target.id.split("#")[0],i=t.target.scrollLeft,o=t.target.scrollTop;for(var r in Controls){var n=Controls[r]._tctl;if(n&&n.uid_==e){n.tctl_&&(n=n.tctl_),n.scroll_fun_&&n.scroll_fun_.call(n.scroll_scope_,i,o,t);break}}},TextObject.prototype={Destructor:function(){var t=$(this.uid_);t&&(t.onscroll=null,t.parentNode.removeChild(t)),this.observer_id_&&(WCT.image_watcher.StopObserving(this.observer_id_),this.observer_id_=null),this.scroll_fun_=null,this.scroll_scope_=null,this.style_=null},Create:function(t){var e=this.uid_,i=$$("div"),o=to_producer_resource_("1");i.id=e,i.style.position="absolute",i.style.overflow="auto",i.style.backgroundImage="url("+o+")",i.style.backgroundRepeat="repeat",i.style.backgroundPosition="0 0";var r=$$("div");r.style.display="table-cell",r.style.tableLayout="fixed",r.id=e+"#text",r.className="dgo_text_container",r.setAttribute("data-placeholder","Enter text here..."),BROWSER.IE?i.style.filter="":BROWSER.MOBILE&&(PLATFORM.IOS&&(i.style.WebkitOverflowScrolling="touch"),arguments[1]||(i.ontouchmove=function(t){t.stopPropagation()})),i.appendChild(r),t.appendChild(i)},SetText:function(t){var e=$(this.uid_),i=$(this.uid_+"#text");e&&i&&(WCT.image_watcher.RemoveImagesInside(i),e.scrollTop=0,EDIT_MODE&&Editor&&!Editor.Preview()&&(t=t.replace(/autoplay=["|']true["|']/gi,"")),i.innerHTML=t,WCT.Previewer.setPreviewForTag(i,"img"),WCT.Previewer.setPreviewForTag(i,"video"),WCT.image_watcher.AddImagesInside(i))},SetObserverId:function(t){this.observer_id_=t},SetStyle:function(t){var e={main:$(this.uid_),text:$(this.uid_+"#text")};if(e.text){var i=TextObject.STYLE_MAP,o=this.style_,r=this.dirty_,n=this.ctl_id_,s=!1;for(var a in t){var _=i[a];if(_){var l=t[a];if("align"==_.t&&(l=get_correct_align(l.toLowerCase(),n)),o[a]!=l&&(o[a]=l,!_.a||-1!=_.a.indexOf(l))){switch(_.t){case"bold":l=l?"bold":"normal";break;case"italic":l=l?"italic":"normal";break;case"underline":l=l?"underline":"none";break;case"string":l+="";break;case"size":"number"==typeof l&&(l+="px");break;case"align":break;case"fontsize":var d=window.Controls&&Controls.page&&Controls.page._obj,h=d&&d.fontsizeInPt?"pt":"px";l=l?l+h:"","lineHeight"===_.n&&(s=!0);break;case"width":r.w=!0;continue;case"height":r.h=!0;continue;case"padding":r.padding=!0,r.w=!0,r.h=!0;continue;case"border":r.border=!0,r.w=!0,r.h=!0;continue;case"direction":l="rtl"==l?"rtl":"ltr";break;case"selectable":WCT.dom.NotSelectable(e.text,l);continue;case"title":e.text.setAttribute("title","string"==typeof l?l:"");continue;default:continue}if(_.i.isArray)for(var c=0,p=null;p=_.i[c++];)e[p]&&(e[p].style[_.n]=null!=l?l:"","direction"==_.t&&e[p].setAttribute("dir",l));else e[_.i]&&(e[_.i].style[_.n]=null!=l?l:"","direction"==_.t&&e[_.i].setAttribute("dir",l))}}}(function u(){var t=this.dirty_;if(t.w||t.h){var e=$(this.uid_),i=$(this.uid_+"#text"),o=this.style_,r=get_border(o),n=0,s=0;if(!this.msie5_){var a=get_padding(o);n=a.w,s=a.h}if(t.w){if("number"!=typeof o.w||isNaN(o.w))e.style.width="auto",i.style.width="auto";else{var _=Math.max(0,o.w-r.w);e.style.width=_+"px",i.style.width=Math.max(0,_-n)+"px"}delete t.w}if(t.h){if("number"!=typeof o.h||isNaN(o.h))e.style.height="auto",i.style.height="auto";else{var l=Math.max(0,o.h-r.h);e.style.height=l+"px",i.style.height=Math.max(0,l-s)+"px"}delete t.h}}}).call(this),function f(){if(this.dirty_.padding){delete this.dirty_.padding;var t=$(this.uid_+"#text"),e=get_padding(this.style_);t.style.padding=e.t+"px "+e.r+"px "+e.b+"px "+e.l+"px"}}.call(this),function m(){if(this.dirty_.border){delete this.dirty_.border;var t=$(this.uid_),e=get_border(this.style_),i={t:"Top",r:"Right",b:"Bottom",l:"Left"};for(var o in i)0<e[o]?(t.style["border"+i[o]+"Style"]="solid",t.style["border"+i[o]+"Width"]=e[o]+"px"):(t.style["border"+i[o]+"Style"]="none",t.style["border"+i[o]+"Width"]="0px")}}.call(this),EDIT_MODE&&BROWSER.IE&&BROWSER.VERSION<11&&(e.main.style.display="none",e.main.style.display="block",e.main.style.display=""),BROWSER.FIREFOX&&!s&&(e.main.style.lineHeight="1.15")}},SetMSIE5:function(t){this.msie5_=t},SetAccessibility:function(t){var e=$(this.uid_);e&&"number"==typeof t.tabindex&&(t.href?(e.tabIndex=t.tabindex,e.removeAttribute("aria-current"),e.setAttribute("role","link")):(e.tabIndex=-1,e.removeAttribute("role"),e.setAttribute("aria-current",t.text)))},SetButtonMode:function(t){if(t.id){var e=$(this.uid_);e&&(e.style.backgroundImage="url("+t.id+")",e.style.backgroundRepeat="no-repeat")}else t.bg&&this.SetTextImage(t)},SetTextImage:function(t){var e=$(this.uid_);if(e){var i=$$("img");i.id=this.uid_+"#img",i.src=to_producer_resource_("1"),t.bg&&(i.style.backgroundImage="url("+t.bg+")",i.style.backgroundColor="transparent",i.style.backgroundRepeat="no-repeat"),i.style.backgroundPosition=-t.offsetX+"px "+-t.offsetY+"px";var o=Controls.page.GetParams().image;o&&(i.style.backgroundSize=o.w+"px "+o.h+"px"),i.style.borderWidth="0",i.style.position="absolute",i.style.left="0",i.style.top="0",i.style.width=t.w+"px",i.style.height=t.h+"px",e.appendChild(i)}},HideScrollbars:function(t){var e=this.style_;if(e.hide_scrollbars!=t){e.hide_scrollbars=t;var i=$(this.uid_);i&&(i.style.overflow=t?"hidden":"auto")}},EnableMarquee:function(t){var e=$(this.uid_+"#text");if(t)if(BROWSER.SAFARI)e.style.WebkitMarquee="auto medium infinite scroll normal",e.style.overflowX="-webkit-marquee";else{var i;for((i=$$("marquee")).direction="rtl"===this.style_.direction?"right":"left";e.firstChild;)i.appendChild(e.firstChild);e.appendChild(i)}else if(BROWSER.SAFARI)e.style.WebkitMarquee="",e.style.overflowX="";else if(i=(i=e.getElementsByTagName("marquee"))?i[0]:null){for(;i.firstChild;)e.appendChild(i.firstChild);e.removeChild(i)}},ObserveOnScroll:function(t,e){var i=$(this.uid_);i&&(this.scroll_fun_=t,this.scroll_scope_=e,i.onscroll=TextObject.OnScroll)},GetAutoSize:function(t){var e=$(this.uid_+"#text");if(!e)return 0;var i=0,o=Number(this.style_[t]);return"w"==t?(this.SetStyle({w:1e4}),e.style.width="auto",i=e.offsetWidth,this.SetStyle({w:o})):"h"==t&&(this.SetStyle({h:1e4}),e.style.height="auto",i=e.offsetHeight,this.SetStyle({h:o})),i},GetPosSize:function(){var t=this.style_,e=$(this.uid_);if(e){var i=getHtmlPosSize(e),o=get_padding(t);i.x+=o.l-1,i.y+=o.t+1,i.w-=o.w-2,i.h-=o.h+2}return{x:t.x,y:t.y,w:t.w,h:t.h}},GetScrollPos:function(){var t=$(this.uid_);return t?{x:t.scrollLeft,y:t.scrollTop}:{x:0,y:0}},GetObserverId:function(){return this.observer_id_}},BorderObject.POPUP_STYLE={frame:{body:{background_color:"#FFFFFF"},nw:{image:{id:"book_style:textbox/top_left.png"}},ne:{image:{id:"book_style:textbox/top_right.png"}},sw:{image:{id:"book_style:textbox/bottom_left_end.png"}},se:{image:{id:"book_style:textbox/bottom_right_end.png"}},n:{image:{id:"book_style:textbox/top.png",repeat:"x"}},w:{image:{id:"book_style:textbox/vert_left.png",repeat:"y"}},e:{image:{id:"book_style:textbox/vert_right.png",repeat:"y"}},s:{image:{id:"book_style:textbox/bottom.png",repeat:"x"}},w_w:8,e_w:8,n_h:17,s_h:8},title:{font_family:"Verdana",font_size:"7pt",text_color:"#333333",outer_spacing_l:7,outer_spacing_icon_l:30,outer_spacing_r:30,outer_spacing_t:2,h:15},content:{outer_spacing_l:2,outer_spacing_r:2,outer_spacing_t:17,outer_spacing_b:8},close:{image:{id:"book_style:textbox/close.png"},image_h:{id:"book_style:textbox/close_hi.png"},image_a:{id:"book_style:textbox/close_hi.png"},tooltip:"CLOSE",x:-10,y:1,w:15,h:15},info:{image:{id:"book_style:textbox/icon_info.png"},x:10,y:1,w:15,h:15},tip:{image:{id:"book_style:textbox/icon_tip.png"},x:10,y:1,w:15,h:15}},BorderObject.prototype=function(){function d(t,e){for(var i=e.frame,o=["nw","n","ne","w","e","sw","s","se","body"],r=0,n=null;n=o[r++];){(a=i[n]?i[n].image:null)&&a.id&&(a.id=t.ToAbsPath(a.id))}o=[];var s=this.config_;!1!==s.close&&o.push("close"),!1!==s.info&&o.push("info"),!1!==s.tip&&o.push("tip");for(r=0,n=null;n=o[r++];){var a;if(a=e[n]){var _=a.image,l=a.image_h,d=a.image_a;_&&_.id&&(_.id=t.ToAbsPath(_.id)),l&&l.id&&(l.id=t.ToAbsPath(l.id)),d&&d.id&&(d.id=t.ToAbsPath(d.id))}}return e}function m(t,e){var i={};if(e.title){var o=e.title,r=o.outer_spacing_l||0,n=o.outer_spacing_icon_l||0,s=o.outer_spacing_r||0,a=r,_=n;if("rtl"==this.direction_&&(_=a=s),i.title={x1:a,x2:_,y:o.outer_spacing_t||0,w1:t.w-r-s,w2:t.w-n-s,h:o.h||0,direction:this.direction_||"ltr"},""==this.title_class_){var l=o.font_size;null==l?l="":"number"==typeof l&&(l+="px"),WCT.ExtendObject(i.title,{ffamily:o.font_family||"",fsize:l,fstyle:o.font_style||"",color:o.text_color||""})}}(function b(t,e,i){var o=this.direction_,r=[],n=this.config_;!1!==n.close&&r.push("close"),!1!==n.info&&r.push("info"),!1!==n.tip&&r.push("tip");for(var s=0,a=null;a=r[s++];){var _=e[a];if(_){var l="rtl"==o?_.x<0?-_.x:t.w-_.x-_.w:0<_.x?_.x:t.w+_.x-_.w,d={sprite:_.image.id||"",sprite_x:_.image.x||0,sprite_y:_.image.y||0,repeat:"no-repeat",tooltip:_.tooltip||"",x:l,y:_.y,w:_.w,h:_.h};i[a]=d;var h=_.image_h;h&&(d.sprite_h=h.id||"",d.sprite_h_x=h.x||0,d.sprite_h_y=h.y||0);var c=_.image_a;c&&(d.sprite_a=c.id||"",d.sprite_a_x=c.x||0,d.sprite_a_y=c.y||0)}}}).call(this,t,e,i);for(var d=e.frame,h=Math.max(0,t.w-d.e_w-d.w_w),c=Math.max(0,t.h-d.n_h-d.s_h),p=["nw","n","ne","w","e","sw","s","se","body"],u=0,f=null;f=p[u++];)if(d[f]){var m={},g=d[f].image;if(g){var y=g.repeat?"repeat"==g.repeat?"repeat":"repeat-"+g.repeat:"no-repeat";m={sprite:g.id,sprite_x:g.x||0,sprite_y:g.y||0,repeat:y,stretch:g.stretch||!1}}switch(d[f].background_color&&(m.background_color=d[f].background_color),f){case"nw":case"n":case"ne":m.y=0,m.h=d.n_h;break;case"w":case"e":m.y=d.n_h,m.h=c;break;case"sw":case"s":case"se":m.y=Math.max(0,t.h-d.s_h),m.h=d.s_h;break;case"body":m.x=d.w_w,m.y=d.n_h,m.w=h,m.h=c}switch(f){case"nw":case"w":case"sw":m.x=0,m.w=d.w_w;break;case"ne":case"e":case"se":m.x=Math.max(0,t.w-d.e_w),m.w=d.e_w;break;case"n":case"s":m.x=d.w_w,m.w=h}if(m.stretch)switch(m.sprite_w=g.w||0,m.sprite_h=g.h||0,m.stretch_w=m.sprite_w,m.stretch_h=m.sprite_h,f){case"nw":case"n":case"ne":case"sw":case"s":case"se":m.stretch_h=d[f.charAt(0)+"_h"];break;case"w":case"e":m.stretch_w=d[f+"_w"]}i[f]=m}return i}function g(t,e,i,o){var r=o?"sprite_"+o:"sprite";if(t.stretch){var n=function l(t,e,i){var o=t/Math.max(1,i.stretch_w),r=e/Math.max(1,i.stretch_h);return{x:i.sprite_x*o,y:i.sprite_y*r,w:Math.ceil(i.sprite_w*o),h:Math.ceil(i.sprite_h*r),fx:o,fy:r}}(t.w,t.h,t),s=null;i?s=e.firstChild:((s=$$("img")).src=t[r]||t.sprite,s.style.position="absolute",e.appendChild(s)),s.style.left=n.x+"px",s.style.top=n.y+"px",s.style.width=n.w+"px",s.style.height=n.h+"px"}else{!i&&t.repeat&&(e.style.backgroundRepeat=t.repeat);var a=t[r]?r:"sprite";if(t[a]){var _=e.style.backgroundImage;_="string"==typeof _?_.replace(/url\(['"](.*?)['"]\)/,"$1"):"",t[a]!=_&&(e.style.backgroundImage="url("+t[a]+")"),e.style.backgroundPosition=t[a+"_x"]+"px "+t[a+"_y"]+"px"}else e.style.backgroundImage="none"}}function h(){if(this.style_){var t=this.uid_,e=$(t);if(e){var i=this.obj_,o=arguments[0]||!1,r=m.call(this,i,this.style_),n=this.type_icon_,s=this.icon_states_;if(e.style.width=i.w+"px",e.style.height=i.h+"px",this.iframe_){var a=$(t+"#iframe");a&&(a.style.width=i.w+"px",a.style.height=i.h+"px")}if(this.cover_){var _=$(t+"#cover");_&&(_.style.width=i.w+"px",_.style.height=i.h+"px")}for(var l in t+="#",r){var d=r[l],h=null;if(o){if(!(h=$(t+l)))continue}else{(h=$$("div")).id=t+l,h.style.position="absolute",h.style.overflow="hidden",h.style.backgroundColor=d.background_color||"transparent",h.style.display="block";var c="title"===l?"heading":"close"===l?"button":"presentation";if(h.setAttribute("role",c),"title"===l){var p=d.fstyle;if(p){p=p.split(",");for(var u=0,f=null;f=p[u++];)switch(f){case"bold":h.style.fontWeight="bold";break;case"italic":h.style.fontStyle="italic";break;case"underline":h.style.textDecoration="underline"}}d.ffamily&&(h.style.fontFamily=d.ffamily),d.fsize&&(h.style.fontSize=d.fsize),d.color&&(h.style.color=d.color)}else"close"===l&&(h.tabIndex=this.obj_.tabindex);!{title:1,close:1,info:1,tip:1}[l]||(h.style.zIndex=1),d.tooltip&&h.setAttribute("title",ctx.cfg_tr(d.tooltip)),e.appendChild(h)}h.style.top=d.y+"px",h.style.height=Math.max(0,d.h)+"px","title"==l?(n?(h.style.left=d.x2+"px",h.style.width=Math.max(0,d.w2)+"px"):(h.style.left=d.x1+"px",h.style.width=Math.max(0,d.w1)+"px"),h.style.direction=d.direction):(h.style.left=d.x+"px",h.style.width=Math.max(0,d.w)+"px",g.call(this,d,h,o,s[l]),"info"!=l&&"tip"!=l||(h.style.display=n==l?"block":"none"))}}}}return{Destructor:function(){var t=$(this.uid_);t&&t.parentNode.removeChild(t),this.config_=null,this.src_ctx_=null,this.style_=null,this.obj_=null},Create:function(t,i){this.obj_=WCT.DeepCopy(i),this.style_=null;var o=$(this.uid_);if(o)o.innerHTML="";else{var r=this.uid_;if(this.iframe_){var n=WCT.iframe.Create("about:blank",!0);n.id=r+"#iframe",n.tabIndex=-1,n.setAttribute("role","presentation"),n.style.left="0",n.style.top="0",t.appendChild(n)}if((o=$$("div")).id=r,o.style.position="absolute",o.style.left="0",o.style.top="0",o.style.backgroundImage="url("+to_producer_resource_("1")+")",o.style.backgroundRepeat="repeat",o.style.backgroundPosition="0 0",t.appendChild(o),this.cover_){var s=$$("div");s.id=r+"#cover",s.style.position="absolute",s.style.backgroundColor="#fff",s.style.opacity=.01,s.style.left="0",s.style.top="0",t.appendChild(s)}}var a=i.border_style||"";if(this.custom_style_)this.style_=this.custom_style_;else{if(!a)return;a.indexOf("!")<0&&(a="adaptable!"+a);var _=function l(t){var i=Env.LoadFile(t+":frame.txt");if("string"==typeof i)try{i=JSON.parse(i)}catch(e){i=null}if(!i||"object"!=typeof i)return null;var o=new WCT.context(Context);o.Set("border_style",t),o.SetScope("border_style");var r=WCT.DeepCopy(i);return d.call(this,o,r),r}.call(this,a);if(!_)return;this.style_=_}h.call(this),this.SetTitle()},GetContentPos:function(){var t=this.style_,e=t?t.content:null;if(e){var i=e.outer_spacing_l||0,o=e.outer_spacing_r||0,r=e.outer_spacing_t||0,n=e.outer_spacing_b||0;return"number"==typeof e.outer_spacing_title_t&&(this.title_||this.type_icon_)&&(r=e.outer_spacing_title_t),{l:i,r:o,t:r,b:n,w:i+o,h:r+n}}return{l:0,r:0,t:0,b:0,w:0,h:0}},GetBorderStyle:function(){return this.obj_.border_style||""},GetPosSize:function(){if(!this.style_)return{};var t=m.call(this,this.obj_,this.style_),e=this.type_icon_,i={},o=["title"];e&&o.push(e),!1!==this.config_.close&&o.push("close");for(var r=0,n=null;n=o[r++];){var s;(s=t[n])&&(i[n==e?"icon":n]={x:s.x,y:s.y,w:s.w,h:s.h})}(s=t.title)&&(i.title.x=e?s.x2:s.x1,i.title.w=e?s.w2:s.w1);var a=this.style_.drag;if(a&&a.handle)switch(a.handle){case"whole":var _={x:0,y:0,w:t.se.x+t.se.w,h:t.se.y+t.se.h},l=this.GetContentPos();l={x:l.l,y:l.t,w:_.w-l.w,h:_.h-l.h},i.drag=WCT.geometry.ExciseRect(_,l);break;case"n":i.drag=[i.title];break;case"s":i.drag=[{x:0,y:t.se.y,w:t.se.x+t.se.w,h:t.se.y+t.se.h}];break;case"area":i.drag=[{x:a.x<0?a.x+t.e.x+t.e.w:a.x,y:a.y<0?a.y+t.s.y+t.s.h:a.y,w:null!=a.w?a.w:t.se.x+t.se.w,h:null!=a.h?a.h:t.se.y+t.se.h}]}return i},GetFrameSize:function(){var t=this.style_,e=t?t.frame:null;return e?{l:e.w_w,r:e.e_w,t:e.n_h,b:e.s_h,w:e.w_w+e.e_w,h:e.n_h+e.s_h}:null},GetAutoSize:function(t){var e=this.GetContentPos(),i=this.GetFrameSize()||{w:0,h:0};return e[t]+i[t]},SetBorderStyle:function(t){var e=$(this.uid_);(e=e?e.parentNode:null)&&this.Create(e,t)},SetCustomBorderStyle:function(t){t?(t=WCT.DeepCopy(t),this.custom_style_=d.call(this,Context,t)):this.custom_style_=null;var e=$(this.uid_);(e=e?e.parentNode:null)&&this.Create(e,this.obj_)},SetStyle:function(t){var e=this.obj_,i=!1;null!=t.w&&e.w!=t.w&&(e.w=t.w,i=!0),null!=t.h&&e.h!=t.h&&(e.h=t.h,i=!0),t.direction&&this.direction_!=t.direction&&(this.direction_=t.direction,i=!0),i&&h.call(this,!0)},SetTitle:function(){var t="string"==typeof arguments[0]?arguments[0]:this.title_;t=WCT.EncodeTagBrackets(t),this.title_=t;var e=$(this.uid_+"#title");e&&(e.innerHTML=t,e.className=this.title_class_)},SetTitleClass:function(t){this.title_class_=t;var e=$(this.uid_+"#title");e&&(e.className=t)},SetTypeIcon:function(t){this.type_icon_=t,h.call(this,!0)},SetIconState:function(t,e){this.icon_states_[t]=e,h.call(this,!0)},SetSrcCtx:function(t){this.src_ctx_=t},EnableIFrame:function(t){this.iframe_=t}}}(),ImageBorderObject.prototype=new BorderObject,ImageBorderObject.RTL_MAP={left:"right",right:"left",top_left:"top_right",top_right:"top_left",bottom_left:"bottom_right",bottom_right:"bottom_left"},WCT.ExtendObject(ImageBorderObject.prototype,function(){function l(){var t=this.style_,e=t?t.content:null,i={l:0,r:0,t:0,b:0,w:0,h:0},o=0,r=0,n=0,s=0;e&&(o=e.outer_spacing_l||0,r=e.outer_spacing_r||0,n=e.outer_spacing_t||0,s=e.outer_spacing_b||0);var a=this.image_;if(a){var _="rtl"==this.direction_,l=this.image_padding_;_?(i.l=o+l.r,i.r=r+l.l):(i.l=o+l.l,i.r=r+l.r),i.t=n+l.t,i.b=s+l.b,i.w=a.w||0,i.h=a.h||0;var d=this.image_align_;switch(_&&(d=ImageBorderObject.RTL_MAP[d]||d),d){case"left":case"top_left":case"bottom_left":o+=i.w+l.w;break;case"right":case"top_right":case"bottom_right":r+=i.w+l.w;break;case"top":n+=i.h+l.h;break;case"bottom":s+=i.h+l.h}}return{content:{l:o,r:r,t:n,b:s,w:o+r,h:n+s},image:i}}return{Destructor:function(){this.image_=null,this.image_padding_=null,BorderObject.prototype.Destructor.call(this)},Create:function(t,e){BorderObject.prototype.Create.apply(this,arguments);var i=$(this.uid_),o=$$("img");o.id=this.uid_+"#img",o.style.position="absolute",i.appendChild(o),this.SetImage(this.image_)},GetContentPos:function(){return l.call(this).content},SetImage:function(t){this.image_=t;var e=$(this.uid_+"#img");if(e&&(e.style.backgroundImage="none",t&&t.id)){t.w&&(e.style.width=t.w+"px"),t.h&&(e.style.height=t.h+"px");var i=Context.ToAbsPath(t.id,this.src_ctx_);null!=t.x||null!=t.y?(e.src=to_producer_resource_("1"),e.style.backgroundImage="url("+i+")",e.style.backgroundPosition=(t.x||0)+"px "+(t.y||0)+"px"):e.src=i}},SetImagePadding:function(t){this.image_padding_=t},SetImageAlign:function(t){this.image_align_=t},SetStyle:function(t){if(BorderObject.prototype.SetStyle.apply(this,arguments),null!=t.w||null!=t.h){var e=$(this.uid_+"#img");if(e){var i=this.obj_,o=l.call(this).image,r=this.image_align_;"rtl"==this.direction_&&(r=ImageBorderObject.RTL_MAP[r]||r);var n=0,s=0;switch(r){case"left":case"top_left":case"bottom_left":n=o.l;break;case"top":case"bottom":n=(i.w-o.w-o.l-o.r>>1)+o.l;break;case"right":case"top_right":case"bottom_right":n=i.w-o.w-o.r}switch(r){case"left":case"right":s=(i.h-o.h-o.t-o.b>>1)+o.t;break;case"top":case"top_left":case"top_right":s=o.t;break;case"bottom":case"bottom_left":case"bottom_right":s=i.h-o.h-o.b}n=Math.max(o.l,n),s=Math.max(o.t,s),e.style.left=n+"px",e.style.top=s+"px";var a=i.w-o.w-o.l-o.r,_=i.h-o.h-o.t-o.b;0<=a&&0<=_?(e.style.width=o.w+"px",e.style.height=o.h+"px"):(a<0&&(e.style.width=Math.max(0,i.w-o.l-o.r)+"px"),_<0&&(e.style.height=Math.max(0,i.h-o.t-o.b)+"px"))}}}}}()),ButtonObject.STYLE_MAP={box_shadow:{t:"string",n:"boxShadow"},font_family:{t:"string",n:"fontFamily"},font_size:{t:"size",n:"fontSize"},direction:{t:"direction"},button_border_color:{t:"string",n:"borderColor"},button_border_style:{t:"string",n:"borderStyle"},button_border:{t:"border"},button_border_t:{t:"border"},button_border_r:{t:"border"},button_border_b:{t:"border"},button_border_l:{t:"border"},button_padding_r:{t:"padding"},button_padding_b:{t:"padding"}},ButtonObject.UpdateFromControl=function(t,e,i){var o={};o[e]=i;for(var r=0,n=null,s=this.buttons_;n=s[r++];)n.SetStyle(o)},ButtonObject.prototype=function(){function s(t){var e=this.obj_,i="number"==typeof e.button_border?e.button_border:0;i={t:i,r:i,b:i,l:i},"number"==typeof e.button_border_t&&(i.t=e.button_border_t),"number"==typeof e.button_border_r&&(i.r=e.button_border_r),"number"==typeof e.button_border_b&&(i.b=e.button_border_b),"number"==typeof e.button_border_l&&(i.l=e.button_border_l),t.style.borderWidth=[i.t,i.r,i.b,i.l].join("px ")+"px"}function a(t){var e=this.obj_,i="number"==typeof e.button_padding?e.button_padding:0;i={t:i,r:i,b:i,l:i},"number"==typeof e.button_padding_t&&(i.t=e.button_padding_t),"number"==typeof e.button_padding_r&&(i.r=e.button_padding_r),"number"==typeof e.button_padding_b&&(i.b=e.button_padding_b),"number"==typeof e.button_padding_l&&(i.l=e.button_padding_l),t.style.margin=[i.t,i.r,i.b,i.l].join("px ")+"px"}function _(){var t=this.uid_,e=$(t);if(e){var i=this.obj_.direction,o="ltr"==i?"left":"right";e.style.cssFloat=o,e.style.styleFloat=o,e.style.direction=i,e.setAttribute("dir",i);var r=$(t+"#body"),n=$(t+"#img");if(r&&n){var s=this.custom_style_,a=s.image,_=s.frame;n.style.left="",n.style.right="",n.style[o]=(a.x||0)+"px";var l=(_.w_w||0)+(a.x||0)+(a.w||0)+(a.padding_r||0),d=_.e_w||0;"ltr"==i?(r.style.paddingLeft=l+"px",r.style.paddingRight=d+"px"):(r.style.paddingLeft=d+"px",r.style.paddingRight=l+"px")}}}return{SetBorderStyle:BorderObject.prototype.SetCustomBorderStyle,SetSrcCtx:BorderObject.prototype.SetSrcCtx,SetImage:ImageBorderObject.prototype.SetImage,Destructor:function(){var t=$(this.uid_);t&&t.parentNode.removeChild(t),this.obj_=null,this.src_ctx_=null,this.custom_style_=null,this.config_=null,this.image_=null},Create:function(t,e){this.obj_=WCT.DeepCopy(e);var i=$(this.uid_);if(i)for(;i.firstChild&&i.firstChild.id.indexOf("#cover")<0;)i.removeChild(i.firstChild);else{(i=$$("div")).id=this.uid_,i.tabIndex=0,i.setAttribute("role","button"),i.className="dgo_text_container",i.style.position="relative",i.style.borderWidth="0",i.style.borderStyle="solid",i.style.fontSize="1px",i.style.cssFloat="left",i.style.padding="0",i.style.overflow="hidden",WCT.dom.NotSelectable(i),t.appendChild(i);var o=$$("div");o.id=this.uid_+"#cover",o.style.position="absolute",o.style.backgroundColor="#fff",o.style.opacity=.01,o.style.left="0",o.style.top="0",o.style.width="100%",o.style.height="100%",i.appendChild(o)}this.custom_style_&&(function c(){var t=this.custom_style_,e=t&&t.frame||null;if(e&&e.h){var i=this.uid_,o=$(i);if(o&&(o.style.height=e.h+"px",e.body)){for(var r=["body","w","e"],n=null,s=0,a=null;a=r[s++];){var _=e[a];if(_){var l;(l=$$("div")).id=i+"#"+a,l.style.overflow="hidden",l.style.color=_.text_color||"#000",l.style.backgroundColor=_.background_color||"transparent",l.style.height=e.h+"px","w"==a?(l.style.position="absolute",l.style.left="0",l.style.top="0",l.style.width=(e.w_w||0)+"px"):"e"==a?(l.style.position="absolute",l.style.right="0",l.style.top="0",l.style.width=(e.e_w||0)+"px"):(WCT.dom.NotSelectable(l),l.style.paddingLeft=(e.w_w||0)+"px",l.style.paddingRight=(e.e_w||0)+"px",l.style.lineHeight=e.h+"px",l.style.whiteSpace="nowrap",n=l);var d=_.image;if(d){var h=d.repeat?"repeat"==d.repeat?"repeat":"repeat-"+d.repeat:"no-repeat";l.style.backgroundRepeat=h,l.style.backgroundImage="url("+d.id+")",l.style.backgroundPosition=(d.x||0)+"px "+(d.y||0)+"px"}o.insertBefore(l,o.lastChild)}}if(t=t.image)(l=$$("div")).id=i+"#img",l.setAttribute("role","presentation"),l.style.position="absolute",l.style.backgroundRepeat="no-repeat",l.style.left=(t.x||0)+"px",l.style.top=(t.y||0)+"px",l.style.width=(t.w||0)+"px",l.style.height=(t.h||0)+"px",o.insertBefore(l,o.lastChild),n.style.paddingLeft=(e.w_w||0)+(t.x||0)+(t.w||0)+(t.padding_r||0)+"px"}}}.call(this),this.SetStyle(this.obj_,!0),this.SetText(),this.SetImage(this.image_))},SetStyle:function(t){var e=$(this.uid_),i=this.obj_,o=ButtonObject.STYLE_MAP;for(var r in t){var n=o[r];if(n&&(i[r]!=t[r]||arguments[1])&&(i[r]=t[r],e))switch(n.t){case"string":e.style[n.n]=t[r];break;case"border":s.call(this,e);break;case"padding":a.call(this,e);break;case"size":e.style[n.n]=t[r]+"px";break;case"direction":_.call(this)}}},SetText:function(){var t=arguments[0]||this.text_;this.text_=t;var e=$(this.uid_+"#body");e&&(e.firstChild?e.firstChild.nodeValue=t:e.appendChild($$2(t)))},getId:function(){return this.uid_},GetPosSize:function(){var t=$(this.uid_);return t?{x:t.offsetLeft,y:t.offsetTop,w:t.offsetWidth,h:t.offsetHeight}:null}}}();var IMAGE_OBJECTS={Cleanup:function(){for(var t in IMAGE_OBJECTS)"Cleanup"!=t&&(IMAGE_OBJECTS[t].Destructor&&IMAGE_OBJECTS[t].Destructor(),delete IMAGE_OBJECTS[t])}};function ImageObject(){this.uid_=arguments[2]||WCT.uid.Generate(10,"IO_"),this.x_=0,this.y_=0,this.w_=0,this.h_=0,this.zoom_x_=0,this.zoom_y_=0,this.img_w_=0,this.img_h_=0,this.box_w_=0,this.box_h_=0,this.dom_=null,this.img_src_=null,this.ctl_=arguments[0]||null,this.onload_=arguments[1]||function(){},this.onload_once_=null,this.onload_once_ctl_=null,this.config_={use_image_watcher:!1,keep_aspect:!0,show_zoom_icon:null,zoom_icon_state:null,direction:null},IMAGE_OBJECTS[this.uid_]=this}function BorderTextObject(t){var e=arguments[1],i=e&&e.uid||WCT.uid.Generate(10,"BTO_");this.uid_=i,this.bctl_=new BorderObject(i+"#BO",arguments[1]),this.tctl_=new TextObject(t,i+"#TO"),this.obj_=null,this.ctl_id_=t,this.max_wh_={w:null,h:null}}function ImageBorderTextObject(t){BorderTextObject.apply(this,arguments),this.bctl_.Destructor(),this.bctl_=new ImageBorderObject(this.uid_+"#BO",arguments[1]),this.wh_={w:0,h:0}}function CanvasObject(){this.uid_=arguments[0]||WCT.uid.Generate(10,"CO_"),this.ctx_=null,this.w_=0,this.h_=0,this.shapes_={}}function GroupObject(t){this.group_={},this.grp_ctl_id_=t}function RectSelection(){this._in_sel=!1}ImageObject.ImageLoaded=function(){this.onload=null,this.onerror=null;var t=IMAGE_OBJECTS[this.id.replace(/#[^#]*$/,"")];if(t){var e=t.img_w_,i=t.img_h_;e||i||(e=this.scrollWidth,i=this.scrollHeight,this.style.width=e+"px",this.style.height=i+"px",t.img_w_=e,t.img_h_=i);var o=this.parentNode;o.style.width=e+"px",o.style.height=i+"px",t.on_load_()}},ImageObject.ImageError=function(){this.onload=null,this.onerror=null;var t=IMAGE_OBJECTS[this.id.replace(/#[^#]*$/,"")];t&&t.SetImage(null)},ImageObject.prototype=function(){function a(t,e){var i=$(this.uid_+"#img");if(i){var o=i.parentNode;t=Math.max(0,t),e=Math.max(0,e),i.style.width=t+"px",i.style.height=e+"px",o.style.width=t+"px",o.style.height=e+"px",this.w_=t,this.h_=e}}function _(t,e){var i=$(this.uid_);i&&(i.style.left=t+"px",i.style.top=e+"px",this.x_=t,this.y_=e)}function s(){var t=$(this.uid_+"#zoom");if(t){var e=this.config_.show_zoom_icon,i="rtl"==this.config_.direction?0===e.x?"-0":-Number(e.x):e.x;("-0"===i||i<0)&&(i=this.w_-e.w+Number(i));var o="-0"===e.y||e.y<0?this.h_-e.h+Number(e.y):e.y;t.style.left=i+"px",t.style.top=o+"px",this.zoom_x_=i,this.zoom_y_=o}}function l(){var t=$(this.uid_+"#zoom");if(t){var e=this.config_,i=e.show_zoom_icon,o=e.zoom_icon_state,r="string"==typeof o?"id_"+o:"id";t.src=Context.ToAbsPath(i[r]||i.id,this._src_ctx)}}function d(t){var e=this.config_.show_zoom_icon,i=$(this.uid_+"#zoom");if(t&&e){if(!i){var o=e.alt_txt||"",r=e.tabindex||0,n=ctx.cfg_tr("VIEW");(i=$$("img")).id=this.uid_+"#zoom",i.tabIndex=r,i.setAttribute("role","button"),i.setAttribute("title",n),i.setAttribute("aria-label",n+" "+o),i.style.position="absolute",i.style.left="0",i.style.top="0",i.style.width=e.w+"px",i.style.height=e.h+"px",i.style.zIndex=100,this.dom_.appendChild(i),l.call(this)}s.call(this)}else i&&i.parentNode.removeChild(i)}return{Destructor:function(){this.dom_=null,this.ctl_=null,this.onload_=null,this.src_ctx_=null,this.onload_once_=null,this.onload_once_ctl_=null,this.config_=null,delete IMAGE_OBJECTS[this.uid_]},Create:function(t){var e=$$("div");e.id=this.uid_,e.style.position="relative",e.style.left="0",e.style.top="0",t.appendChild(e),this.dom_=e},SetImage:function(t){var e=$(this.uid_+"#img");if(!e&&t&&t.id)(e=$$("img")).id=this.uid_+"#img",e.alt=this.alt_txt_||"",e.onclick=function(){},this.dom_.appendChild(e),d.call(this,!0);else if(!t||!t.id)return e&&e.parentNode.removeChild(e),d.call(this,!1),this.w_=0,this.h_=0,this.img_w_=0,this.img_h_=0,this.on_load_(),void(this.img_src_="");if(t.id!=this.img_src_){this.img_src_=t.id,this.x_=0,this.y_=0,e.style.position="absolute",e.style.left="0",e.style.top="0","function"==typeof arguments[1]&&(this.onload_once_=arguments[1],this.onload_once_ctl_=arguments[2]||null),this.config_.use_image_watcher&&WCT.image_watcher.AddExternal(this.uid_),e.onload=ImageObject.ImageLoaded,e.onerror=ImageObject.ImageError;var i=Context.ToAbsPath(t.id,this.src_ctx_),o=-1!=i.search(/.svg$/i),r=!t.w&&!t.h,n=o&&r?this.ctl_._obj.w:t.w,s=o&&r?this.ctl_._obj.h:t.h;if(null==n||null==s)e.style.width="",e.style.height="",this.img_w_=0,this.img_h_=0;else{e.style.width=n+"px",e.style.height=s+"px";var a=this.dom_;a.style.width=n+"px",a.style.height=s+"px",this.img_w_=n,this.img_h_=s}e.setAttribute("src",i)}},SetAltText:function(t){this.alt_txt_=t;var e=$(this.uid_+"#img");e&&(e.alt=t)},GetUid:function(){return this.uid_},Fit:function(){var t=this.img_w_,e=this.img_h_;if(t&&e){var i="number"==typeof arguments[0]?arguments[0]:this.box_w_,o="number"==typeof arguments[1]?arguments[1]:this.box_h_;if(this.config_.keep_aspect){var r=Math.min(i/t,o/e);t=Math.max(0,Math.min(i,Math.round(t*r))),e=Math.max(0,Math.min(o,Math.round(e*r)));var n=Math.floor(i-t>>1),s=Math.floor(o-e>>1);a.call(this,t,e),_.call(this,n,s)}else a.call(this,i,o),_.call(this,0,0);this.box_w_=i,this.box_h_=o,d.call(this,!0)}},GetPosSize:function(){var t=null,e=this.config_.show_zoom_icon;return e&&(t={x:this.zoom_x_,y:this.zoom_y_,w:e.w,h:e.h}),0<this.img_w_&&0<this.img_h_?{x:this.x_,y:this.y_,w:this.w_,h:this.h_,img_w:this.img_w_,img_h:this.img_h_,zoom:t}:null},SetConfig:function(t,e){if("undefined"!=typeof this.config_[t])switch(this.config_[t]=e,t){case"show_zoom_icon":d.call(this,!0);break;case"zoom_icon_state":l.call(this);break;case"direction":s.call(this)}},SetSrcCtx:function(t){this.src_ctx_=t},on_load_:function(){if(WCT.image_watcher.RemoveExternal(this.uid_),this.onload_once_){var t=this.onload_once_,e=this.onload_once_ctl_;this.onload_once_=null,this.onload_once_ctl_=null,t.call(e,this.uid_)}else this.onload_.call(this.ctl_,this.uid_)}}}(),WCT.ExtendObject(BorderTextObject,{GetAutosize:function(){var t=this._obj,e=this._tctl;if(t&&e){var i=t.autosize,o=e.GetAutoSize(i);o&&(this["autosize_"+i]=o,BorderTextObject.SetControlWH.call(this,t,i,o))}},ClampControlWH:function(t,e){var i=e.name,o="clamp_",r=i.length;if(1<r&&(i=i.charAt(r-1).toLowerCase(),o="clamp_popup_"),window[o+i].apply(this,arguments),this._tctl){var n=(this._tctl.GetFrameSize()||{w:0,h:0})[i];e.res=Math.max(n,e.res)}},SetControlWH:function(t,e,i){var o=e,r=null,n="main",s=o.length;1<s&&(o=o.charAt(s-1).toLowerCase(),r="#popup#dom",n="popup");var a=this._tctl;if(a&&t.autosize==o){var _="autosize_"+o;if(null==this[_])return void(this["autosize_t_"+o]||(this["autosize_t_"+o]=WCT.SetTimeout(BorderTextObject.GetAutosize,1,this)));this["autosize_t_"+o]&&"subtitle"===this.GetType()&&this.doneAutosize(this[_]),delete this["autosize_t_"+o],i=this[_];var l=a.GetMaxWH(o);if("number"==typeof l&&l<i&&(i=l),t[o]!=i){t[o]=i;var d=0;"w"==o?(t.ctl_border_l&&(d+=t.ctl_border_l),t.ctl_border_r&&(d+=t.ctl_border_r)):(t.ctl_border_t&&(d+=t.ctl_border_t),t.ctl_border_b&&(d+=t.ctl_border_b)),Env.onPropChange(this._id,o,i+d)}}var h=this._get_el(r);if(h&&(h.style["w"==o?"width":"height"]=Math.max(1,i)+"px"),a){var c={};c[o]=i,a.SetStyle(c)}!1!==arguments[3]&&(this._rd_update_dom_rect&&this._rd_update_dom_rect(),this._draggers&&this._draggers[n].UpdatePos(),this._update_hit_areas&&this._update_hit_areas())},SetControlBorderStyle:function(t,e,i){var o=this._tctl;if(o&&o.GetBorderStyle()!=i){o.SetBorderStyle(t);var r=this._rd_get_min_rect()||o.GetFrameSize();r&&(r.w>t.w||r.h>t.h)&&(r.w>t.w&&(t.w=r.w,Env.onPropChange(this._id,"w",r.w),BorderTextObject.SetControlWH.call(this,t,"w",r.w)),r.h>t.h&&(t.h=r.h,Env.onPropChange(this._id,"h",r.h),BorderTextObject.SetControlWH.call(this,t,"h",r.h)))}},SetControlCustomStyle:function(t,e,i){var o=this._tctl;o&&o.SetCustomBorderStyle(i||null)},Create:function(t){var e=arguments[1]||{};null==e.close&&(e.close=!1),null==e.info&&(e.info=!1),null==e.tip&&(e.tip=!1);var i=this._obj,o=e.image_?new ImageBorderTextObject(this._id,e):new BorderTextObject(this._id,e);return o.SetSrcCtx(this._src_ctx),o.Create(t,i),null!=i.msie5&&o.SetMSIE5(i.msie5),this._tctl=o}}),BorderTextObject.prototype=function(){function e(){var t=arguments[0]||this.obj_;if(t){var e=this.GetTextPos(),i={x:e.l,y:e.t,w:Math.max(0,(t.textBoxW||t.w)-e.w),h:Math.max(0,(t.textBoxH||t.h)-e.h)};this.tctl_.SetStyle(i)}}return{Destructor:function(){this.autosize_t_w&&WCT.ClearTimeout(this.autosize_t_w),this.autosize_t_h&&WCT.ClearTimeout(this.autosize_t_h),this.bctl_.Destructor(),this.tctl_.Destructor(),this.bctl_=null,this.tctl_=null,this.obj_=null,this.max_wh_=null;var t=$(this.uid_);t&&t.parentNode.removeChild(t)},Create:function(t,e){this.obj_=WCT.DeepCopy(e);var i=$$("div");i.id=this.uid_,i.className="bto_"+e.type,i.style.position="absolute",t.appendChild(i),this.bctl_.Create(i,e),this.tctl_.Create(i),this.SetBorderStyle(e)},SetText:function(t){var e=$(this.uid_+"#TO");e&&this.tctl_.HideScrollbars(!t||!!this.obj_.hide_scrollbars),this.obj_.text=t,this.tctl_.SetText(t),e&&BROWSER.IE&&(e.style.display="none",e.style.display="block")},SetMSIE5:function(t){this.tctl_.SetMSIE5(t)},SetButtonMode:function(t){this.tctl_.SetButtonMode(t)},SetTextImage:function(t){this.tctl_.SetTextImage(t)},SetObserverId:function(t){this.tctl_.SetObserverId(t)},HideScrollbars:function(t){this.tctl_.HideScrollbars(!this.obj_.text||t),this.obj_.hide_scrollbars=t},EnableMarquee:function(t){this.tctl_.EnableMarquee(t)},ObserveOnScroll:function(t,e){this.tctl_.ObserveOnScroll(t,e)},GetUid:function(){return this.uid_},GetAutoSize:function(t){var e=this.tctl_,i=this.bctl_;if(e&&i)return e.GetAutoSize(t)+i.GetAutoSize(t)},GetObserverId:function(){return this.tctl_.GetObserverId()},GetScrollPos:function(){return this.tctl_.GetScrollPos()},GetTextPos:function(){return this.bctl_.GetContentPos()},GetBorderStyle:function(){return this.bctl_.GetBorderStyle()},GetFrameSize:function(){return this.bctl_.GetFrameSize()},SetBorderStyle:function(t){this.bctl_.SetBorderStyle(t),e.call(this,t),this.obj_=WCT.DeepCopy(t)},SetSrcCtx:function(t){this.bctl_.SetSrcCtx(t)},SetTitle:function(t){this.bctl_.SetTitle(t),e.call(this)},SetTitleClass:function(t){this.bctl_.SetTitleClass(t)},SetTypeIcon:function(t){this.bctl_.SetTypeIcon(t),e.call(this)},SetIconState:function(t,e){this.bctl_.SetIconState(t,e)},SetCustomBorderStyle:function(t){this.bctl_.SetCustomBorderStyle(t),e.call(this)},EnableIFrame:function(t){this.bctl_.EnableIFrame(t)},GetPosSize:function(){if(arguments[0]){var t=this.bctl_.GetPosSize();return t.text=this.tctl_.GetPosSize(),t}return this.tctl_.GetPosSize()},SetStyle:function(t){for(var e in t){var i={};switch(i[e]=t[e],e){case"w":case"h":this.obj_[e]=t[e],this.bctl_.SetStyle(i);var o=this.GetTextPos();i[e]=Math.max(0,i[e]-o[e]),this.tctl_.SetStyle(i);break;case"direction":this.bctl_.SetStyle(i);default:this.tctl_.SetStyle(i)}}},SetMaxWH:function(t,e){this.max_wh_[t]=e},GetMaxWH:function(t){return this.max_wh_[t]}}}(),ImageBorderTextObject.prototype=new BorderTextObject,ImageBorderTextObject.Create=function(t){var e=arguments[1]||{};e.image_=!0,BorderTextObject.Create.call(this,t,e)},WCT.ExtendObject(ImageBorderTextObject.prototype,{Destructor:function(){this.wh_=null,BorderTextObject.prototype.Destructor.call(this)},SetImage:function(t){this.bctl_.SetImage(t)},SetImagePadding:function(t){this.bctl_.SetImagePadding(t),this.SetStyle(this.wh_)},SetImageAlign:function(t){this.bctl_.SetImageAlign(t),this.SetStyle(this.wh_)},SetBorderStyle:function(t){BorderTextObject.prototype.SetBorderStyle.apply(this,arguments),this.SetStyle(this.wh_)},SetCustomBorderStyle:function(t){BorderTextObject.prototype.SetCustomBorderStyle.apply(this,arguments),this.SetStyle(this.wh_)},SetStyle:function(t){for(var e in t){var i={};switch(i[e]=t[e],e){case"w":case"h":this.wh_[e]=i[e],this.bctl_.SetStyle(i);var o=this.GetTextPos();"w"==e?(i.w=Math.max(0,t.w-o.w),i.x=o.l):(i.h=Math.max(0,t.h-o.h),i.y=o.t),this.tctl_.SetStyle(i);break;default:BorderTextObject.prototype.SetStyle.call(this,i)}}}}),CanvasObject.CreateCanvas=function(t,e){var i=new CanvasObject(this._id+"#main#canvas");return i.AddShape("0",e),i.Create(t),this._cctl=i},CanvasObject.prototype=function(){function s(t){var e=this.shapes_[t];e&&(e.shape&&e.shape.Destructor(),e.shape=null,e.opar=null,e.cpar=null,delete this.shapes_[t])}function e(){var t=this.shapes_;for(var e in t)s.call(this,e)}function o(t,e){var i=this.shapes_[t];if(i){var o=WCT.DeepCopy(Shape.ACCEPTED_PARAMS,{dir:1}),r={};for(var n in o)"undefined"!=typeof e[n]&&(r[n]=e[n]);i.opar&&i.opar.dir!=r.dir&&(s.call(this,t),i={id:t},this.shapes_[t]=i),i.opar=r}}function r(t){var e=this.shapes_[t];if(!e||!e.opar)return null;var i=e.opar;"rounded_rectangle"==i.dir&&(i=WCT.DeepCopy(i,{legacy:!0}));var o=Shape.GetCanvasParams(i,i);return e.shape&&e.shape.SetParams(o),e.cpar=o,function s(){var t=this.GetDom(),e=[],i=[],o=this.shapes_;for(var r in o){var n=o[r].cpar;n&&!o[r].hidden&&(e.push((n.x||0)+(n.w||0)),i.push((n.y||0)+(n.h||0)))}e=Math.max.apply(null,e),i=Math.max.apply(null,i),e>this.w_&&(t&&(t.width=e),this.w_=e),i>this.h_&&(t&&(t.height=i),this.h_=i)}.call(this),o}function _(t){var e=this.shapes_[t];if(!e||!e.opar||!e.cpar)return null;if(!e.shape){var i=e.opar,o="rounded_rectangle2"==i.dir?"rounded_rectangle":i.dir;e.shape=new Shape[o],e.shape.SetParams(e.cpar)}return e.shape}function l(t,e){t&&this.Clear();var i=this.GetDom();i&&WCT.dom.AndroidOpacitySwitch(i);var o=arguments[2];if(o){var r=_.call(this,o),n=this.GetCtx();if(!r||!n)return;var s=this.shapes_[o];if(s.hidden)return;e?r.DrawAnimated(n,s.border_style):r.Draw(n,s.body_style,s.border_style)}else{var a=this.shapes_;for(o in a)l.call(this,!1,e,o)}}return{Destructor:function(){var t=this.GetDom();t&&t.parentNode.removeChild(t),e.call(this),this.ctx_=null,this.shapes_=null},Create:function(t){var e=$$("canvas");e.id=this.uid_,e.style.position="absolute",e.style.overflow="hidden",e.style.zIndex=-1,e.style.left="0",e.style.top="0",e.width=this.w_,e.height=this.h_,t.appendChild(e),this.ctx_=e.getContext("2d")},Clear:function(){var t=this.GetCtx();t&&t.clearRect(0,0,this.w_,this.h_)},GetCtx:function(){if(!this.ctx_){var t=this.GetDom();t&&(this.ctx_=t.getContext("2d"))}return this.ctx_},GetDom:function(){return $(this.uid_)},AddShape:function(t,e){var i=this.shapes_;return i[t]||(i[t]={id:t}),o.call(this,t,e),r.call(this,t),_.call(this,t)},RemoveShape:function(t){s.call(this,t)},RemoveAllShapes:function(){e.call(this),this.Clear()},HideShape:function(t,e){var i=this.shapes_[t];i&&(i.hidden=e)},Draw:function(){l.call(this,!1,!1,arguments[0])},Redraw:function(){l.call(this,!0,!1,arguments[0])},DrawAnimated:function(){l.call(this,!1,!0,arguments[0])},RedrawAnimated:function(){l.call(this,!0,!0,arguments[0])},SetDrawStyle:function(t,e,i){var o=this.shapes_[t];o&&(o.body_style=e,o.border_style=i)},SetParams:function(t,e){return o.call(this,t,e),r.call(this,t)},IsDrawing:function(){var t=arguments[0];if(!t){var e=this.shapes_;for(t in e)if(this.IsDrawing(t))return!0;return!1}var i=_.call(this,t);return i&&i.IsDrawing&&i.IsDrawing(this.ctx_)||!1},GetTextRect:function(){var t=arguments[0];if(!t){var e=this.shapes_,i={};for(t in e)i[t]=this.GetTextRect(t);return i}var o=_.call(this,t);return o&&!this.shapes_[t].hidden?o.GetTextRect():null},GetHitarea:function(t){var e=arguments[1];if(!e){var i=this.shapes_,o={};for(e in i)o[e]=this.GetHitarea(t,e);return o}var r=_.call(this,e);return r&&!this.shapes_[e].hidden?r.GetHitarea(t):null}}}(),GroupObject.CreateGroup=function(){var t=this._obj,e=new GroupObject(t.id),i=t.collection;return i&&(i=-1==i.search(";")?[i]:i.split(";"),e.Add(i)),this._gctl=e},function(){function e(t,e){for(var i=this.group_,o=this.grp_ctl_id_,r=0,n=e.length;r<n;r++){var s=e[r],a=Controls[s];a?"remove"===t?(a.SetGrouped(""),delete i[s]):a.IsGrouped()||a.isStatusControl||(a.SetGrouped(o),i[s]=!0):delete i[s]}}WCT.ExtendObject(GroupObject.prototype,{Destructor:function(){this.RemoveAll(),this.group_=null},Exec:function(t){switch(t){case"fade_in":case"fade_out":case"fade_toggle":var e=this.group_;for(var i in e){var o=Controls[i];o&&o.RTFireTrigger(t)}}},Add:function(t){e.call(this,"add",t)},Remove:function(t){e.call(this,"remove",t)},RemoveAll:function(){var t=this.group_,e=[];for(var i in t)e.push(i);this.Remove(e)},Get:function(){return this.group_}})}(),function(){function set_defaults_(){if(PageCanvas.IgnoreFallbacks(arguments[0]))return this.defaults_={},void(ctx.slide_defaults={});if(!ctx.slide_defaults){var adp=this.variables_.simulation_playback||"simulation_playback",url=EDIT_MODE?"adaptable!"+adp+":slide_fallbacks.js":"config:slide_fallbacks.js",cnt=LoadFile(url);if(cnt){var defs=cnt;if("string"==typeof defs)try{defs=eval("("+cnt+")")}catch(e){}if(defs&&"object"==typeof defs)for(var i in defs){var def=defs[i];if(def){var fb=FallbackValues[i];for(var j in fb||(FallbackValues[i]={},fb=FallbackValues[i]),def)fb[j]=def[j]}}}ctx.slide_defaults=FallbackValues}this.config_&&this.config_.book_style&&(FallbackValues.page||(FallbackValues.page={}),FallbackValues.page.skin=this.config_.book_style,ctx.slide_defaults=FallbackValues),this.defaults_=ctx.slide_defaults}function realize_page_(t){Media.audio.StopAll([AudioControl.BOOKSOUND]);var e=t.controls;(n=WCT.DeepCopy(e.page)).type||(n.type="page");var i=this.defaults_&&this.defaults_[n.type]||null;if(i)for(var o in i)"undefined"==typeof n[o]&&(n[o]=i[o]);Canvas=new PageCanvas,Controls.page=Canvas,n._src_ctx?Canvas._src_ctx=createSourceContext(n._src_ctx):Canvas._src_ctx=createSourceContext(BOOK_EDIT||!LESSON_EDIT&&!SIM_MODE?{_this:"slide",slide:Context.Get("slide")}:{_this:"project",project:Context.Get("project")}),Canvas.Init(n),hdl_onresize();var r=[];for(var o in e){var n;"page"!=(n=e[o]).id&&("group"==n.type&&r.push(o),add_control_.call(this,n,!0))}for(var s=r.length-1,a=0;a<=s;a++){var _=r[a],l=Controls[_];if(l)l.InitGroup(),0===l.GetGroup(!0).length&&Page.DeleteControl(_,!0)}if(EDIT_MODE)BOOK_EDIT&&Editor.SetSelection("page");else if(SIM_MODE)try{document.body.focus()}catch(d){}}function attach_event_handler_(t){var e=EDIT_MODE?document.documentElement:$("frame");t?(WCT.event.Observe("dragstart",hdl_forbiddrag,document),WCT.event.Observe("draggesture",hdl_forbiddrag,document),EDIT_MODE&&WCT.event.Observe("scroll",hdl_onscroll,document),e.onscroll=hdl_onscroll,EDIT_MODE?AddEditorEventListener():(AddRTEventListener(),$("drag_sel").style.display="none",window.Canvas?Canvas.HideScrollbars():e.style.overflow="auto")):(EDIT_MODE?RemoveEditorEventListener():RemoveRTEventListener(),e.onscroll=null,WCT.event.StopObserving("dragstart",hdl_forbiddrag,document),WCT.event.StopObserving("draggesture",hdl_forbiddrag,document),EDIT_MODE&&WCT.event.StopObserving("scroll",hdl_onscroll,document),window.onscroll=null)}function create_(t,e){EDIT_MODE||"null"!=t&&"interactive"!=t||(this.config_.transition&&BROWSER.IE?(WCT.transition.Set(this.config_.transition),WCT.transition.Apply()):Curtain.Add()),this.ClearSlide();var i=e[0];if(i.controls.page||(i.controls.page={type:"page",id:"page"}),set_defaults_.call(this,i.controls.page),RT&&Env&&Env.enterOrSpaceInUse){var o=Env.enterOrSpaceInUse();RT.keysInUse={space:o.space,enter:o.enter}}var r=Page.GetContentScale();if(1!==r){var n=i.controls.page;n&&n.image&&n.image.id&&(n.w=n.w/r,n.h=n.h/r,n.image.w=n.image.w/r,n.image.h=n.image.h/r)}var s=i.controls.page;s.image&&s.image.id?(this.last_bg_=s.image.id,this.last_bg_ctx_=s._src_ctx):(this.last_bg_=null,this.last_bg_ctx_=null),realize_page_.call(this,i),attach_event_handler_(!0);var a=Context.ToAbsPath("book_style:textbox/textbox.css"),_=this.variables_.text_styles||"text_styles",l=$("customcss"),d=Context.ToAbsPath("adaptable!"+_+":text_styles.css");if(this.textbox_css_!==a&&(this.textbox_css_=$("textboxcss").href=a),this.custom_css_!==d&&(l.addEventListener("load",Page.CallControlUpdateHitareas.bind(this)),this.custom_css_=l.href=d),SCREENSHOT_MODE||!EDIT_MODE)return this.image_watcher_id_=WCT.image_watcher.Observe(images_loaded_,this),"loading";if(EDIT_MODE){for(var h in Controls)"page"!=h&&Controls[h].UpdateAfterImagesLoaded&&Controls[h].UpdateAfterImagesLoaded();return"edit_mode"}}function images_loaded_(){for(var t in WCT.image_watcher.StopObserving(this.image_watcher_id_),this.image_watcher_id_=null,Controls)"page"!=t&&Controls[t].UpdateAfterImagesLoaded&&Controls[t].UpdateAfterImagesLoaded();this.sengine_.Exec(SCREENSHOT_MODE?"screenshot_ready":"loaded")}function make_interactive_(){for(var t in Controls)Controls[t].ShowAfterTransition();return Media.audio.PlayPagesound(),Canvas._obj&&Canvas._obj.onload&&this.RTFireTrigger(Canvas._obj.onload),Controls.page&&Controls.page.track(),hdl_onresize(),"interactive"}function do_init_delayed_(){if(window.Page){for(var t=Page.delayed_init_,e=t.shift();e;)e.f.apply(e.s,e.p),e=t.shift();Page.sengine_.Exec("late")}}function init_delayed_(){return WCT.SetTimeout(do_init_delayed_,1),"late"}function do_call_delayed_(){for(var t=Page.delayed_call_,e=t.shift();e;)e.f.apply(e.s,e.p),e=t.shift()}function call_delayed_(){this.delayed_timeout_id_&&WCT.ClearTimeout(this.delayed_timeout_id_),this.delayed_timeout_id_=WCT.SetTimeout(do_call_delayed_,1)}function screenshot_ready_(){for(var t in Controls)if("page"!==t){var e=Controls[t],i=e._obj||{},o=e.get_doc_enable_.call(e);i.hidden?o&&e.SetParam("hidden",!1):o||e.SetParam("hidden",!0)}return Env.OnScreenshotReady(),"edit_mode"}function play_transition_(){if(this.config_.transition&&BROWSER.IE){for(var t in Controls)Controls[t].PrepareTransition();return WCT.transition.Play(after_transition_,this),"transitioning"}return BROWSER.IE&&11==BROWSER.VERSION&&!Env.VideoMode()?WCT.SetTimeout(Curtain.Remove,1):Curtain.Remove(),make_interactive_.call(Page)}function after_transition_(){make_interactive_.call(this),this.sengine_.Exec("transitioned")}function add_control_(ctl_obj){"object"!=typeof ctl_obj&&eval("ctl_obj = "+ctl_obj);var scaling=Page.GetContentScale();if(1!==scaling){var ctId=ctl_obj.id,macId=ctl_obj._src_ctx&&ctl_obj._src_ctx.macro||ctId;-1!==macId.search(/^MAC_/)&&(ctl_obj.x=Math.round(ctl_obj.x/scaling),ctl_obj.y=Math.round(ctl_obj.y/scaling),-1===ctId.search(/_binfo$/)&&(ctl_obj.w=Math.round(ctl_obj.w/scaling),ctl_obj.h=Math.round(ctl_obj.h/scaling)))}var ct=ctl_obj.template||"";if(ct){var tp=ctx.slide_template||{},pt=ctx.slide_template_id||"";if(ct!=pt||!tp[ctl_obj.id])return null}if(Controls[ctl_obj.id])return Controls[ctl_obj.id]._obj;ctl_obj=WCT.DeepCopy(ctl_obj);var def=this.defaults_&&this.defaults_[ctl_obj.type]||null;if(def)for(var i in def)"undefined"==typeof ctl_obj[i]&&(ctl_obj[i]=def[i]);var ctl=null,_ctx;switch(ctl_obj.type){case"progress":ctl=new ProgressControl;break;case"poi":ctl=new PoiControl;break;case"sprite":ctl=new SpriteControl;break;case"image":ctl=new ImageControl;break;case"inputclick":if(ctl=new TextControl,"drag"==ctl_obj.action||"drop"==ctl_obj.action)break;this.last_bg_&&!LESSON_EDIT&&(ctl_obj.image={bg:this.last_bg_,w:ctl_obj.w,h:ctl_obj.h,offsetX:ctl_obj.x,offsetY:ctl_obj.y},ctl_obj._src_ctx=this.last_bg_ctx_);break;case"inputtext":ctl=new InputTextControl;break;case"inputradio":ctl=new InputRadioControl;break;case"inputselect":ctl=new InputSelectControl;break;case"linklist":ctl=new LinkListControl;break;case"breadcrumb_trail":ctl=new BreadcrumbTrailControl;break;case"buttonarea":ctl=new ButtonAreaControl;break;case"text":case"hrefarea":case"placeholder":case"subtitle":ctl=new TextControl;break;case"imagebutton":ctl=new ImageButton;break;case"activity_control":ctl=new ActivityControl;break;case"timer":ctl=new TimerControl;break;case"counter":ctl=new CounterControl;break;case"collector":ctl=new CollectorControl;break;case"big_arrow":case"shape":ctl=new CanvasControl;break;case"connector":ctl=new ConnectorControl;break;case"arrow":ctl=new ArrowControl;break;case"mchoice":ctl=new Quiz.mchoice;break;case"sqmaquiz":ctl=new Quiz.sqma;break;case"fibquiz":ctl=new Quiz.fib;break;case"puzzlequiz":ctl=new Quiz.puzzle;break;case"matchquiz":ctl=new Quiz.match;break;case"gridquiz":ctl=new Quiz.grid;break;case"connquiz":ctl=new Quiz.connection;break;case"mixquiz":ctl=new Quiz.mix;break;case"scalequiz":ctl=new Quiz.scale;break;case"hotspotquiz":ctl=new Quiz.hotspot;break;case"quiz_eval":ctl=new Quiz.eval;break;case"quiz_template":EDIT_MODE&&Env.onPropChange(ctl_obj.id,"name","quiz_element"),ctl=new Quiz.template;break;case"y_ruler":void 0!==YRuler&&(ctl=new YRuler);break;case"x_ruler":void 0!==XRuler&&(ctl=new XRuler);break;case"group":ctl=new GroupControl,EDIT_MODE&&ctl_obj.name&&Editor.GroupName(ctl_obj.name,!0);break;case"link_textBoxIcon":ctl=new TextBox;break;case"link_demo":case"link_pres":case"link_guided":case"link_test":case"link_slide":case"link_book":case"link_quiz":case"link_practice":case"link_concurrent":ctl=new ImageLink,ctl.SetLinkType(ctl_obj.type.replace(new RegExp("link_"),""));break;case"link_document":ctl=new ImageLink,ctl.SetLinkType("start");break;case"video":case"wmp":case"flash":case"quicktime":case"realplayer":ctl=new MediaControl;break;case"audio":ctl=new AudioControl;break;case"bubble":ctl=new Bubble;break;case"html":case"office":ctl=new iFrameControl;break;case"animator":ctl=new AnimatorControl;break;case"switchboard":ctl=new SwitchboardControl;break;case"jumper":ctl=new Jumper;break;case"notifier":ctl=new Notifier;break;case"tracker":ctl=new Tracker;break;case"waypoint":ctl=new Waypoint;break;case"testomat":ctl=new Testomat;break;case"mouse":ctl=new MouseControl;break;case"typist":ctl=new Typist;break;case"highlight":ctl=new Highlight;break;case"drop_down_ani":ctl=new DropDownAni;break;case"hotkey":ctl=new Hotkey;break;case"dragdrop":ctl=new DragDrop;break;case"qrcode":ctl=new QRCodeControl;break;default:return null}return ctl?(_ctx="undefined"!=typeof ctl_obj._src_ctx?ctl_obj._src_ctx:BOOK_EDIT||!LESSON_EDIT&&!SIM_MODE?{_this:"slide",slide:Context.Get("slide")}:{_this:"macro",macro:ctl_obj.uid},ctl._src_ctx=createSourceContext(_ctx),Controls[ctl_obj.id]=ctl,ctl.Init(ctl_obj),EDIT_MODE&&!Editor.Preview()||ctl.SetPreview(!0),ctl_obj):null}function group_delete_(t){var e=Controls[t],i=ctx.slide_template||{};if(e&&e.IsGroupControl()){var o=e.GetGroup(),r=!1;for(var n in o){var s=Controls[n];i[n]?(hide_inherited_control_.call(this,n,r),r=!0):(s&&(s.IsGroupControl()&&group_delete_(n),delete Controls[n],s.Terminate()),Env.ControlDeleted(n))}}}function delete_control_(t){var e=Controls[t];if(e){if(e.IsGrouped()){var i=e.GetGroupId(),o=Controls[i];o&&o.RemoveCtlFromGroup(t)}delete Controls[t],e.Terminate(),Env.ControlDeleted(t,arguments[1]),"page"==t&&(Canvas=null),EDIT_MODE&&Editor.SetSelection("page")}}function hide_inherited_control_(t){if(!arguments[1]&&Editor){var e="slide.inherited_delete",i=ctx.cfg_tr(e);i===e&&(i="The selected objects are inherited from the active book page template and cannot be deleted. The objects will be hidden."),Editor.EdittimeInfo(i)}Page.UpdateControl(t,"hidden",1),Env.onPropChange(t,"hidden",1),Page.UpdateControl(t,"doc_enable",0),Env.onPropChange(t,"doc_enable",0)}function append_(t){var e=t.controls;for(var i in e)"page"==e[i].id||add_control_.call(this,e[i])}window.Page={MR_SHOW_TASK_BUBBLE:!0,MR_SHOW_EXPL_BUBBLE:!0,clientWidth:document.documentElement.clientWidth,clientHeight:document.documentElement.clientHeight,scrollLeft:document.documentElement.scrollLeft,scrollTop:document.documentElement.scrollTop,offsetWidth:document.documentElement.offsetWidth,offsetHeight:document.documentElement.offsetHeight,editorEvtListener:!1,rtEvtListener:!1,_userPaused:!1,_continueAction:[],paused_:!1,config_:{},defaults_:{},placeholder_:{},firing_:{},last_bg_:null,last_bg_ctx_:null,delayed_init_:[],delayed_call_:[],delayed_timeout_id_:0,image_watcher_id_:null,variables_:{},textbox_css_:null,custom_css_:null,sengine_:new WCT.state(this),Init:function(){var t=this.sengine_;t.AddState("null","edit_mode","loading","loaded","playable","transitioning","interactive","late"),t.AddEvent("create","loaded","play","transitioned","edit","late","clear","screenshot_ready"),t.SetStartState("null"),t.AddTransition("create","*",create_,this,["loading","edit_mode"]),t.AddTransition("loaded","loading",function(){return"loaded"}),t.AddTransition("loaded","playable",init_delayed_,this,["late"]),t.AddTransition("play","loading",function(){return"playable"}),t.AddTransition("play","loaded",init_delayed_,this,["late"]),t.AddTransition("play","edit_mode",make_interactive_,this,["interactive"]),t.AddTransition("late","late",play_transition_,this,["transitioning","interactive"]),t.AddTransition("edit","interactive",function(){return"edit_mode"}),t.AddTransition("edit","edit_mode",function(){return"edit_mode"}),t.AddTransition("screenshot_ready","loading",screenshot_ready_),t.AddTransition("transitioned","transitioning",function(){return"interactive"}),t.AddTransition("clear","*",function(){return"null"})},Cleanup:function(){this.ClearSlide(),this.delayed_timeout_id_&&(WCT.ClearTimeout(this.delayed_timeout_id_),this.delayed_timeout_id_=0),this.delayed_init_=[],this.delayed_call_=[],this.config_={},this.defaults_={},this.placeholder_={},this.firing_={},this.last_bg_=null,this.last_bg_ctx_=null,this.textbox_css_=null,this.custom_css_=null,this.sengine_.Cleanup()},RegisterDelayedInit:function(t,e){this.IsInCreate()?this.delayed_init_.push({f:t,s:e,p:arguments[2]||[]}):(this.delayed_call_.push({f:t,s:e,p:arguments[2]||[]}),call_delayed_())},ShowHighlights:function(t){t=t?".show":".hide";var e=[];for(var i in Controls)Highlight.IsHighlight(i)&&e.push(i+t);if(!e.length)for(i in Controls)Controls[i]instanceof Bubble&&e.push(i+t);e=e.join(";"),this.RTFireTrigger(e)},SetupVideoMode:function(t){Ticker.SetVideoMode(t)},VideoTick:function(){Ticker.VideoTick()},SetSink:function(t){null==t?T2||(Env._sink=window.external,EDIT_MODE=!0):Env._sink=t},SetPageloadSink:function(t){Env._pageloadSink=t,Env.isPageComplete()&&Env.pageComplete(!0)},SetBase:function(t){init_page(),Context.SetBase(t)},SetScreenshotMode:function(t){SCREENSHOT_MODE=t},UpdateControl:function(t,e){var i=Controls[t];if(!i||this.in_update)return null;var o=null;return o="string"==typeof e?i.SetParam(e,arguments[2]):i.SetParams(e),i.IsGrouped()&&(Controls[i.GetGroupId()].Refresh(),Editor&&Editor.HandleGroupChange(i)),o},GetControlProperties:function(t,e){var i=Controls[t];return i?i.GetParams():null},doLog:function(t){Log2Win(t)},SetVariable:function(t,e){EDIT_MODE&&Editor&&Editor.RuntimeInfo('Set Variable "'+t+'" to "'+e+'"'),this.variables_[t]=e},GetVariable:function(t){return this.variables_[t]},getFallbackValue:function(t,e){return this.defaults_&&this.defaults_[t]&&this.defaults_[t][e]},RTFireTrigger:function(t){if(!EDIT_MODE||!window.Editor||Editor.Preview())if(this._userPaused)this._continueAction.push(t);else{for(var e=arguments[1],i=arguments[2],o=t.split(";"),r=[],n=0,s=o.length;n<s;n++){var a=o[n],_=a.indexOf(".");if(-1!=_){var l=a.substr(0,_),d=a.substr(_+1),h=Controls[l];if(h&&h.RTFireTrigger){var c=e;if(0<=d.indexOf("#")){var p=d.split("#");d=p.shift(),c=p}this.firing_[a]?EDIT_MODE&&r.push("trigger loop detected "+a):(this.firing_[a]=!0,h.RTFireTrigger(d,c,i),delete this.firing_[a])}else EDIT_MODE&&r.push((h?"no trigger_handler ":"no control ")+l)}}EDIT_MODE&&Editor&&r.length&&Editor.RuntimeInfo(r.join("\n"))}},DeleteControl:function(t){!arguments[1]&&"null"==this.sengine_.GetState()||delete_control_.call(this,t,arguments[1])},DeleteAllControls:function(){if("null"!=this.sengine_.GetState()||arguments[0])for(var t in Controls)"page"!=t&&delete_control_.call(this,t)},Delete:function(){if(!Editor||"null"==this.sengine_.GetState())return!1;var t=arguments[0]?[arguments[0]]:Editor.GetSelection(),e=arguments[1]||!1;if(!t.length)return!1;for(var i=ctx.slide_template||{},o=t.length,r=0;r<o;r++)if("page"!=t[r]){var n=t[r];group_delete_.call(this,n),!i[n]||e?delete_control_.call(this,n):hide_inherited_control_.call(this,n)}},GetControlPreloadStreams:function(t){var e,i=[];return t._src_ctx&&(e=createSourceContext(t._src_ctx)),"page"==t.type&&t.image&&t.image.id&&i.push(Context.ToAbsPath(t.image.id,e)),i},AddControl:function(t){return"null"!=this.sengine_.GetState()||arguments[1]?add_control_.call(this,t):null},Refresh:function(){var t=Context.ToAbsPath("book_style:textbox/textbox.css");this.textbox_css_!=t&&(this.textbox_css_=t,$("textboxcss").href=t);var e=this.variables_.text_styles||"text_styles",i=Context.ToAbsPath("adaptable!"+e+":text_styles.css");this.custom_css_!=i&&(this.custom_css_=i,$("customcss").href=i),this.CallControlRefresh()},CallControlRefresh:function(){for(var t in Controls)"page"!==t&&Controls[t].Refresh()},CallControlUpdateHitareas:function(){for(var t in Controls)"page"!==t&&Controls[t].UpdateHitAreas&&Controls[t].UpdateHitAreas()},ClearSlide:function(){for(var t in this.sengine_.Exec("clear"),WCT.transition.Stop(),Canvas&&Canvas.clear_image(),Controls)"page"!=t&&delete_control_.call(this,t);delete_control_.call(this,"page"),Media.audio.Source("Pagesound",""),attach_event_handler_(!1),Ticker.UnregisterAll(),HitManager.Cleanup(),WCT.image_watcher.Cleanup(),this.SetPlaceholderValue("ttstext","")},SetBookStyle:function(t){this.book_style=t,init_page(),Context.Set("book_style",t)},ReloadFallbacks:function(){ctx.slide_defaults=null,set_defaults_.call(this)},SetTemplate:function(temp){var ctls=arguments[1]||Page.slide_obj.controls,page=ctls&&ctls.page;temp=temp||(page&&page.template||null);var ts=null;if(temp){var tuid=temp.split("!")[1];if(ts=Env.LoadFile(temp+":slide.js"),ts){if("string"==typeof ts)try{ts=eval("("+ts+")")}catch(e){ts=null}if(ts&&"object"==typeof ts){var lock=page.template_locked,tctx=new WCT.context;for(var id in tctx.SetScope("slide"),tctx.Set("slide",tuid),ts.controls){var ctl=ts.controls[id];if(lock&&(ctl.locked=!0),tctx.ExpandSlideControl(ctl),ctls[id])for(var att in ctl)if("undefined"==typeof ctls[id][att]){var att_value=ctl[att];"pagesound"==att&&att_value&&(-1==att_value.indexOf(":")?att_value=temp+":"+att_value:att_value.match(/^slide:/)&&(att_value=att_value.replace(/^slide:/,temp+":"))),ctls[id][att]=att_value}else"page"==id&&"onload"==att&&(ctls.page.onload=ctl.onload+";"+ctls.page.onload);else ctls[id]=ctl}}}}ctx.slide_template=ts&&ts.controls||null,ctx.slide_template_id=temp},Create:function(t,e,i,o){LESSON_EDIT=EDIT_MODE&&o,BOOK_EDIT=EDIT_MODE&&!LESSON_EDIT,Dragger.SetIdleColor(LESSON_EDIT),this._continueAction=[];var r=t.controls,n=r&&r.page,s=n&&n.template;this.SetTemplate(s,r),Page.slide_obj=t,this.sengine_.Exec("create",[t]),Env.OnInteractive()},Append:function(t){"null"!=this.sengine_.GetState()&&append_.call(this,t)},Play:function(){this.sengine_.Exec("play"),this.paused_&&Page.Pause(!0,this._userPaused,!0)},Pause:function(t){if(arguments[2]||t!=this.paused_)if(this.paused_=t){var e=this._userPaused=arguments[1];Ticker.Pause(e),Media.Pause()}else this._userPaused=!1,Ticker.Continue(),Media.Resume(),this._executeContinueAction();return this.paused_},IsPaused:function(){return this.paused_},_executeContinueAction:function(){this.RTFireTrigger(this._continueAction.join(";")),this._continueAction=[]},SetPreview:function(){"edit_mode"==this.sengine_.GetState()&&Editor.SetPreview(!0)},SetEditView:function(){if(EDIT_MODE){var t=this.sengine_.GetState();"interactive"!=t&&"edit_mode"!=t||(Media.audio.StopPagesound(),Ticker.UnregisterAll(),Mouse.StopAni(),Editor.SetPreview(!1),this.sengine_.Exec("edit"))}},SetReadOnly:function(t){Editor.SetReadOnly(t)},SetSettings:function(t){var e="SlideSettings",i=e.length;for(var o in t)if(o.substr(0,i)==e){var r=o.substr(i);"undefined"!=typeof window[r]&&(window[r]=t[o])}},SetSimulationMode:function(){SIM_MODE=!0},IsInCreate:function(){return{"null":!0,loading:!0,loaded:!0,playable:!0,transitioning:!0}[this.sengine_.GetState()]||!1},SetPlaceholderValue:function(t,e){this.placeholder_[t]=e||""},GetPlaceholderValue:function(t){if(window.ctx&&ctx.getQuizScore&&t.match(/quiz_(cur|max)_score/)){var e=ctx.getQuizScore();return e?"quiz_cur_score"==t?e.cur:e.max:0}return this.placeholder_[t]||""},GetPlaceholderValues:function(){var t=WCT.DeepCopy(this.placeholder_);if(window.ctx&&ctx.getQuizScore){var e=ctx.getQuizScore()||{cur:0,max:0};t.quiz_cur_score=""+e.cur,t.quiz_max_score=""+e.max}return t},SetContextMap:function(t){var e={"slide:.caption":"slidetitle","slide:.description":"slidedescription","book:.caption":"booktitle","book:.description":"bookdescription","chapter:.caption":"chaptertitle","chapter:.description":"chapterdescription"};for(var i in t)this.SetPlaceholderValue(i,t[i]),e[i]&&this.SetPlaceholderValue(e[i],t[i])},SetConfig:function(t,e){this.config_[t]=e||""},setAccessibilityMode:function(t){EDIT_MODE||window.WORKFLOW_EDIT||t===this.config_.accessibilityMode||(this.config_.accessibilityMode=t,document.body.className=t?"accessibility-mode":"")},setHtmlLang:function(t){var e=document.documentElement,i=t.split("-")[0]||t;e.setAttribute("lang",i)},SetContentScale:function(t){this.config_.content_scale=t||1},GetContentScale:function(){return this.config_.content_scale||1},GetConfig:function(t){return this.config_&&this.config_[t]||null},HandleSubtitle:function(){PageCanvas.HandleSubtitle()},GetBoundaryRect:function(t){var e=Controls[t];return e&&e.GetBoundaryRect?e.GetBoundaryRect():null},SetTaskBubbleVisibility:function(t){var e=t?".show":".hide";for(var i in this.MR_SHOW_TASK_BUBBLE=t,Controls){var o=Controls[i]&&Controls[i]._obj||{};"bubble"==o.type&&o.mr_bubble_task&&this.RTFireTrigger(o.id+e)}},SetExplanationBubbleVisibility:function(t){var e=t?".show":".hide";for(var i in this.MR_SHOW_EXPL_BUBBLE=t,Controls){var o=Controls[i]&&Controls[i]._obj||{};"bubble"==o.type&&o.mr_bubble_expl&&this.RTFireTrigger(o.id+e)}},GetScale:function(){return EDIT_MODE&&Editor&&!Editor.Preview()?Editor.GetScale():RT&&RT.GetScale()||1},GetTextRect:function(t){var e=Controls[t];return e&&e.GetTextRect?e.GetTextRect():null},SetScale:function(t){EDIT_MODE&&Editor&&!Editor.Preview()&&Editor.SetScale(t)},ZoomIn:function(){EDIT_MODE&&Editor&&!Editor.Preview()&&Editor.ZoomIn()},ZoomOut:function(){EDIT_MODE&&Editor&&!Editor.Preview()&&Editor.ZoomOut()},ZoomToSelection:function(){EDIT_MODE&&Editor&&!Editor.Preview()&&Editor.ZoomToSelection()},ZoomToFit:function(){EDIT_MODE&&Editor&&!Editor.Preview()&&Editor.ZoomToFit()},ScrollToPos:function(t,e){window.scrollTo(t,e),hdl_onscroll()},HighlightHtmlString:function(t){var e=arguments[1]||"dgo_searchterm",i=this.GetVariable("lib_searchinfo");if(i&&i.length){for(var o=t,r=0,n=null;n=i[r++];)o=WCT.HighlightHtmlString(o,n,e)||o;return o}var s=this.GetVariable("lib_searchstring");return s?WCT.HighlightHtmlString(t,s,e):t},UpdateAllTextControls:function(){for(var t in Controls){var e=Controls[t];e.UpdateText&&e.UpdateText()}},GetPreviewCanvas:function(t,e){Env.SetPreviewCanvas&&Canvas&&Env.SetPreviewCanvas(Canvas.Parent(),t,e)},Group:function(){EDIT_MODE&&Editor&&!Editor.Preview()&&Editor.HandleGroup()},UnGroup:function(t){EDIT_MODE&&Editor&&!Editor.Preview()&&Editor.RemoveGroup(t)},GroupName:function(t,e){EDIT_MODE&&Editor&&!Editor.Preview()&&Editor.GroupName(t,e)},HandleEnvEvent:function(t){var e=Controls[t.control_id];e&&e.OnEnvEvent(t)}}}(),RectSelection.prototype.StartSel=function(t){this._in_sel=!0;var e=t.canvasX,i=t.canvasY;this._x1=e,this._x2=e,this._y1=i,this._y2=i,this._first=null},RectSelection.prototype._update_pos=function(){var t=$("drag_rect");if(t){var e=Editor.GetScale(),i=Canvas.x(),o=Canvas.y();BROWSER.IE8&&(i*=e,o*=e);var r=this._x1*e,n=this._x2*e,s=this._y1*e,a=this._y2*e;r<n?(t.style.left=r+i+"px",t.style.width=n-r+"px"):(t.style.left=n+i+"px",t.style.width=r-n+"px"),s<a?(t.style.top=s+o+"px",t.style.height=a-s+"px"):(t.style.top=a+o+"px",t.style.height=s-a+"px")}},RectSelection.prototype._create_rect=function(){var t=$$("div");t.id="drag_rect",t.style.position="absolute",t.style.fontSize="1px",t.style.border="1px dashed #009DE0 ",t.style.zIndex=99,document.body.appendChild(t),this._have_rect=!0},RectSelection.prototype.InSel=function(t){return this._in_sel},RectSelection.prototype.DragSel=function(t){if(this._in_sel){var e,i,o,r;this._have_rect||this._create_rect(),this._x2=t.canvasX,this._y2=t.canvasY,this._update_pos(),i=this._x1<this._x2?(e=this._x1,this._x2):(e=this._x2,this._x1),r=this._y1<this._y2?(o=this._y1,this._y2):(o=this._y2,this._y1);var n={},s=null;for(var a in Draggers){var _=Draggers[a];if(!_._parent.IsGrouped()){var l=_.RectSelect("main",e,o,i,r);if(l){if(!_._visible)continue;n[_.ParentId()]=!0,s=s||_.ParentId()}_.hotspotquiz&&"hotspot"==_.SubId()||Editor.SelectDrag(_.ParentId(),_.SubId(),l)}}!s||this._first&&this._first in n||(this._first=s,Editor.SetActive(this._first)),s?Editor.Active()!=this._first&&Editor.SetActive(this._first):"page"!=Editor.Active()&&Editor.SetActive("page")}},RectSelection.prototype.EndSel=function(){this._in_sel=!1;var t=$("drag_rect");this._have_rect=!1,t&&document.body.removeChild(t),Editor.DrgSelToCtlSel()};var SnapEnabled=!0,SnapDistance=8,SnapObjects=!0,SnapGrid=!1,SnapCenters=!0,SnapRulers=!0,SnapBorderInner=0,SnapBorderOuter=6,SnapGridX0=16,SnapGridDX=32,SnapGridY0=16,SnapGridDY=32,ShowSnapTargets=!1;function remove_edittime_info(){remove_info("ET")}function remove_runtime_info(){remove_info("RT")}function remove_info(t){"RT"==t?this._rt_info_timeout=null:this._et_info_timeout=null;var e=$(t+"Info");e&&document.body.removeChild(e)}function numeric_sort(t,e){return t-e}function _Editor(){this._down=!1,this._down_x=0,this._down_y=0,this._drag_id="",this._drag_sub_id="",this._drag_hdl_id="",this._kbd={handle:!0},this._preview=!1,this._readonly=!1,this._selection={},this._drag_selection={},this._active="",this._sel_rect=new RectSelection,this.scale_=1,this.scale_info_=null,this.css_applied_=!1,this.mov_hdl_id_=null,this.onSelectionChange(),this.SetActive("page")}function _RT(){this._hooks={},this._drag_hit=null,this._last_hit_result=null,this.cur_cursor_="",this.mouse_act_=null,this.dragging_=null,this.last_evt_clientX_=0,this.last_evt_clientY_=0,this.call_on_resize_=[],this.scale_=1,this.touch_down_=null,this.last_dist_=null,this.pinch_handled_=!1,this.touch_id_=null}_Editor.ZOOM_STEP=1.1,_Editor.prototype={GetScale:function(){var t=arguments[0];if("number"!=typeof t)return this.scale_;var e=this.scale_*t;return.95<e&&e<1.1?1:1.9<e&&e<2.1?2:3.8<e&&e<4.2?4:e},SetScale:function(t){var e=Math.min(4,Math.max(.1,t));if(e=Math.round(100*e)/100,this.scale_==e)return e;if(this.scale_=e,BROWSER.IE&&BROWSER.VERSION<9?(WCT.dom.CssZoom($(BROWSER.IE8?"frame":"canvas"),e),BROWSER.IE8||WCT.dom.CssZoom($("status"),e,0,0)):(WCT.dom.CssTransformScale($("canvas"),e,0,0),WCT.dom.CssTransformScale($("status"),e,0,0)),!this.css_applied_&&1!=e){WCT.ExtendHeadByCSS(null,[{selector:"*",rule:"-ms-interpolation-mode: nearest-neighbor; image-rendering: -moz-crisp-edges;"}]),this.css_applied_=!0}return Canvas.OnViewResize(),this.Preview()||arguments[1]||this.EdittimeInfo(Math.round(100*e)+"%"),e},ZoomIn:function(){var t=this.GetScale(_Editor.ZOOM_STEP);this.SetScale(t)},ZoomOut:function(){var t=this.GetScale(1/_Editor.ZOOM_STEP);this.SetScale(t)},ZoomToSelection:function(){this.ZoomToFit(!0)},ScrollToSelection:function(){return this.ZoomToFit(!0,!0),!0},ZoomToFit:function(){var t=Page.GetScale(),e=0;for(var i in Controls)Controls[i].isStatusControl&&e++;var o=Math.ceil(e*StatusControl.W/Canvas.w()),r={x:0,y:0,w:Canvas.w(),h:Canvas.h()};r.h+=o*StatusControl.H+PageCanvas.RULER_W+PageCanvas.SNAPLINE_SPACE+PageCanvas.RULER_BUFFER;var n=arguments[0]?this.GetSelection():[],s=n.length;if(s){if(LESSON_EDIT){var a=[];for(i=0;i<s;i++)for(var _ in Controls)-1<_.search(n[i])&&a.push(_);a.length&&(n=a)}this.SetScale(1);var l=GetRectForControls(n);l&&(r=l)}var d=Canvas.GetClientWH(),h=Canvas.GetSpaces(),c=document.documentElement;d.w<c.scrollWidth&&(d.w+=WCT.dom.SCROLLBAR_W),d.h<c.scrollHeight&&(d.h+=WCT.dom.SCROLLBAR_H);var p=d.w-2*h.l-80,u=d.h-2*h.t-80,f=Math.round(100*p/r.w)/100,m=Math.round(100*u/r.h)/100;if(arguments[1]){g=this.SetScale(t);s?Page.ScrollToPos(r.x*g,r.y*g):Page.ScrollToPos(0,0)}else{var g=this.SetScale(Math.min(f,m)),y=r.x*g+Canvas.x(),b=r.y*g+Canvas.y();BROWSER.IE8&&(y=(r.x+Canvas.x())*g,b=(r.y+Canvas.y())*g),s?Page.ScrollToPos(y-20,b-20):Page.ScrollToPos(0,0)}},HandleZoomPreview:function(){var t=1,e=0,i=0;if(this._preview)this.scale_info_={s:this.scale_,x:Page.scrollLeft,y:Page.scrollTop};else if(this.scale_info_){var o=this.scale_info_;t=o.s,e=o.x,i=o.y,this.scale_info_=null}this.SetScale(t,!0),Page.ScrollToPos(e,i)},Preview:function(t){return this._preview},ReadOnly:function(){return this._readonly},SetCur:function(t){this.SetActive(t)},SetPreview:function(t){if(this._preview!=t){for(i in this._preview=t,this.HandleZoomPreview(),Controls)Controls[i].HandleObj(t);for(i in Controls)Controls[i].SetPreview(t);for(i in Controls)Controls[i].Hidden()&&Page.UpdateControl(i,"hidden",!0)}t?(AddRTEventListener(),document.body.className="preview"):(AddEditorEventListener(),document.body.className="editmode"),hdl_onresize()},SetReadOnly:function(t){if(this._readonly=t)for(var e in Controls)Controls.hasOwnProperty(e)&&Controls[e].SetLocked(t)},EvaluateSelection:function(){var t=Object.keys(this._selection).join(","),e=this._active;this.SetSelection(t),Controls[e]&&this.SetActive(e)},SetSelection:function(t){var e=t.split(","),i=e.length;1==i&&this.SetActive(e[0]);for(var o={},r=i-1;0<=r;r--)Controls[e[r]]&&(o[e[r]]=!0);var n=0;for(var s in Controls){var a=Controls[s],_=s in o;a.Selected()!=_&&(a.SetSelected(_,!0),n++)}this._selection=o,n&&(this.onSelectionChange(),this.CtlSelToDrgSel())},GetSelection:function(){var t=this._selection,e=[];for(var i in t)e.push(i);return e},SelectAll:function(){var t=this.Active();"page"==t&&(t=null);var e={};for(var i in Controls){var o=Controls[i];"page"==i?o.SetSelected(!1):(e[i]=!0,o.SetSelected(!0),t=t||i)}t&&this.SetActive(t),this._selection=e,this.onSelectionChange(),this.CtlSelToDrgSel()},ToggleSelection:function(t){this._selection[t]?(delete this._selection[t],Controls[t].SetSelected(!1),this.onSelectionChange()):Controls[t]&&(this._selection[t]=!0,Controls[t].SetSelected(!0),this.onSelectionChange(),1==this._selection.length&&this.SetActive(t)),this.CtlSelToDrgSel()},SelectSingle:function(t,e){for(var i in this._selection)i!=t&&Controls[i]&&Controls[i].SetSelected(!1,e);this._selection={},t&&Controls[t]?(Controls[t].SetSelected(!0,e),this.SetActive(t),this._selection[t]=!0):this.SetActive("page"),this.CtlSelToDrgSel(),this.onSelectionChange()},Select:function(t,e){var i=Controls[t];i&&t in this._selection!=e&&(e?this._selection[t]=!0:delete this._selection[t],i.SetSelected(e),this.onSelectionChange())},CtlSelToDrgSel:function(){var t=this._selection,e={};for(var i in Draggers){var o=Draggers[i];if(o.isSelectable()){var r=o.ParentId()in t;o.SetSelected(r),r&&(e[i]=!0)}}this._drag_selection=e,this.onDragSelectionChange()},DrgSelToCtlSel:function(){var t={};for(var e in this._drag_selection){t[Draggers[e].ParentId()]=!0}var i=!1;for(var o in Controls){var r=Controls[o],n=o in t;r.Selected()!=n&&(r.SetSelected(n,!1),i=!0)}this._selection=t,i&&this.onSelectionChange()},onSelectionChange:function(){var t="";for(var e in this._selection)t.length&&(t+="|"),t+=e;Env.onSelectionChange(t)},Active:function(){return this._active},SetActive:function(t){if(this._active!=t){for(var e in Controls){e==t&&(this._active=t),(o=Controls[e])&&"page"!=o.Id()&&o.SetActive(e==t)}var i={},o=Controls[t];for(var r in o&&o.CollectTargets(i),Controls){var n=i[r];Controls[r].ShowRelated(1==n,t)}Env.onActivate(t)}},onDragSelectionChange:function(){var t="";for(var e in this._drag_sel_count=0,this._drag_selection)t.length&&(t+=" | "),t+=e+(Draggers[e].Selected()?"":" ?? "),this._drag_sel_count++;$("drag_sel").innerHTML=t},DragSelectionSize:function(){return this._drag_sel_count},ToggleDragSelection:function(t,e){if("page"!=t){var i=t+"#"+e,o=Draggers[i];if(o.hotspotquiz){var r="hotspot"==e?"main":"hotspot";if(this._drag_selection[t+"#"+r])return}this._drag_selection[i]?(delete this._drag_selection[i],o.SetSelected(!1)):(this._drag_selection[i]=!0,o.SetSelected(!0),1==this._drag_selection.length&&this.SetActive(t)),Editor.DrgSelToCtlSel(),this.onDragSelectionChange()}},SelectDrag:function(t,e,i){var o=t+"#"+e,r=Draggers[o];r&&o in this._drag_selection!=i&&(i?this._drag_selection[o]=!0:delete this._drag_selection[o],r.SetSelected(i),this.onDragSelectionChange())},SelectSingleDrag:function(t,e){var i=t+"#"+e;for(var o in this._drag_selection)o!=i&&Draggers[o]&&Draggers[o].SetSelected(!1);this._drag_selection={},i&&Draggers[i]?(this._drag_selection[i]=!0,this.SetActive(t),Draggers[i].SetSelected(!0)):this.SetActive("page"),Editor.DrgSelToCtlSel(),this.onDragSelectionChange()},EdittimeInfo:function(t){var e=this.get_info_item_("ET");this._et_info_timeout&&WCT.ClearTimeout(this._et_info_timeout),this._et_info_timeout=WCT.SetTimeout(remove_edittime_info,1500),e.innerHTML=t},RuntimeInfo:function(t){if(this._preview){var e=this.get_info_item_("RT");this._rt_info_timeout&&WCT.ClearTimeout(this._rt_info_timeout),this._rt_info_timeout=WCT.SetTimeout(remove_runtime_info,4e3),e.innerHTML=t}},get_info_item_:function(t){var e=$(t+"Info");return e||((e=$$("div")).id=t+"Info",e.className="se-notification",document.body.appendChild(e)),e},_hide_snap_matches:function(){for(var t in this._x_points_fix){(e=$("_SNAP_MATCH_X#"+t))&&Canvas.Parent().removeChild(e)}for(var t in this._y_points_fix){var e;(e=$("_SNAP_MATCH_Y#"+t))&&Canvas.Parent().removeChild(e)}},_show_snap_matches:function(){for(var t in this._snap_match_x){(e=$$("div")).id="_SNAP_MATCH_X#"+t,e.style.position="absolute",e.style.left=t+"px",e.style.width="1px",e.style.top="-20px",e.style.height=Canvas.h()+40+"px",e.style.borderLeft="1px dashed #009DE0",e.style.fontSize="1px",e.style.zIndex=99,Canvas.Parent().appendChild(e)}for(var t in this._snap_match_y){var e;(e=$$("div")).id="_SNAP_MATCH_Y#"+t,e.style.position="absolute",e.style.top=t+"px",e.style.left="-20px",e.style.width=Canvas.w()+40+"px",e.style.height="1px",e.style.borderTop="1px dashed #009DE0",e.style.fontSize="1px",e.style.zIndex=99,Canvas.Parent().appendChild(e)}},_hide_snap_targets:function(){for(var t in this._x_points_fix){(e=$("_SNAPX#"+t))&&Canvas.Parent().removeChild(e)}for(var t in this._y_points_fix){var e;(e=$("_SNAPY#"+t))&&Canvas.Parent().removeChild(e)}},_show_snap_targets:function(){for(var t in this._x_points_fix){(e=$$("div")).id="_SNAPX#"+t,e.style.position="absolute",e.style.left=t+"px",e.style.width="1px",e.style.top="-20px",e.style.height=Canvas.h()+40+"px",e.style.borderLeft="1px dashed #DDADDD",e.style.fontSize="1px",e.style.zIndex=1,Canvas.Parent().appendChild(e)}for(var t in this._y_points_fix){var e;(e=$$("div")).id="_SNAPY#"+t,e.style.position="absolute",e.style.top=t+"px",e.style.left="-20px",e.style.width=Canvas.w()+40+"px",e.style.height="1px",e.style.borderTop="1px dashed #ADDDDD",e.style.fontSize="1px",e.style.zIndex=1,Canvas.Parent().appendChild(e)}},_get_snap:function(t,e){for(var i=[],o=(f=this._x_arr_mov).length,r=0;r<o;r++)i.push(f[r]+t-0);var n={};for(r=0;r<=2*SnapDistance;r++)n[r-SnapDistance]={};for(var s=0,a=this._x_arr_fix,_=0,l=99999,d=0,h=i.length,c=a.length;s<h&&_<c;){var p=i[s],u=a[_];(y=Math.abs(p-u))<=l&&y<SnapDistance&&(l=y,n[d=u-p][u]="true"),p<u?s++:_++}this._snap_match_x=l<SnapDistance?n[d]:{};var f;for(i=[],o=(f=this._y_arr_mov).length,r=0;r<o;r++)i.push(f[r]+e);s=0,a=this._y_arr_fix,_=0,l=99999;var m=0,g={};for(r=0;r<=2*SnapDistance;r++)g[r-SnapDistance]={};for(h=i.length,c=a.length;s<h&&_<c;){var y,b=i[s],v=a[_];(y=Math.abs(b-v))<=l&&y<SnapDistance&&(l=y,g[m=v-b][v]="true"),b<v?s++:_++}return this._snap_match_y=l<SnapDistance?g[m]:{},{x:d,y:m}},_collect_snap_points:function(t,e){for(var i in Draggers){var o=Draggers[i],r={obj:!0,ruler:!0,center:SnapCenters,selected:!0},n={obj:SnapObjects,ruler:SnapRulers,center:SnapCenters,inner_border:SnapBorderInner,outer_border:SnapBorderOuter,selected:!1};!o.Locked()&&o.Selected()&&t==this.mov_hdl_id_&&o.GetSnapPoints(r,this._x_points_mov,this._y_points_mov,t,e);var s=Controls[this._drag_id]?Controls[this._drag_id].GetType():"";o.Selected()&&"pld"!=e||o.GetSnapPoints(n,this._x_points_fix,this._y_points_fix,t,e,s)}if(SnapGrid){var a=Canvas.w(),_=Canvas.h();if(1<SnapGridDX)for(var l=SnapGridX0;add_snap_point(this._x_points_fix,l,"l"),(l+=SnapGridDX)<=a;);if(1<SnapGridDY)for(var d=SnapGridY0;add_snap_point(this._y_points_fix,d,"l"),(d+=SnapGridDY)<=_;);}for(var h in this._x_arr_fix=[],this._x_points_fix)this._x_arr_fix.push(h-0);for(var h in this._x_arr_fix.sort(numeric_sort),this._y_arr_fix=[],this._y_points_fix)this._y_arr_fix.push(h-0);for(var h in this._y_arr_fix.sort(numeric_sort),this._x_arr_mov=[],this._x_points_mov)this._x_arr_mov.push(h-0);for(var h in this._x_arr_mov.sort(numeric_sort),this._y_arr_mov=[],this._y_points_mov)this._y_arr_mov.push(h-0);this._y_arr_mov.sort(numeric_sort)},OnMouseLeave:function(t){if(!this._down){var e=this.normalize_evt(t);if(e.sub_id){var i=Controls[e.ctl_id];i&&i.OnMouseLeave(e)}}},OnMouseClick:function(t){if(!Env._in_drag){var e=this.normalize_evt(t);if("button"==e.targetClass){var i=Buttons[e.targetId];return i&&i(e.targetId),!0}if(!this._down&&e.sub_id){var o=Controls[e.ctl_id];o&&o.OnMouseClick(e)}}},ImageLoaded:function(t){var e=this.normalize_evt(t);if(e.sub_id){var i=Controls[e.ctl_id];i&&i._image_loaded(e)}},OnMouseDblClick:function(t){if(!this._readonly&&!this._preview){var e=this.normalize_evt(t),i=this.HitTest(e);if(i&&i.ctl_id&&Controls[i.ctl_id]){var o=Controls[i.ctl_id];!Env.onDefaultEdit(i.ctl_id,e)&&o.OnMouseDblClick&&o.OnMouseDblClick(e)}}},OnMouseEnter:function(t){if(!this._down){var e=this.normalize_evt(t);if(e.sub_id){var i=Controls[e.ctl_id];i&&i.OnMouseEnter(e)}}},SetMouseDown:function(t){this._down_x=t.screenX,this._down_y=t.screenY},setCapture:function(t){this._drag_id=t},releaseCapture:function(){this._drag_id=""},scrollbar_hit_:function(t){var e=t.target?t.target:t.srcElement;if(e){if("HTML"==e.tagName)return!0;if("object"==typeof e){var i=!0;for(var o in e){i=!1;break}if(i)return!0}}return!1},scale_factor_:function(t,e,i,o){var r=i/2/(t/2),n=o/2/(e/2);return Math.max(r,n)},limit_dims_:function(t,e,i,o){var r=0,n=e.hdl_id,s=i._orig_rect.w,a=i._orig_rect.h;switch(o){case"y":r=(_=s/a)*t.y,r="lb"==n||"rt"==n?-1*r:r;break;case"x":var _=a/s;r=Math.round(_*t.x);r="lb"==n||"rt"==n?-1*r:r}return Math.round(r)},keep_aspect_ratio_:function(t,e,i){var o=WCT.DeepCopy(t),r=e.hdl_id,n=i._orig_rect;if("undefined"==typeof n.w||"undefined"==typeof n.h)return t;var s=n.w,a=n.h,_=0,l=0,d=1;switch(r){case"rb":_=s+o.x,l=a+o.y,d=this.scale_factor_(s,a,_,l),o.x=s*d-s,o.y=a*d-a;break;case"lt":_=s+-o.x,l=a+-o.y,d=this.scale_factor_(s,a,_,l),o.x=-(s*d-s),o.y=-(a*d-a);break;case"lb":_=s+-o.x,l=a+o.y,d=this.scale_factor_(s,a,_,l),o.x=-(s*d-s),o.y=a*d-a;break;case"rt":_=s+o.x,l=a+-o.y,d=this.scale_factor_(s,a,_,l),o.x=s*d-s,o.y=-(a*d-a)}return o.x=Math.round(o.x),o.y=Math.round(o.y),o},OnMouseDown:function(t){if(this.prevent_direct_select_&&(this.prevent_direct_select_=!1),!Env._in_drag){if(this.space_down_)return this.pan_={start_x:t.clientX,start_y:t.clientY,scrollLeft:Page.scrollLeft,scrollTop:Page.scrollTop},t&&"function"==typeof t.preventDefault&&t.preventDefault(),BROWSER.IE&&(this._capture=!0,document.body.setCapture(!0)),!1;if(this.scrollbar_hit_(t))return t&&"function"==typeof t.preventDefault&&!BROWSER.SAFARI&&t.preventDefault(),!0;var e=this.normalize_evt(t);if("button"==e.targetClass)return!0;e.target&&"SELECT"==e.target.tagName||document.body.focus(),hdl_onscroll();var i=this.HitTest(e);if(i){this.mov_hdl_id_=i.hdl_id,this._down=!0,this._down_x=e.screenX,this._down_y=e.screenY;var o=Controls[i.ctl_id],r=!0;if(o&&(e.shiftKey&&o.HandleShiftMouseDown&&(i=o.HandleShiftMouseDown(i),this.CtlSelToDrgSel()),e.ctrlKey&&(this.ToggleDragSelection(i.ctl_id,i.sub_id),r=!1),e.altKey&&o.HandleAltMouseDown&&(o.HandleAltMouseDown(i),this.CtlSelToDrgSel(),r=!1),r&&i)){this._drag_id=i.ctl_id,this._drag_sub_id=i.sub_id,this._drag_hdl_id=i.hdl_id,this._drag_hdl_type=i.hdl_type,i.drag_hdl_id=i.hdl_id;var n=this._drag_selection,s=o.IsGroupControl()&&o.IsGrouped()&&this._selection[o.GetGroupId()];if(n[i.ctl_id+"#"+i.sub_id]||s){switch(this._x_points_fix={},this._y_points_fix={},this._x_points_mov={},this._y_points_mov={},i.hdl_id){case"l":case"r":this._collect_snap_points("l","l"),this._collect_snap_points("r","r");break;case"t":case"b":this._collect_snap_points("t","t"),this._collect_snap_points("b","b");break;case"lb":case"rt":this._collect_snap_points("lb","lb"),this._collect_snap_points("rt","rt");break;case"rb":case"lt":this._collect_snap_points("rb","rb"),this._collect_snap_points("lt","lt");break;default:this._collect_snap_points(i.hdl_id,i.hdl_type)}for(var a in n){var _=Draggers[a];_&&!_.Locked()&&_.StartDrag(e,i)}ShowSnapTargets&&this._show_snap_targets(),this._dragging=!0,Env.onBeginDrag()}else BROWSER.FIREFOX?WCT.SetTimeout(this.SelectSingleDrag,500,this,[i.ctl_id,i.sub_id]):this.SelectSingleDrag(i.ctl_id,i.sub_id),Controls[i.ctl_id].IsGroupControl()&&(this.prevent_direct_select_=!0)}}else e.ctrlKey||(this.SelectSingleDrag(null),this._down=!0,this._sel_rect.StartSel(e));return BROWSER.IE&&(this._capture=!0,document.body.setCapture(!0)),BROWSER.FIREFOX?WCT.event.Cancel(t):void 0}},HitTest:function(t){var e=null;for(var i in Controls){var o=Controls[i],r=o.isStatusControl?o.HitTest(t.statusX,t.statusY,t):o.HitTest(t.canvasX,t.canvasY,t);r&&(!e||r.z>e.z)&&(e=r)}return e},OnMouseMove:function(t){if(BROWSER.FIREFOX&&!t.buttons&&this._down&&WCT.event.CreateAndDispatchEvent("MouseEvent","mouseup",window),this.handle_pan_(t))return!1;var e=this.normalize_evt(t);if("button"===e.targetClass)return!0;if(this._down){var i=this.scale_;if(e.downX=this._down_x,e.downY=this._down_y,e.dx=Math.round((e.screenX-e.downX)/i),e.dy=Math.round((e.screenY-e.downY)/i),e.ctl_id=this._drag_id,e.sub_id=this._drag_sub_id,e.hdl_id=this._drag_hdl_id,e.hdl_type=this._drag_hdl_type,this._sel_rect.InSel())this._sel_rect.DragSel(e),Editor.DrgSelToCtlSel(),this.prevent_direct_select_||(this.prevent_direct_select_=!0);else if(this._dragging){var o={x:e.dx,y:e.dy};this._hide_snap_matches();var r=["rb","lb","rt","lt"];if(t.ctrlKey!=SnapEnabled&&"s"!=e.hdl_id&&r.indexOf(e.hdl_id)<0){var n=this._get_snap(e.dx,e.dy);this._show_snap_matches(),o.x+=n.x,o.y+=n.y}if("s"==e.hdl_id){(a=Draggers[e.ctl_id+"#"+e.sub_id])&&!a.Locked()&&(a.Limit(e,o),a.Apply(e,o))}else{for(var s in this._drag_selection){if("pld"!=e.hdl_type||-1!=s.indexOf(e.ctl_id))(a=Draggers[s])&&!a.Locked()&&a.Limit(e,o)}for(var s in this._drag_selection)if("pld"!=e.hdl_type||-1!=s.indexOf(e.ctl_id)){var a=Draggers[s];r=["rb","lb","rt","lt"];if(e.shiftKey&&0<=r.indexOf(e.hdl_id)){o=this.keep_aspect_ratio_(o,e,a);var _=WCT.DeepCopy(o);a.Limit(e,o);var l=Math.abs(_.x)-Math.abs(o.x),d=Math.abs(_.y)-Math.abs(o.y);1<l?o.y=this.limit_dims_(o,e,a,"x"):1<d&&(o.x=this.limit_dims_(o,e,a,"y"))}if(t.ctrlKey!=SnapEnabled&&0<=r.indexOf(e.hdl_id)){this._hide_snap_matches();n=this._get_snap(o.x,o.y);this._show_snap_matches(),o.x+=n.x,o.y+=n.y,0!=n.x&&e.shiftKey?o.y=this.limit_dims_(o,e,a,"x"):0!=n.y&&e.shiftKey&&(o.x=this.limit_dims_(o,e,a,"y")),a.Limit(e,o)}if(a&&!a.Locked()&&(a.Apply(e,o),a.ApplySpecial(e,o,a)),!this.prevent_direct_select_){var h=s.split("#");h.length&&(h=h[0]);var c=h?Controls[h]:null,p=5<o.x||o.x<-5,u=5<o.y||o.y<-5;c&&c.IsGroupControl()&&(p||u)&&(this.prevent_direct_select_=!0)}}}}}else{var f=this.HitTest(e);if(f){var m=this._last_hit;if(!m||f.code!==m.code||f.hdl_type!==m.hdl_type){var g={t:"n-resize",l:"e-resize",r:"w-resize",b:"s-resize",lt:"nw-resize",lb:"ne-resize",rt:"ne-resize",rb:"nw-resize",s:"move",pos:"move",pld:"crosshair",p:"crosshair",text:"text"}[f.hdl_type]||"default";({s:1,pos:1})[f.hdl_type]&&Controls[f.ctl_id].isLocked()&&(g="default"),document.documentElement.style.cursor!=g&&(document.documentElement.style.cursor=g),this._last_hit=f}}else this._last_hit&&(this._last_hit=null,document.documentElement.style.cursor="default")}return!0},OnDragStart:function(t){return t&&(t.returnValue=!1,t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()),!1},IsDragging:function(){return this._dragging},OnMouseUp:function(t){this.pan_=null;var e=this.normalize_evt(t);if(this._capture&&(BROWSER.IE&&document.body.releaseCapture(),this._capture=!1),"button"==e.targetClass)return!0;if(this._down){if(e.downX=this._down_x,e.downY=this._down_y,this._drag_id=this._drag_id||e.ctl_id,this._sel_rect.InSel())this._sel_rect.EndSel();else{var i=Controls[this._drag_id];if(i){if(this._dragging)for(var o in ShowSnapTargets&&this._hide_snap_targets(),this._hide_snap_matches(),this._snap_match_x={},this._snap_match_y={},this._x_points_fix={},this._y_points_fix={},this._drag_selection){var r=Draggers[o];r&&!r.Locked()&&r.EndDrag(e)}this.HandleGroupChange(i)}}this._dragging&&(this._dragging=!1,Env.onEndDrag()),this._drag_id=null,this._drag_sub=null,this._drag_hdl_id=null}this._down=!1;var n=this.HitTest(e);if(n&&!e.ctrlKey){var s=Controls[n.ctl_id];!s.IsGrouped()||s.Selected()||this.prevent_direct_select_||this.SelectSingleDrag(n.ctl_id,n.sub_id),this.prevent_direct_select_=!1}return!0},OnMouseWheel:function(t){if(t.ctrlKey){WCT.event.Cancel(t);var e=this.normalize_evt(t),i=this.scale_,o="Zoom"+{up:"In",down:"Out"}[WCT.event.GetWheelDirection(t)];this[o]&&this[o]();var r=this.scale_;if(i!=r){var n=this.normalize_evt(t),s=Math.round((e.canvasX-n.canvasX)*r),a=Math.round((e.canvasY-n.canvasY)*r),_=Math.max(0,Page.scrollLeft+s),l=Math.max(0,Page.scrollTop+a);Page.ScrollToPos(_,l)}}},handle_pan_:function(t){if(this.space_down_&&this.pan_){var e=this.pan_,i=e.start_x-t.clientX,o=e.start_y-t.clientY;return Page.ScrollToPos(e.scrollLeft+i,e.scrollTop+o),!0}return!1},HandleGroupChange:function(t){if(t.IsGrouped()){var e=t.GetGroupId(),i=Controls[e],o=GetRectForControls(i.GetGroup(!0));if(!o)return;i.UpdateDom(o),i._obj.x=o.x,i._obj.y=o.y,i._obj.w=o.w,i._obj.h=o.h,Env.onPropChange(e,"x",o.x),Env.onPropChange(e,"y",o.y),Env.onPropChange(e,"w",o.w),Env.onPropChange(e,"h",o.h),this.HandleGroupChange(i)}},handle_group_z_:function(t){for(var e=[],i=t.id,o=Controls[i],r=o.GetGroup(!0,!0),n=r.length,s=0;s<n;s++){var a=r[s];e.push({z:Controls[a].GetZIndex(),id:a})}e=e.sort(sort_z);var _=GetZForControls(r,"min"),l=GetZForControls(r,"max"),d=l+1;for(n=e.length,s=0;s<n;s++){a=e[s].id;Page.UpdateControl(a,"z",d),Env.onPropChange(a,"z",d),d--}Page.UpdateControl(i,"z",d),Env.onPropChange(i,"z",d),d--;var h=[];for(var a in r=o.GetGroup(!1,!0),Controls)if("page"!=a&&a!=i&&!r[a]){var c=Controls[a];h.push({z:c.GetZIndex(),id:a})}for(n=(h=h.sort(sort_z)).length,s=0;s<n;s++)(c=h[s]).z<_||(c.z>l?(Page.UpdateControl(c.id,"z",c.z+1),Env.onPropChange(c.id,"z",c.z+1)):(Page.UpdateControl(c.id,"z",d),Env.onPropChange(c.id,"z",d--)))},normalize_evt:function(t,e){var i=WCT.event.Standardize(t);if(!i)return null;var o=this.scale_,r=0,n=0,s=0,a=0,_=i.clientX,l=i.clientY,d=Canvas.x(),h=Canvas.y(),c=Canvas.StatusX(),p=Canvas.StatusY(),u=Page.scrollLeft,f=Page.scrollTop;a=BROWSER.IE8?(r=Math.round((_+u)/o-d),n=Math.round((l+f)/o-h),s=Math.round((_+u)/o-c),Math.round((l+f)/o-p)):BROWSER.IE&&BROWSER.VERSION<8?(r=u<d?Math.round((_-d-u)/o+u):Math.round((_+(u-d))/o),n=f<h?Math.round((l-h-f)/o+f):Math.round((l+(f-h))/o),s=u<c?Math.round((_-c-u)/o+u):Math.round((_+(u-c))/o),f<h?Math.round((l-p-f)/o+f):Math.round((l+(f-p))/o)):(r=u<d?Math.round((_-d+u)/o):Math.round((_+(u-d))/o),n=f<h?Math.round((l-h+f)/o):Math.round((l+(f-h))/o),s=u<c?Math.round((_-c+u)/o):Math.round((_+(u-c))/o),f<h?Math.round((l-p+f)/o):Math.round((l+(f-p))/o)),i.canvasX=r,i.canvasY=n,i.statusX=s,i.statusY=a,i.drag_hdl_id=Editor?Editor._drag_hdl_id:null;for(var m=i.target;m&&!m.id;)m=m.parentNode;if(!m||!m.id)return i;var g=Canvas.Base().id,y=m.id,b=y.split("#");for(i.targetId=y,i.targetClass=m.className;m&&b.length<2&&m.id!=g;)(m=m.parentElement)&&(b=(y=m.id).split("#"));if(delete i.clientX,delete i.clientY,delete i._orig_,delete i.target,m){if((i.target=m).id==g)i.ctl_id=g;else if(3<=b.length){i.ctl_id=b[0],i.sub_id=b[1];var v=b[2].split(":");i.hdl_id=v[0],i.hdl_type=v[1]||""}else 2<=b.length&&(i.ctl_id=b[0],i.sub_id=b[1]);i.ctl_id==g&&(i.ctl_id="page")}return i},OnTouchStart:function(t){if(this.touch_id_=null,2==t.touches.length){var e=t.touches[0].clientX,i=t.touches[1].clientX,o=t.touches[0].clientY,r=t.touches[1].clientY;this.last_dist_=Math.sqrt((i-e)*(i-e)+(r-o)*(r-o))}if(1==t.changedTouches.length){var n=t.changedTouches[0];this.touch_id_=n.identifier,this.OnMouseDown(n)}},OnTouchEnd:function(t){if(this.touch_id_){2==t.touches.length&&(this.last_dist_=null);for(var e=null,i=0,o=null;o=t.changedTouches[i];i++)if(o.identifier==this.touch_id_){e=o;break}e&&(e.type||(e.type="touchend"),this.OnMouseUp(e),this.touch_id_=null)}},OnTouchMove:function(t){if(2==t.touches.length){var e=t.touches[0].clientX,i=t.touches[1].clientX,o=t.touches[0].clientY,r=t.touches[1].clientY,n=Math.sqrt((i-e)*(i-e)+(r-o)*(r-o));n>this.last_dist_+50?(this.ZoomIn(),this.last_dist_=n):n<this.last_dist_-50&&(this.ZoomOut(),this.last_dist_=n),hdl_onscroll()}else if(1==t.touches.length){if(!this.touch_id_)return;for(var s=null,a=0,_=null;_=t.changedTouches[a];a++)if(_.identifier==this.touch_id_){s=_;break}if(!s)return;return this.OnMouseMove(s),this.touch_moved_=!0,WCT.event.Cancel(t)}},grp_names_:{},grp_info_:{remove_ok:"Group removed (%ID%).",create_ok:"Group created (%ID%).",no_grp:"Selected control is not a group.",grp_in_grp:"Selected group is part of another group, ungroup parent group first.",no_ctl:"No Control, please select the group first.",no_sel:"Group could not be created. The selected controls are grouped already or not groupable.",one_sel:"Group could not be created. Besides one, all controls are grouped already.",create_failed:"Group could not be created."},GroupName:function(){var t=arguments[0],e=!0===arguments[1],i=this.grp_names_;if(t)i[t]=e;else for(var o=1;o<=1e3;o++){var r="Group "+o;if(!i[r])return r}},HandleGroup:function(){var t=this.GetSelection();if(t){var e="",i=null;1<t.length?"GRP"==(i=this.CreateGroup(t)).substr(0,3)&&(e=i,i="create_ok"):(e=t[0],i=this.RemoveGroup(e));var o=this.grp_info_[i];o=o.replace("%ID%",e),this.EdittimeInfo(o,!0)}},CreateGroup:function(t){for(var e=t.length,i=[],o=0;o<e;o++){var r=t[o];!(s=Controls[r])||s.IsGrouped()||s.isStatusControl||s.isRuler||i.push(r)}var n=i.length;if(n<2)return 0==n?"no_sel":"one_sel";var s,a=GetRectForControls(i),_="GRP"+WCT.uid.Generate(16).toUpperCase(),l=i.join(";"),d={id:_,name:this.GroupName(),type:"group",collection:l,x:a.x,y:a.y,w:a.w,h:a.h,z:1};return Env.ControlAdded(JSON.stringify(d)),(s=Page.AddControl(d))?(Controls[_].SetSelected(!0),this.SelectSingle(_),this.handle_group_z_(d),_):"create_failed"},RemoveGroup:function(t){var e=Controls[t];if(!t||!e)return"no_ctl";if(!e.IsGroupControl())return"no_grp";if(e.IsGrouped())return"grp_in_grp";var i=e.GetGroup(!0);Editor.GroupName(e._obj.name,!1),e.Remove(),delete Controls[t],Env.ControlDeleted&&Env.ControlDeleted(t);for(var o=i.length,r=0;r<o;r++){var n=i[r],s=Controls[n],a=s.GetOpacity();s instanceof TextBox&&(Page.UpdateControl(n,"popup_opacity",a),Env.onPropChange(n,"popup_opacity",a)),Page.UpdateControl(n,"opacity",a),Env.onPropChange(n,"opacity",a)}return this.SetSelection(i.join(",")),this.SetActive(i[0]),"remove_ok"},resetGroup:function(t,e){var i=Controls[e];i&&i.isStatusControl&&this.removeCtlFromGroup(t,e)},removeCtlFromGroup:function(t,e){var i=Controls[t];t&&i&&i.IsGroupControl()&&(i.RemoveCtlFromGroup(e),i._obj&&this.handle_group_z_(i._obj))},addCtlToGroup:function(t,e){var i=Controls[t];t&&i&&i.IsGroupControl()&&(i.addCtlToGroup(e),this.handle_group_z_(i._obj))},get_info_:function(t){return info[t]},EnableLocalKeyHandling:function(t){this._kbd.handle!=t&&((this._kbd.handle=t)?(WCT.event.Observe("keypress",hdl_keypress,document),WCT.event.Observe("keydown",hdl_keydown,document),WCT.event.Observe("keyup",hdl_keyup,document)):(WCT.event.StopObserving("keypress",hdl_keypress,document),WCT.event.StopObserving("keydown",hdl_keydown,document),WCT.event.StopObserving("keyup",hdl_keyup,document)))},OnKeyDown:function(t){if(!this._readonly)switch(t.keyCode){case 37:case 39:case 38:case 40:return this.OnArrowKeyDown(t),WCT.event.Cancel(t),!0;default:return Env.OnHotkey&&Env.OnHotkey(t),!1}},OnKeyPress:function(t){},OnKeyUp:function(t){if(!this._readonly)switch(t.keyCode){case 37:case 39:case 38:case 40:return this.OnArrowKeyUp(t),WCT.event.Cancel(t),!0;default:return Env.OnKeyUp&&Env.OnKeyUp(t),!1}},OnFocus:function(t){if(!t)return!1},OnBlur:function(t){if(this._kbd.in_drag&&this.OnArrowKeyUp({}),!t)return!1}},function(){function s(t,e){var i=this._drag_selection;for(var o in i){var r=Draggers[o];r&&!r.Locked()&&r[t].apply(r,e)}}_Editor.prototype.OnArrowKeyDown=function(t){t=this.normalize_evt(t);var e=this._kbd;e.in_drag||function r(t){s.call(this,"StartDrag",[t]);var e=t.keyCode,i=37==e||39==e?"x":"y";Env.onBeginDrag(),this._kbd.in_drag=!0,this._kbd.prop=i,this._kbd.delta={x:0,y:0},this._kbd.hdl_id=t.shiftKey?"x"==i?"r":"b":"pos"}.call(this,t);var i=function n(t){var e=1,i=SnapGridDX||2;switch(t.keyCode){case 37:e=-e;case 39:break;case 38:e=-e;case 40:i=SnapGridDY||2}return t.ctrlKey&&(e*=i),e}.call(this,t),o=e.delta;o[e.prop]+=i,t.hdl_id=e.hdl_id,s.call(this,"Limit",[t,o]),s.call(this,"Apply",[t,o])},_Editor.prototype.OnArrowKeyUp=function(t){t=this.normalize_evt(t),s.call(this,"EndDrag",[t]),Env.onEndDrag();var e=this._kbd;for(c in e.in_drag=!1,delete e.prop,delete e.delta,delete e.hdl_id,this._selection)this.HandleGroupChange(Controls[c])}}(),_RT.DBCLICK_TO=300,_RT.synth_event=function(t,e){var i=EDIT_MODE?2:0;return{canvasX:t.clientX+Page.scrollLeft-Canvas.x()-i,canvasY:t.clientY+Page.scrollTop-Canvas.y()-i,screenX:t.screenX,screenY:t.screenY,ctrlKey:t.ctrlKey,altKey:t.altKey,keyCode:t.keyCode,shiftKey:t.shiftKey,modifiers:t.modifiers,ctl_id:e.ctl_id,sub_id:e.sub_id,hdl_id:e.hdl_id,button:t.button}},_RT.throw_click_=function(t,e){var i=window.RT&&RT.mouse_act_;if(i){RT.mouse_act_=null;var o=i[e];if(!o)return;o.type="click",RT.EvalHooks("click",o);var r=Controls&&Controls[t];r&&r.OnRTMouseClick(o)}},_RT.prototype={GetScale:function(){return this.scale_},SetScale:function(t){if(this.scale_!=t){this.scale_=t;var e=$("frame");e&&(BROWSER.CHROME||BROWSER.EDGECHR?document.body.style.zoom=t:WCT.dom.CssTransformScale(e,t,0,0),HitManager.recreateExtendedHitAreas())}},HasResizeControls:function(){return 0<this.call_on_resize_.length},GetResizeControls:function(){return this.call_on_resize_},RegisterResizeControl:function(t){-1==this.call_on_resize_.indexOf(t)&&this.call_on_resize_.push(t)},UnregisterResizeControl:function(t){var e=this.call_on_resize_.indexOf(t);0<=e&&this.call_on_resize_.splice(e,1)},_check_enter_leave:function(t,e){var i=this._last_hit;if(e){var o=Controls[e.ctl_id];if(i){if(i.ctl_id!=e.ctl_id||i.sub_id!=e.sub_id||i.hdl_id!=e.hdl_id)(r=Controls[i.ctl_id])&&r.OnRTMouseLeave(_RT.synth_event(t,i),i.ctl_id==e.ctl_id),this.change_control_cursor_(i,""),o&&o.OnRTMouseEnter(t,i.ctl_id==e.ctl_id)}else o&&o.OnRTMouseEnter(_RT.synth_event(t,e));null!=e.cursor&&e.cursor!=this.cur_cursor&&(document.documentElement.style.cursor=e.cursor,this.cur_cursor=e.cursor),this.change_control_cursor_(e,e.cursor)}else{var r;if(i)(r=Controls[i.ctl_id])&&(""!=this.cur_cursor&&(document.documentElement.style.cursor="",this.change_control_cursor_(i,""),this.cur_cursor=""),r.OnRTMouseLeave(_RT.synth_event(t,i)))}this._last_hit=e},change_control_cursor_:function(t,e){var i=Controls[t.ctl_id];if(i){var o=void 0!==e?e:t.cursor,r=""!=t.sub_id?"#"+t.sub_id:"";r+=""!=t.hdl_id?"#"+t.hdl_id:"";var n=i._get_el(r);n&&n.style.cursor!=o&&(n.style.cursor=o)}},normalize_evt:function(t,e){var i=WCT.event.Standardize(t);if(!document||!i)return null;var o=i.clientX,r=i.clientY;if("click"==t.type&&(o<0||r<0))o=this.last_evt_clientX_,r=this.last_evt_clientY_;else if("mousewheel"==t.type||"DOMMouseScroll"==t.type){var n=WCT.event.GetWheelDirection(t);i.type="wheel_"+n}var s=Page.GetScale();i.canvasX=parseInt(o/s+Page.scrollLeft-Canvas.x()),i.canvasY=parseInt(r/s+Page.scrollTop-Canvas.y()),delete i.clientX,delete i.clientY;var a=i.target;if(a&&(i.target=a.id||null),i.hasToBeCancelled=!1,e&&BROWSER.IE&&("select"==i.targetName||"option"==i.targetName)&&(e=!1),t.type&&"key"==t.type.substr(0,3)||delete i._orig_,delete i.targetName,delete i.targetType,!e){var _=a.id.split("#");return i.hdl_id=_.pop(),i.sub_id=_.pop(),i.ctl_id=_[0],i}if(this._drag_hit){var l=this._last_hit_result;return i.ctl_id=l.ctl_id,i.sub_id=l.sub_id,i.hdl_id=l.hdl_id,i}var d=this.RTHitTest(i.canvasX,i.canvasY);return d?(i.ctl_id=d.ctl_id,i.sub_id=d.sub_id,i.hdl_id=d.hdl_id,i.cursor=d.cursor||""):(i.ctl_id="page",i.sub_id=null,i.hdl_id=null,i.cursor=""),this._check_enter_leave(i,d),i},AddHook:function(t,e,i){var o={fn:e,ctl:i};this._hooks[t]?this._hooks[t].push(o):this._hooks[t]=[o]},RemoveHook:function(t,e,i){var o=this._hooks&&this._hooks[t]||[];if(o.length){for(var r=[],n=0,s=o.length;n<s;n++)o[n].fn!=e&&o[n].ctl!=i&&r.push(o[n]);r.length?this._hooks[t]=r:delete this._hooks[t]}},EvalHooks:function(t,e){for(var i=this._hooks[t]||[],o=i.length-1;0<=o;o--){var r=i[o];if(r.ctl){var n=Controls[r.ctl];r.fn.call(n,e)}else r.fn(e)}},Cleanup:function(){this._hooks={},document.documentElement.style.cursor="",BROWSER.IE&&this._drag_hit&&document.body.releaseCapture(),this._drag_hit=null,this.touch_down_=null,this.last_dist_=null,this.pinch_handled_=!1,this.touch_id_=null,this.mouse_act_&&(this.mouse_act_.to&&WCT.ClearTimeout(this.mouse_act_.to),this.mouse_act_=null)},setCapture:function(t){this._drag_hit=t,BROWSER.IE&&document.body.setCapture(!1)},releaseCapture:function(){this._drag_hit=null,BROWSER.IE&&document.body.releaseCapture()},checkTrainerKeys:function(t){return!EDIT_MODE&&(13===t&&RT.keysInUse.enter||32===t&&RT.keysInUse.space)},RTHitTest:function(t,e){var i=HitManager.getHitObjectAt(t,e,arguments[2]);return this._last_hit_result=i},OnTouchStart:function(t){if(this.touch_id_=null,this.touch_start_=null,this.touch_moved_=!1,2==t.touches.length&&Page.GetConfig("allow_mobile_pinch_zoom")){var e=t.touches[0].clientX,i=t.touches[1].clientX,o=t.touches[0].clientY,r=t.touches[1].clientY;this.last_dist_=Math.sqrt((i-e)*(i-e)+(r-o)*(r-o)),this.pinch_handled_=!1}else if(1<t.touches.length){if(this.touch_down_)(s=Controls[this.touch_down_.ctl_id])&&(s.OnRTMouseUp(this.touch_down_),s.OnRTMouseLeave(this.touch_down_),this.touch_down_=null);return}if(this.touch_down_=null,1==t.changedTouches.length){var n=t.changedTouches[0];this.touch_id_=n.identifier,this.touch_start_={x:n.clientX,y:n.clientY};var s,a=this.normalize_evt(n,!0);if(a)this.EvalHooks("mousedown",a),(s=Controls[a.ctl_id])&&(s.OnRTMouseEnter(a),s.OnRTMouseDown(a),this.touch_down_=a)}},OnTouchEnd:function(t){if(this.last_dist_=null,this.pinch_handled_=!1,null!=this.touch_id_){for(var e=null,i=0,o=null;o=t.changedTouches[i];i++)if(o.identifier==this.touch_id_){e=o;break}if(e){var r,n=this.dragging_,s=this.normalize_evt(e,!0);if(s)this.EvalHooks("mouseup",s),(r=Controls[s.ctl_id])&&(r.OnRTMouseUp(s),this.touch_moved_||(this.EvalHooks("click",s),r.OnRTMouseClick(s)));if(this.touch_down_)(r=Controls[this.touch_down_.ctl_id])&&r.OnRTMouseLeave(this.touch_down_),this.touch_down_=null;if(this.touch_moved_&&!n&&"fit"==Page.GetConfig("mobile_view_mode")){var a=e.clientX-this.touch_start_.x,_=e.clientY-this.touch_start_.y,l=Math.abs(a);l>=Math.abs(_)&&250<=l&&a&&Page.RTFireTrigger("page."+(0<a?"prev":"next"))}this.touch_id_=null}}},OnTouchMove:function(t){if(2==t.touches.length&&!this.pinch_handled_&&Page.GetConfig("allow_mobile_pinch_zoom")){var e=t.touches[0].clientX,i=t.touches[1].clientX,o=t.touches[0].clientY,r=t.touches[1].clientY,n=Math.sqrt((i-e)*(i-e)+(r-o)*(r-o)),s=this.last_dist_,a=s+50<n,_=n<s-50;if(_||a){var l=Canvas.GetClientWH(),d=["100","fit"];(Canvas.w()>l.w||Canvas.h()>l.h)&&d.reverse();var h=a?d[1]:_?d[0]:null;h&&(Canvas.SetMobileViewMode(h),this.pinch_handled_=!0)}return WCT.event.Cancel(t)}if(null!=this.touch_id_){for(var c=null,p=0,u=null;u=t.changedTouches[p];p++)if(u.identifier==this.touch_id_){c=u;break}if(c){this.touch_moved_=!0;var f=this.normalize_evt(c,!0);if(PLATFORM.IOS&&"fit"==Page.GetConfig("mobile_view_mode")&&(f.hasToBeCancelled=!0),f){var m=Controls[f.ctl_id];this.EvalHooks("mousemove",f),m&&m.OnRTMouseMove(f)}return!f.hasToBeCancelled||WCT.event.Cancel(t)}}},OnMSPointerDown:function(t){this.touch_start_=null,this.touch_moved_=!1,this.touch_down_=null,this.touch_over_=null;var e=this.normalize_evt(t,!0);if(e){this.handle_mouse_actions_(e),this.EvalHooks("mousedown",e);var i=Controls[e.ctl_id];return this.touch_start_={x:t.clientX,y:t.clientY},i&&i.OnRTMouseDown(e),!(this.touch_down_=e).hasToBeCancelled||WCT.event.Cancel(t)}},OnMSPointerMove:function(t){this.touch_moved_=!0;var e=this.normalize_evt(t,!0);if(e){this.handle_mouse_actions_(e);var i=Controls[e.ctl_id];return i&&i.OnRTMouseMove(e),!e.hasToBeCancelled||WCT.event.Cancel(t)}},OnMSPointerUp:function(t){if(this.touch_down_){var e,i=this.normalize_evt(t,!0);if(i)this.handle_mouse_actions_(i),this.EvalHooks("mouseup",i),(e=Controls[i.ctl_id])&&e.OnRTMouseUp(i);if(this._last_hit)(e=Controls[this._last_hit.ctl_id])&&e.OnRTMouseLeave(this._last_hit);var o=this.dragging_;if(this.touch_moved_&&!o){var r=t.clientX-this.touch_start_.x,n=t.clientY-this.touch_start_.y,s=Math.abs(r);s>=Math.abs(n)&&250<=s&&r&&Page.RTFireTrigger(0<"page."+r?"prev":"next")}return this.touch_down_=null,this.touch_moved_=null,!i.hasToBeCancelled||WCT.event.Cancel(t)}},OnMouseDown:function(t){var e=this.normalize_evt(t,!0);if(e)return Env.onDeviceInput("mouse"),this.last_evt_clientX_=t.clientX,this.last_evt_clientY_=t.clientY,this.handle_mouse_actions_(e),!e.hasToBeCancelled||WCT.event.Cancel(t)},OnMouseMove:function(t){var e=this.normalize_evt(t,!0);if(e){if("mouseover"!=e.type&&"mouseout"!=e.type)this.handle_mouse_actions_(e);else{this.EvalHooks("move",e);var i=Controls[e.ctl_id];i&&i.OnRTMouseMove(e)}return!e.hasToBeCancelled||WCT.event.Cancel(t)}},OnMouseUp:function(t){var e=this.normalize_evt(t,!0);if(e)return this.last_evt_clientX_=t.clientX,this.last_evt_clientY_=t.clientY,this.handle_mouse_actions_(e),!e.hasToBeCancelled||WCT.event.Cancel(t)},OnMouseClick:function(t){var e=this.normalize_evt(t,!0);if(e)return e.type="click",this.handle_mouse_actions_(e),!e.hasToBeCancelled||WCT.event.Cancel(t)},OnMouseDblClick:function(t){var e=this.normalize_evt(t,!0);if(e)return e.type="dblclick",this.handle_mouse_actions_(e),!e.hasToBeCancelled||WCT.event.Cancel(t)},OnMouseWheel:function(t){(t.ctrlKey||t.shiftKey)&&WCT.event.Cancel(t);var e=this.normalize_evt(t,!0);if(e)return this.handle_mouse_actions_(e),!e.hasToBeCancelled||WCT.event.Cancel(t)},OnChange:function(t){var e=this.normalize_evt(t);if(e){this.EvalHooks("change",e);var i=e.sub_id?Controls[e.ctl_id]:null,o=!i||i.OnRTChange(e);return e.hasToBeCancelled?WCT.event.Cancel(t):o}},OnKeyDown:function(t){var e=this.normalize_evt(t);if(e){Env.onDeviceInput("key"),this.EvalHooks("keydown",e),Env.OnHotkey(e);var i=e.sub_id?Controls[e.ctl_id]:null,o=this.checkTrainerKeys(e.button),r=!(i&&!o)||i.OnRTKeyDown(e),n=WCT.event.Standardize(t),s=WCT.event.hotkey.IsBackKey(n);return e.hasToBeCancelled||s?WCT.event.Cancel(t):r}},OnKeyPress:function(t){var e=this.normalize_evt(t);if(e){this.EvalHooks("keypress",e);var i=e.sub_id?Controls[e.ctl_id]:null,o=this.checkTrainerKeys(e.button),r=!(i&&!o)||i.OnRTKeyPress(e);return e.hasToBeCancelled?WCT.event.Cancel(t):r}},OnKeyUp:function(t){var e=this.normalize_evt(t),i=EDIT_MODE&&Editor.Preview();if(e&&(!i||13!==e.button&&32!==e.button)){this.EvalHooks("keyup",e),Env.OnHotkey(e);var o=e.sub_id?Controls[e.ctl_id]:"canvas"===e.ctl_id?Controls.page:null,r=this.checkTrainerKeys(e.button),n=!(o&&!r)||o.OnRTKeyUp(e),s=WCT.event.Standardize(t),a=WCT.event.hotkey.IsBackKey(s);return e.hasToBeCancelled||a?WCT.event.Cancel(e):n}},OnFocus:function(t){var e=this.normalize_evt(t);if(e){this.EvalHooks("focus",e);var i=e.sub_id?Controls[e.ctl_id]:null,o=!i||i.OnRTFocus(e);return e.hasToBeCancelled?WCT.event.Cancel(t):o}},OnBlur:function(t){var e=this.normalize_evt(t);if(e){this.EvalHooks("blur",e);var i=e.sub_id?Controls[e.ctl_id]:null,o=!i||i.OnRTBlur(e);return e.hasToBeCancelled?WCT.event.Cancel(t):o}},SetDrag:function(t){this.dragging_=t},mouse_on_scrollbar_:function(t){var e=WCT.dom,i=Canvas.Frame(),o=e.HasHorizontalScrollbar(i),r=e.HasVerticalScrollbar(i),n=e.GetWindowHeight(),s=e.GetWindowWidth(),a=e.GetScrollbarWidth(),_=e.GetScrollbarHeight(),l=t.canvasX-Page.scrollLeft,d=t.canvasY-Page.scrollTop;return o&&s-a<l||r&&n-_<d},handle_mouse_actions_:function(t){var e=t.type;if(BROWSER.FIREFOX&&"mouseup"==e&&this.mouse_on_scrollbar_(t))t.hasToBeCancelled=!0;else{2!=t.button&&3!=t.button||(t.hasToBeCancelled=!0);var i=this.mouse_act_||[],o=i.chain||"";this.mouse_act_=i,"mousemove"==e&&0<=o.search(/mousemove$/)?i.pop():i.chain=o+"-"+e,i.push(t);var r=this.decide_mouse_action_(t);if(r)i.to&&WCT.ClearTimeout(i.to),this.mouse_act_=null,"drop"==r?(this.EvalHooks("drop",t),e="mouseup"):"drag"!=r&&(e=r);else if("click"==e)return;this.EvalHooks(e,t);var n=Controls[t.ctl_id],s=null;switch(e){case"click":s="OnRTMouseClick";break;case"dblclick":s="OnRTMouseDblClick";break;case"mousedown":s="OnRTMouseDown";break;case"mouseup":s="OnRTMouseUp";break;case"mousemove":s="OnRTMouseMove";break;case"mousewheel":s="OnRTMouseWheel"}n&&n[s]&&n[s](t)}},decide_mouse_action_:function(t){var e=this.mouse_act_,i=_Mouse.IsDrag(e),o=_Mouse.IsDrop(e),r=_Mouse.IsClick(e),n=_Mouse.IsDblClick(e);if(n<0){var s=e.chain.substr(0,-n).split("-").length-1,a=e.chain.substr(-n);e.splice(0,s),e.chain=a}else{if(1==n)return t.type="dblclick";if(r<0)e.to&&WCT.ClearTimeout(e.to),this.mouse_act_=null;else if(1==r)if(PLATFORM.WINCE)_RT.throw_click_(t.ctl_id,e.length-1);else{if(e.to)return t.type="dblclick";e.to=WCT.SetTimeout(_RT.throw_click_,_RT.DBCLICK_TO,_RT,[t.ctl_id,e.length-1])}else{if(1==i)return"drag";if(1==o)return"drop"}}return null}};var Status=function(){function o(t,e){return t.z-e.z}var s=[];return{Cleanup:function(){s=[]},GetIdxByEleId:function(t){return s.indexOfAtt(t,"id")},UpdateZByEleId:function(t,e){var i=this.GetIdxByEleId(t);s[i].z=e,s.sort(o)},AddCtl:function(t){-1===this.GetIdxByEleId(t.id)&&(s.push(t),s.sort(o))},RemoveCtl:function(t){var e=this.GetIdxByEleId(t);-1<e&&(s.splice(e,1),this.UpdateCtlsPos())},GetCtlCount:function(){return s.length},CalcCtlPos:function(t){var e=Canvas.GetStaCtlsInLine();return e?{x:t%e*StatusControl.W,y:Math.floor(t/e)*StatusControl.H}:{x:0,y:0}},UpdateCtlsPos:function(){for(var t=0,e=s.length;t<e;t++){var i=$(s[t].id);if(i){var o=this.CalcCtlPos(t);i.style.left=o.x+"px",i.style.top=o.y+"px"}}var r=Canvas.GetStaCtlsInLine(),n=r?Math.ceil(t/r)*StatusControl.H:0;Canvas.SetStatusHeight(n)}}}(),HotkeyMaster=function(){var p={},o=0,r=null,_=null;function i(){if(o||_){r=r||{all_:Env.ObserveHotkey("ALL",BROWSER.IE&&10<=BROWSER.VERSION?"up":"down",a)};var t={all_:!0};for(var e in p)for(var i in p[e])r[i]||(r[i]={down:Env.ObserveHotkey(i,"down",s),up:Env.ObserveHotkey(i,"up",BROWSER.IE8||BROWSER.IE&&10<=BROWSER.VERSION?s:n)}),t[i]=!0;for(var i in r)t[i]||(Env.StopObservingHotkey(i,r[i].down),Env.StopObservingHotkey(i,r[i].up),delete r[i])}else if(r){for(var i in r.all_&&(Env.StopObservingHotkey("ALL",r.all_),delete r.all_),r)Env.StopObservingHotkey(i,r[i].down),Env.StopObservingHotkey(i,r[i].up),delete r[i];r=null}}function n(t,e,i){i.hasToBeCancelled=!0}function s(t,e,i){var o=0<=t.indexOf("shift_"),r=0<=t.indexOf("ctrl_"),n=0<=t.indexOf("alt_"),s=t.replace(/shift_|alt_|ctrl_/g,"");for(var a in p)for(var _ in p[a]){var l=0<=_.indexOf("shift_"),d=0<=_.indexOf("ctrl_"),h=0<=_.indexOf("alt_");if(_=_.replace(/shift_|alt_|ctrl_/g,""),o==l&&n==h&&r==d&&s==_){var c=Controls[a];c&&c.OnHotkey&&c.OnHotkey(t,e,i)}}i.hasToBeCancelled=!0}function a(t,e){if(_){var i=WCT.event.hotkey,o=i.GetKey(e);if(o&&"alt"!=o&&"ctrl"!=o&&"shift"!=o){var r=[];for(var n in p)for(var s in p[n]){if(i.IsKey(e,s))return;r.push(s)}for(var n in r=r.join(", "),_){var a=_[n];a.f.call(a.s,o,r,t,e)}}}}return{Cleanup:function(){_=null,p={},o=0,i()},Register:function(t,e){if(p[t]){if(p[t][e])return}else p[t]={};p[t][e]=!0,o++,i()},Unregister:function(t){if(p[t]){if(null==(e=arguments[1]||null)){for(var e in p[t])o--;delete p[t]}else p[t][e]&&(o--,delete p[t][e]);i()}},RegisterWrong:function(t,e){(_=_||{})[t]={f:e,s:arguments[2]},i()},UnregisterWrong:function(){var t=arguments[0];if(t&&_){delete _[t];var e=0;for(t in _){e++;break}e||(_=null)}else _=null;i()}}}(),EventMaster=function(){var h={},e=0,t=!1,a={};function i(){!t&&e?(t=!0,RT.AddHook("click",o),RT.AddHook("dblclick",o),RT.AddHook("drop",o),RT.AddHook("wheel_down",o),RT.AddHook("wheel_up",o),HotkeyMaster.RegisterWrong("EVENT_MASTER",r)):t&&!e&&(t=!1,RT.RemoveHook("click",o),RT.RemoveHook("dblclick",o),RT.RemoveHook("drop",o),RT.RemoveHook("wheel_down",o),RT.RemoveHook("wheel_up",o),HotkeyMaster.UnregisterWrong("EVENT_MASTER"))}function l(t,e,i){var o=Controls[t.ctl_id];if(!o||!o._obj)return!e&&t.ctl_id&&(!BROWSER.SAFARI&&"canvas"!=t.ctl_id||BROWSER.SAFARI&&"slidemaster"!=t.ctl_id);var r=t.target&&t.target.split("#")[0];if(a[r])return delete a[r],!0;var n=o._obj;if(e&&"inputtext"==n.type){if(n.disabled)return!1;var s=i.replace(/shift_|alt_|ctrl_/g,"");if(WCT.event.hotkey.NONE_INPUT_KEYS[s])return!1}if("dragdrop"==n.type){if(!n.right&&3==t.button)return!1;if(n.right&&1==t.button)return!1}return n.ignore_sim_action||!1===n.trigger_error_on_use}function o(t){if(!l(t,!1)){var e=[];for(var i in h)e.push(i);var o=!1;if(BROWSER.MOBILE||0!=t.type.search("wheel_")||(o=function d(t){var e=!1;for(var i in h){var o=Controls[i];if(o.IsActive()){var r=Controls[o.GetTargetId()];if(r){var n=r.GetWheelAction?r.GetWheelAction():null;if(n){var s=n.action==t.type,a=n.ctrl_key&&t.ctrlKey||!n.ctrl_key&&!t.ctrlKey,_=n.alt_key&&t.altKey||!n.alt_key&&!t.altKey,l=n.shift_key&&t.shiftKey||!n.shift_key&&!t.shiftKey;if(e=s&&a&&_&&l)return!0}}}}return e}(t))||Canvas.HandleWheelError()){var r=o?".correct_answer":".wrong_answer";e=e.join(r+";")+r,Page.RTFireTrigger(e)}}}function r(t,e,i,o){if(!l(o,!0,t)&&(e||"tab"!==t)){var r=t.toUpperCase().replace(/_/g," "),n=e.toUpperCase().replace(/_/g," "),s=Dict_get("EXER_FAILKEY1").replace(/@1_key_/,'"'+r+'"');n?s+=" "+Dict_get("EXER_FAILKEY2").replace(/@1_keys_/,' "'+n+'"'):s=Dict_get("EXER_FAIL1")+" "+s;var a=[];for(var _ in h)a.push(_);a=a.join(".wrong_answer;")+".wrong_answer",Page.RTFireTrigger(a,s)}}return{Cleanup:function(){h={},e=0,i(),a={}},Register:function(t){h[t]||(h[t]=!0,e++,i())},Unregister:function(t){h[t]&&(delete h[t],e--,i())},IgnoreNextForTarget:function(t){a[t]=1}}}();function SlideControl(){this._hdx=null,this._obj=null,this._id=null,this._init=!1,this._handles_visible=!1,this._have_handles=!1,this._selected=!1,this._waitForTransition=!1,this._cursor=null,this._fader=null,this._direction="",this._shadow=null,this.group_id_="",this._ictl=null,this._tctl=null,this._cctl=null,this._orig_obj=null,this._readonly=!1}function RectControl(){SlideControl.call(this),this._link_to=null}function StatusControl(){SlideControl.call(this),this._hdx={z:{to_dom:StatusControl.SetZ,clamp:clamp_z}},this.isStatusControl=!0,this.icon_x_=0,this.icon_y_=0,this.icon_id_=0}WCT.ExtendObject(SlideControl,{set_cursor:function(t){this._cursor=t},ExtendHdx:function(t){var e={name:{to_dom:noop},visual_over:{to_dom:noop},visual_down:{to_dom:noop},openInNewWindow:{to_dom:noop},nWF_top:{to_dom:noop},nWF_left:{to_dom:noop},nWF_width:{to_dom:noop},nWF_height:{to_dom:noop},nWF_fullscreen:{to_dom:noop},nWF_location:{to_dom:noop},nWF_menubar:{to_dom:noop},nWF_scrollbars:{to_dom:noop},nWF_resizable:{to_dom:noop},nWF_status:{to_dom:noop},nWF_toolbar:{to_dom:noop},onclick:{to_dom:noop},onenter:{to_dom:noop},onleave:{to_dom:noop},onshow:{to_dom:noop},onvisible:{to_dom:noop},onhide:{to_dom:noop},onhidden:{to_dom:noop},doc_enable:{to_dom:noop},autosize:{to_dom:noop,clamp:clamp_boolean},forceDownload:{to_dom:noop}};for(var i in e)"undefined"==typeof t[i]&&(t[i]=e[i])},CleanupObjects:function(){this._ictl&&(this._ictl.Destructor(),this._ictl=null),this._tctl&&(this._tctl.Destructor(),this._tctl=null),this._cctl&&(this._cctl.Destructor(),this._cctl=null)}}),WCT.ExtendObject(SlideControl.prototype,{get_doc_enable_:function(){if(this.IsGrouped()){var t=Controls[this.GetGroupId()];return!!t&&t.get_doc_enable_.call(t)}return this._obj.doc_enable},Terminate:function(){if(SlideControl.CleanupObjects.call(this),this._hdx){for(var t in this._hdx)this._hdx[t].to_dom=null,this._hdx[t].clamp=null,delete this._hdx[t];this._hdx=null}for(var e in this._obj=null,this._orig_obj=null,EDIT_MODE&&Editor.Select(this._id,!1),Ticker.Unregister(this._id),this._draggers)this._draggers[e].Destroy(),delete this._draggers[e];delete this._draggers,this._fader&&(this._fader.Terminate(),this._fader=null),this._remove_dom()},GetZIndex:function(){return this._obj.z},IsGroupControl:function(){return"group"==this._obj.type},GetGroupId:function(){return this.group_id_},IsGrouped:function(){return""!=this.group_id_},isHidden:function(){if(this._obj.hidden)return!0;if(arguments[0]||!this.IsGrouped())return!1;var t=this.GetGroupId();return Controls[t].isHidden()},isLocked:function(){if(this._obj.locked)return!0;if(this.IsGrouped()){var t=this.GetGroupId();return Controls[t]&&Controls[t].isLocked()}return!1},SetGrouped:function(t){this.group_id_=t||""},IsRTL:function(){return"rtl"==this._direction},SetDirection:function(t){var e=WCT.IsLanguageRTL(t)?"rtl":"ltr";this._direction=e;var i=this._get_el("#main#text")||this._get_el("#main#txt")||this._get_el();i&&(i.style.direction=e,i.setAttribute("dir",e))},Init:function(t){if(!t.id)return!1;if(this._init=!0,this._obj=t,this._id=t.id,this._create_dom&&this._create_dom(),this._disable_dom_update=!0,"page"==t.type)this.SetParam("skin",t.skin);else{var e=Page.GetVariable("content_language");e&&this.SetDirection(e)}this.SetParams(t,["skin"],!1),this._init=!1,this._update_dom&&this._update_dom(),EDIT_MODE&&(this._draggers={},this.InitEdit())},Refresh:function(){for(var t in EDIT_MODE&&Editor.Select(this._id,!1),this._draggers)this._draggers[t].Destroy(),delete this._draggers[t];delete this._draggers,this._remove_dom();var e=this._fader;e&&e.Refresh(),this.Init(this._obj)},ToDom:function(){var t=this._obj,e=!1;for(var i in t){var o=this._hdx&&this._hdx[i]||null;o&&(o.to_dom?o.to_dom.call(this,t,i,t[i]):e=!0)}e&&this._update_dom&&!this._disable_dom_update&&this._update_dom()},Id:function(){return this._id},GetBoundaryRect:function(){return null},GetType:function(){return this._obj.type},GetName:function(){return this._obj.name},GetOpacity:function(){var t=this._obj.opacity;return void 0!==t?t:100},StateToDom:function(){var t=this._draggers;for(var e in t)t[e].StateToDom()},SetSelected:function(t){this._selected!=t&&(this._selected=t,this.StateToDom())},CollectTargets:function(t){var e=this._obj;e.target&&(t[e.target]=1),e.client0&&(t[e.client0]=1),e.client1&&(t[e.client1]=1),e.client2&&(t[e.client2]=1),e.client3&&(t[e.client3]=1),e.client4&&(t[e.client4]=1),e.client5&&(t[e.client5]=1),e.client6&&(t[e.client6]=1),e.client7&&(t[e.client7]=1),e.client8&&(t[e.client8]=1),e.client9&&(t[e.client9]=1),e.ok_bubble&&(t[e.ok_bubble]=1),e.error_bubble&&(t[e.error_bubble]=1),e.help_bubble&&(t[e.help_bubble]=1),e.fail_bubble&&(t[e.fail_bubble]=1),e.feedback_bubble&&(t[e.feedback_bubble]=1),collect_targets(e.lesson_continue,t),collect_targets(e.onclick,t),collect_targets(e.onload,t),collect_targets(e.onenter,t),collect_targets(e.onleave,t),collect_targets(e.onshow,t),collect_targets(e.onhide,t),collect_targets(e.onvisible,t),collect_targets(e.onhidden,t),collect_targets(e.oncorrectanswer,t),collect_targets(e.onwronganswer,t),collect_targets(e.onchange,t),collect_targets(e.oncheck,t),collect_targets(e.onuncheck,t),collect_targets(e.onstop,t),collect_targets(e.onfinish,t),collect_targets(e.onpagesoundfinish,t)},ShowRelated:function(t,e){var i={};this.CollectTargets(i);var o=t?"target":e in i?"source":null;this._related!=o&&(this._related=o,this.StateToDom())},Selected:function(){return this._selected},Locked:function(){return this.isLocked()},Hidden:function(){return!(!this._obj||!this._obj.hidden)},SetActive:function(t){this._active!=t&&(this._active=t,this.StateToDom())},Active:function(){return this._active},HitTest:function(t,e){var i=this._draggers,o=null;for(var r in i){var n=i[r].HitTest(t,e);n&&(!o||n.z>o.z)&&(o=n)}if(o){var s=Controls[o.ctl_id];if(s.IsGrouped()){var a=arguments[2],_=Controls[s.GetGroupId()],l=_.Selected(),d=s.Selected();(!l&&!d||l&&a&&"mouseup"!=a.type&&"touchend"!=a.type)&&(o=_.HitTest(t,e))}}return o},_get_el:function(t){var e=t||"#main#dom";return $(this._id+e)},HandleObj:function(t){t?this._orig_obj=WCT.DeepCopy(this._obj):this._orig_obj&&(this._obj=WCT.DeepCopy(this._orig_obj))},SetPreview:function(t){if(EDIT_MODE){if(this._preview!=t&&(this._preview=t,this.StateToDom()),!t){var e=this._obj;this._init=!0,this.SetParams(e,[],!1),this._init=!1,this._update_dom&&this._update_dom()}}else this._preview=t;var i=this._popupFader||this._fader;i&&i[t?"InitPreview":"ExitPreview"](),this._update_hit_areas&&this._update_hit_areas(),this._on_set_preview&&this._on_set_preview(t)},UpdateHitAreas:function(){this._update_hit_areas&&this._update_hit_areas()},Preview:function(){return this._preview},SetLocked:function(t){this._obj.locked=t},SetParam:function(t,e){var i=this._obj||{},o=this._hdx&&this._hdx[t]||null;if(o&&o.clamp&&Canvas.AllowClamping()&&"subtitle"!==i.type){var r={val:e,res:e,name:t};o.clamp.call(this,i,r),r.res!==r.val&&(e=r.res,EDIT_MODE&&Editor&&!Editor.Preview()&&Env.onPropChange(i.id,t,e))}return i[t]=e,o&&o.to_dom?o.to_dom.call(this,i,t,e):!this._disable_dom_update&&this._update_dom&&this._update_dom(),i[t]},handle_clipping_:function(t,e,i,o){var r={};return"arrow"==t.type?("undefined"!=typeof t.x0&&"undefined"!=typeof t.x1&&(r.x0=1,r.x1=1,t.x0<t.x1?(o.x0=i.x?e.x0:this.SetParam("x0",t.x0),o.x1=i.x?e.x1:this.SetParam("x1",t.x1)):(o.x1=i.x?e.x1:this.SetParam("x1",t.x1),o.x0=i.x?e.x0:this.SetParam("x0",t.x0))),"undefined"!=typeof t.y0&&"undefined"!=typeof t.y1&&(r.y0=1,r.y1=1,t.y0<t.y1?(o.y0=i.y?e.y0:this.SetParam("y0",t.y0),o.y1=i.y?e.y1:this.SetParam("y1",t.y1)):(o.y1=i.y?e.y1:this.SetParam("y1",t.y1),o.y0=i.y?e.y0:this.SetParam("y0",t.y0)))):"connector"==t.type?(r.points=1,o.points=i.points?e.points:this.SetParam("points",t.points)):("undefined"!=typeof t.x&&(r.x=1,o.x=i.x?e.x:this.SetParam("x",t.x)),"undefined"!=typeof t.y&&(r.y=1,o.y=i.y?e.y:this.SetParam("y",t.y))),r},SetParams:function(t){for(var e=arguments[1]||[],i={},o=0,r=null;r=e[o++];)i[r]=1;var n={},s=this._obj;this._disable_dom_update=!0;var a=this.handle_clipping_(t,s,i,n);for(var _ in t)a[_]||(n[_]=i[_]?s[_]:this.SetParam(_,t[_]));return(this._disable_dom_update=!1)!==arguments[2]&&this._update_dom&&this._update_dom(),n},GetParams:function(){return this._obj},GetHtmlPosSize:function(t){var e=this._get_el();return e?getHtmlPosSize(e):{x:0,y:0,w:0,h:0}},OnDefaultEdit:function(){return!1},UpdateText:function(){var t=this._obj,e=this._hdx&&this._hdx.text||null;e&&e.to_dom&&t.text&&e.to_dom.call(this,t,"text",t.text)},CalcShadow:function(){var t=(arguments[0]||"shadow")+"_",e="_"+(arguments[0]||"shadow"),i=this._obj,o="";if(i[t+"show"]){var r=i[t+"h"]||0,n=i[t+"v"]||0,s=i[t+"blur"]||0,a=i[t+"spread"]||0,_="number"==typeof i[t+"trans"]?i[t+"trans"]:100;o=r+"px "+n+"px "+s+"px "+a+"px "+WCT.HexToRgb(i[t+"color"]||"#888888",_/100)}return o!=this[e]&&(this[e]=o,!0)},_remove_dom:function(){SlideControl.CleanupObjects.call(this);var t=this._get_el();t&&t.parentNode.removeChild(t),this._shadow="",HitManager.clearHitControl(this._id)},OnRTKeyUp:function(t){13!==t.button&&32!==t.button||(this.OnRTMouseClick(t),WCT.event.Cancel(t._orig_))},MoveHome:function(){},MoveTo:function(){},Zoom:function(){},InitEdit:function(){},ShowAfterTransition:function(){},PrepareTransition:function(){},OnMouseEnter:function(t){},OnMouseLeave:function(t){},OnMouseClick:function(t){},OnMouseDblClick:function(t){},OnRTMouseEnter:function(t){},OnRTMouseLeave:function(t){},OnRTMouseDown:function(t){},OnRTMouseUp:function(t){},OnRTMouseClick:function(t){},OnRTMouseDblClick:function(t){},OnRTMouseMove:function(t){},OnViewResize:function(t){},OnRTChange:function(t){},OnRTKeyDown:function(t){},OnRTKeyPress:function(t){},OnRTFocus:function(t){},OnRTBlur:function(t){},OnEnvEvent:function(t){},RTFireTrigger:function(t,e){},GetSnapPoints:function(t,e,i,o){}}),RectControl.prototype=new SlideControl,RectControl.SetLink=function(t,e,i){this._link_to=i},WCT.ExtendObject(RectControl.prototype,{InitEdit:function(){var t=arguments[0]||null,e=t?new ConstRectDragger(this,this._id,"main"):new RectDragger(this,this._id,"main"),i=t||!0;(this._draggers.main=e).LimitWH(arguments[1]||!1,arguments[2]||!1),e.Init({x:"x",y:"y",w:"w",h:"h",r:"r",z:"z"},i),e.UpdatePos()},GetBoundaryRect:function(){var t=this._obj;return{x:t.x,y:t.y,w:t.w,h:t.h,z:t.z}},GetHtmlPosSize:function(t){var e=this._obj,i={x:e.x+Canvas.x(),y:e.y+Canvas.y(),w:e.w,h:e.h};return Canvas.ApplyScaleToPos(i),i.x-=Page.scrollLeft,i.y-=Page.scrollTop,i},MoveHome:function(){var t=this._get_el(arguments[0]),e=this._obj;t&&e&&(t.style.left=e.x+"px",t.style.top=e.y+"px")},MoveTo:function(t,e,i){var o=this._get_el(t);o&&(o.style["x"==e?"left":"top"]=i+"px")},Zoom:function(t,e){var i=this._get_el(t);i&&(BROWSER.IE&&BROWSER.VERSION<9?(i=i.firstChild||i,WCT.dom.CssZoom(i,e)):WCT.dom.CssTransformScale(i,e))},HandleFaderEnd:function(t){var e=this._obj;if(e){var i={show:1,fade_in:1,zoom_in:1,bounce_in:1,fly_in_left:1,fly_in_right:1,fly_in_top:1,fly_in_bottom:1}[t.action]?"onvisible":"onhidden";e[i]&&Page.RTFireTrigger(e[i]),this._fader.UnRegisterCallback("onend")}},RTFireTrigger:function(t,e){function i(t){return t.charAt(t.length-1).toUpperCase()}var o=this._obj,r=this._fader,n=!1,s=this.GetGroupId()||!1,a=s&&Controls[s];switch(a&&a.isHidden()&&(n=!0),t){case"show":if(o.hidden){if(o.hidden=!1,n)return t;o.onshow&&Page.RTFireTrigger(o.onshow),r?(o.onvisible&&r.RegisterCallback("onend",this.HandleFaderEnd,this),r.SetHideOpacity(o.opacity),r.Show(),this._update_hit_areas()):set_hidden.call(this,o,"hidden",!1)}return t;case"hide":return o.hidden||(o.hidden=!0,o.onhide&&Page.RTFireTrigger(o.onhide),r?(this._update_hit_areas(),o.onhidden&&r.RegisterCallback("onend",this.HandleFaderEnd,this),!EDIT_MODE||Editor.Preview()?r.SetHideOpacity(0):o.opacity<Fader.HIDE_OPACITY?r.SetHideOpacity(o.opacity*Fader.HIDE_OPACITY/100):r.SetHideOpacity(Fader.HIDE_OPACITY),r.Hide()):set_hidden.call(this,o,"hidden",!0)),t;case"toggle":return this.RTFireTrigger(o.hidden?"show":"hide",e);case"group_fade_in":if(o.hidden||n)return t;case"group_fade_in_force":return(_=(o.anim_show_effect||"fade").split("_")).splice(1,0,"in"),_=_.join("_").replace(/^.|_./g,i),r&&r[_]?(this._update_hit_areas(),o.onshow&&Page.RTFireTrigger(o.onshow),o.onvisible&&r.RegisterCallback("onend",this.HandleFaderEnd,this),r[_]()):this.RTFireTrigger("show",e),t;case"group_fade_out":return(_=(o.anim_hide_effect||"fade").split("_")).splice(1,0,"out"),_=_.join("_").replace(/^.|_./g,i),r&&r[_]?(this._update_hit_areas(),o.onhide&&Page.RTFireTrigger(o.onhide),o.onhidden&&r.RegisterCallback("onend",this.HandleFaderEnd,this),r[_]()):this.RTFireTrigger("hide",e),t;case"fade_in":if((_=(o.anim_show_effect||"fade").split("_")).splice(1,0,"in"),_=_.join("_").replace(/^.|_./g,i),o.hidden&&r&&r[_]){if(o.hidden=!1,n)return t;this._update_hit_areas(),o.onshow&&Page.RTFireTrigger(o.onshow),o.onvisible&&r.RegisterCallback("onend",this.HandleFaderEnd,this),r[_]()}else this.RTFireTrigger("show",e);return t;case"fade_out":var _;return(_=(o.anim_hide_effect||"fade").split("_")).splice(1,0,"out"),_=_.join("_").replace(/^.|_./g,i),!o.hidden&&r&&r[_]?(o.hidden=!0,this._update_hit_areas(),o.onhide&&Page.RTFireTrigger(o.onhide),o.onhidden&&r.RegisterCallback("onend",this.HandleFaderEnd,this),r[_]()):this.RTFireTrigger("hide",e),t;case"fade_toggle":return this.RTFireTrigger(o.hidden?"fade_in":"fade_out",e)}return null},_rd_get_min_rect:function(t){"main"==t||NO_ALERT||alert("_rd_get_min_rect called with sub_id "+t);var e=this._obj,i={border:e.border,border_t:e.border_t,border_r:e.border_r,border_b:e.border_b,border_l:e.border_l,padding:e.padding,padding_t:e.padding_t,padding_r:e.padding_r,padding_b:e.padding_b,padding_:e.padding_l,x:0,y:0},o={val:-1,res:0},r={val:-1,res:0};return clamp_w.call(this,i,o),clamp_h.call(this,i,r),{w:o.res,h:r.res}},_rd_update_dom_pos:function(t,e){var i=this._get_el();i&&(i.style.left=e.x+"px",i.style.top=e.y+"px")},_rd_update_dom_rect:function(t,e){this._update_dom(e)},_update_dom:function(t){if(!this._disable_dom_update){var e=this._get_el();if(e){var i=this._obj,o=t||i,r=o.w,n=o.h,s="number"==typeof i.border&&0<i.border?i.border:0;"none"==i.border_style&&(s=0);var a="number"==typeof i.padding&&0<i.padding?i.padding:0,_=i.msie5?2*s:2*(s+a);e.style.left=o.x+"px",e.style.top=o.y+"px";var l={};return"number"==typeof r&&0<=r&&(l.w=Math.max(0,r-_),e.style.width=l.w+"px"),"number"==typeof n&&0<=n&&(l.h=Math.max(0,n-_),e.style.height=l.h+"px"),this._update_hit_areas(),null!=l.w||null!=l.h?l:null}}},_update_hit_areas:function(){if(HitManager.clearHitControl(this._id),!this.isHidden()){var t=this._obj,e="default";this._cursor?e=this._cursor:(this._link_to||t.ondown||t.onclick||t.ondblclick)&&(e="pointer"),HitManager.setHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"dom",type:"rect",cursor:e,x:t.x,y:t.y,w:t.w,h:t.h,z:t.z})}},_on_set_preview:function(t){var e=this._get_el();e&&(t?this._obj.debug||(e.style.display="none"):e.style.display="block")},_exec_link:function(){var t=this._link_to;if(!t)return null;Canvas.CloseToc();var e=t.toLowerCase().split("!");if((e.length<2||"action"!=e[0]&&"trigger"!=e[0])&&(pauseMedia(),WCT.address.IsFile(t)&&(t=Context.ToAbsPath(t))),this._obj.forceDownload){var i=t.split("?");t=i[0]+"?download=1"+(i[1]?"&"+i[1]:"")}var o=this._obj;if(o.openInNewWindow){var r=getNewWindowFormatString(o);ctx.cfg_show(t,!0,r,null)}else ctx.cfg_show(t,!1,null,null)}}),StatusControl.prototype=new SlideControl,StatusControl.W=40,StatusControl.H=40,StatusControl.COL=10,StatusControl.BGW=16,StatusControl.BGH=16,StatusControl.DEF_BG=BROWSER.IE&&BROWSER.VERSION<9?"#cccccc":"rgba(255,255,255,0.5)",StatusControl.SetZ=function(t,e,i){var o=this._get_el();o.style.zIndex=i,Status.UpdateZByEleId(o.id,i),Status.UpdateCtlsPos(),Dragger.UpdateAll()},WCT.ExtendObject(StatusControl.prototype,{Terminate:function(){Status.RemoveCtl(this._id+"#main#dom"),Dragger.UpdateAll(),SlideControl.prototype.Terminate.call(this)},_create_dom:function(){var t=this.icon_id_,e=StatusControl.BGW,i=StatusControl.BGH,o=StatusControl.COL;this.icon_x_=-t%o*e,this.icon_y_=-Math.floor(t/o)*i;var r=this._obj,n=$$("div");t=this._id+"#main#dom";n.id=t,n.className="StatusControl "+r.type.toFirstUpperCase(),n.style.position="absolute",n.style.width=StatusControl.W+"px",n.style.height=StatusControl.H+"px",n.style.backgroundColor=StatusControl.DEF_BG,n.style.zIndex=r.z||"2";var s=$$("div");if(s.style.position="relative",s.style.width=e+"px",s.style.height=i+"px",s.style.margin="2px auto",s.style.overflow="hidden",EDIT_MODE){var a=$$("img");a.src=to_producer_resource_("statuscontrols"),a.style.position="absolute",a.style.left=this.icon_x_+"px",a.style.top=this.icon_y_+"px",s.appendChild(a)}var _=$$("div");_.id=this._id+"#pv",_.style.width="28px",_.style.height="20px",_.style.textAlign="center",_.style.fontFamily="arial, helvetica, sans-serif",_.style.fontSize="6pt",_.style.color="#000",_.style.margin="2px auto",n.setAttribute("title",r.name),Canvas.Status().appendChild(n),n.appendChild(s),n.appendChild(_),Status.AddCtl({id:t,z:r.z}),Status.UpdateCtlsPos()},InitEdit:function(){var t=new StatusDragger(this,this._id,"main");t.Init({w:StatusControl.W,h:StatusControl.H},this._obj.name),Dragger.UpdateAll(),this._draggers.main=t},Locked:function(){return!0},set_message_:function(t){var e=Editor&&Editor.Preview()||!1,i=$(this._id+"#pv");i&&(i.innerHTML=e?t:"")},_on_set_preview:function(t){var e=this._get_el();e&&(e.style.display=EDIT_MODE?"block":"none"),t||this.set_message_("")},_update_hit_areas:function(){},_update_dom:function(){}});var Media=function(){var o={},t=!1;return{Cleanup:function(){for(var t in this.mixer.Cleanup(),this.video.Cleanup(),this.audio.Cleanup(),o){var e=o[t];e&&e.Destructor&&e.Destructor(),delete o[t]}},Play:function(){t=!1,this.video.PlayAll(),this.audio.PlayAll()},Pause:function(){t=arguments[0]||!1,this.video.PauseAll(),this.audio.PauseAll()},Stop:function(){this.video.StopAll(),this.audio.StopAll()},Rewind:function(){this.video.RewindAll(),this.audio.RewindAll()},Resume:function(){t=!1,this.video.ResumeAll(),this.audio.ResumeAll()},Mute:function(){Media.mixer.Mute("Master",!0,arguments[0]),this.video.MuteAll(),this.audio.RemuteAll()},Unmute:function(){Media.mixer.Mute("Master",!1,arguments[0]),this.video.UnmuteAll(),this.audio.RemuteAll()},Volume:function(t){Media.mixer.Volume("Master",t,arguments[1]),this.video.VolumeAll(t),this.audio.RevolumeAll()},Paused:function(){return t},Register:function(t,e){o[t]=e},Unregister:function(t){delete o[t]},GetRegistered:function(t){return o[t]||null},IterateRegistered:function(t,e){for(var i in o)t.call(e,o[i],arguments[2]||null)},PluginInstalled:function(t){var i={wmp:"Windows Media Player",quicktime:"QuickTime"}[t],o={wmp:"WMPlayer.OCX",quicktime:"QuickTime.QuickTime"}[t];if(i&&navigator.plugins&&navigator.plugins.length){for(var r=0,n=navigator.plugins.length;r<n;r++)if(0<=navigator.plugins[r].name.indexOf(i))return!0}else if(o)try{return null!=new ActiveXObject(o)}catch(e){}return!1}}}();function OnDSPlayStateChangeEvt(t){Media.IterateRegistered(Media.object.OnUnscopedWmpEvent,Media.object,[t])}function TextControl(){RectControl.call(this),this._hdx={border_color:{to_dom:TextObject.UpdateFromControl,clamp:clamp_color},border:{to_dom:TextObject.UpdateFromControl,clamp:clamp_border},border_t:{to_dom:TextObject.UpdateFromControl,clamp:clamp_border},border_r:{to_dom:TextObject.UpdateFromControl,clamp:clamp_border},border_b:{to_dom:TextObject.UpdateFromControl,clamp:clamp_border},border_l:{to_dom:TextObject.UpdateFromControl,clamp:clamp_border},padding:{to_dom:TextObject.UpdateFromControl,clamp:clamp_padding},padding_t:{to_dom:TextObject.UpdateFromControl,clamp:clamp_padding},padding_r:{to_dom:TextObject.UpdateFromControl,clamp:clamp_padding},padding_b:{to_dom:TextObject.UpdateFromControl,clamp:clamp_padding},padding_l:{to_dom:TextObject.UpdateFromControl,clamp:clamp_padding},font_family:{to_dom:TextObject.UpdateFromControl,clamp:clamp_font_family},font_size:{to_dom:TextObject.UpdateFromControl,clamp:clamp_font_size},background_color:{to_dom:TextObject.UpdateFromControl,clamp:clamp_color},text_color:{to_dom:TextObject.UpdateFromControl,clamp:clamp_color},bold:{to_dom:TextObject.UpdateFromControl,clamp:clamp_boolean},italic:{to_dom:TextObject.UpdateFromControl,clamp:clamp_boolean},underline:{to_dom:TextObject.UpdateFromControl,clamp:clamp_boolean},align:{to_dom:TextObject.UpdateFromControl,clamp:clamp_align},valign:{to_dom:TextObject.UpdateFromControl,clamp:clamp_valign},text:{to_dom:TextObject.UpdateFromControl},title:{to_dom:TextControl.SetTitle},placeholder_text:{to_dom:TextObject.UpdateFromControl},hide_scrollbars:{to_dom:TextObject.UpdateFromControl,clamp:clamp_boolean},line_height:{to_dom:TextObject.UpdateFromControl,clamp:clamp_font_size},white_space:{to_dom:TextObject.UpdateFromControl},overflow:{to_dom:TextObject.UpdateFromControl},direction:{to_dom:TextControl.SetDirection},shadow_show:{to_dom:TextObject.UpdateFromControl},shadow_color:{to_dom:TextObject.UpdateFromControl,clamp:clamp_color},shadow_trans:{to_dom:TextObject.UpdateFromControl,clamp:clamp_trans},shadow_blur:{to_dom:TextObject.UpdateFromControl},shadow_spread:{to_dom:TextObject.UpdateFromControl},shadow_h:{to_dom:TextObject.UpdateFromControl},shadow_v:{to_dom:TextObject.UpdateFromControl},autosize:{to_dom:TextControl.Autosize},max_w:{to_dom:TextObject.UpdateFromControl},max_h:{to_dom:TextObject.UpdateFromControl},tooltip:{to_dom:set_tooltip},href:{to_dom:RectControl.SetLink},trigger_error_on_use:{to_dom:set_trigger_error_on_use},opacity:{to_dom:set_ctrl_opacity,clamp:clamp_opacity},hidden:{to_dom:set_hidden,clamp:clamp_boolean},locked:{to_dom:set_locked},arialabel:{to_dom:setAccessibility},tabindex:{to_dom:setTabIndex,clamp:clampTabIndex},role:{to_dom:setAccessibility},fade_in_time:{to_dom:set_fade_time,clamp:clamp_time},fade_out_time:{to_dom:set_fade_time,clamp:clamp_time},border_style:{to_dom:BorderTextObject.SetControlBorderStyle},custom_style:{to_dom:BorderTextObject.SetControlCustomStyle},custom_style_mouseover:{to_dom:noop},custom_style_mousedown:{to_dom:noop},x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},w:{to_dom:BorderTextObject.SetControlWH,clamp:BorderTextObject.ClampControlWH},h:{to_dom:BorderTextObject.SetControlWH,clamp:BorderTextObject.ClampControlWH},z:{to_dom:set_z,clamp:clamp_z},disabled:{to_dom:set_disabled,clamp:clamp_boolean},cursorhand:{to_dom:set_cursorhand,clamp:clamp_boolean}},SlideControl.ExtendHdx(this._hdx),this._fader=new Fader(this,"#main#dom"),this._mouse_state=null}function MediaControl(){RectControl.call(this),this._hdx={background_color:{to_dom:set_background_color,clamp:clamp_color},border:{to_dom:set_border,clamp:clamp_border},border_color:{to_dom:set_border_color,clamp:clamp_color},padding:{to_dom:set_padding,clamp:clamp_padding},tooltip:{to_dom:set_tooltip},z:{to_dom:set_z,clamp:clamp_z},w:{to_dom:set_w,clamp:clamp_w},h:{to_dom:set_h,clamp:clamp_h},x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},src:{to_dom:MediaControl.SetSource},alt_src_1:{to_dom:MediaControl.SetSource},alt_src_2:{to_dom:MediaControl.SetSource},link_to:{to_dom:RectControl.SetLink},loop:{to_dom:MediaControl.SetOption},noDownload:{to_dom:MediaControl.SetOption},playonstart:{to_dom:MediaControl.SetOption},opacity:{to_dom:set_ctrl_opacity,clamp:clamp_ctrl_opacity},tabindex:{to_dom:setTabIndex,clamp:clampTabIndex},hidden:{to_dom:set_hidden},locked:{to_dom:set_locked}},this.media_=null}function AudioControl(){StatusControl.apply(this),WCT.ExtendObject(this._hdx,{src:{to_dom:MediaControl.SetSource},soundchannel:{to_dom:AudioControl.SetSoundchannel},volume:{to_dom:AudioControl.SetVolume,clamp:AudioControl.ClampVolume},playonstart:{to_dom:MediaControl.SetOption},loop:{to_dom:MediaControl.SetOption}}),this.has_client_=!1,this.is_playing_=!1,this.icon_id_=2}function Fader(t,e){this._target=t,this._sub_id=e.isArray?e:[e],this._ticker_id=WCT.uid.Generate(12,"FDR_"),this._dom_vis=100,this._hid_op=0,this.opacity_=100,this._dom_pos_x=0,this._dom_pos_y=0,this._fade_dir="",this._fly_x_dir="",this._fly_y_dir="",this._zoom_dir="",this._bounce_dir="",this._times={fade_base_:0,fade_cur_:0,fly_x_base_:0,fly_x_range_:0,fly_x_cur_:0,fly_y_base_:0,fly_y_range_:0,fly_y_cur_:0,zoom_base_:0,zoom_in_base_:0,zoom_out_base_:1,zoom_cur_:0,bounce_base_:0,bounce_cur_:0,fade_in_time:500,fade_out_time:500,fly_x_in_time:500,fly_x_out_time:500,fly_y_in_time:500,fly_y_out_time:500,zoom_in_time:500,zoom_out_time:500,bounce_in_time:500,bounce_out_time:500},this._callbacks={onstart:null,ontick:null,onend:null},this._cur_fade=null,this._cur_fly_x=null,this._cur_fly_y=null,this._cur_zoom=null,this._cur_bounce=null,this.handle_opac_for_old_ie_=!1}function TimerControl(){StatusControl.call(this),this._timeouts=null,this.icon_id_=0}function CollectorControl(){StatusControl.call(this),this._goals=null,this._flags=null,this._next_goal=null,this._next_idx=null,this._count=0,this.icon_id_=4}function CounterControl(){CollectorControl.apply(this),this._hdx.time={clamp:clamp_time},this.icon_id_=3}function SwitchboardControl(){StatusControl.call(this),this.icon_id_=1}function AnimatorControl(){RectControl.call(this),this._hdx={x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},w:{to_dom:set_w,clamp:clamp_w},h:{to_dom:set_h,clamp:clamp_h},z:{to_dom:set_z,clamp:clamp_z},time:{to_dom:set_time,clamp:clamp_time},locked:{to_dom:set_locked}},this._x0=null,this._y0=null,this._w0=null,this._h0=null,this._dx=null,this._dy=null,this._dw=null,this._dh=null,this._op=null,this._np=null}function Testomat(){StatusControl.call(this),this.active_=!1,this.finished_=!1,this.state_="idle",this.next_=null,this.last_msg_=null,this.icon_id_=11}Media.mixer=function(){var n={Master:{user:!1,author:!1},Booksound:{user:!1,author:!1},Narrative:{user:!1,author:!1},Effects:{user:!1,author:!1},Simulation:{user:!1,author:!1}},s={Master:{user:100,author:100},Booksound:{user:100,author:100},Narrative:{user:100,author:100},Effects:{user:100,author:100},Simulation:{user:100,author:100}};return{Cleanup:function(){n={Master:{user:!1,author:!1},Booksound:{user:!1,author:!1},Narrative:{user:!1,author:!1},Effects:{user:!1,author:!1},Simulation:{user:!1,author:!1}},s={Master:{user:100,author:100},Booksound:{user:100,author:100},Narrative:{user:100,author:100},Effects:{user:100,author:100},Simulation:{user:100,author:100}}},GetMixerChannel:function(t){return{Master:"Master",Booksound:"Booksound",Narrative:"Narrative",Pagesound:"Narrative",Effects:"Effects",Others:"Effects",tour_sound:"Simulation"}[t]||"Effects"},Mute:function(t){var e=this.GetMixerChannel(t),i=arguments[1];if("boolean"==typeof i){var o=arguments[2]||!1;n[e][o?"user":"author"]=i}var r=n.Master.user||n.Master.author;return"Master"==e?r:r||n[e].user||n[e].author},Volume:function(t){var e=this.GetMixerChannel(t),i=arguments[1];if("number"==typeof i){var o=arguments[2]||!1;s[e][o?"user":"author"]=Math.max(0,Math.min(100,i))}var r=s.Master.user*s.Master.author/100;if("Master"==e)return Math.round(r);var n=s[e].user*s[e].author/100;return Math.round(r*n/100)},Get:function(t,e,i){var o=this.GetMixerChannel(e),r="mute"==t?n:"volume"==t?s:null;return(r=r&&r[o]||null)?r[i?"user":"author"]:null}}}(),Media.object=function(t){this.uid_="MO_"+GenerateUid(12),this.type_=null,this.plugin_=null,this.play_count_=0,this.verify_count_=0,this.timeout_=null,this.client_=null,this.dom_parent_=null,this.audio_=t||!1,this.tick_=Media.object.IE_QT_TICK_INTERVAL,this.ie_qt_evt_=null,this.created_=!1,this.verified_=!1,this.no_veri_stack_=[],this.all_sources_=[],this.c_src_=0,this.dummy_={duration:0,play:!0,pause:!0,stop:!0,playing:!0,paused:!0,stopped:!0,state:"stopped"},this.state_={showControls:null,showStatusBar:null,scale:null,quality:null,wmode:null,w:null,h:null,loop:!1,autostart:!1,volume:null,muted:!1,source:"",stopped:!1,resume:!1,plugin:null},Media.Register(this.uid_,this)},Media.object.EXTENSION_MAP={ogm:{IE:"video",FF:"video",SAFARI:"video",MIME_TYPE:"ogg"},ogv:{IE:"video",FF:"video",SAFARI:"video",MIME_TYPE:"ogg"},ogg:{IE:"video",FF:"video",SAFARI:"video",MIME_TYPE:"ogg"},webm:{IE:"video",FF:"video",SAFARI:"video",MIME_TYPE:"webm"},mp4:{IE:"wmp",FF:"quicktime",SAFARI:"quicktime",MIME_TYPE:"mp4"},m4v:{IE:"wmp",FF:"quicktime",SAFARI:"quicktime",MIME_TYPE:"mp4"},qt:{IE:"quicktime",FF:"quicktime",SAFARI:"quicktime",MIME_TYPE:"mp4"},mov:{IE:"quicktime",FF:"quicktime",SAFARI:"quicktime",MIME_TYPE:"mp4"},avi:{IE:"wmp",FF:"wmp",SAFARI:"wmp",MIME_TYPE:"avi"},wmv:{IE:"wmp",FF:"wmp",SAFARI:"wmp",MIME_TYPE:"wmv"},mpg:{IE:"wmp",FF:"wmp",SAFARI:"quicktime",MIME_TYPE:"mpg"},mpeg:{IE:"wmp",FF:"wmp",SAFARI:"quicktime",MIME_TYPE:"mpg"},rm:{IE:"realplayer",FF:"realplayer",SAFARI:"realplayer",MIME_TYPE:"realplayer"}},Media.object.HTML5_VIDEO={ogm:!0,ogv:!0,ogg:!0,webm:!0,mp4:!0,m4v:!0},Media.object.HTML5_AUDIO={mp3:!0},Media.object.HTML5_IOS={mov:!0,qt:!0},Media.object.PLUGINS={wmp:{object:{classid:"CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6",codebase:"//activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701",type:"application/x-ms-wmp",https_:!1,properties_:{source:"URL",autostart:"autoStart"},params_:{AutoSize:"false",animationatStart:"false",transparentatStart:"true",windowlessVideo:"true",SendPlayStateChangeEvents:"true"}},embed:{pluginspage:"//microsoft.com/windows/mediaplayer/en/download/",type:"application/x-ms-wmp",https_:!0,params_:{stretchToFit:"true",scale:"true",windowlessVideo:"false",SendPlayStateChangeEvents:"true"}}},quicktime:{object:{classid:"CLSID:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B",codebase:"//www.apple.com/qtactivex/qtplugin.cab",type:"video/quicktime",https_:!0,properties_:{source:"src",autostart:"autoplay"},params_:window.PLATFORM&&PLATFORM.MAC?{wmode:"opaque",KIOSKMODE:"true",postdomevents:"true"}:{wmode:"opaque",QTSRCDONTUSEBROWSER:"true",TARGETCACHE:"true",KIOSKMODE:"true",postdomevents:"true"}},embed:{pluginspage:"//www.apple.com/quicktime/download/",type:"video/quicktime",https_:!0,params_:window.PLATFORM&&PLATFORM.MAC?{wmode:"opaque",KIOSKMODE:"true",postdomevents:"true",EnableJavaScript:"true"}:{wmode:"opaque",QTSRCDONTUSEBROWSER:"true",TARGETCACHE:"true",KIOSKMODE:"true",postdomevents:"true",EnableJavaScript:"true"}}},realplayer:{object:{classid:"CLSID:CFCDAA03-8BE4-11cf-B84B-0020AFBBCCFA",codebase:"//www.real.com/products/player/",type:"audio/x-pn-realaudio-plugin",https:!1,properties_:{source:"src",autostart:"autostart"},params_:{controls:"all",console:"c1210008304328"}},embed:{pluginspage:"//www.real.com/products/player/",type:"audio/x-pn-realaudio-plugin",https_:!1,params_:{controls:"all",console:"c1210008304328"}}},flash:{object:{classid:"CLSID:D27CDB6E-AE6D-11cf-96B8-444553540000",codebase:"//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,29,0",type:"application/x-shockwave-flash",https_:!0,properties_:{source:"movie",autostart:"play"},params_:{allowScriptAccess:"sameDomain"}},embed:{pluginspage:"//www.macromedia.com/go/getflashplayer",type:"application/x-shockwave-flash",params_:{allowScriptAccess:"sameDomain"}}}},Media.object.COMMAND_MAP={IE:{wmp:{play:"%o%controls.play()",pause:"%o%controls.pause()",stop:"%o%controls.stop()",mute:"%o%settings.mute=%p%",volume:"%o%settings.volume=%p%",time:"%o%controls.currentPosition=%p%/1000",loop:'%o%settings.setMode("loop",%p%)',source:'%o%URL=unescape("%p%")'},quicktime:{play:"%o%play()",pause:"%o%stop()",stop:"%o%stop()",mute:"%o%SetMute(%p%)",volume:"%o%SetVolume(%p%*2.55)",time:"%o%SetTime(%p%)",loop:"%o%SetIsLooping(%p%)",source:'%o%SetURL("%p%")'},realplayer:{play:"%o%DoPlay()",pause:"%o%DoPause()",mute:"%o%SetMute(%p%)",volume:"%o%SetVolume(%p%)"},flash:{play:"%o%play()",pause:"%o%stop()"},video:{play:"%o%play()",stop:"%o%pause()",pause:"%o%pause()",mute:"%o%muted=%p%",volume:"%o%volume=%p%/100",time:"%o%currentTime=%p%",loop:"%o%loop=%p%",source:'%o%src="%p%"'},audio:{play:"%o%play()",pause:"%o%pause()",stop:"%o%pause()",mute:"%o%muted=%p%",volume:"%o%volume=%p%/100",time:"%o%currentTime=%p%",loop:"%o%loop=%p%",source:'%o%src="%p%"'}},other:{wmp:{play:"%o%controls.play()",pause:"%o%controls.pause()",stop:"%o%controls.stop()",mute:"%o%settings.mute=%p%",volume:"%o%settings.volume=%p%",time:"%o%controls.currentPosition=%p%/1000",loop:'%o%settings.setMode("loop",%p%)',source:'%o%URL=unescape("%p%")'},quicktime:{play:"%o%Play()",pause:"%o%Stop()",stop:"%o%Stop()",mute:"%o%SetMute(%p%)",volume:"%o%SetVolume(%p%*2.55)",time:"%o%SetTime(%p%)",loop:"%o%SetIsLooping(%p%)",source:'%o%SetURL("%p%")'},realplayer:{play:"%o%DoPlay()",pause:"%o%DoPause()",mute:"%o%SetMute(%p%)",volume:"%o%SetVolume(%p%)"},flash:{play:"%o%Play()",pause:"%o%StopPlay()"},video:{play:"%o%play()",stop:"%o%pause()",pause:"%o%pause()",mute:"%o%muted=%p%",volume:"%o%volume=%p%/100",time:"%o%currentTime=%p%",loop:"%o%loop=%p%",source:'%o%src="%p%"'},audio:{play:"%o%play()",pause:"%o%pause()",stop:"%o%pause()",mute:"%o%muted=%p%",volume:"%o%volume=%p%/100",time:"%o%currentTime=%p%",loop:"%o%loop=%p%",source:'%o%src="%p%"'}}},Media.object.STATE_MAP={IE:{wmp:{playing:"%o%playState==3",paused:"%o%playState==2",stopped:"%o%playState==1",buffering:"%o%playState==6",waiting:"%o%playState==7",playable:"%o%playState==10",ended:"%o%playState==8",transitioning:"%o%playState==9",reconnecting:"%o%playState==11",unknown:"%o%playState==0",time:"%o%controls.currentPosition*1000",duration:"%o%currentMedia.duration*1000"},quicktime:{playing:"%o%GetRate()==1",paused:"%o%GetRate()==0",stopped:"%o%GetRate()==0&&%o%GetTime()==%o%GetDuration()",buffering:'%o%GetPluginStatus()=="Loading"',waiting:'%o%GetPluginStatus()=="Waiting"',playable:'%o%GetPluginStatus()=="Playable"',ended:"%o%GetTime()==%o%GetDuration()",complete:'%o%GetPluginStatus()=="Complete"',time:"%o%GetTime()/%o%GetTimeScale()*1000",duration:"%o%GetDuration()/%o%GetTimeScale()*1000"},realplayer:{playing:"%o%GetPlayState()==3"},flash:{playing:"%o%Playing"},video:{playing:"%o%paused!=true",paused:"%o%paused==true",ended:"%o%ended==true&&%o%currentTime>=%o%duration",time:"%o%currentTime",duration:"%o%duration"},audio:{playing:"%o%paused!=true",paused:"%o%paused==true",ended:"%o%ended==true&&%o%currentTime>=%o%duration",time:"%o%currentTime",duration:"%o%duration"}},other:{wmp:{playing:"%o%playState==3",paused:"%o%playState==2",stopped:"%o%playState==1",buffering:"%o%playState==6",waiting:"%o%playState==7",playable:"%o%playState==10",ended:"%o%playState==8",transitioning:"%o%playState==9",reconnecting:"%o%playState==11",unknown:"%o%playState==0",time:"%o%controls.currentPosition*1000",duration:"%o%currentMedia.duration * 1000"},quicktime:{playing:"%o%GetRate()==1",paused:"%o%GetRate()==0",stopped:"%o%GetRate()==0&&%o%GetTime()==%o%GetDuration()",buffering:'%o%GetPluginStatus()=="Loading"',waiting:'%o%GetPluginStatus()=="Waiting"',playable:'%o%GetPluginStatus()=="Playable"',ended:"%o%GetTime()==%o%GetDuration()",complete:'%o%GetPluginStatus()=="Complete"',time:"%o%GetTime()/%o%GetTimeScale()*1000",duration:"%o%GetDuration()/%o%GetTimeScale()*1000"},realplayer:{playing:"%o%GetPlayState()==3"},flash:{playing:"%o%IsPlaying()"},video:{playing:"%o%paused!=true",paused:"%o%paused==true",ended:"%o%ended==true&&%o%currentTime>=%o%duration",time:"%o%currentTime",duration:"%o%duration"},audio:{playing:"%o%paused!=true",paused:"%o%paused==true",ended:"%o%ended==true&&%o%currentTime>=%o%duration",time:"%o%currentTime",duration:"%o%duration"}}},Media.object.MAX_PLAY_COUNT=30,Media.object.MAX_VERIFY_COUNT=50,Media.object.IE_QT_TICK_INTERVAL=3,Media.object.PlayLater=function(t){var e=Media.GetRegistered(t);e&&e.Play&&e.Play()},Media.object.VerifyLater=function(t){var e=Media.GetRegistered(t);e&&e.verify_&&e.verify_()},Media.object.OnUnscopedWmpEvent=function(t,e){var i=null;switch(e=e[0]){case 1:i="Stopped";break;case 2:i="Paused";break;case 3:i="Playing";break;case 8:i="Finished"}if(null!=i){var o=i.toLowerCase();t.state_.plugin!=o&&t[i]()&&t.on_wmp_event_(e)}},Media.object.OnWmpEvent=function(t,e){var i=Media.GetRegistered(t);i&&i.on_wmp_event_(e)},Media.object.OnAudioPlay=function(){if(void 0!==Media){var t="string"==typeof this.id&&this.id.split("#")[0]||null,e=t&&Media.GetRegistered(t)||null;e&&e.on_audio_event_("play")}},Media.object.OnAudioPause=function(){if(void 0!==Media){var t="string"==typeof this.id&&this.id.split("#")[0]||null,e=t&&Media.GetRegistered(t)||null;e&&e.on_audio_event_("pause")}},Media.object.OnAudioStop=function(){if(void 0!==Media){var t="string"==typeof this.id&&this.id.split("#")[0]||null,e=t&&Media.GetRegistered(t)||null;e&&e.on_audio_event_("stop")}},Media.object.OnAudioEnd=function(){if(void 0!==Media){var t="string"==typeof this.id&&this.id.split("#")[0]||null,e=t&&Media.GetRegistered(t)||null;e&&e.on_audio_event_("finish")}},Media.object.OnVideoEvent=function(t){if(t){var e="ended"==t.type?"finish":t.type;if(e&&void 0!==Media){var i="string"==typeof this.id&&this.id.split("#")[0]||null,o=i&&Media.GetRegistered(i)||null;if(o){if("error"==e){var r=o.all_sources_||[],n=[],s=r.length,a=Controls[o.client_],_=a.DoPlayOnStart&&a.DoPlayOnStart();if(1<s){for(var l=0;l<s;l++)r[l]!=this.currentSrc&&n.push(r[l]);return o.Reset(),o.HTML5Sources(n),o.Source(n[0]),void(_&&o.Play())}if(1==s&&!BROWSER.MOBILE){var d=Media.object.EXTENSION_MAP,h=r[0].substr(r[0].lastIndexOf(".")+1),c=BROWSER.IE?"IE":BROWSER.FIREFOX?"FF":BROWSER.SAFARI?"SAFARI":"",p=d[h][c];if("video"!=p)return o.Reset(),o.SetType(p),o.HTML5Sources(null),o.Source(r[0]),void(_&&o.Play())}}o.on_video_event_(e)}}}},Media.object.prototype=function(){function get_dom_string_for_audio_(){var t=this.state_,e=t.source||"";return["<audio autobuffer",' id="',this.uid_,'#audiotag"',' src="',e,'"',t.showControls?" controls":"",!Page.IsPaused()&&t.autostart?" autoplay":"",t.volume?" volume="+t.volume:"",t.loop?" loop="+t.loop:"",t.showControls?"":' style="position:absolute;top:0px;left:0px;width:'+t.w+"px;height:"+t.h+'px"',"></audio>"].join("")}function get_dom_string_for_video_(){var t=Media.object.EXTENSION_MAP,e=this.state_,i=e.source||"",o=i.substr(i.lastIndexOf(".")+1),r=t[o].MIME_TYPE||"",n=["<video",' id="',this.uid_,'#videotag" preload="auto"',e.showControls?" controls":"",!Page.IsPaused()&&e.autostart?" autoplay":"",e.volume?" volume="+e.volume:"",e.muted?" muted":"",e.loop?" loop":"",e.noDownload?' controlsList="nodownload"':"",' style="position:absolute;top:0px;left:0px;width:100%;height:100%;"',">",'<source src="',i,'" ',r?'type="video/'+r+'"':"","/>"],s=this.all_sources_||[];if(1<(s?s.length:0))for(var a=Media.object.HTML5_VIDEO,_=0,l=null;l=s[_++];)i!=l&&a[o=l.substr(l.lastIndexOf(".")+1)]&&(r=t[o].MIME_TYPE||"",n.push('<source src="',l,'" ',r?'type="video/'+r+'"':"","/>"));return n.push("</video>"),n.join("")}function get_dom_string_(){if(!this.plugin_||"dummy"==this.plugin_)return"";var t=this.plugin_.object,e=this.plugin_.embed,i=this.state_,o=i.source||"",r={},n={id:this.uid_+"#embed",type:e.type,pluginspage:e.pluginspage,width:"100%",height:"100%"},s={};switch(s.loop=i.loop?"true":"false",s[t.properties_.autostart]="false",this.type_){case"wmp":var a=i.loop?"9999":"1",_=i.showControls?"true":"false",l=i.showStatusBar?"true":"false";o=unescape(o),r.PlayCount=a,r.showControls=_,r.showStatusBar=l,n.playcount=a,n.showcontrols=_,n.showstatusbar=l,i.showControls||(r.uiMode="none",n.uimode="none");break;case"quicktime":s.controller=i.showControls?"true":"false",s.scale=i.scale||"tofit";break;case"realplayer":var d=GenerateUid(3);t.params_&&t.params_.console&&(t.params_.console+=d),e.params_&&e.params_.console&&(e.params_.console+=d);break;case"flash":s.quality=i.quality||"high",s.base=o.substr(0,o.lastIndexOf("/")+1),i.wmode&&"none"!=i.wmode&&(s.wmode=i.wmode);break;default:return""}r[t.properties_.source]=o,n.src=o;var h=["<object",' classid="',t.classid,'"',' codebase="',t.codebase,'"',' width="100%"',' height="100%"',' type="',t.type,'"',' id="',this.uid_,'#object"',' name="',this.uid_,'#object"',">"];if(t.params_)for(var c in t.params_)h.push('<param name="'+c+'" value="'+t.params_[c]+'" />');for(var c in r)h.push('<param name="'+c+'" value="'+r[c]+'" />');for(var c in s)h.push('<param name="'+c+'" value="'+s[c]+'" />');if(h.push("<embed"),e.params_)for(var c in e.params_)h.push(" "+c+'="'+e.params_[c]+'"');for(var c in n)h.push(" "+c+'="'+n[c]+'"');for(var c in s)h.push(" "+c+'="'+s[c]+'"');return h.push(" /></object>"),h.join("")}function get_el_(){if("dummy"==this.type_)return $(this.uid_);if("audio"==this.type_)return $(this.uid_+"#audiotag");if("video"==this.type_)return $(this.uid_+"#videotag");if(BROWSER.IE){var t=$(this.uid_+"#object");return t?t.object:null}return $(this.uid_+"#embed")}function exec_cmd_(cmd){if(!this.verified_)return this.no_veri_stack_.push({cmd:cmd,map:arguments[1],param:arguments[2]}),null;var map=arguments[1]||"COMMAND_MAP";if("dummy"==this.type_){var d=this.dummy_;if(null==d[cmd])return null;switch(cmd){case"play":"playing"!=d.state&&(d.state="playing",Ticker.RegisterJS(this,this.uid_),this.fire_trigger_("play"));break;case"pause":"paused"!=d.state&&(d.state="paused",Ticker.UnregisterJS(this.uid_),this.fire_trigger_("pause"));break;case"stop":"stopped"!=d.state&&(d.state="stopped",Ticker.UnregisterJS(this.uid_),this.fire_trigger_("stop"));break;case"playing":case"paused":case"stopped":return d.state==cmd}}else{var el=get_el_.call(this);if(!el)return null;var m=Media.object[map][BROWSER.IE?"IE":"other"][this.type_]||null,f=m&&m[cmd]||null;if(!f)return null;var p=arguments[2];f=f.replace(/%o%/g,"el."),null!=p&&(f=f.replace(/%p%/g,p));try{return eval(f)}catch(e){}}return null}function clear_timeout_(){null!=this.timeout_&&(WCT.ClearTimeout(this.timeout_),this.timeout_=null),this.play_count_=0}function create_video_(){if(this.dom_parent_){var t=$(this.uid_);t&&t.parentNode.removeChild(t);var e=$$("div");this.dom_parent_.appendChild(e),e.id=this.uid_;var i=get_dom_string_for_video_.call(this);e.innerHTML=i,this.type_="video",this.verify_(),this.created_=!0;var o=$(this.uid_+"#videotag");o&&(o.muted=this.state_.muted?1:0,WCT.event.Observe("play",Media.object.OnVideoEvent,o),WCT.event.Observe("pause",Media.object.OnVideoEvent,o),WCT.event.Observe("stop",Media.object.OnVideoEvent,o),WCT.event.Observe("ended",Media.object.OnVideoEvent,o),WCT.event.Observe("error",Media.object.OnVideoEvent,o),WCT.event.Observe("volumechange",Media.object.OnVideoEvent,o))}}function create_audio_(){if(this.dom_parent_){var t=$$("div");if(this.dom_parent_.appendChild(t),t.id=this.uid_,!this.state_.showControls){var e=BROWSER.MOBILE?"0px":"-10000px";t.style.position="absolute",t.style.left=e,t.style.top=e,t.style.visibility="hidden",t.style.width="0px",t.style.height="0px",PLATFORM.IOS&&(t.style.zIndex=2)}var i=get_dom_string_for_audio_.call(this);t.innerHTML=i,this.verified_=!0,this.created_=!0;var o=$(this.uid_+"#audiotag");o&&(o.muted=this.state_.muted?"true":"false",WCT.event.Observe("play",Media.object.OnAudioPlay,o),WCT.event.Observe("pause",Media.object.OnAudioPause,o),WCT.event.Observe("stop",Media.object.OnAudioStop,o),WCT.event.Observe("ended",Media.object.OnAudioEnd,o))}}function create_(){if(this.dom_parent_){var t="https"!=Context.GetProtocol(),i=t?"http:":"https:",o=this.uid_,r=WCT.DeepCopy(Media.object.PLUGINS[this.type_]||null);r?(t||r.object.https_?r.object.codebase=i+r.object.codebase:r.object.codebase="",delete r.object.https_,t||r.embed.https_?r.embed.pluginspage=i+r.embed.pluginspage:r.embed.pluginspage="",delete r.embed.https_,BROWSER.SAFARI&&this.audio_&&"quicktime"===this.type_&&(r.embed.params_.wmode="transparent",r.object.params_.wmode="transparent"),this.plugin_=r):"dummy"===this.type_&&(this.plugin_="dummy"),BROWSER.MOBILE||remove_.call(this);var n=$$("div");this.dom_parent_.appendChild(n),n.id=o,this.audio_?(n.style.position="absolute",n.style.visibility="hidden",n.style.left="-10000px",n.style.top="-10000px",n.style.width="0px",n.style.height="0px"):(n.style.width="100%",n.style.height="100%");var s=get_dom_string_.call(this);switch(n.innerHTML=s,this.verify_(),this.type_){case"wmp":var a='window.Media && Media.object && Media.object.OnWmpEvent("'+o+'", newS);';if(BROWSER.IE7)n.innerHTML+=["<scr",'ipt id="',o,'#script" ','for="',o,'#object" ','event="PlayStateChange(newS)" ','language="JScript">',a,"</scr","ipt>"].join("");else{var _=document.createElement("script");_.setAttribute("id",o+"#script"),_.setAttribute("for",o+"#object"),_.setAttribute("event","PlayStateChange(newS)"),_.setAttribute("language","JScript");try{_.innerHTML=a}catch(e){_.text=a}n.appendChild(_)}break;case"quicktime":Ticker.RegisterJS(this,o),BROWSER.IE&&this.audio_&&(n.style.visibility="visible")}this.type_&&(this.created_=!0)}}function remove_(){var t=this.uid_;Ticker.UnregisterJS(t);var e=$(t+"#audiotag");e&&(WCT.event.StopObserving("play",Media.object.OnAudioPlay,e),WCT.event.StopObserving("pause",Media.object.OnAudioPause,e),WCT.event.StopObserving("stop",Media.object.OnAudioStop,e),WCT.event.StopObserving("ended",Media.object.OnAudioEnd,e),e.parentNode.removeChild(e)),(e=$(t+"#videotag"))&&(WCT.event.StopObserving("play",Media.object.OnVideoEvent,e),WCT.event.StopObserving("pause",Media.object.OnVideoEvent,e),WCT.event.StopObserving("stop",Media.object.OnVideoEvent,e),WCT.event.StopObserving("ended",Media.object.OnVideoEvent,e),WCT.event.StopObserving("error",Media.object.OnVideoEvent,e),e.parentNode.removeChild(e)),store_or_remove_(t),this.verified_=!1,this.created_=!1}function get_last_dom_store_(){for(var t=0,e=$("MOVED_MO#"+t);e;)e=$("MOVED_MO#"+ ++t);return--t}function store_or_remove_(t){if(!BROWSER.IE||8<BROWSER.VERSION){var e=$(t);e&&e.parentNode.removeChild(e)}else{var i=$("MO_CONTAINER");i||((i=$$("DIV")).id="MO_CONTAINER",i.style.visibility="hidden",i.style.display="none",i.style.width="1px",i.style.height="1px",i.style.overflow="hidden",document.body.appendChild(i));for(var o=["","#script","#object"],r=get_last_dom_store_()+1,n=0;n<=2;n++){var s=o[n];(e=$(t+s))&&(e.id="MOVED_MO"+s+"#"+r,s||(i.appendChild(e),e.style.visibility="hidden",e.style.display="none",e.style.width="1px",e.style.height="1px",e.width="1",e.height="1"))}}}function is_wmp_(t){return"number"==typeof t.playState}function is_qt_(t){try{return"function"==typeof t.GetRate||"number"==typeof t.GetRate()}catch(e){}return!1}function is_realplayer_(t){try{return"function"==typeof t.GetPlayState||"number"==typeof t.GetPlayState()}catch(e){}return!1}function is_flash_(t){return"function"==typeof t.IsPlaying||"undefined"!=typeof t.Playing}function is_html5_(t,e){return WCT.dom.GetNodeName(t)==e}function get_plugin_type_(t){return is_wmp_(t)?"wmp":is_qt_(t)?"quicktime":is_realplayer_(t)?"realplayer":is_flash_(t)?"flash":is_html5_(t,"video")?"video":is_html5_(t,"audio")?"audio":null}return{Destructor:function(){return this.Pause(),this.Stop(),Media.Unregister(this.uid_),Ticker.UnregisterJS(this.uid_),remove_.call(this),this.uid_=null,this.type_=null,this.plugin_=null,this.state_=null,this.client_=null,this.dom_parent_=null},GetUid:function(){return this.uid_},Play:function(){if(this.state_.source)if(Page.IsPaused())this.EnableResume();else{var t=arguments[0]||!1;if(this.state_.stopped=!1,exec_cmd_.call(this,"playing","STATE_MAP")){if(clear_timeout_.call(this),!t)return;this.Stop()}exec_cmd_.call(this,"play");var e=exec_cmd_.call(this,"playing","STATE_MAP"),i=exec_cmd_.call(this,"transitioning","STATE_MAP");!e&&"wmp"!=this.type_||"wmp"==this.type_&&i?++this.play_count_<Media.object.MAX_PLAY_COUNT?this.timeout_=WCT.SetTimeout(Media.object.PlayLater,100,Media.object,[this.uid_]):(clear_timeout_.call(this),this.fire_trigger_("error")):(clear_timeout_.call(this),null!=this.state_.volume&&this.Volume(this.state_.volume,!0),this[this.state_.muted?"Mute":"Unmute"](),"quicktime"==this.type_&&this.on_qt_event_("play"))}},Resumable:function(){this.state_.resume=!0},EnableResume:function(){this.state_.resume=!0},Pause:function(){clear_timeout_.call(this),this.state_.stopped=!1;var t=this.Playing();(this.state_.resume=t)&&exec_cmd_.call(this,"pause")},Stop:function(){clear_timeout_.call(this),this.state_&&(this.state_.resume=!1,this.state_.stopped=!0),exec_cmd_.call(this,"stop"),BROWSER.IE&&this.audio_&&"wmp"==this.type_||this.Rewind()},Resume:function(){this.state_.resume&&this.Play()},Rewind:function(){exec_cmd_.call(this,"time",null,0),"quicktime"==this.type_&&this.on_qt_event_("rewind")},Mute:function(){this.state_.muted||(this.state_.muted=!0,exec_cmd_.call(this,"mute",null,"true"),this.fire_trigger_("mute"))},Unmute:function(){this.state_.muted&&(this.state_.muted=!1,exec_cmd_.call(this,"mute",null,"false"),this.fire_trigger_("unmute"))},Playing:function(){return exec_cmd_.call(this,"playing","STATE_MAP")||!1},Paused:function(){return exec_cmd_.call(this,"paused","STATE_MAP")||!1},Stopped:function(){return exec_cmd_.call(this,"stopped","STATE_MAP")||!1},Finished:function(){return exec_cmd_.call(this,"ended","STATE_MAP")||!1},Muted:function(){return this.state_.muted},GetTime:function(){return exec_cmd_.call(this,"time","STATE_MAP")},GetDuration:function(){return exec_cmd_.call(this,"duration","STATE_MAP")},GetDom:function(){return $(this.uid_)||null},Volume:function(){var t=arguments[0];return"number"==typeof t&&(t=Math.min(Math.max(0,t),100),this.state_.volume=t,exec_cmd_.call(this,"volume",null,t),arguments[1]||this.fire_trigger_("volume"),this.state_.muted&&exec_cmd_.call(this,"mute",null,"true")),this.state_.volume},Autostart:function(){var t=arguments[0];return null!=t&&(this.state_.autostart=t),this.state_.autostart},Loop:function(){var t=arguments[0];return null!=t&&this.state_.loop!=t&&(this.state_.loop=t,exec_cmd_.call(this,"loop",null,t)),this.state_.loop},Reset:function(){this.created_=!1,this.verified_=!1,this.state_.source=""},HTML5Sources:function(t){for(var e=[],i=0,o=(t=t||[]).length;i<o;i++){var r=t[i];e.indexOf(r)<0&&e.push(r)}this.all_sources_=e},PlayMedia:function(){if(this.SetType("video"),this.all_sources_.length){for(var t=null;t=this.all_sources_[this.c_src_++];){var e=this.Source(t);if(e){if(t&&"unsupported"!=e){this.Autostart()&&this.Play();break}}else this.SetType("video")}this.c_src_>=this.all_sources_.length&&!this.created_&&this.fire_trigger_("error")}},Source:function(){var t=arguments[0],e=PLATFORM.IOS||PLATFORM.ANDROID||BROWSER.METRO,i=!this.audio_&&e,o=this.audio_&&e;if(null!=t&&this.state_.source!=t){if(this.state_.source=t,this.created_)"quicktime"==this.type_&&Ticker.RegisterJS(this,this.uid_),this.Stop(),exec_cmd_.call(this,"source",null,t);else{if(i&&(this.type_="video"),"video"==this.type_){if("unsupported"==this.determine_plugin_(t))return"unsupported";i="video"==this.type_}if(o||"audio"==this.type_?(this.type_="audio",create_audio_.call(this)):i&&"flash"!=this.type_?create_video_.call(this):create_.call(this),!this.created_)return""}this.state_&&this.state_.autostart?this.Play():this.Stop()}return this.state_&&this.state_.source||""},SetClient:function(t){this.fire_trigger_("client_change",t),this.client_=t},SetPosition:function(t){var e=this.state_;null!=t.w&&(e.w=t.w),null!=t.h&&(e.h=t.h)},SetParams:function(t){var e=this.state_;for(var i in t)switch(i){case"showControls":case"controls":e.showControls=t[i];break;case"loop":case"showStatusBar":case"scale":case"quality":case"wmode":case"noDownload":e[i]=t[i];break;case"playonstart":e.autostart=1===t[i]}},SetDomParent:function(t){this.dom_parent_=t},SetType:function(t){this.type_=t},SetDummyDuration:function(t){this.dummy_.duration=t},Tick:function(t){if("dummy"==this.type_){var e=this.dummy_;"playing"==e.state&&t>=e.duration&&(e.state="stopped",Ticker.UnregisterJS(this.uid_),this.fire_trigger_("finish"))}else if(!--this.tick_){this.tick_=Media.object.IE_QT_TICK_INTERVAL;var i=this.Playing()?"play":this.Finished()?"end":this.Paused()?"pause":null;this.on_qt_event_(i)}},on_qt_event_:function(t){var e=null,i=null;switch(t){case"pause":if(this.GetTime()==this.GetDuration())return;this.state_.stopped?(Ticker.UnregisterJS(this.uid_),e="stopped",i="stop",this.state_.stopped=!1):(e="paused",i="pause");break;case"play":Ticker.RegisterJS(this,this.uid_),e="playing",i="play";break;case"end":if(this.Playing())return;Ticker.UnregisterJS(this.uid_),e="finished",i="finish";break;case"rewind":this.Playing()||(e="stopped",i="stop"),Ticker.RegisterJS(this,this.uid_)}null==this.state_.plugin&&"paused"==e&&(this.state_.plugin=e),this.state_.plugin!=e&&("stopped"==e&&"finished"==this.state_.plugin?this.state_.plugin="stopped":(this.state_.plugin=e,this.fire_trigger_(i)))},on_audio_event_:function(t){var e=this.state_;if("end"==t&&"finished"==e.plugin)e.plugin="stopped";else switch(t){case"end":e.plugin="stopped",this.fire_trigger_("stop");break;case"pause":e.plugin="paused",this.fire_trigger_("pause");break;case"play":e.plugin="playing",this.fire_trigger_("play");break;case"finish":this.state_.loop||(e.plugin="finished",this.fire_trigger_("finish"))}},on_video_event_:function(t){var e=this.state_;if("end"==t&&"finished"==e.plugin)e.plugin="stopped";else switch(t){case"end":e.plugin="stopped",this.fire_trigger_("stop");break;case"pause":e.plugin="paused",this.fire_trigger_("pause");break;case"play":e.plugin="playing",this.fire_trigger_("play");break;case"finish":this.state_.loop||(e.plugin="finished",this.fire_trigger_("finish"));break;case"volumechange":this.fire_trigger_("volume")}},on_wmp_event_:function(t){var e=this.state_;if(1==t&&"finished"==e.plugin)e.plugin="stopped";else switch(t){case 1:e.plugin="stopped",this.fire_trigger_("stop");break;case 2:e.plugin="paused",this.fire_trigger_("pause");break;case 3:e.plugin="playing",this.fire_trigger_("play");break;case 8:this.state_.loop||(e.plugin="finished",this.fire_trigger_("finish"))}},fire_trigger_:function(t){var e=Controls[this.client_];e&&e.on_channel_event_&&e.on_channel_event_(t,arguments[1])},verify_:function(){var t=get_el_.call(this);if(t){var e="dummy"==this.type_?"dummy":get_plugin_type_(t);if(e){if(e!=this.type_)return this.type_=e,create_.call(this),null;for(this.verified_=!0;this.no_veri_stack_[0];){var i=this.no_veri_stack_.shift();exec_cmd_.call(this,i.cmd,i.map,i.param)}}else++this.verify_count_<Media.object.MAX_VERIFY_COUNT?WCT.SetTimeout(Media.object.VerifyLater,50,Media.object,[this.uid_]):(this.type_=null,this.Reset(),this.PlayMedia())}else this.type_=null},determine_plugin_:function(t){var e=WCT.dom.SupportsHtml5Video(),i=t.substr(t.lastIndexOf(".")+1),o=BROWSER.IE?"IE":BROWSER.FIREFOX?"FF":BROWSER.SAFARI?"SAFARI":"",r=Media.object.EXTENSION_MAP[i],n=Media.object.HTML5_VIDEO;return void 0===r?"unsupported":0<e?n[i]||PLATFORM.IOS&&Media.object.HTML5_IOS[i]?"video":BROWSER.MOBILE?"unsupported":(this.type_=r[o],this.type_):n[i]&&"mp4"!=i&&"m4v"!=i?"unsupported":(BROWSER.MOBILE||(this.type_=r[o]),this.type_)}}}(),Media.audio=function(){var a={},l={};function e(t,e,i){for(var o=e||[],r=i||[],n={},s=r.length-1;0<=s;s--)n[r[s]]=!0;for(var a in l){var _=n[a]?null:l[a];_&&_[t]&&_[t].apply(_,o)}}function o(t){if(!BROWSER.MOBILE||Media.audio.MobileConfirmed)return!0;var e={def:{file:"book.txt",play:"pause#0",pause:"pause#1"}};e[AudioControl.TOURSOUND]={file:"lesson.txt",play:"lesson_play",pause:"lesson_pause"},e=e[t]||e.def;var i=LoadFile(Context.ToAbsPath("skin:"+e.file)),o=Controls.page._obj,r=i&&i.mobile_play;if(r){var n={type:"text",text:"",opacity:r.opacity||"75",id:"audio_starter_bg",hidden:!1,z:5e3,background_color:r.background_color||"#cccccc",x:0,y:0,w:o.w,h:o.h};Page.AddControl(n),n={type:"sprite",id:"audio_starter",hidden:!1,z:5001,image:{id:"skin:"+r.image.id},x:(o.w>>1)-(r.w>>1),y:(o.h>>1)-(r.h>>1),w:r.w,h:r.h,offset_left:r.image.x,offset_top:r.image.y,onclick:"page."+e.play+";page.play_Channel#"+t+";audio_starter_bg.hide;page.show_panel;audio_starter.hide;"},Page.AddControl(n),Page.RTFireTrigger("page.hide_panel")}else{n={type:"text",id:"audio_starter",text:"<b> CLICK TO PLAY </b>",font_size:"36pt",valign:"middle",align:"center",opacity:"75",hidden:!1,z:5e3,background_color:"#cccccc",x:0,y:0,w:o.w,h:o.h,onclick:"page."+e.play+";page.play_Channel#"+t+";audio_starter.hide;"};Page.AddControl(n)}return Page.RTFireTrigger("page."+e.pause),!(Media.audio.MobileConfirmed=!0)}return{MobileConfirmed:!1,Cleanup:function(){for(var t in l)l[t]&&l[t].Destructor&&l[t].Destructor(),delete l[t]},FindPlugin:function(){if(PLATFORM.WINDOWS||PLATFORM.MAC){var t=BROWSER.IE,e=BROWSER.EDGE,i=BROWSER.FIREFOX,o=BROWSER.CHROME,r=BROWSER.SAFARI,n=BROWSER.VERSION;if(e||t&&8<n||(i||o||r)&&3<n){var s=arguments[0]||"",a=s?s.substr(s.lastIndexOf(".")+1).toLowerCase():"";if(Media.object.HTML5_AUDIO[a])return"audio"}for(var _=t?"IE":i?"FF":"Other",l={IE:["wmp","quicktime"],FF:"wmp"==(Page.GetConfig("ffmp")||"quicktime").toLowerCase()?["wmp","quicktime"]:["quicktime","wmp"],Other:["quicktime"]}[_],d=0,h=l.length;d<h;d++)if(Media.PluginInstalled(l[d]))return l[d];return t?"wmp":"audio"}return BROWSER.MOBILE?"audio":"quicktime"},GetChannel:function(t){var e=arguments[1]||{},i=l[t];if(i)return e.video_mode&&i.SetDummyDuration(e.duration),i;var o=Media.mixer.Volume(t,100),r=Media.mixer.Mute(t),n=Canvas&&Canvas.Parent&&Canvas.Parent()||null;if(!n)return null;if(i=new Media.object(!0),e.video_mode)i.SetType("dummy"),i.SetDummyDuration(e.duration);else{var s=e.src;a[s]||(a[s]=this.FindPlugin(s)),i.SetType(a[s])}return i.SetPosition({w:1,h:1}),i.SetDomParent(n),i.Volume(o),i.Mute(r),l[t]=i},Autostart:function(t,e){var i=Media.audio.GetChannel(t);return i&&i.Autostart?i.Autostart(e):null},Loop:function(t,e){var i=Media.audio.GetChannel(t);return i&&i.Loop?i.Loop(e):null},Source:function(t){var e=arguments[1],i=arguments[2]||null;null!=e&&""!==e&&i&&!WCT.address.IsExternal(e)&&(e=Context.ToAbsPath(e,i));var o=Media.audio.GetChannel(t);return o&&o.Source?o.Source(e):null},SetClient:function(t,e){var i=Media.audio.GetChannel(t,arguments[2]);i&&i.SetClient&&i.SetClient(e)},EnablePagesoundResume:function(){var t=Media.audio.GetChannel("Pagesound");t&&t.EnableResume()},Play:function(t){var e=Media.audio.GetChannel(t),i=Media.Paused()?"Resumable":"Play";if(e&&e[i]){if(t!=AudioControl.TOURSOUND&&!arguments[2])return e[i](arguments[1]),!0;if(o(t))return e[i](arguments[1]),!0}return!1},Pause:function(t){var e=Media.audio.GetChannel(t);e&&e.Pause&&e.Pause()},Stop:function(t){var e=Media.audio.GetChannel(t);e&&e.Stop&&e.Stop()},Resume:function(t){var e=Media.audio.GetChannel(t);e&&e.Resume&&e.Resume()},Rewind:function(t){var e=Media.audio.GetChannel(t);e&&e.Rewind&&e.Rewind()},Mute:function(t){Media.mixer.Mute(t,!0,arguments[1]),this.RemuteAll()},Unmute:function(t){Media.mixer.Mute(t,!1,arguments[1]),this.RemuteAll()},Remute:function(t){var e=Media.mixer.Mute(t)?"Mute":"Unmute",i=Media.audio.GetChannel(t);i&&i[e]&&i[e]()},Volume:function(t){var e=arguments[1];return"number"==typeof e&&(Media.mixer.Volume(t,e,arguments[2]),this.RevolumeAll()),Media.mixer.Get("volume",t,arguments[2])},PlayAll:function(){e("Play",null,arguments[0]);var t=Controls.page;t&&t._obj.pagesound&&!l.Pagesound&&this.PlayPagesound()},PauseAll:function(){e("Pause",null,arguments[0])},StopAll:function(){e("Stop",null,arguments[0])},ResumeAll:function(){e("Resume",null,arguments[0])},RewindAll:function(){e("Rewind",null,arguments[0])},MuteAll:function(){var t=arguments[0]||[],e=arguments[1],i="boolean"!=typeof arguments[2]||arguments[2];i=i?"Mute":"Unmute";for(var o={},r=t.length-1;0<=r;r--)o[t[r]]=!0;for(var n in l)o[n]||this[i](n,e)},UnmuteAll:function(){this.MuteAll(arguments[0],arguments[1],!1)},RemuteAll:function(){for(var t=arguments[0]||[],e={},i=t.length-1;0<=i;i--)e[t[i]]=!0;for(var o in l)if(!e[o]){var r=Media.mixer.Mute(o)?"Mute":"Unmute",n=Media.audio.GetChannel(o);n&&n[r]&&n[r]()}},VolumeAll:function(t){e("Volume",t,arguments[1])},RevolumeAll:function(){for(var t=arguments[0]||[],e={},i=t.length-1;0<=i;i--)e[t[i]]=!0;for(var o in l)if(!e[o]){var r=Media.mixer.Volume(o),n=Media.audio.GetChannel(o);n&&n.Volume&&n.Volume(r)}},Playing:function(t){var e=Media.audio.GetChannel(t);return e&&e.Playing?e.Playing():null},Paused:function(t){var e=Media.audio.GetChannel(t);return e&&e.Paused?e.Paused():null},Stopped:function(t){var e=Media.audio.GetChannel(t);return e&&e.Stopped?e.Stopped():null},Muted:function(t){var e=Media.audio.GetChannel(t);return e&&e.Muted?e.Muted():null},PlayPagesound:function(){var t=Controls.page;if(t){var e=t._obj.pagesound;if(e){this.SetClient("Pagesound","page",{src:e}),this.Autostart("Pagesound",!1),this.Source("Pagesound",e,t._src_ctx),this.Unmute("Pagesound"),this.Volume("Pagesound",80);var i=Page.IsPaused();!i&&o("Pagesound")&&this.Play("Pagesound"),i&&this.EnablePagesoundResume(),PageCanvas.HandleSubtitle()}}},StopPagesound:function(){this.Stop("Pagesound")},FreeAllChannels:function(){for(var t=arguments[0]||[],e={},i=t.length-1;0<=i;i--)e[t[i]]=!0;for(var o in l){var r=e[o]?null:l[o];r&&(r.Destructor&&r.Destructor(),delete l[o])}}}}(),Media.video=function(){function e(t,e){for(var i in Controls){var o=Controls[i];switch(o._obj.type){case"video":case"flash":case"wmp":case"realplayer":case"quicktime":o.ExecMediaCommand&&o.ExecMediaCommand(t,e)}}}return{Cleanup:function(){},PlayAll:function(){e("Play")},PauseAll:function(){e("Pause")},StopAll:function(){e("Stop")},ResumeAll:function(){e("Resume")},RewindAll:function(){e("Rewind")},MuteAll:function(){e("Mute")},UnmuteAll:function(){e("Unmute")},VolumeAll:function(t){e("Volume",t)}}}(),TextControl.prototype=new RectControl,WCT.ExtendObject(TextControl,{SetTitle:function(t,e,i){this._tctl&&this._tctl.SetTitle(i)},Autosize:function(t,e,i){if(i){var o=this._hdx;o[i]&&o[i].to_dom?o[i].to_dom.call(this,t,i,t[i]):this._update_dom()}},SetDirection:function(t,e,i){this.SetDirection(null)},HideScrollbars:function(){var t=this._tctl;t&&t.HideScrollbars(this._obj.hide_scrollbars||!1)}}),WCT.ExtendObject(TextControl.prototype,{ImagesLoaded:function(){var t=this._obj,e=t?t.autosize:null;TextControl.Autosize.call(this,t,"autosize",e)},doneAutosize:function(t){var e=Page.scrollTop,i=Page.clientHeight,o=Page.GetScale(),r=(e+i-Canvas.y()*o-8-t*o)/o;Page.UpdateControl(this._id,"y",r)},RTFireTrigger:function(t,e){if(RectControl.prototype.RTFireTrigger.apply(this,arguments))return!0;var i=this._obj;switch(t){case"follow_link":this._exec_link();break;case"set_text":TextObject.UpdateFromControl.call(this,i,"text",e[0]);break;case"update_placeholder":"placeholder"==i.type?TextObject.UpdateFromControl.call(this,i,"placeholder_text",i.placeholder_text):TextObject.UpdateFromControl.call(this,i,"text",i.text);break;default:EDIT_MODE&&Editor.RuntimeInfo("no trigger: "+t)}},OnRTMouseDown:function(t){var e=this._obj;if("inputclick"==e.type&&e.disabled)return!(t.hasToBeCancelled=!0);(e.visual_down||e.button)&&(this._mouse_state="down",this._update_visual()),e.ondown&&Page.RTFireTrigger(e.ondown,t)},OnRTMouseUp:function(t){var e=this._obj;if("inputclick"==e.type&&e.disabled)return!(t.hasToBeCancelled=!0);(e.visual_down||e.button)&&(this._mouse_state="over",this._update_visual()),e.onup&&Page.RTFireTrigger(e.onup,t)},OnRTMouseEnter:function(t){var e=this._obj;if("inputclick"==e.type&&e.disabled)return!(t.hasToBeCancelled=!0);(e.visual_over||e.button)&&(this._mouse_state="over",this._update_visual()),e.onenter&&Page.RTFireTrigger(e.onenter,t),this.handle_sim_actions_&&(t.type="enter",this.handle_sim_actions_(t))},OnRTMouseLeave:function(t){var e=this._obj;if("inputclick"==e.type&&e.disabled)return!(t.hasToBeCancelled=!0);this._mouse_state=null,(e.visual_down||e.visual_over||e.button)&&this._update_visual(),e.onleave&&Page.RTFireTrigger(e.onleave,t)},OnRTMouseMove:function(t){var e=this._obj;if("inputclick"==e.type&&e.disabled)return!(t.hasToBeCancelled=!0)},OnRTMouseClick:function(t){var e=this._obj;if("inputclick"==e.type&&e.disabled)return!(t.hasToBeCancelled=!0);e.onclick&&Page.RTFireTrigger(e.onclick,t),this._exec_link(),this.handle_sim_actions_&&this._obj&&(t.type="click",this.handle_sim_actions_(t))},OnRTMouseDblClick:function(t){var e=this._obj;if("inputclick"==e.type&&e.disabled)return!(t.hasToBeCancelled=!0);e.ondblclick&&Page.RTFireTrigger(e.ondblclick,t),this.handle_sim_actions_&&(t.type="dblclick",this.handle_sim_actions_(t))},GetHtmlPosSize:function(t){var e=RectControl.prototype.GetHtmlPosSize.call(this,t);if(1==t&&this._tctl){var i=this._tctl.GetPosSize();e.x+=i.x,e.y+=i.y,e.w=i.w,e.h=i.h}return e},OnDefaultEdit:function(){return Env.edit({ctlId:this._id,paramName:"text",posSize:this.GetHtmlPosSize(1),paramW:"w",paramH:"h",extInfo:this._obj}),!0},SetDirection:function(t){var e=this._obj.direction||(WCT.IsLanguageRTL(t)?"rtl":"");if(this._direction=e,this._tctl){var i=this._obj,o={direction:e};i.align&&(o.align=i.align),this._tctl.SetStyle(o)}},GetWheelAction:function(){var t=this._obj;return-1==t.action.search("wheel_")?null:{action:t.action,alt_key:t.alt_key,ctrl_key:t.ctrl_key,shift_key:t.shift_key}},_create_dom:function(){var t=$$("div");t.id=this._id+"#main#dom",t.className="TextControl",t.style.position="absolute",BROWSER.IE&&t.setAttribute("role","article");var e=this._obj,i="hrefarea"===e.type;(i||e.onclick||e.onleave||e.onenter)&&t.setAttribute("role",i?"link":"button"),Canvas.Parent().appendChild(t);var o=BorderTextObject.Create.call(this,t);if(t.setAttribute("aria-labelledby",o.GetUid()+"#TO#text"),e.image){var r=WCT.DeepCopy(e.image),n=this._src_ctx;e.button?(r.id||r.bg)&&(r.id&&(r.id=Context.ToAbsPath(r.id,n)),r.bg&&(r.bg=Context.ToAbsPath(r.bg,n)),this._tctl.SetButtonMode(r)):(r.bg?r.bg=Context.ToAbsPath(r.bg,n):(r.offsetX=0,r.offsetY=0,r.bg=r.id?Context.ToAbsPath(r.id,n):""),this._tctl.SetTextImage(r))}},_update_dom:function(t){if(!this._disable_dom_update){var e=this._obj,i=t||e;set_x.call(this,e,"x",i.x,!1),set_y.call(this,e,"y",i.y,!1);var o=BorderTextObject.SetControlWH,r=BorderTextObject.SetControlWH,n=this._hdx;if(n&&(n.w&&n.w.to_dom&&(o=n.w.to_dom),n.h&&n.h.to_dom&&(r=n.h.to_dom)),o.call(this,e,"w",i.w,!1),r.call(this,e,"h",i.h,!1),this._update_hit_areas(),!EDIT_MODE&&BROWSER.IE&&!e.hide_scrollbars){var s=this._tctl;s&&(s.HideScrollbars(!0),WCT.SetTimeout(TextControl.HideScrollbars,100,this))}}},_update_visual:function(){var t=this._obj,e=t.background_color||"",i=t.border_color||"",o=t.text_color||"",r=t.x,n=t.y,s=this._mouse_state;s&&("over"==s&&t.visual_over?(t.background_color_over&&(e=t.background_color_over),t.border_color_over&&(i=t.border_color_over),t.text_color_over&&(o=t.text_color_over)):"down"==s&&(t.visual_down&&(t.background_color_down&&(e=t.background_color_down),t.border_color_down&&(i=t.border_color_down),t.text_color_down&&(o=t.text_color_down)),t.button&&(r++,n++))),set_x.call(this,t,"x",r),set_y.call(this,t,"y",n);var a={text_color:o,background_color:e,border_color:i};this._tctl.SetStyle(a)},_rd_get_min_rect:function(t){var e=this._tctl,i=e?e.GetFrameSize():null;return i?{w:i.w,h:i.h}:{w:0,h:0}},_on_set_preview:function(t){var e=this._get_el(),i=this._obj;if(t){e.style.cursor=this._cursor&&!this._link_to?this._cursor:"default";var o="placeholder"===i.type?"placeholder_text":"text";TextObject.UpdateFromControl.call(this,i,o,i[o])}else e.scrollTop=0,this._mouse_state=null;i.marquee&&this._tctl&&this._tctl.EnableMarquee(t)},handle_sim_actions_:function(t){var e=this._obj,i=e.oncorrectanswer,o=e.onwronganswer;if(i||o){1!=t.button&&(t.hasToBeCancelled=!0);var r=this.decide_sim_action_(t);r&&(r.accept&&i?Page.RTFireTrigger(i,this._id):!r.accept&&o&&Page.RTFireTrigger(o,r.msg,this._id))}},decide_sim_action_:function(t){var e=this._obj,i=e.ctrl_key&&t.ctrlKey||!e.ctrl_key&&!t.ctrlKey,o=e.alt_key&&t.altKey||!e.alt_key&&!t.altKey,r=e.shift_key&&t.shiftKey||!e.shift_key&&!t.shiftKey,n=i&&o&&r,s=1==t.button,a=2==t.button,_=3==t.button,l=!0,d=e.action,h=e.action,c=e.action+"1";switch(e.action){case"drag":case"drop":l=s;break;case"lclick":d="click",h="click2",c="click3",l=s;break;case"mclick":d="click",h="click2",c="click3",l=a;break;case"rclick":d="click",h="click2",c="click3",l=_;break;case"ldblclick":h=d="dblclick",c="dblclick1",l=s;break;case"mdblclick":h=d="dblclick",c="dblclick1",l=a;break;case"rdblclick":h=d="dblclick",c="dblclick1",l=_}var p=Dict_get("EXER_FAIL"+h.toUpperCase()),u=[];t.ctrlKey&&u.push(Dict_get("CTRLKEY")),t.altKey&&u.push(Dict_get("ALTKEY")),t.shiftKey&&u.push(Dict_get("SHIFTKEY")),p=p.replace(/@1_keys_/,u.join(", "));var f=Dict_get("EXER_FAIL"+c.toUpperCase()),m=[];return e.ctrl_key&&m.push(Dict_get("CTRLKEY")),e.alt_key&&m.push(Dict_get("ALTKEY")),e.shift_key&&m.push(Dict_get("SHIFTKEY")),f=f.replace(/@1_keys_/,m.join(", ")),d==t.type?n&&l?{accept:!0}:{accept:!1,msg:p+"<br />"+f}:"enter"!=t.type?{accept:!1,msg:Dict_get("EXER_FAIL1")+"<br />"+f}:null}}),MediaControl.prototype=new RectControl,WCT.ExtendObject(MediaControl,{DEFAULT_VOLUME:100,SetInfo:function(t,e){var i=this._get_el(t);if(i)if(e)i.innerHTML=e;else{var o=to_producer_resource_("warning_overlay");i.innerHTML='<img src="'+o+'"/>'}},SetSource:function(t,e,i){MediaControl.SetInfo.call(this,"#main#"+e,i),!EDIT_MODE&&!Editor&&this.media_&&i&&this.media_.Source(Context.ToAbsPath(i))},SetOption:function(t,e,i){var o={loop:"Loop",playonstart:"Autostart",noDownload:"Prevent Download"}[e],r=this._get_el("#main#options");if(o&&r){var n=r.innerHTML,s=n.indexOf(o);(!i&&0<=s||i&&s<0)&&(i?n+=n.length?", "+o:o:n==o?n="":(n=n.substr(0,s)+n.substr(s+o.length),1<s&&","==n.charAt(s-2)?n=n.substr(0,s-2)+n.substr(s):","==n.charAt(0)&&(n=n.substr(2))),r.innerHTML=n)}},CreateDomRow:function(t,e,i){return['<tr style="background-color:#cccccc">','<th style="width:50%;text-align:right;padding:5px">',t,"</th>",'<td style="padding:5px" id="',i,'">',e,"</td>","</tr>"].join("")}}),WCT.ExtendObject(MediaControl.prototype,{Terminate:function(){this.remove_media_(),ctx.onVideoPlay&&ctx.onVideoPlay(this._id,!1),RectControl.prototype.Terminate.call(this)},get_table_:function(t){var e=this._id,i=this._obj,o=MediaControl.CreateDomRow,r=['<div class="wrapper" id="',e,'#main#infoTable" ><TABLE class="se-frame-object">',o("Type",i.type.toFirstUpperCase(),e+"#main#type"),o("Source",i.src,e+"#main#src")];return"video"==i.type&&r.push(o("Alternative Source 1",i.alt_src_1,e+"#main#alt_src_1"),o("Alternative Source 2",i.alt_src_2,e+"#main#alt_src_2")),r.push(o("Options",t,e+"#main#options")),r.join("")+"</TABLE></div>"},_on_set_preview:function(t){var e=this._get_el("#main#infoTable"),i=this._get_el("#main#mediaObj");if(this.remove_media_(),!t)return i.style.display="none",e.style.display="block",void(e.style.display="");if(EDIT_MODE&&Editor&&(e.style.display="none"),!SCREENSHOT_MODE){var o=this._obj;if(!o.hidden){var r="video"==o.type;if(o.src||r&&(o.alt_src_1||o.alt_src_2)){var n=2*(o.border+o.padding),s=Math.max(0,o.w-n),a=Math.max(0,o.h-n),_=null,l=this._src_ctx;r?(_=[],o.src&&_.push(WCT.address.IsExternal(o.src)?o.src:Context.ToAbsPath(o.src,l)),o.alt_src_1&&_.push(WCT.address.IsExternal(o.alt_src_1)?o.alt_src_1:Context.ToAbsPath(o.alt_src_1,l)),o.alt_src_2&&_.push(WCT.address.IsExternal(o.alt_src_2)?o.alt_src_2:Context.ToAbsPath(o.alt_src_2,l))):(_=o.src,WCT.address.IsExternal(_)||(_=Context.ToAbsPath(_,l)));var d=new Media.object;d.SetType(o.type),d.SetClient(this._id),d.SetPosition({w:s,h:a}),d.SetParams(o),d.SetDomParent(i),r?(d.HTML5Sources(_),d.PlayMedia()):d.Source(_),this.media_=d;var h=Media.mixer.Volume("Master",MediaControl.DEFAULT_VOLUME);if(d.Volume(h,!0),i.style.display="block",o.link_to){var c=d.GetDom();c&&WCT.event.Observe("mousedown",rt_hdl_click,c)}}}}},_create_dom:function(){var t=this._id,e=this._obj,i=$$("div");i.id=t+"#main#dom",i.className="MediaControl",i.style.position="absolute",i.style.overflow="hidden",i.style.border=(e.border||0)+"px solid "+(e.border_color||"#0000ff"),i.style.backgroundColor=e.background_color||"#f2f2f2",i.style.verticalAlign="middle",i.style.textAlign="left",i.setAttribute("role","presentation"),i.setAttribute("aria-label",e.name);var o=$$("div");o.style.display="none",o.id=t+"#main#mediaObj",o.style.width="100%",o.style.height="100%";var r=[];e.playonstart&&r.push("Autostart"),e.loop&&r.push("Loop"),EDIT_MODE&&Editor&&(i.innerHTML=this.get_table_(r.join(", "))),i.appendChild(o),Canvas.Parent().appendChild(i)},_remove_dom:function(){this.remove_media_(),RectControl.prototype._remove_dom.call(this)},remove_media_:function(){var t=this.media_;if(t){var e=t.GetDom();e&&WCT.event.StopObserving("mousedown",rt_hdl_click,e),t.Destructor(),this.media_=null}},OnDefaultEdit:function(){return Env.edit({ctlId:this._id,paramName:"src",posSize:this.GetHtmlPosSize(0)}),!0},OnRTMouseClick:function(t){this._obj.onclick&&Page.RTFireTrigger(this._obj.onclick),this._exec_link()},ExecMediaCommand:function(t){var e=this.media_;e&&e[t=t.toFirstUpperCase()]&&e[t](arguments[1])},RTFireTrigger:function(t,e){if(this._get_el()){var i=this._obj,o=null;switch(t){case"play":o=!0;case"pause":case"stop":ctx.onVideoPlay&&ctx.onVideoPlay(this._id,o||!1);case"rewind":this.ExecMediaCommand(t,e);break;case"show":case"fade_in":i.hidden&&(i.hidden=!1,set_hidden.call(this,i,"hidden",i.hidden),this._on_set_preview(!0));break;case"hide":case"fade_out":i.hidden=!0,set_hidden.call(this,i,"hidden",i.hidden),this.ExecMediaCommand("stop"),this.remove_media_();break;case"toggle":case"fade_toggle":this.RTFireTrigger(i.hidden?"show":"hide",e);break;default:EDIT_MODE&&Editor.RuntimeInfo("no trigger: "+t)}}},ShowAfterTransition:function(){var t=Media.mixer.Mute("Master",!1);this.ExecMediaCommand(t?"mute":"unmute"),this._obj.hidden||!this._obj.playonstart||Media.Paused()||this.ExecMediaCommand("play")},DoPlayOnStart:function(){return this._obj.playonstart||!1},on_channel_event_:function(t){var e=this._obj;switch(t){case"play":case"pause":case"stop":case"mute":case"unmute":var i="on"+t;e[i]&&Page.RTFireTrigger(e[i]);break;case"finish":case"error":e.onstop&&Page.RTFireTrigger(e.onstop),e.onfinish&&Page.RTFireTrigger(e.onfinish),ctx.onVideoPlay&&ctx.onVideoPlay(this._id,!1);break;case"volume":e.onvolumechange&&Page.RTFireTrigger(e.onvolumechange)}}}),AudioControl.prototype=new StatusControl,WCT.ExtendObject(AudioControl,{BOOKSOUND:"Booksound",TOURSOUND:"tour_sound",SetSoundchannel:function(t,e,i){if(MediaControl.SetInfo.call(this,"#main#soundchannel",i),EDIT_MODE){var o=Media.audio.GetChannel(i);o&&o.SetClient(this._id)}},ClampVolume:function(t,e){var i=Number(e.val);e.res=isNaN(i)?MediaControl.DEFAULT_VOLUME:Math.min(Math.max(0,i),100)},SetVolume:function(t,e,i){MediaControl.SetInfo.call(this,"#main#volume",i)}}),WCT.ExtendObject(AudioControl.prototype,{OnDefaultEdit:MediaControl.prototype.OnDefaultEdit,Terminate:function(){var t=this._obj.soundchannel;return t!=AudioControl.BOOKSOUND&&t!=AudioControl.TOURSOUND&&this.RTFireTrigger("stop"),StatusControl.prototype.Terminate.call(this)},_on_set_preview:function(t){StatusControl.prototype._on_set_preview.call(this,t);var e=this._obj;if(t){if(e.showOnScreen&&!SCREENSHOT_MODE&&!e.hidden&&e.src){WCT.ExtendObject(this._hdx,{z:{to_dom:set_z,clamp:clamp_z},w:{to_dom:set_w,clamp:clamp_w},h:{to_dom:set_h,clamp:clamp_h},x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y}});var i=this._get_el();i.parentNode.removeChild(i),Canvas.Parent().appendChild(i),i.style.display="";var o=2*(e.border+e.padding),r=Math.max(0,e.w-o),n=Math.max(0,e.h-o),s=this._src_ctx,a=e.src;WCT.address.IsExternal(a)||(a=Context.ToAbsPath(a,s));var _=this._id,l=$$("div");l.id=_+"#main#mediaObj",l.style.width="100%",l.style.height="100%",i.appendChild(l);var d=new Media.object;d.SetType(e.type),d.SetClient(this._id),d.SetPosition({w:r,h:n}),d.SetParams(e),d.SetDomParent(l),d.Source(a),this.media_=d}}else Media.Unmute(),Media.audio.Unmute(e.soundchannel,!0),this.RTFireTrigger("stop")},ExecPlayCommand:function(){var t=this._obj;if(t.src){var e=t.soundchannel;this.has_client_||(Media.audio.SetClient(e,this._id,t),this.has_client_=!0),Media.audio.Source(e,t.src,this._src_ctx),Media.audio.Unmute(e),Media.audio.Volume(e,t.volume),Media.audio.Loop(e,t.loop||!1),Media.audio.Play(e,arguments[0],arguments[1])}},RTFireTrigger:function(t,e){var i=this._obj.soundchannel;switch(t){case"play":if(this.is_playing_)break;e&&e.isArray&&"mobile_confirmed"==e[0]&&(Media.audio.MobileConfirmed=!0,e=null),this.ExecPlayCommand(e);break;case"pause":case"stop":if(!this.has_client_||!this.is_playing_)break;Media.audio[t.toFirstUpperCase()](i,e);break;case"rewind":if(!this.has_client_)break;Media.audio.Rewind(i,e);break;default:EDIT_MODE&&Editor.RuntimeInfo("no trigger: "+t)}},ShowAfterTransition:function(){this._obj.playonstart&&this.ExecPlayCommand(null,!0)},on_channel_event_:function(t){var e=this._obj,i=e.soundchannel,o="on"+t,r=!0;switch(t){case"play":if(this.is_playing_)break;this.is_playing_=!0,ctx.onAudioPlay&&ctx.onAudioPlay(i,!0),e.video_mode&&e.onplay?Page.RTFireTrigger(e.onplay,e.src):e.onplay&&Page.RTFireTrigger(e.onplay);break;case"pause":case"stop":if(!this.is_playing_)break;this.is_playing_=!1,ctx.onAudioPlay&&ctx.onAudioPlay(i,!1),e[o]&&Page.RTFireTrigger(e[o]);break;case"mute":case"unmute":e[o]&&Page.RTFireTrigger(e[o]);break;case"finish":case"error":this.is_playing_=!1,ctx.onAudioPlay&&ctx.onAudioPlay(i,!1),BROWSER.IE&&Media.audio.Source(i,"",this._src_ctx),e.onstop&&Page.RTFireTrigger(e.onstop),e.onfinish&&Page.RTFireTrigger(e.onfinish,e.video_mode?e.src:undefined);break;case"volume":r=!1,e.onvolumechange&&Page.RTFireTrigger(e.onvolumechange);break;case"client_change":r=!1,arguments[1]!=this._id&&(this.RTFireTrigger("stop"),this.has_client_=!1,this.is_playing_=!1,ctx.onAudioPlay&&ctx.onAudioPlay(i,!1),e.onstop&&Page.RTFireTrigger(e.onstop))}r&&this.set_message_(t)}}),Fader.animcount=0,Fader.HIDE_OPACITY=15,Fader.prototype=function(){function m(t,e){var i="_cur_"+t,o="_"+t+"_dir",r=null,n=this[i];e?this[o]&&(r=this[i]!=this[o]?"onstart":"ontick",this[i]=this[o],n=this[o]):this[i]&&((0<=this[i].indexOf("fly_out")||0<=this[i].indexOf("bounce_out")||0<=this[i].indexOf("zoom_out"))&&y.call(this,0),this[i]=null,r="onend");var s=this._callbacks[r];s&&s.f.call(s.s,{type:r,action:n})}function g(t){for(var e=t.length-1;0<=e;e--){var i="_"+t[e]+"_dir";this[i]&&(m.call(this,t[e],!1),this[i]="")}if(!(this._fade_dir||this._fly_x_dir||this._fly_y_dir||this._zoom_dir||this._bounce_dir)){var o=this._target;if(o){var r=this._sub_id[0];o.MoveHome(r),o.Zoom(r,1)}if(--Fader.animcount<=0&&(Canvas.HideScrollbars(),Fader.animcount=0),$(this._target._id+"#overlay")){var n=this._target,s=n?n._get_el():null;s&&(Canvas.Parent().appendChild(s),function a(){var t=$(this._target._id+"#overlay");t&&t.parentNode.removeChild(t)}.call(this))}Ticker.UnregisterJS(this._ticker_id)}}function t(t,e){var i="fly_"+e;g.call(this,[i]);var o=0<=t.indexOf("_out_"),r=i+"_base_",n=i+"_range_",s=this._target.GetBoundaryRect(),a="x"==e?"w":"h",_=this._times;o?(_[r]=s[e],_[n]=Canvas[a]()-s[e]):(_[r]=-s[a],_[n]=s[e]-_[r]),d.call(this),this["_dom_pos_"+e]=0,l.call(this,t,e,i)}function e(t,e){var i="fly_"+e;g.call(this,[i]);var o=0<=t.indexOf("_out_"),r=i+"_base_",n=i+"_range_",s=this._target.GetBoundaryRect(),a="x"==e?"w":"h",_=this._times;o?(_[r]=s[e],_[n]=s[e]+s[a]):(_[r]=Canvas[a](),_[n]=_[r]-s[e]),d.call(this),this["_dom_pos_"+e]=100,l.call(this,t,e,i)}function l(t,e,i){var o=0<=t.indexOf("_out_"),r=this._times;r[i+"_cur_"]=r[i+(o?"_out_time":"_in_time")],this["_"+i+"_dir"]=t,Fader.animcount++;var n=Canvas.Frame(),s=WCT.dom.HasVerticalScrollbar(n),a=WCT.dom.HasHorizontalScrollbar(n);s||a||Canvas.HideScrollbars(!0),this._target.MoveTo(this._sub_id[0],e,r[i+"_base_"]),Ticker.RegisterJS(this,this._ticker_id)}function d(){var t=this._target._get_el(),e=function i(){var t=$(this._target._id+"#overlay");t||((t=$$("div")).id=this._target._id+"#overlay",t.style.position="absolute",t.style.width=Canvas.w()+"px",t.style.height=Canvas.h()+"px",t.style.top=0,t.style.left=0,t.style.overflow="hidden",t.style.backgroundColor="transparent");return Canvas.Parent().appendChild(t),t}.call(this);e&&e.appendChild(t)}function y(t){if(t=Math.max(0,Math.min(t,100)),!0===arguments[1]||this._dom_vis!=t){this._dom_vis=t;for(var e=this._target,i=this._sub_id,o=0,r=null,n=null;r=i[o++];)n=e._get_el(r),-1<r.indexOf("#main#spike")||(set_opacity(n,t),PLATFORM.IOS&&(n.style.zIndex=0===t?0:this._target._obj.z))}}function h(t,e){return 1-e(1-t)}function _(t,e){return e(2*t)/2}function c(t,e,i){var o="x"===e?"w":"h",r=Canvas[e](),n=Canvas[o]();return i?("w"==o?1:-1)*(r+n):t[e]-r-n}var b=function(t,e){var i=this._target;if(i){var o="fly_"+e,r=o+"_base_",n=0<=this["_"+o+"_dir"].indexOf("_out_")?"x"==e?Canvas.w():Canvas.h():i.GetBoundaryRect()[e],s=this._times;t=Math.max(s[r],Math.min(t,n)),this["_dom_pos_"+e]=(t-s[r])/s[o+"_range_"]*100,i.MoveTo(this._sub_id[0],e,t)}},v=function(t,e){var i=this._target;if(i){var o=i.GetBoundaryRect(),r="fly_"+e,n=r+"_base_",s=0<=this["_"+r+"_dir"].indexOf("_out_")?"x"==e?-o.w:-o.h:o[e],a=this._times;t=Math.max(s,Math.min(t,a[n])),this["_dom_pos_"+e]=(a[n]-t)/a[r+"_range_"]*100,i.MoveTo(this._sub_id[0],e,t)}},x={to_in:function(t){var e=this._target;if(e){var i=Math.min(1,t);e.Zoom(this._sub_id[0],i),x.handle_old_ie_.call(this,i),0<i&&this.handle_opac_for_old_ie_&&(this.handle_opac_for_old_ie_=!1,y.call(this,this.opacity_))}},to_out:function(t){var e=this._target;if(e){var i=Math.max(0,t);e.Zoom(this._sub_id[0],i),x.handle_old_ie_.call(this,i)}},handle_old_ie_:function(t){if(BROWSER.IE&&BROWSER.VERSION<9){var e=this._sub_id[0],i=this._target,o=i._get_el(e);if(!o)return;var r=i._obj;if("number"!=typeof r.x||"number"!=typeof r.y||"number"!=typeof r.w||"number"!=typeof r.h)return;var n=r.w,s=r.h,a=n*t,_=s*t;o.style.left=r.x+(n-a>>1)+"px",o.style.top=r.y+(s-_>>1)+"px"}}},w=function(t){var e=this._target;if(e){var i=e.GetBoundaryRect(),o=c(i,"x"),r=c(i,"y"),n=i.x-o,s=i.y-r,a=h(t=Math.max(0,Math.min(1,t)),WCT.Ease.Bounce),_=h(t,WCT.Ease.QuadIn),l=this._sub_id[0];e.MoveTo(l,"y",s*a+r),e.MoveTo(l,"x",n*_+o)}},C=function(t){var e=this._target;if(e){var i=e.GetBoundaryRect(),o=c(i,"x",!0),r=c(i,"y",!0),n=_(t=Math.max(0,Math.min(1,t)),WCT.Ease.Bounce),s=_(t,WCT.Ease.QuadIn),a=this._sub_id[0];e.MoveTo(a,"y",r*n+i.y),e.MoveTo(a,"x",o*s+i.x)}};return{Terminate:function(){for(var t in g.call(this,["fade","fly_x","fly_y","zoom","bounce"]),this._target=null,this._sub_id=null,this._callbacks)this._callbacks[t]&&(this._callbacks[t].f=null,this._callbacks[t].s=null),this._callbacks[t]=null;this._callbacks=null},Refresh:function(){this._dom_vis=100},SetDomVis:function(t){this._dom_vis=t},SetHideOpacity:function(t){this._hid_op=t},GetHideOpacity:function(){return this._hid_op},SetOpacity:function(t){this.opacity_=t},GetOpacity:function(){return this.opacity_},InitPreview:function(){this._dom_vis=this._target._obj.hidden?0:100},ExitPreview:function(){this[this._target._obj.hidden?"Hide":"Show"]()},UnRegisterCallback:function(t){this._callbacks[t]=null},RegisterCallback:function(t,e,i){"undefined"!=typeof this._callbacks[t]&&(this._callbacks[t]={f:e,s:i})},SetTime:function(t,e){this._times[t]=e},ChangeSubId:function(t){this._sub_id=t.isArray?t:[t]},Tick:function(t){var e=this._times,i=1,o=this.opacity_;switch(this._fade_dir){case"fade_out":i=-1,o=0;case"fade_in":var r=0<e.fade_cur_?100*i*t/e.fade_cur_:0,n=Math.min(this.opacity_,e.fade_base_+r);y.call(this,n),this._dom_vis==o?g.call(this,["fade"]):m.call(this,"fade",!0)}var s=1,a=b;switch(this._fly_x_dir){case"fly_in_right":case"fly_out_left":s=-1,a=v;case"fly_in_left":case"fly_out_right":r=0<e.fly_x_cur_?s*e.fly_x_range_*t/e.fly_x_cur_:0;var _=e.fly_x_base_+r;a.call(this,_,"x"),100==this._dom_pos_x?g.call(this,["fly_x"]):m.call(this,"fly_x",!0)}var l=1,d=b;switch(this._fly_y_dir){case"fly_in_bottom":case"fly_out_top":l=-1,d=v;case"fly_in_top":case"fly_out_bottom":r=0<e.fly_y_cur_?l*e.fly_y_range_*t/e.fly_y_cur_:0,_=e.fly_y_base_+r;d.call(this,_,"y"),100==this._dom_pos_y?g.call(this,["fly_y"]):m.call(this,"fly_y",!0)}var h=1,c=x.to_in;switch(e.zoom_base_=e.zoom_in_base_,this._zoom_dir){case"zoom_out":h=-1,c=x.to_out,e.zoom_base_=e.zoom_out_base_;case"zoom_in":r=0<e.zoom_cur_?h*t/e.zoom_cur_:0;var p=e.zoom_base_+r;c.call(this,p),p<=0||1<=p?g.call(this,["zoom"]):m.call(this,"zoom",!0)}var u=w;switch(this._bounce_dir){case"bounce_out":u=C;case"bounce_in":r=0<e.bounce_cur_?1*t/e.bounce_cur_:0;var f=e.bounce_base_+r;u.call(this,f),f<=0||1<=f?g.call(this,["bounce"]):m.call(this,"bounce",!0)}},Hide:function(){g.call(this,["fade","fly_x","fly_y","zoom","bounce"]),this._fade_dir="hide",y.call(this,this._hid_op,!0),m.call(this,"fade",!0),g.call(this,["fade"])},Show:function(){var t=this._hid_op;g.call(this,["fade","fly_x","fly_y","zoom","bounce"]),this._fade_dir="show",y.call(this,t,!0),m.call(this,"fade",!0),g.call(this,["fade"])},FadeOut:function(){var t=this.opacity_;if(g.call(this,["fade"]),0!=this._dom_vis){var e=this._times;e.fade_base_=this._dom_vis,e.fade_cur_=e.fade_out_time*e.fade_base_/t,this._fade_dir="fade_out",Ticker.RegisterJS(this,this._ticker_id)}},FadeIn:function(){var t=this.opacity_;if(g.call(this,["fade"]),this._dom_vis!=t){var e=this._times;e.fade_base_=this._dom_vis,e.fade_cur_=e.fade_in_time*(1-e.fade_base_/t),this._fade_dir="fade_in",Ticker.RegisterJS(this,this._ticker_id)}},FlyOutBottom:function(){t.call(this,"fly_out_bottom","y")},FlyOutRight:function(){t.call(this,"fly_out_right","x")},FlyOutTop:function(){e.call(this,"fly_out_top","y")},FlyOutLeft:function(){e.call(this,"fly_out_left","x")},FlyInBottom:function(){y.call(this,this.GetOpacity()),e.call(this,"fly_in_bottom","y")},FlyInRight:function(){y.call(this,this.GetOpacity()),e.call(this,"fly_in_right","x")},FlyInLeft:function(){y.call(this,this.GetOpacity()),t.call(this,"fly_in_left","x")},FlyInTop:function(){y.call(this,this.GetOpacity()),t.call(this,"fly_in_top","y")},ZoomIn:function(){if(BROWSER.IE&&BROWSER.VERSION<9)this.handle_opac_for_old_ie_=!0;else{var t=this.opacity_;y.call(this,t)}g.call(this,["zoom"]),x.to_in.call(this,0);var e=this._times;e.zoom_cur_=e.zoom_in_time*(1-e.zoom_in_base_),this._zoom_dir="zoom_in",Ticker.RegisterJS(this,this._ticker_id)},ZoomOut:function(){g.call(this,["zoom"]);var t=this._times;t.zoom_cur_=t.zoom_out_time*t.zoom_out_base_,this._zoom_dir="zoom_out",Ticker.RegisterJS(this,this._ticker_id)},BounceIn:function(){g.call(this,["bounce"]);var t=this.opacity_,e=this._target,i=e.GetBoundaryRect(),o=c(i,"x"),r=c(i,"y");e.MoveTo(this._sub_id[0],"y",r),e.MoveTo(this._sub_id[0],"x",o),y.call(this,t);var n=this._times;n.bounce_cur_=n.bounce_in_time*(1-n.bounce_base_),this._bounce_dir="bounce_in",Ticker.RegisterJS(this,this._ticker_id)},BounceOut:function(){g.call(this,["bounce"]);var t=this._times;t.bounce_cur_=t.bounce_out_time*(1-t.bounce_base_),this._bounce_dir="bounce_out",Ticker.RegisterJS(this,this._ticker_id),Fader.animcount++;var e=Canvas.Frame(),i=WCT.dom.HasVerticalScrollbar(e),o=WCT.dom.HasHorizontalScrollbar(e);i||o||Canvas.HideScrollbars(!0)}}}(),TimerControl.prototype=new StatusControl,TimerControl.timeout_sort=function(t,e){return t.to-e.to},WCT.ExtendObject(TimerControl.prototype,{Terminate:function(){this._timeouts=null,StatusControl.prototype.Terminate.call(this)},Tick:function(t){if(this.set_message_((t/1e3).toFixed(2)+" / "+(this._next_time/1e3).toFixed(2)),this._obj.countdown){var e=WCT.TimestampToTimeString(Math.max(0,this._next_time-t+1e3));e=e.substr(0,e.indexOf(".")),Page.RTFireTrigger(this._obj.countdown,[e])}if(this._next_time<=t){for(var i=[],o=this._timeouts,r=o.length;this._next_to<r&&o[this._next_to].to<=t;)i.push(o[this._next_to].ev),this._next_to++;this._next_to<r?this._next_time=o[this._next_to].to:(this.g_timeout_&&this.stop_g_timeout_(),Ticker.Unregister(this._id),delete this._next_time),i.length&&Page.RTFireTrigger(i.join(";"),{time:t,value:t})}},RTFireTrigger:function(t,e){switch(t){case"start":if(this._timeouts){this._next_to=0;var i=this._timeouts[this._next_to].to;this._next_time="${g_quiz_timeout}"==i?this.start_g_timeout_():i,this.Tick(0),null!=this._next_time&&Ticker.Register(this._id)}break;case"stop":this.g_timeout_&&this.stop_g_timeout_(),Ticker.Unregister(this._id),delete this._next_time;break;default:EDIT_MODE&&Editor.RuntimeInfo("No Trigger "+t+" in "+this._obj.name)}},_on_set_preview:function(t){if(StatusControl.prototype._on_set_preview.call(this,t),t){for(var e=this._obj,i=[],o=0;o<8;o++){var r={to:e["time"+o],ev:e["ontimeout"+o]};("${g_quiz_timeout}"==r.to||0<=r.to)&&r.ev&&i.push(r)}i.length&&(i.sort(TimerControl.timeout_sort),this._timeouts=i)}else delete this._timeouts,delete this._next_time},start_g_timeout_:function(){var t=0;return window.ctx&&ctx.getStore&&(t=ctx.getStore("g_quiz_timeout"),this._timeouts[this._next_to].to=t,this.g_timeout_={start:(new Date).getTime(),to:t}),t},stop_g_timeout_:function(){var t=this.g_timeout_.to-((new Date).getTime()-this.g_timeout_.start);ctx.setStore("g_quiz_timeout",0<t?t:0),delete this.g_timeout_}}),CollectorControl.prototype=new StatusControl,CollectorControl.goal_sort=function(t,e){return t.goal-e.goal},WCT.ExtendObject(CollectorControl.prototype,{Terminate:function(){this._goals=null,this._flags=null,StatusControl.prototype.Terminate.call(this)},Count:function(t){if(!(this._next_goal>t)){this._next_goal&&this.set_message_(t+"/"+this._next_goal);for(var e=this._goals,i=e.length;this._next_idx<i&&e[this._next_idx].goal<=t;){var o=e[this._next_idx].ev;if(Page.RTFireTrigger(o,{count:t,value:t}),-1!==o.search(this._id+".reset"))break;this._next_idx++}this._next_idx<i?this._next_goal=e[this._next_idx].goal:delete this._next_goal}},RTFireTrigger:function(t,e){switch(t){case"reset":this._goals&&(this._count=0,this._next_idx=0,this._next_goal=this._goals[this._next_idx].goal),this._flags={},this._obj.onreset&&Page.RTFireTrigger(this._obj.onreset,{});break;case"enable":this._obj.enabled=!0;break;case"disable":this._obj.enabled=!1;break;case"flag_0":case"flag_1":case"flag_2":case"flag_3":case"flag_4":case"flag_5":case"flag_6":case"flag_7":case"flag_8":case"flag_9":if(!this._obj.enabled)return;this._goals&&!this._flags[t]&&(this._flags[t]=!0,this.Count(++this._count));break;default:EDIT_MODE&&Editor.RuntimeInfo("No Trigger "+t+" in "+this._obj.name)}},_on_set_preview:function(t){if(StatusControl.prototype._on_set_preview.call(this,t),t){for(var e=this._obj,i=[],o=0;o<8;o++){var r={goal:e["count"+o],ev:e["oncount"+o]};0<=r.goal&&r.ev&&i.push(r)}i.length&&(i.sort(CollectorControl.goal_sort),this._goals=i,this._count=0,this._next_idx=0,this._next_goal=this._goals[this._next_idx].goal,this._flags={})}else this._goals=null,this._next_goal=null}}),CounterControl.prototype=new CollectorControl,CounterControl.prototype.RTFireTrigger=function(t,e){if("count_up"==t){if(!this._obj.enabled)return;this._goals&&(this._count++,this.Count(this._count))}else CollectorControl.prototype.RTFireTrigger.apply(this,arguments)},SwitchboardControl.prototype=new StatusControl,WCT.ExtendObject(SwitchboardControl.prototype,{activate:function(t){for(var e=this._obj,i=[],o=0;o<10;o++){var r=e["client"+o];if(r){var n=".";Controls[r].IsGroupControl()&&(n+="nondistribute_"),o==t?(r+=e.fadeing?n+"fade_in":".show",i.push("<b>",o,"</b>")):(r+=e.fadeing?n+"fade_out":".hide",i.push(o)),Page.RTFireTrigger(r)}else i.push('<font color="#CCCCCC">',o,"</font>")}this.set_message_(i.join("&nbsp;"))},RTFireTrigger:function(t,e){if(t.indexOf("activate"))EDIT_MODE&&Editor.RuntimeInfo("No Trigger "+t+" in "+this._obj.name);else{var i=Number(t.charAt(8));this.activate(i)}}}),AnimatorControl.prototype=new RectControl,WCT.ExtendObject(AnimatorControl.prototype,{_create_dom:function(){var t=$$("div");t.id=this._id+"#main#dom",t.className="AnimatorControl",t.style.position="absolute",t.style.overflow="hidden",t.style.padding="0px",t.style.textAlign="center",t.style.fontFamily="Courier New",t.style.fontSize="10pt",t.style.backgroundColor="#ECFFFF",Canvas.Parent().appendChild(t)},_rd_get_min_rect:function(t){return{w:0,h:0}},_start_ani:function(){var t=this._obj.target;if(t){var e=this._obj,i=e.duration;if(!("number"!=typeof i||i<1)){var o=Controls[t];if(o){var r=o.GetType(),n=o._obj;if("arrow"===r)this._x0=n.x0,this._x1=n.x1,this._y0=n.y0,this._y1=n.y1,this._x0<this._x1?(this._dx0=e.x-this._x0,this._dx1=e.x+e.w-this._x1):(this._dx1=e.x-this._x1,this._dx0=e.x+e.w-this._x0),this._y0<this._y1?(this._dy0=e.y-this._y0,this._dy1=e.y+e.h-this._y1):(this._dy1=e.y-this._y1,this._dy0=e.y+e.h-this._y0);else if("connector"===r){this._op=WCT.DeepCopy(o.control_points_),this._np=WCT.DeepCopy(this._op);for(var s=o.dim_,a=e.w/s.w,_=e.h/s.h,l=s.x*a,d=s.y*_,h=this._np,c=this._op,p=0,u=h.length;p<u;p++){var f=h[p];f.x*=a,f.y*=_,f.x+=e.x-l,f.y+=e.y-d,f.dx=f.x-c[p].x,f.dy=f.y-c[p].y}}else this._x0=n.x,this._y0=n.y,this._w0=n.w,this._h0=n.h,this._dx=e.x-this._x0,this._dy=e.y-this._y0,this._dw=e.w-this._w0,this._dh=e.h-this._h0;if(this.Ease=WCT.Ease.None,e.ease)switch(e.ease){case"quad_in":this.Ease=WCT.Ease.QuadIn;break;case"quad_out":this.Ease=WCT.Ease.QuadOut;break;case"quad_in_out":this.Ease=WCT.Ease.QuadInOut;break;case"cube_in":this.Ease=WCT.Ease.CubeIn;break;case"cube_out":this.Ease=WCT.Ease.CubeOut;break;case"cube_in_out":this.Ease=WCT.Ease.CubeInOut;break;case"sine_in":this.Ease=WCT.Ease.SineIn;break;case"sine_out":this.Ease=WCT.Ease.SineOut;break;case"sine_in_out":this.Ease=WCT.Ease.SineInOut}}Ticker.Register(this._id),e.onstart&&Page.RTFireTrigger(e.onstart)}}},_stop_ani:function(t){Ticker.Unregister(this._id),this._obj.onstop&&Page.RTFireTrigger(this._obj.onstop),t&&this._obj.onfinish&&Page.RTFireTrigger(this._obj.onfinish)},Tick:function(t){if(this.Ease){var e=this._obj,i=e.duration;if(e.debug)this._get_el().innerHTML=(t/1e3).toFixed(2)+" / "+(i/1e3).toFixed(2);var o=e.target;if(o){var r=Controls[o];if(r){var n=t/i;i<=t&&(n=1),n=this.Ease(n);var s=r.GetType();if("arrow"==s)r.SetParam("x0",this._x0+n*this._dx0),r.SetParam("y0",this._y0+n*this._dy0),r.SetParam("x1",this._x1+n*this._dx1),r.SetParam("y1",this._y1+n*this._dy1);else if("connector"===s){for(var a=[],_=this._np,l=this._op,d=0,h=_.length;d<h;d++){var c=_[d],p=l[d];c.x=p.x+n*c.dx,c.y=p.y+n*c.dy,a.push(parseInt(c.x)),a.push(parseInt(c.y))}r.SetParam("points",a.join(","))}else r.SetParam("x",this._x0+n*this._dx),r.SetParam("y",this._y0+n*this._dy),r.SetParam("w",this._w0+n*this._dw),r.SetParam("h",this._h0+n*this._dh)}}i<=t&&this._stop_ani(!0)}else this._stop_ani(!1)},RTFireTrigger:function(t,e){switch(t){case"start":this._start_ani();break;case"stop":this._stop_ani(!1);break;default:EDIT_MODE&&Editor.RuntimeInfo("No Trigger "+t+" in "+this._obj.name)}},_update_hit_areas:function(){},_on_set_preview:function(t){RectControl.prototype._on_set_preview.call(this,t),t||(this._get_el().innerHTML="")}}),Testomat.prototype=new StatusControl,Testomat.ICON_STYLE='style="vertical-align:middle;margin:0 10px;cursor:pointer"',WCT.ExtendObject(Testomat.prototype,function(){function _(t){if(window.ctx&&ctx.track){var e=this._obj,i=Controls[arguments[1]]||!1,o=i._obj||{},r=!i||e.form_mode||o.branch_mode?{}:o;WCT.ExtendObject(t,{uid:r.macro_uid||e.macro_uid,caption:r.macro_caption||e.macro_caption,cur:Math.max(0,this.points_avail_),max:e.max_points}),r.macro_description?t.description=r.macro_description:e.macro_description&&(t.description=e.macro_description),ctx.track(t)}}function l(t){var e=this._obj;if("boolean"==typeof t.ok&&e.ok_bubble){var i=t.ok?".show":".hide";Page.RTFireTrigger(e.ok_bubble+i)}if("boolean"==typeof t.fail&&e.fail_bubble){i=t.fail?".show":".hide";Page.RTFireTrigger(e.fail_bubble+i)}if("boolean"==typeof t.task&&e.task_bubble){i=t.task?".show":".hide";Page.RTFireTrigger(e.task_bubble+i)}if(e.info_bubble)if("boolean"==typeof t.info){i=t.info?".show":".hide";Page.RTFireTrigger(e.info_bubble+i)}else"string"==typeof t.info&&(Page.RTFireTrigger(e.info_bubble+".set_text",t.info),Page.RTFireTrigger(e.info_bubble+".show"))}function d(t){var e=null!=arguments[1]?arguments[1]:this._obj.help_hl,i=arguments[2]||!1;if(e){if(e=e.split(";").join("."+t+";")+"."+t,Page.RTFireTrigger(e,this._obj.help_effect),"hide"==t||i)return;e=e.split(t).join("flash"),Page.RTFireTrigger(e,this._obj.help_effect||"")}}function h(t){var e=this._obj,i=[],o=[],r={};for(var n in e.form_items)r[n]=1,e.form_items[n]?i.push(n+"_hl"):o.push(n+"_hl");if(t)for(var s=e.help_hl.split(";"),a=s.length-1;0<=a;a--){r[n=s[a].replace(/_hl$/,"")]||o.push(n+"_hl")}d.call(this,"show_wrong",o.join(";"),!0),d.call(this,"show_correct",i.join(";"),!0)}function c(t,e,i){var o,r=this._obj,n=Testomat.ICON_STYLE,s="<p>"+t.replace(/<br\/>/g,"").replace(/\\r|\\n/g,"")+"</p>",a='style="text-decoration:none;color:inherit;margin:1px;display:inline-block;vertical-align:top;',_='style="vertical-align:middle;margin:0 10px;"';return s+='<p style="margin:5px 0 1px"><a role="button" tabindex="1" '+(a+='border:0;background-color:transparent;font-weight:normal;font-style:normal;"')+' href="javascript:void(0);"'+(o=" onclick=\"ctx.cfg_show('trigger!"+r.id+".try_again', null, null)\"")+"><img "+_+' src="skin:tryagain.png" '+n+">"+Dict_get("EXER_TRYAGAIN").replace(/\\r|\\n/g,"")+"</a></p>",s+='<p style="margin:1px 0"><a role="button" tabindex="1" '+a+' href="javascript:void(0);"'+(o=" onclick=\"ctx.cfg_show('trigger!"+r.id+".skip', null, null)\"")+"><img "+_+' src="skin:goon.png" '+n+">"+Dict_get("EXER_GOON").replace(/\\r|\\n/g,"")+"</a></p>",i&&(o=" onclick=\"ctx.cfg_show('trigger!"+r.id+".get_help', null, null)\"",s+='<p style="margin:5px 0 1px">'+Dict_get("EXER_ASK4HELP").replace(/\\r|\\n/g,"")+'</p><p style="margin:1px 0"><a role="button" tabindex="1" '+a+' href="javascript:void(0);"'+o+"><img "+_+' src="skin:help.png" '+n+">"+Dict_get("EXER_SHOWHELP").replace(/\\r|\\n/g,"")+"</a></p>"),e&&(s+='<p style="margin:5px 0 1px">'+e.replace(/<br\/>/g,"").replace(/\\r|\\n/g,"")+"</p>"),s}function p(t){var e;this.finished_=!0;var i=null,o=null;switch(t){case"ok":e="ok_bubble",i=!0;break;case"fail":if(this._obj.await_correct)return void(this.finished_=!1);case"skip":e="fail_bubble",o=!0;break;case"time":e="FALSE";break;default:return}var r=this._obj;r[e]&&!PLATFORM.WINCE?(l.call(this,{ok:i,fail:o,task:!1,info:!1}),Ticker.Register(this._id)):(l.call(this,{ok:!1,fail:!1,task:!1,info:!1}),EventMaster.Unregister(this._id),this.next_?Jumper.Jump(this.next_):r.lesson_continue?Page.RTFireTrigger(r.lesson_continue):EDIT_MODE&&Editor.RuntimeInfo("continue lesson"))}function s(){var t=this._obj.form_items,e=0;for(var i in t)t[i]||e++;return e}function a(t){if(this.active_&&!this.finished_){var e=arguments[1],i=arguments[2],o=!1,r=this._obj;if(r.form_affirmation)"undefined"!=typeof r.form_items[e]&&(o=!(r.form_items[e]=!1));else if(r.form_mode){if("undefined"!=typeof r.form_items[e])return void(r.form_items[e]=!1);"number"==typeof i&&(this.points_avail_-=i-1,o=!0)}if("number"!=typeof i&&(i=1),--this.points_avail_<0)this.points_avail_=0,this.state_="failed",_.call(this,{id:"user_action_goon",auto:!0}),p.call(this,"fail");else{var n;this.state_="wrong",_.call(this,{id:"user_action_wrong_action",error_points:i,error_message:t}),n=r.scorable?r.form_mode&&!r.form_affirmation?Dict_get("EXER_FAIL3").replace(/@1_rest-points_/g,this.points_avail_):Dict_get("EXER_FAIL2").replace(/@1_rest-points_/g,this.points_avail_):Dict_get("EXER_FAIL1");var s=0==this.points_avail_?Dict_get("EXER_WOULDGOON"):null,a=c.call(this,n,s,!0);l.call(this,{info:a}),o&&h.call(this,!1)}}}return{Terminate:function(){EventMaster.Unregister(this._id),StatusControl.prototype.Terminate.call(this)},Tick:function(t){this.set_message_(t.toFixed(2)),t>=this._obj.ok_time&&(Ticker.Unregister(this._id),p.call(this,"time"))},IsActive:function(){return this.active_||!1},GetTargetId:function(){var t=this._obj;return t?t.target_id:""},RTFireTrigger:function(t){var e=arguments[1];switch(t){case"activate":if(this.active_)return;EventMaster.Register(this._id),this.active_=!0,this.state_="active",l.call(this,{task:!0});break;case"deactivate":if(!this.active_)return;EventMaster.Unregister(this._id),this.active_=!1,this.state_="idle";break;case"correct_answer":(function n(t){if(this.active_&&!this.finished_){var e=this._obj;if(e.form_affirmation)if("undefined"!=typeof e.form_items[t])e.form_items[t]=!0;else{for(var i in e.form_items){e.form_items[i]=!0,Page.RTFireTrigger(i+".checkvalue");break}if(0<(o=s.call(this)))return}else if(e.form_mode){if("undefined"!=typeof e.form_items[t])return void(e.form_items[t]=!0);var o;if(0<(o=s.call(this)))return void a.call(this,null,null,o)}this.state_="ok";var r=e["on_"+t];r&&r.isArray&&"undefined"!=typeof arguments[1]&&(r=r[arguments[1]]),this.next_="string"==typeof r?r.replace(/;.*/g,""):null,_.call(this,{id:"user_action_correct_action"},t),d.call(this,"hide"),p.call(this,"ok")}}).call(this,e,arguments[2]);break;case"wrong_answer":this.last_msg_="string"==typeof e?e:null,a.call(this,this.last_msg_,arguments[2]);break;case"demo_help":(function i(){this.active_&&!this.finished_&&(this.state_="failed",this.points_avail_=0,_.call(this,{id:"user_action_help",helptext:""}),_.call(this,{id:"user_action_goon",auto:!0}),p.call(this,"skip"))}).call(this);break;case"get_help":(function o(){if(this.active_){this.state_="help",this.points_avail_=0;var t=this._obj,e=null==this.last_msg_||t.form_mode?t.help_msg:this.last_msg_,i=c.call(this,e,"",!1);l.call(this,{fail:!1,info:i}),t.form_mode?h.call(this,!0):d.call(this,"show_wrong"),_.call(this,{id:"user_action_help",helptext:e})}}).call(this);break;case"try_again":if(!this.active_||this.finished_)return;l.call(this,{info:!1});break;case"skip":(function r(){this.active_&&!this.finished_&&(this.state_="failed",this.points_avail_=0,_.call(this,{id:"user_action_goon",auto:!1}),p.call(this,"skip"))}).call(this);break;case"reset":EventMaster.Register(this._id),this.finished_=!1,this.points_avail_=this._obj.max_points;break;default:EDIT_MODE&&Editor.RuntimeInfo("no trigger: "+t)}},_on_set_preview:function(t){StatusControl.prototype._on_set_preview.call(this,t),this.points_avail_=this._obj.max_points,t?this.finished_=!1:this.state_="inactive"}}}());var CanvasArrow=function(){function create_canvas_(t,e,i){for(var o=t.length,r=[],n=[],s=o-1;0<=s;s--){var a=t[s];r.push(a.x),n.push(a.y)}var _=r.min(),l=r.max(),d=n.min(),h=n.max(),c={nbr_draggers:o,head0:e,head1:i,dim:{x:Math.floor(_),y:Math.floor(d),w:Math.ceil(l-_),h:Math.ceil(h-d)}};for(s=o-1;0<=s;s--){a=t[s];c["d"+s]={x:a.x-_,y:a.y-d}}var p=o-1;for(s=0;s<p;s++){var u=vectors_from_points_(c["d"+s],c["d"+(s+1)]);c["vu"+s]=u.vu,c["vo"+s]=u.vo}return c["vu"+p]=c["vu"+(p-1)],c["vo"+p]=c["vo"+(p-1)],c}function calc_output_dimension_(t){var e=[],i=[];for(var o in t)for(var r=t[o],n=r.length-1;0<=n;n--)if("circles"==o)for(var s=0,a=null;a=r[n].c[s];s++)e.push(r[n].x+a.r),e.push(r[n].x-a.r),i.push(r[n].y+a.r),i.push(r[n].y-a.r);else e.push(r[n].x),i.push(r[n].y);var _=e.min(),l=e.max(),d=i.min(),h=i.max();return{x:Math.floor(_),y:Math.floor(d),w:Math.ceil(l-_),h:Math.ceil(h-d)}}function recalc_canvas_output_(t,e,i){for(var o in t)for(var r=t[o],n=r.length-1;0<=n;n--)r[n].x-=e,r[n].y-=i}function vectors_from_points_(t,e){var i={x:e.x-t.x,y:e.y-t.y},o=Math.sqrt(Math.pow(i.x,2)+Math.pow(i.y,2)),r=0!=o?{x:i.x/o,y:i.y/o}:{x:0,y:0};return{vu:r,vo:{x:-r.y,y:r.x}}}function draw_standard_structure_(t,e){var i=e.length-1;if(0<=i){t.moveTo(e[0].x,e[0].y);for(var o=0;o<i;o++)t.lineTo(e[o].x,e[o].y);t.lineTo(e[0].x,e[0].y)}}function draw_circle_structures_(t,e){for(var i=2*Math.PI,o=0,r=null;r=e[o];o++){t.beginPath();for(var n=0,s=null;s=r.c[n];n++)t.arc(r.x,r.y,s.r,0,i,s.d);t.fill(),t.closePath()}}function draw_line_endpoint_(t,e,i,o,r){var n,s=e.thickness/2,a=t["vo"+i];o?n=t["d"+(i+1)]:(n=t["d"+i],s*=-1);var _=a.x*s,l=a.y*s;r.main.push({x:n.x+_,y:n.y+l})}function draw_line_midpoint_(t,e,i,o,r){var n,s,a,_,l=e.thickness/2,d=t["vo"+i],h=t["vu"+i];o?(n=t["d"+i],s=t["d"+(i+2)],a=t["vo"+(i+1)],_=t["vu"+(i+1)]):(n=t["d"+(i+1)],s=t["d"+(i-1)],a=t["vo"+(i-1)],_=t["vu"+(i-1)],l*=-1);var c={x:n.x+d.x*l,y:n.y+d.y*l},p={x:s.x+a.x*l,y:s.y+a.y*l},u={x:c.x+h.x,y:c.y+h.y},f={x:p.x+_.x,y:p.y+_.y},m=CanvasArrow.calculateIPoint(c,u,p,f);m?r.main.push(m):draw_line_endpoint_.apply(null,arguments)}function draw_line_(t,e,i,o,r){o&&i+2==t.nbr_draggers||!o&&!i?draw_line_endpoint_.apply(null,arguments):draw_line_midpoint_.apply(null,arguments)}function draw_none_(t,e,i,o){var r=t["vo"+i],n=e.thickness/2,s=r.x*n,a=r.y*n,_=t["d"+i],l={x:_.x+s,y:_.y+a},d={x:_.x-s,y:_.y-a};i?o.main.push(d):(o.main.push(d),o.main.push(l))}function draw_standard_(t,e,i,o){var r=t["d"+i],n=t["vu"+i],s=t["vo"+i],a=i?-1:1,_=t[i?"head1":"head0"],l=_.len*a,d=n.x*l,h=n.y*l,c=r.x+d,p=r.y+h,u=_.width/2*a,f=s.x*u,m=s.y*u,g=c+f,y=p+m,b=c-f,v=p-m,x=_.thickness,w=x/2*a,C=s.x*w,T=s.y*w,S={x:g+C,y:y+T},k={x:g-C,y:y-T},E={x:b+C,y:v+T},R={x:b-C,y:v-T},O=vectors_from_points_(r,S),I=vectors_from_points_(r,R),M={x:r.x+O.vu.x*x,y:r.y+O.vu.y*x},D={x:r.x+I.vu.x*x,y:r.y+I.vu.y*x},P={x:r.x+C,y:r.y+T},A={x:r.x-C,y:r.y-T},W={x:c+C,y:p+T},z={x:c-C,y:p-T},j=CanvasArrow.calculateIPoint(k,D,W,P),L=CanvasArrow.calculateIPoint(E,M,z,A);if(j&&L){var H=o.main;H.push(L),H.push(E),H.push(R),H.push(r),H.push(S),H.push(k),H.push(j)}}function draw_triangle_filled_(t,e,i,o){var r=t["vu"+i],n=t["vo"+i],s=i?-1:1,a=t[i?"head1":"head0"],_=a.width/2*s,l=a.len*s,d=e.thickness/2*s,h=n.x*d,c=n.y*d,p=r.x*l,u=r.y*l,f=n.x*_,m=n.y*_,g=t["d"+i],y=g.x+p,b=g.y+u,v={x:y+h,y:b+c},x={x:y-h,y:b-c},w={x:y+f,y:b+m},C={x:y-f,y:b-m};0<i&&o.main.pop();var T=o.main;return T.push(x),T.push(C),T.push(g),T.push(w),T.push(v),{p:g,c1:w,c2:C,vu:r,e:s}}function draw_triangle_(t,e,i,o){var r=draw_triangle_filled_.apply(null,arguments),n=r.p,s=r.c1,a=r.c2,_=r.vu,l=t[i?"head1":"head0"].thickness,d=_.x*l*r.e,h=_.y*l*r.e,c={x:s.x-d,y:s.y-h},p={x:a.x-d,y:a.y-h},u=vectors_from_points_(s,n),f=u.vo.x*l,m=u.vo.y*l,g={x:s.x+f,y:s.y+m},y={x:n.x+f,y:n.y+m},b=vectors_from_points_(n,a),v=b.vo.x*l,x=b.vo.y*l,w={x:a.x+v,y:a.y+x},C={x:n.x+v,y:n.y+x},T=CanvasArrow.calculateIPoint(c,p,g,y),S=CanvasArrow.calculateIPoint(c,p,w,C),k=CanvasArrow.calculateIPoint(g,y,w,C);if(T&&S&&k){var E=o[i?"head1":"head0"];E.push(S),E.push(T),E.push(k),E.push({x:S.x,y:S.y})}}function draw_circle_filled_(t,e,i,o){var r=t["d"+i],n=t["vu"+i],s=t["vo"+i],a=e.thickness/2,_=i?-1:1,l=t[i?"head1":"head0"],d=(l.len-1)*_,h=l.len/2*_,c=s.x*a,p=s.y*a,u=n.x*d,f=n.y*d,m=n.x*h,g=n.y*h,y={x:r.x+c+u,y:r.y+p+f},b={x:r.x-c+u,y:r.y-p+f},v={x:r.x+m,y:r.y+g};i?(o.main.push(y),o.main.push(b)):(o.main.push(b),o.main.push(y)),o.circles.push({x:v.x,y:v.y,c:[{r:Math.abs(h),d:!0}]})}function draw_circle_(t,e,i,o){draw_circle_filled_.call(null,t,e,i,o);var r=t[i?"head1":"head0"];o.circles[o.circles.length-1].c.push({r:Math.abs(r.len/2-r.thickness),d:!1})}function draw_diamond_filled_(t,e,i,o){var r=t["d"+i],n=t["vu"+i],s=t["vo"+i],a=i?-1:1,_=t[i?"head1":"head0"],l=_.len*a,d=l/2,h=_.width/2*a,c=s.x*h,p=s.y*h,u={x:r.x+n.x*l,y:r.y+n.y*l},f=r.x+n.x*d,m=r.y+n.y*d,g={x:f+c,y:m+p},y={x:f-c,y:m-p},b=e.thickness/2*a,v=s.x*b,x=s.y*b,w={x:u.x+v,y:u.y+x},C={x:u.x-v,y:u.y-x},T={x:r.x+v,y:r.y+x},S={x:r.x-v,y:r.y-x},k=CanvasArrow.calculateIPoint(w,T,g,u),E=CanvasArrow.calculateIPoint(C,S,y,u);if(!k||!E)return null;var R=o.main;return R.push(E),R.push(y),R.push(r),R.push(g),R.push(k),{p:r,b:u,e0:g,e1:y}}function draw_diamond_(t,e,i,o){var r=draw_diamond_filled_.apply(null,arguments);if(r){var n=r.p,s=r.b,a=r.e0,_=r.e1,l=t[i?"head1":"head0"],d=vectors_from_points_(s,a),h=vectors_from_points_(s,_),c=l.thickness,p=d.vu.x*c,u=d.vu.y*c,f=h.vu.x*c,m=h.vu.y*c,g={x:s.x+p,y:s.y+u},y={x:s.x+f,y:s.y+m},b={x:a.x-p,y:a.y-u},v={x:a.x+f,y:a.y+m},x={x:_.x+p,y:_.y+u},w={x:_.x-f,y:_.y-m},C={x:n.x-p,y:n.y-u},T={x:n.x-f,y:n.y-m},S=CanvasArrow.calculateIPoint(T,w,C,b),k=CanvasArrow.calculateIPoint(g,x,y,v),E=CanvasArrow.calculateIPoint(C,b,y,v),R=CanvasArrow.calculateIPoint(T,w,g,x);if(S&&k&&E&&R){var O=o[i?"head1":"head0"];O.push(k),O.push(E),O.push(S),O.push(R),O.push({x:k.x,y:k.y})}}}return{DEFAULT_LINE_CAP:"butt",calculateIPoint:function(t,e,i,o){var r=(t.x-e.x)*(i.y-e.y)-(t.y-e.y)*(i.x-e.x),n=(t.y-e.y)*(o.x-i.x)-(t.x-e.x)*(o.y-i.y);if(0==n&&0==r)return{x:t.x,y:t.y};if(0==n)return null;var s=r/n;return{x:i.x+s*(o.x-i.x),y:i.y+s*(o.y-i.y)}},calculateLineIPoint:function(t,e,i,o){var r=this.calculateIPoint(t,e,i,o);if(r){var n=Math.min(t.x,e.x),s=Math.min(t.y,e.y),a=Math.max(t.x,e.x),_=Math.max(t.y,e.y),l=Math.min(i.x,o.x),d=Math.min(i.y,o.y),h=Math.max(i.x,o.x),c=Math.max(i.y,o.y);return n<=r.x&&a>=r.x&&s<=r.y&&_>=r.y&&l<=r.x&&h>=r.x&&d<=r.y&&c>=r.y?r:null}return null},draw:function(){var draggers_=arguments[0],head0_=arguments[1],head1_=arguments[2],object_=arguments[3],pid=arguments[4]||"",cid=arguments[5]||"#main#canvas",d_=this._get_el(pid),c_=this._get_el(cid);if(!d_||!c_||!c_.getContext)return null;var canvas_=create_canvas_(draggers_,head0_,head1_),fn_head0_=eval("draw_"+head0_.type+"_"),fn_head1_=eval("draw_"+head1_.type+"_"),max_=canvas_.nbr_draggers-1,output_={main:[],head0:[],head1:[],circles:[]};if(object_.thickness%2==1)for(var i=canvas_.nbr_draggers-1;0<=i;i--){var p_=canvas_["d"+i];p_.x+=.5,p_.y+=.5}fn_head0_(canvas_,object_,0,output_);for(var i=0;i<max_;i++)draw_line_(canvas_,object_,i,!0,output_);fn_head1_(canvas_,object_,max_,output_);for(var i=max_-1;0<=i;i--)draw_line_(canvas_,object_,i,!1,output_);var dim_=calc_output_dimension_(output_);if(BROWSER.IE&&(8192<dim_.w||8192<dim_.h))return null;recalc_canvas_output_(output_,dim_.x,dim_.y);var ret={x:canvas_.dim.x+dim_.x,y:canvas_.dim.y+dim_.y,w:Math.max(canvas_.dim.w,dim_.w),h:Math.max(canvas_.dim.h,dim_.h),output:output_.main};d_.style.left=ret.x+"px",d_.style.top=ret.y+"px",d_.style.width=ret.w+"px",d_.style.height=ret.h+"px",c_.width=1,c_.width=dim_.w,c_.height=dim_.h,this._cctx||(this._cctx=c_.getContext("2d"));var ctx_=this._cctx;return ctx_.clearRect(0,0,dim_.w,dim_.h),ctx_.closePath(),"transparent"==object_.color?ctx_.globalAlpha=0:(ctx_.globalAlpha=1,ctx_.strokeStyle=object_.color,ctx_.fillStyle=object_.color),ctx_.lineWidth=object_.thickness,ctx_.lineCap=object_.lineCap||CanvasArrow.DEFAULT_LINE_CAP,ctx_.beginPath(),draw_standard_structure_(ctx_,output_.main),draw_standard_structure_(ctx_,output_.head0),draw_standard_structure_(ctx_,output_.head1),ctx_.fill(),ctx_.closePath(),draw_circle_structures_(ctx_,output_.circles),ret}}}();function ArrowControl(){SlideControl.call(this),this._hdx={hidden:{to_dom:set_hidden},locked:{to_dom:set_locked},z:{to_dom:set_z,clamp:clamp_z},x0:{to_dom:ArrowControl.set,clamp:ArrowControl.clamp_x},y0:{to_dom:ArrowControl.set,clamp:ArrowControl.clamp_y},x1:{to_dom:ArrowControl.set,clamp:ArrowControl.clamp_x},y1:{to_dom:ArrowControl.set,clamp:ArrowControl.clamp_y},l0:{to_dom:ArrowControl.set,clamp:ArrowControl.clamp_l},w0:{to_dom:ArrowControl.set,clamp:ArrowControl.clamp_w},l1:{to_dom:ArrowControl.set,clamp:ArrowControl.clamp_l},w1:{to_dom:ArrowControl.set,clamp:ArrowControl.clamp_w},thickness:{clamp:ArrowControl.clamp_thickness},trigger_error_on_use:{to_dom:set_trigger_error_on_use},fade_in_time:{to_dom:set_fade_time,clamp:clamp_time},fade_out_time:{to_dom:set_fade_time,clamp:clamp_time},opacity:{to_dom:set_ctrl_opacity,clamp:clamp_ctrl_opacity},tabindex:{to_dom:ArrowControl.setTabIndex,clamp:clampTabIndex}},this._cctx=null,this.dim_=null,this._fader=new Fader(this,"#main#dom")}function ConnectorControl(){ArrowControl.call(this),this._hdx={hidden:{to_dom:set_hidden},locked:{to_dom:set_locked},z:{to_dom:set_z,clamp:clamp_z},points:{to_dom:ConnectorControl.set,clamp:ConnectorControl.clamp_points},thickness:{clamp:ArrowControl.clamp_thickness},trigger_error_on_use:{to_dom:set_trigger_error_on_use},fade_in_time:{to_dom:set_fade_time,clamp:clamp_time},fade_out_time:{to_dom:set_fade_time,clamp:clamp_time},opacity:{to_dom:set_ctrl_opacity,clamp:clamp_ctrl_opacity},tabindex:{to_dom:ConnectorControl.setTabIndex,clamp:clampTabIndex}},this._fader=new Fader(this,"#main#dom"),this.control_points_=[]}function CanvasControl(){RectControl.call(this),this._hdx={font_family:{to_dom:TextObject.UpdateFromControl,clamp:clamp_font_family},font_size:{to_dom:TextObject.UpdateFromControl,clamp:clamp_font_size},text_color:{to_dom:TextObject.UpdateFromControl,clamp:clamp_color},text:{to_dom:TextObject.UpdateFromControl},align:{to_dom:TextObject.UpdateFromControl},valign:{to_dom:TextObject.UpdateFromControl},tooltip:{to_dom:set_tooltip},href:{to_dom:RectControl.SetLink},hidden:{to_dom:set_hidden},trigger_error_on_use:{to_dom:set_trigger_error_on_use},background_color:{to_dom:set_background_color,clamp:clamp_color},arrow_color:{clamp:clamp_color},border_color:{clamp:clamp_color},shape_color2:{clamp:clamp_color},border_color2:{clamp:clamp_color},text_color_over:{to_dom:noop,clamp:clamp_color},shape_color_over:{to_dom:noop,clamp:clamp_color},shape_color2_over:{to_dom:noop,clamp:clamp_color},border_color_over:{to_dom:noop,clamp:clamp_color},border_color2_over:{to_dom:noop,clamp:clamp_color},text_color_down:{to_dom:noop,clamp:clamp_color},shape_color_down:{to_dom:noop,clamp:clamp_color},shape_color2_down:{to_dom:noop,clamp:clamp_color},border_color_down:{to_dom:noop,clamp:clamp_color},border_color2_down:{to_dom:noop,clamp:clamp_color},bold:{to_dom:TextObject.UpdateFromControl,clamp:clamp_boolean},italic:{to_dom:TextObject.UpdateFromControl,clamp:clamp_boolean},underline:{to_dom:TextObject.UpdateFromControl,clamp:clamp_boolean},border:{clamp:clamp_border},thickness:{clamp:CanvasControl.ClampThickness},white_space:{to_dom:TextObject.UpdateFromControl},padding:{to_dom:TextObject.UpdateFromControl,clamp:clamp_padding},padding_l:{to_dom:TextObject.UpdateFromControl,clamp:clamp_padding},padding_r:{to_dom:TextObject.UpdateFromControl,clamp:clamp_padding},padding_t:{to_dom:TextObject.UpdateFromControl,clamp:clamp_padding},padding_b:{to_dom:TextObject.UpdateFromControl,clamp:clamp_padding},autosize:{to_dom:TextControl.Autosize},selectable:{to_dom:TextObject.UpdateFromControl,clamp:clamp_boolean},fade_in_time:{to_dom:set_fade_time,clamp:clamp_time},fade_out_time:{to_dom:set_fade_time,clamp:clamp_time},x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},w:{to_dom:CanvasControl.SetWH,clamp:clamp_floor_w},h:{to_dom:CanvasControl.SetWH,clamp:clamp_floor_h},z:{to_dom:set_z,clamp:clamp_z},opacity:{to_dom:set_ctrl_opacity,clamp:clamp_ctrl_opacity},tabindex:{to_dom:CanvasControl.setTabIndex,clamp:clampTabIndex},locked:{to_dom:set_locked}},SlideControl.ExtendHdx(this._hdx),this._fader=new Fader(this,"#main#dom")}function Shape(){this.points_=null,this.points_a_=null,this.textrect_=null,this.params_=null,this.hitpos_={},this.hitmap_=null}function XRuler(){SlideControl.call(this),this._hdx={x:{clamp:XRuler.clamp_ruler,to_dom:XRuler.set_ruler}},this.isRuler=!0}function YRuler(){SlideControl.call(this),this._hdx={y:{clamp:XRuler.clamp_ruler,to_dom:XRuler.set_ruler}},this.isRuler=!0}function ImageLink(){RectControl.call(this),this._hdx={image:{to_dom:ImageLink.SetImage},link_to:{to_dom:ImageLink.SetLink},tooltip:{to_dom:set_tooltip},x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},z:{to_dom:set_z,clamp:clamp_z},hidden:{to_dom:set_hidden},locked:{to_dom:set_locked},trigger_error_on_use:{to_dom:set_trigger_error_on_use},shadow_show:{to_dom:ImageControl.SetShadow},shadow_color:{to_dom:ImageControl.SetShadow,clamp:clamp_color},shadow_trans:{to_dom:ImageControl.SetShadow,clamp:clamp_trans},shadow_blur:{to_dom:ImageControl.SetShadow},shadow_spread:{to_dom:ImageControl.SetShadow},shadow_h:{to_dom:ImageControl.SetShadow},shadow_v:{to_dom:ImageControl.SetShadow},fade_in_time:{to_dom:set_fade_time,clamp:clamp_time},fade_out_time:{to_dom:set_fade_time,clamp:clamp_time},opacity:{to_dom:ImageControl.SetOpacity,clamp:clamp_ctrl_opacity},tabindex:{to_dom:setTabIndex,clamp:clampTabIndex}},this._fader=new Fader(this,"#main#dom"),this._link_type=null}function PageCanvas(){SlideControl.call(this),this._hdx={w:{clamp:PageCanvas.clamp_w,to_dom:PageCanvas.set_wh},h:{clamp:PageCanvas.clamp_h,to_dom:PageCanvas.set_wh},background_color:{clamp:clamp_color,to_dom:PageCanvas.set_bg},background_image:{to_dom:PageCanvas.set_frame_image},canvas_color:{clamp:clamp_color,to_dom:PageCanvas.set_canvas_color},border:{clamp:PageCanvas.clamp_border,to_dom:PageCanvas.prototype.set_border},border_color:{clamp:clamp_color,to_dom:PageCanvas.set_border_color},border_style:{clamp:PageCanvas.clamp_border_style,to_dom:PageCanvas.set_border_style},background_image_centered:{to_dom:PageCanvas.set_center_bg,clamp:clamp_boolean},image:{to_dom:PageCanvas.prototype.set_bg_image},show_toc:{to_dom:PageCanvas.show_toc},skin:{to_dom:PageCanvas.set_skin},show_arrows:{to_dom:PageCanvas.prototype.set_show_arrows},hide_scrollbars:{to_dom:PageCanvas.prototype.HideScrollbars},status_position:{to_dom:PageCanvas.SetStatusPosition},tabindex:{to_dom:PageCanvas.setTabIndex,clamp:clampTabIndex},template:{to_dom:PageCanvas.SetTemplate},pagesound_audio_tts_text:{to_dom:PageCanvas.SetTTSText},shadow_show:{to_dom:PageCanvas.SetShadow,clamp:clamp_boolean},shadow_color:{to_dom:PageCanvas.SetShadow,clamp:clamp_color},shadow_trans:{to_dom:PageCanvas.SetShadow,clamp:clamp_trans},shadow_blur:{to_dom:PageCanvas.SetShadow},shadow_spread:{to_dom:PageCanvas.SetShadow},shadow_h:{to_dom:PageCanvas.SetShadow},shadow_v:{to_dom:PageCanvas.SetShadow}},this.base_obj_=null,this.parent_obj_=null,this.frame_obj_=null,this.status_obj_=null,this.skin_=null,this.toc_=null,this.frame_w_=100,this.frame_h_=100,this.can_x_=-1,this.can_y_=-1,this.can_w_=0,this.can_h_=0,this.scrollbar_w_=null,this.scrollbar_h_=null,this.sta_x_=-1,this.sta_y_=-1,this.sta_w_=0,this.sta_h_=0,this.sta_org_h_=0,this.sta_ctls_in_line_=0,this.dspace_=0,this.status_position_="top"}function Dragger(t,e,i){this._parent=t,this._id=e,this._sub_id=i,this._preview=!1,this._selected=!1,this._readonly=!1,this._active=!1,this._locked=!1,this._visible=!0}function RectDragger(t,e,i){Dragger.apply(this,arguments),this._rect={x:10,y:10,w:100,h:50,r:0,z:0},this._orig_rect={},this._parent=t,this._handles_visible=null,this.lim_={w:!1,h:!1}}function ConstRectDragger(t,e,i){Dragger.apply(this,arguments),this._rect={x:10,y:10,w:100,h:50,z:0},this._orig_rect={}}function StatusDragger(t,e,i){Dragger.apply(this,arguments),this._rect={x:0,y:0,w:40,h:40,z:0},this._orig_rect={},this.status_dragger_=!0}function LineDragger(t,e,i){Dragger.apply(this,arguments),this._line=[{x:10,y:10},{x:20,y:20}],this._parent=t,this._my=LineDragger}function PolyLineDragger(t,e,i){LineDragger.apply(this,arguments),this._my=PolyLineDragger,this._segments=["h"]}function XRDragger(t,e,i){Dragger.apply(this,arguments)}function YRDragger(t,e,i){Dragger.apply(this,arguments)}function BubbleDragger(t,e,i){RectDragger.apply(this,arguments),this._rect={x:10,y:10,w:100,h:50,r:0,z:0,offset:{x:0,y:0},spikeOffset:{x:0,y:0},orientation:"C"},this._last_orientation="",this._orig_rect={},this._parent=t,this.disable_write_values=!0,this.dragging=!1,this.changingOrientation=!1}function HotSpotDragger(t,e,i){RectDragger.apply(this,arguments),this._rect="hotspot"==i?{x:50,y:50,w:100,h:100,r:0,z:0}:{x:10,y:10,w:200,h:200,r:0,z:0},this._orig_rect={},this._parent=t,this._handles_visible=null,this.hotspotquiz=!0,this.pos_drg_="",this.orig_ctl_pos_={},this.orig_img_data_={}}function GroupDragger(t,e,i){Dragger.apply(this,arguments),this._rect={x:10,y:10,w:100,h:50,z:0},this._orig_rect={}}function TextBox(){SlideControl.call(this),this._hdx={x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},z:{to_dom:TextBox.SetZ,clamp:clamp_z},hidden:{to_dom:TextBox.SetHidden},locked:{to_dom:set_locked},image:{to_dom:ImageLink.SetImage},tooltip:{to_dom:set_tooltip},font_family:{to_dom:TextObject.UpdateFromControl,clamp:clamp_font_family},font_size:{to_dom:TextObject.UpdateFromControl,clamp:clamp_font_size},text_color:{to_dom:TextObject.UpdateFromControl,clamp:clamp_color},text:{to_dom:TextObject.UpdateFromControl},bold:{to_dom:TextObject.UpdateFromControl,clamp:clamp_boolean},italic:{to_dom:TextObject.UpdateFromControl,clamp:clamp_boolean},underline:{to_dom:TextObject.UpdateFromControl,clamp:clamp_boolean},align:{to_dom:TextObject.UpdateFromControl},valign:{to_dom:TextObject.UpdateFromControl},hide_scrollbars:{to_dom:TextObject.UpdateFromControl},background_color:{to_dom:TextObject.UpdateFromControl,clamp:clamp_color},shadow_show:{to_dom:ImageControl.SetShadow},shadow_color:{to_dom:ImageControl.SetShadow,clamp:clamp_color},shadow_trans:{to_dom:ImageControl.SetShadow,clamp:clamp_trans},shadow_blur:{to_dom:ImageControl.SetShadow},shadow_spread:{to_dom:ImageControl.SetShadow},shadow_h:{to_dom:ImageControl.SetShadow},shadow_v:{to_dom:ImageControl.SetShadow},box_shadow_show:{to_dom:TextBox.SetShadow},box_shadow_color:{to_dom:TextBox.SetShadow,clamp:clamp_color},box_shadow_trans:{to_dom:TextBox.SetShadow,clamp:clamp_trans},box_shadow_blur:{to_dom:TextBox.SetShadow},box_shadow_spread:{to_dom:TextBox.SetShadow},box_shadow_h:{to_dom:TextBox.SetShadow},box_shadow_v:{to_dom:TextBox.SetShadow},border_color:{to_dom:TextObject.UpdateFromControl,clamp:clamp_color},border:{to_dom:TextObject.UpdateFromControl,clamp:TextBox.ClampBorder},border_t:{to_dom:TextObject.UpdateFromControl,clamp:TextBox.ClampBorder},border_r:{to_dom:TextObject.UpdateFromControl,clamp:TextBox.ClampBorder},border_b:{to_dom:TextObject.UpdateFromControl,clamp:TextBox.ClampBorder},border_l:{to_dom:TextObject.UpdateFromControl,clamp:TextBox.ClampBorder},padding:{to_dom:TextObject.UpdateFromControl,clamp:TextBox.ClampPadding},padding_t:{to_dom:TextObject.UpdateFromControl,clamp:TextBox.ClampPadding},padding_r:{to_dom:TextObject.UpdateFromControl,clamp:TextBox.ClampPadding},padding_b:{to_dom:TextObject.UpdateFromControl,clamp:TextBox.ClampPadding},padding_l:{to_dom:TextObject.UpdateFromControl,clamp:TextBox.ClampPadding},border_style:{to_dom:TextBox.SetBorderStyle},textBoxX:{to_dom:TextBox.SetPopupXY,clamp:TextBox.ClampPopupXY},textBoxY:{to_dom:TextBox.SetPopupXY,clamp:TextBox.ClampPopupXY},textBoxW:{to_dom:BorderTextObject.SetControlWH,clamp:BorderTextObject.ClampControlWH},textBoxH:{to_dom:BorderTextObject.SetControlWH,clamp:BorderTextObject.ClampControlWH},textBoxZ:{to_dom:TextBox.SetPopupZ,clamp:clamp_z},textBox_title:{to_dom:TextControl.SetTitle},textBox_type:{to_dom:TextBox.SetPopupType},trigger_error_on_use:{to_dom:set_trigger_error_on_use},opacity:{to_dom:TextBox.SetOpacity,clamp:clamp_ctrl_opacity},popup_opacity:{to_dom:TextBox.SetPopupOpacity,clamp:clamp_ctrl_opacity},hide_textbox_in_editor:{to_dom:TextBox.HidePopup},tabindex:{to_dom:setTabIndex,clamp:clampTabIndex}},this._cursor="pointer",this._link_type=null,this.popup_open_=!1,this._box_shadow="",this.in_move_=!1,this.drag_sel_=null,this.start_x_=null,this.start_y_=null,this.start_cx_=null,this.start_cy_=null,this._fader=new Fader(this,"#main#dom"),this._popupFader=new Fader(this,"#popup#dom")}function Bubble(){RectControl.call(this),this._waitForTransition=!0,this._hdx={text:{to_dom:Bubble.SetText},title:{to_dom:Bubble.UpdateDom},z:{to_dom:Bubble.SetZ,clamp:clamp_z},w:{to_dom:Bubble.UpdateDom,clamp:clamp_bubble_wh},h:{to_dom:Bubble.UpdateDom,clamp:clamp_bubble_wh},x:{to_dom:Bubble.UpdateDom,clamp:clamp_bubble_x},y:{to_dom:Bubble.UpdateDom,clamp:clamp_bubble_y},bubblestyle:{to_dom:Bubble.SetStyle},orientation:{to_dom:Bubble.SetOrientation},movable:{to_dom:Bubble.UpdateDom},closable:{to_dom:Bubble.UpdateDom},hidden:{to_dom:Bubble.SetHidden},fadeing:{clamp:clamp_boolean},fade_in_time:{to_dom:set_fade_time,clamp:clamp_time},fade_out_time:{to_dom:set_fade_time,clamp:clamp_time},opacity:{to_dom:ImageControl.SetOpacity,clamp:clamp_ctrl_opacity},tabindex:{to_dom:setTabIndex,clamp:clampTabIndex}},this._styleParams={},this.movable=!1,this.closable=!1,this.flag_iframe_created_=!1,this.changingOrientation_=!1,this.settingOrientation_=!1,this.move_trigger_fired_=!1,this.anti_flicker_=!1,this.buffer_added_=!1,this.txt_buffer_=4,this._preventWidthChange=!1,this.auto_size_=!1,this.controlValuesSet_=!1,this.orientation="c",this.TimeoutID=0,this._fader=new Fader(this,"#main#dom")}ArrowControl.prototype=new SlideControl,WCT.ExtendObject(ArrowControl,{MIN_L:2,MAX_L:20,MIN_W:2,MAX_W:20,set:function(t,e,i){var o=this._draggers;this._update_dom(),o&&o.main&&o.main.UpdatePos()},setTabIndex:function(t,e,i){if(t.onclick||t.onleave||t.onenter){var o=this._get_el();o&&(o.tabIndex=t.tabindex,o.setAttribute("role","button"))}},clamp_x:function(t,e){var i=Canvas.w(),o=Math.max(e.val,t[{x0:"x1",x1:"x0"}[e.name]]);i<o&&(e.res=e.val+(i-o)),e.res=Math.max(0,e.res)},clamp_y:function(t,e){var i=Canvas.h(),o=Math.max(e.val,t[{y0:"y1",y1:"y0"}[e.name]]);i<o&&(e.res=e.val+(i-o)),e.res=Math.max(0,e.res)},clamp_l:function(t,e){e.res=Math.min(Math.max(ArrowControl.MIN_L,e.val-0),ArrowControl.MAX_L)},clamp_w:function(t,e){e.res=Math.min(Math.max(ArrowControl.MIN_W,e.val-0),ArrowControl.MAX_W)},clamp_thickness:function(t,e){e.res=Math.max(1,Math.min(e.val-0,30))}}),WCT.ExtendObject(ArrowControl.prototype,{MoveTo:RectControl.prototype.MoveTo,Zoom:RectControl.prototype.Zoom,RTFireTrigger:TextControl.prototype.RTFireTrigger,HandleFaderEnd:RectControl.prototype.HandleFaderEnd,Terminate:function(){this._cctx=null,this.dim_=null,SlideControl.prototype.Terminate.call(this)},SetDirection:function(t){},InitEdit:function(){var t=new LineDragger(this,this._id,"main");(this._draggers.main=t).Init(2),t.UpdatePos()},GetBoundaryRect:function(){var t=this.dim_;return t?{x:t.x,y:t.y,w:t.w,h:t.h,z:this._obj.z}:null},MoveHome:function(){var t=this._get_el(arguments[0]),e=this.dim_;t&&e&&(t.style.left=e.x+"px",t.style.top=e.y+"px")},_create_dom:function(){var t=$$("div");t.id=this._id+"#main#dom",t.style.backgroundColor="transparent",t.className="ArrowControl",t.setAttribute("role","presentation"),t.style.position="absolute",t.style.overflow="visible";var e=$$("canvas");e.id=this._id+"#main#canvas",e.style.position="absolute",e.style.backgroundColor="transparent",e.style.overflow="hidden",e.width=1280,e.height=1280,t.appendChild(e),Canvas.Parent().appendChild(t),this._cctx=e.getContext("2d")},_update_line:function(t,e){e&&this._update_dom(e)},_update_dom:function(t){if(!this._disable_dom_update){var e=this._obj;"number"!=typeof e.x0&&(e.x0=0),"number"!=typeof e.y0&&(e.y0=0),"number"!=typeof e.x1&&(e.x1=0),"number"!=typeof e.y1&&(e.y1=0),"number"!=typeof e.l0&&(e.l0=ArrowControl.MIN_L),"number"!=typeof e.w0&&(e.w0=ArrowControl.MIN_W),"number"!=typeof e.l1&&(e.l1=ArrowControl.MIN_L),"number"!=typeof e.w1&&(e.w1=ArrowControl.MIN_W);var i={x:e.x0,y:e.y0},o={x:e.x1,y:e.y1};t&&(i={x:t[0].x,y:t[0].y},o={x:t[1].x,y:t[1].y});var r={len:e.thickness*e.l0,width:e.thickness*e.w0,thickness:e.thickness,type:e.head0},n={len:e.thickness*e.l1,width:e.thickness*e.w1,thickness:e.thickness,type:e.head1},s=Math.max(("none"!=e.head0?1:0)+("none"!=e.head1?1:0),1),a=Math.sqrt(Math.pow(o.x-i.x,2)+Math.pow(o.y-i.y,2))/s-2;r.len<=a||(r.len=a),n.len<=a||(n.len=a),this.dim_=CanvasArrow.draw.call(this,[i,o],r,n,e),this._update_hit_areas()}},_on_set_preview:function(t){var e=this._get_el(),i=this._get_el("#main#canvas");t?(e.style.pointerEvents="none",i.style.pointerEvents="none"):(e.style.pointerEvents="auto",i.style.pointerEvents="auto")},_update_hit_areas:function(){if(HitManager.clearHitControl(this._id),!this.isHidden()&&this.dim_&&this.dim_.output){for(var t=[],e=this.dim_.x,i=this.dim_.y,o=0,r=null;r=this.dim_.output[o++];)t.push({x:r.x+e,y:r.y+i});HitManager.setHitArea({shape:t,type:"poly",ctl_id:this._id,sub_id:"main",hdl_id:"dom",cursor:"default",z:this._obj.z})}},OnRTMouseClick:function(t){var e=this._obj;e.onclick&&Page.RTFireTrigger(e.onclick,t)},OnRTMouseEnter:function(t){var e=this._obj;e.onenter&&Page.RTFireTrigger(e.onenter,t)},OnRTMouseLeave:function(t){var e=this._obj;e.onleave&&Page.RTFireTrigger(e.onleave,t)},OnDefaultEdit:function(){return Env.edit({ctlId:this._id,paramName:"color",posSize:this.GetHtmlPosSize(0)}),!0}}),ConnectorControl.prototype=new ArrowControl,ConnectorControl.clamp_points=function(t,e){for(var i=e.res.split(","),o=[],r=0,n=0,s=Canvas.w(),a=Canvas.h(),_=0,l=0,d=i.length;l<d;_++)o[_]={x:parseInt(i[l++]),y:parseInt(i[l++])},r=Math.max(o[_].x,r),n=Math.max(o[_].y,n);var h=s<r?s-r:0,c=a<n?a-n:0;if(h||c){var p=o.length,u=[];for(_=0;_<p;_++){var f=o[_];u.push(f.x+h,f.y+c)}e.res=u.join(",")}},ConnectorControl.set=function(t,e,i){this._update_dom();var o=this._draggers?this._draggers.main:null;if(o){var r=this.control_points_.length;if(r!=o._line.length){var n=o._selected;o.Destroy(),(o=new PolyLineDragger(this,this._id,"main")).Init(r),n&&o.SetSelected(this._id+"#main"),this._draggers.main=o}o.UpdatePos()}},ConnectorControl.setTabIndex=function(t,e,i){(t.onclick||t.onleave||t.onenter)&&setTabIndex.apply(this,arguments)},WCT.ExtendObject(ConnectorControl.prototype,{Terminate:function(){this.control_points_=null,ArrowControl.prototype.Terminate.call(this)},InitEdit:function(){var t=new PolyLineDragger(this,this._id,"main");(this._draggers.main=t).Init(this.control_points_.length),t.UpdatePos()},_create_dom:function(){var t=$$("div");t.id=this._id+"#main#dom",t.style.backgroundColor="transparent",t.className="ConnectorControl",t.setAttribute("role","presentation"),t.style.position="absolute",t.style.overflow="visible";var e=this._obj;(e.onclick||e.onleave||e.onenter)&&t.setAttribute("role","button");var i=$$("canvas");i.id=this._id+"#main#canvas",i.style.position="absolute",i.style.backgroundColor="transparent",i.style.overflow="hidden";var o=this.control_points_;o.length||(this.obj_2_control_points_(),o=this.control_points_);for(var r=[],n=[],s=0,a=null;a=o[s];s++)r.push(a.x),n.push(a.y);var _=r.min(),l=n.min(),d=r.max(),h=n.max(),c=Math.max(e.w0,e.w1),p=Math.max(e.l0,e.l1),u=d-_+e.thickness*c+100,f=h-l+e.thickness*p+100;i.width=u,i.height=f,t.appendChild(i),Canvas.Parent().appendChild(t),this._cctx=i.getContext("2d")},_update_dom:function(t){if(!this._disable_dom_update){var e=this._obj;this.obj_2_control_points_();var i=this.control_points_,o=i.length,r=t||i,n={len:e.thickness*e.l0,width:e.thickness*e.w0,thickness:e.thickness,type:e.head0},s={len:e.thickness*e.l1,width:e.thickness*e.w1,thickness:e.thickness,type:e.head1};if(2==r.length){var a=Math.max(("none"!=e.head0?1:0)+("none"!=e.head1?1:0),1),_=i[o-1].x,l=i[o-1].y,d=Math.sqrt(Math.pow(_-i[0].x,2)+Math.pow(l-i[0].y,2))/a-2;n.len<=d||(n.len=d),s.len<=d||(s.len=d)}this.dim_=CanvasArrow.draw.call(this,r,n,s,e),r&&(this.control_points_=r),this._update_hit_areas()}},HandleAltMouseDown:function(t){if(!this._obj.locked){var e=parseInt(t.hdl_id.substr(1));!isNaN(e)&&this.is_end_handle_(t.hdl_id)&&this.RemoveConnector(e)}},HandleShiftMouseDown:function(t){if(!this._obj.locked){var e=t.hdl_id,i=parseInt(e.substr(1));return isNaN(i)||(this.is_end_handle_(e)?(this.AddConnectorToEnd(e),0!=i&&(t=this.SwitchEventHandle(t))):(this.AddConnectorsToCorner(e),t=this.SwitchEventHandle(t))),t}},SwitchEventHandle:function(t){return t.hdl_id="p"+(parseInt(t.hdl_id.substr(1))+1),t},RemoveConnector:function(t){if(!(this.control_points_.length<3)){this.control_points_.splice(t,1),this.control_points_2_obj_(!0),this._update_dom();var e=this._draggers;e&&e.main&&(e.main.Destroy(),this.InitEdit())}},AddConnectorToEnd:function(t){var e=parseInt(t.substr(1));if(!isNaN(e)){var i=this.control_points_[e],o=this.GetDirection(t),r=1==o?1:0,n=2==o?1:0,s=this._obj;0==e?s.points=i.x+r+","+(i.y+n)+","+s.points:s.points+=","+(i.x+r)+","+(i.y+n),Env.onPropChange(s.id,"points",s.points),this._update_dom();var a=this._draggers;a&&a.main&&(a.main.Destroy(),this.InitEdit())}},AddConnectorsToCorner:function(t){var e=this.control_points_,i=parseInt(t.substr(1)),o=e[i];o.x==e[i-1].x?(e.splice(i+1,0,{x:o.x+1,y:e[i+1].y}),e.splice(i,0,{x:o.x,y:o.y-1}),e[i+1].x=e[i+1].x+1,e[i+1].y=e[i+1].y-1):o.y==e[i-1].y&&(e.splice(i+1,0,{x:e[i+1].x,y:o.y+1}),e.splice(i,0,{x:o.x-1,y:o.y}),e[i+1].x=e[i+1].x-1,e[i+1].y=e[i+1].y+1),this.control_points_2_obj_(!0),this._update_dom();var r=this._draggers;r&&r.main&&(r.main.Destroy(),this.InitEdit())},is_end_handle_:function(t){var e=parseInt(t.substr(1));return 0==e||e==this.control_points_.length-1},control_points_2_obj_:function(t){t="boolean"!=typeof t||t;for(var e=this.control_points_,i=[],o=0,r=e.length;o<r;o++){var n=e[o];i.push(n.x,n.y)}this._obj.points=i.join(","),t&&Env.onPropChange(this._obj.id,"points",this._obj.points)},obj_2_control_points_:function(){for(var t=this._obj.points.split(","),e=[],i=0,o=0,r=t.length;o<r;i++)e[i]={x:parseInt(t[o++]),y:parseInt(t[o++])};this.control_points_=e},GetDirection:function(t){var e,i,o=this.control_points_,r=parseInt(t.substr(1));return"undefined"!=typeof o[r]?"undefined"!=typeof o[r+1]&&"undefined"!=typeof o[r-1]?3:(i=o[r+1]?(e=o[r],o[r+1]):(e=o[r-1],o[r]),e.x==i.x?1:2):"canvas"==t?-1:0}}),CanvasControl.prototype=new RectControl,CanvasControl.RESIZE_WH=500,WCT.ExtendObject(CanvasControl,{ClampThickness:function(t,e){e.res=Math.max(0,Math.min(e.val-0,100))},SetWH:function(t,e,i){var o=this._obj;if(this._tctl&&o.autosize==e){var r=this["autosize_"+e];if(null==r)return void(this["autosize_t_"+e]||(this["autosize_t_"+e]=WCT.SetTimeout(this.get_autosize_,1,this)));delete this["autosize_t_"+e],r!=t[e]&&(i=r,t[e]=r,Env.onPropChange(this._id,e,r))}this._get_el().style["w"==e?"width":"height"]=Math.max(1,i)+"px",CanvasControl.UpdatePosSizeTO.call(this),!1!==arguments[3]&&(this._rd_update_dom_rect&&this._rd_update_dom_rect(),this._draggers&&this._draggers.main.UpdatePos(),this._update_hit_areas&&this._update_hit_areas())},setTabIndex:function(t,e,i){if(t.onclick||t.onleave||t.onenter||t.text){var o=this._get_el();o&&(o.tabIndex=t.tabindex,(t.onclick||t.onleave||t.onenter||t.href)&&o.setAttribute("role","button"))}},UpdatePosSizeTO:function(){var t=this._tctl;if(t){var e=this.GetTextRect();t.SetStyle({x:Math.ceil(e.x),y:Math.ceil(e.y),w:Math.max(1,Math.floor(e.w)),h:Math.max(1,Math.floor(e.h))})}}}),WCT.ExtendObject(CanvasControl.prototype,function(){function r(){var t=function g(){var t=arguments[0]||this._obj,e=t.arrow_color,i=t.shape_color2?t.shape_color2:e,o=t.border_color,r=t.border_color2?t.border_color2:o,n=t.text_color,s=this._mouse_state;if(s){if("over"==s&&t.visual_over||"down"==s&&t.visual_down){var a="shape_color_"+s,_="shape_color2_"+s,l="border_color_"+s,d="border_color2_"+s,h="text_color_"+s;t[a]&&(i=e=t[a]),t[_]&&(i=t[_]),t[l]&&(r=o=t[l]),t[d]&&(r=t[d]),t[h]&&(n=t[h])}}else this.mouse_down_received_=!1;var c=this._cctl.GetCtx(),p=null,u=null,f="transparent"!=e,m=0<t.border;switch(t.gradient){case"gradient_1":f&&(p=c.createLinearGradient(0,0,t.w/6,t.h),s?"over"==s?(p.addColorStop(0,e),p.addColorStop(.35,e),p.addColorStop(.59,i),p.addColorStop(1,i)):"down"==s&&(p.addColorStop(0,i),p.addColorStop(.2,i),p.addColorStop(.66,e),p.addColorStop(1,e)):(p.addColorStop(0,e),p.addColorStop(.3,e),p.addColorStop(.5,i),p.addColorStop(1,i))),m&&(s?"over"==s?((u=c.createLinearGradient(0,0,t.w/2,t.h)).addColorStop(0,o),u.addColorStop(.2,o),u.addColorStop(.3,"#FFFFFF"),u.addColorStop(.4,r),u.addColorStop(1,r)):"down"==s&&((u=c.createLinearGradient(0,0,t.w,t.h)).addColorStop(0,r),u.addColorStop(.3,r),u.addColorStop(.6,o),u.addColorStop(1,o)):((u=c.createLinearGradient(0,0,t.w/2,t.h)).addColorStop(0,o),u.addColorStop(.2,o),u.addColorStop(.5,r),u.addColorStop(1,r)));break;case"gradient_0":f&&(p=c.createLinearGradient(0,0,t.w,0)),m&&(u=c.createLinearGradient(0,0,t.w,0));case"gradient_45":f&&!p&&(p=c.createLinearGradient(0,0,t.w,t.h)),m&&!u&&(u=c.createLinearGradient(0,0,t.w,t.h));case"gradient_90":f&&!p&&(p=c.createLinearGradient(0,0,0,t.h)),m&&!u&&(u=c.createLinearGradient(0,0,0,t.h));case"gradient_135":f&&!p&&(p=c.createLinearGradient(t.w,0,0,t.h)),m&&!u&&(u=c.createLinearGradient(t.w,0,0,t.h));case"gradient_180":f&&!p&&(p=c.createLinearGradient(t.w,0,0,0)),m&&!u&&(u=c.createLinearGradient(t.w,0,0,0));case"gradient_225":f&&!p&&(p=c.createLinearGradient(t.w,t.h,0,0)),m&&!u&&(u=c.createLinearGradient(t.w,t.h,0,0));case"gradient_270":f&&!p&&(p=c.createLinearGradient(0,t.h,0,0)),m&&!u&&(u=c.createLinearGradient(0,t.h,0,0));case"gradient_315":f&&!p&&(p=c.createLinearGradient(0,t.h,t.w,0)),m&&!u&&(u=c.createLinearGradient(0,t.h,t.w,0)),p&&(s&&"over"!=s?"down"==s&&(p.addColorStop(0,i),p.addColorStop(1,e)):(p.addColorStop(0,e),p.addColorStop(1,i))),u&&(s&&"over"!=s?"down"==s&&(u.addColorStop(0,r),u.addColorStop(1,o)):(u.addColorStop(0,o),u.addColorStop(1,r)));break;case"gradient_flat":default:f&&(p=e),m&&(u=o)}return{tc:n,ss:p,bs:u}}.call(this,arguments[0]),e=this._cctl;e.SetDrawStyle("0",t.ss,t.bs),e.Redraw("0"),this._tctl.SetStyle({text_color:t.tc})}return{OnRTMouseEnter:TextControl.prototype.OnRTMouseEnter,OnRTMouseLeave:TextControl.prototype.OnRTMouseLeave,RTFireTrigger:TextControl.prototype.RTFireTrigger,GetHtmlPosSize:TextControl.prototype.GetHtmlPosSize,SetDirection:TextControl.prototype.SetDirection,OnRTKeyUp:function(t){13!==t.button&&32!==t.button||(this.mouse_down_received_=!0,TextControl.prototype.OnRTMouseDown.call(this,t),this.OnRTMouseUp(t))},OnRTMouseDown:function(t){this.mouse_down_received_=!0,TextControl.prototype.OnRTMouseDown.call(this,t)},OnRTMouseUp:function(t){TextControl.prototype.OnRTMouseUp.call(this,t)},OnRTMouseClick:function(t){this.mouse_down_received_&&(this._obj.onclick&&Page.RTFireTrigger(this._obj.onclick,t),this._exec_link())},OnDefaultEdit:function(){var t=WCT.DeepCopy(this._obj);return t.background_color=t.arrow_color,Env.edit({ctlId:this._id,paramName:"text",posSize:this.GetHtmlPosSize(1),extInfo:t}),!0},InitEdit:function(){var t=this._obj;RectControl.prototype.InitEdit.call(this,!!t.hotspot_highlight&&{w:t.w,h:t.h}),this._draggers.main.setHandle(Dragger.HdlCanvascontrol)},GetTextRect:function(){return this._cctl.GetTextRect("0")},get_autosize_:function(){var t=this._obj,e=this._tctl;if(t&&e){var i=t.autosize,o=this.GetTextRect(),r=t[i]-o[i],n=e.GetAutoSize(i)+r;this["autosize_"+i]=n,CanvasControl.SetWH.call(this,t,i,n)}},_create_dom:function(){var t=this._id,e=$$("div");e.id=t+"#main#dom",e.className="CanvasControl",e.setAttribute("role","figure"),e.style.position="absolute",e.style.overflow="hidden",Canvas.Parent().appendChild(e);var i=this._obj,o=WCT.DeepCopy(i,{x:0,y:0});CanvasObject.CreateCanvas.call(this,e,o);var r=new TextObject(this._id);r.Create(e),r.HideScrollbars(!0),r.SetStyle({x:0,y:0,w:i.w,h:i.h}),this._tctl=r},_update_dom:function(t){if(!this._disable_dom_update){var e=this._cctl,i=this._obj;i=WCT.DeepCopy(i,t);var o=WCT.DeepCopy(i,{x:0,y:0});o=e.SetParams("0",o),set_x.call(this,i,"x",i.x,!1),set_y.call(this,i,"y",i.y,!1),CanvasControl.SetWH.call(this,i,"w",o.w,!1),CanvasControl.SetWH.call(this,i,"h",o.h,!1),r.call(this,i),CanvasControl.UpdatePosSizeTO.call(this),this._update_hit_areas()}},_update_visual:function(){r.call(this)},_update_hit_areas:function(){if(HitManager.clearHitControl(this._id),!this.isHidden()){var t=this._obj,e=!!(this._link_to||t.ondown||t.onclick||t.ondblclick),i=t.dir.match(/^rounded_rectangle/)?"rounded_rectangle":t.dir,o="ellipse"==i||"rounded_rectangle"==i?i:"poly",r=this._cctl.GetHitarea({x:t.x,y:t.y},"0"),n=this._cursor,s=null;if(BROWSER.MOBILE){var a=HitManager.GetExtHitareaWidth(),_=HitManager.GetExtHitareaHeight();if(t.w<a||t.h<_){var l=new CanvasObject("temp"),d=WCT.DeepCopy(t,{x:0,y:0,w:t.w+a,h:t.h+_});l.AddShape("99",d),s=l.GetHitarea({x:t.x-(a>>1),y:t.y-(_>>1)},"99"),l.Destructor()}}HitManager.setHitArea({type:o,ctl_id:this._id,sub_id:"main",hdl_id:"dom",shape:r,extendedShape:s,cursor:n||(e?"pointer":"default"),z:t.z})}},_on_set_preview:function(t){TextObject.UpdateFromControl.call(this,this._obj,"text",this._obj.text),t||(this._mouse_state=null)}}}()),WCT.ExtendObject(Shape,{ACCEPTED_PARAMS:{rotation:1,padding:1,border:1,duration:1,thickness:1,legacy:1,x:1,y:1,w:1,h:1},CalculateShapePos:function(t,e){var i=new Shape[t.msie5?"rect":t.hl_type||"rect"],o=i.CalculateShapePos(t,e);return i.Destructor(),o},DrawAnimated:function(){var t=this.context_,e=this.count_++,i=this.points_a_,o=i?i.length-1:-1;t&&e<=o&&(i[e].Draw(t),(!BROWSER.IE||8<BROWSER.VERSION||this.interval_)&&t.stroke(),e==o?(t.closePath(),t.stroke(),t.restore(),t.drawing_=null):this.interval_?WCT.SetTimeout(Shape.DrawAnimated,this.interval_,this):Shape.DrawAnimated.call(this))},HitTest:function(t,e,i){for(var o=!1,r=-1,n=i.length,s=n-1;++r<n;s=r){var a=i[r],_=i[s],l=a.y<=e&&e<_.y||_.y<=e&&e<a.y,d=t<(_.x-a.x)*(e-a.y)/(_.y-a.y)+a.x;l&&d&&(o=!o)}return o},GetCanvasParams:function(t,e){var i={r:t.rotation||0,p:t.padding||0,s:t.border||0,s2:Math.floor(1.4*t.border),th:t.thickness,x:t.x||0,y:t.y||0,w:2*Math.round(e.w/2),h:2*Math.round(e.h/2),legacy:t.legacy||!1};return i.wt=t.thickness*i.w/200,i.ht=t.thickness*i.h/200,i.wb=i.w-i.wt,i.hb=i.h-i.ht,i.w2=i.w>>1,i.h2=i.h>>1,null!=t.duration&&(i.duration=t.duration),i}}),Shape.prototype={Destructor:function(){this.points_=null,this.points_a_=null,this.params_=null,this.textrect_=null,this.hitpos_=null,this.hitmap_=null},SetParams:function(t){WCT.DeepEquals(this.params_,t)||(this.params_=t,this.calc_points_(t),this.calc_text_rect_(t),0<t.r&&this.rotate_())},GetHitarea:function(t){var e=this.params_;t={x:t.x+e.x,y:t.y+e.y,w:e.w,h:e.h};var i=this.hitpos_;return t.x==i.x&&t.y==i.y&&t.w==i.w&&t.h==i.h||(this.hitpos_=t,this.calc_hitarea_(t)),this.hitmap_},GetTextRect:function(){var t=this.params_,e=WCT.DeepCopy(this.textrect_);return e.x+=t.x,e.y+=t.y,e},IsDrawing:function(t){return t.drawing_||!1},Draw:function(t){var e=arguments[1],i=arguments[2];t.save();var o=this.params_,r=o.x,n=o.y,s=null,a=0;if(e){a=(s=this.outer_shape_()).length,t.fillStyle=e,t.beginPath();for(var _=0,l=null;l=s[_];_++){var d=l.Copy().Round().Move(r,n);0==_&&t.moveTo(d.x,d.y),d.Draw(t)}t.fill(),t.closePath()}if(i){var h=(a=(s=(s=s||this.outer_shape_()).concat(this.inner_shape_())).length)/2,c=a+h;t.fillStyle=i,t.beginPath();for(_=0;_<a;_++){d=(l=s[h<_?c-_-1:_==h?a-1:_]).Copy().Round().Move(r,n);_%h==0?t.moveTo(d.x,d.y):d.Draw(t)}t.fill(),t.closePath()}t.restore()},DrawAnimated:function(t,e){var i=this.points_a_;if(i&&!t.drawing_){var o=this.params_,r=1e3*(o.duration||0)/(i.length-1);t.save(),t.strokeStyle=e,t.lineWidth=o.s||1,t.beginPath(),t.moveTo(i[0].x,i[0].y),t.drawing_=!0,this.context_=t,this.count_=0,(this.interval_=r)?WCT.SetTimeout(Shape.DrawAnimated,r,this):Shape.DrawAnimated.call(this)}},CalculateShapePos:function(t,e){var i=(t.offset||0)+(t.border||0),o=2*i;return{x:e.x-i,y:e.y-i,w:2*Math.ceil((e.w+o)/2),h:2*Math.ceil((e.h+o)/2),z:Math.max(1,e.z-1)}},outer_shape_:function(){for(var t=arguments[0]||this.points_,e=this.params_,i=e.w,o=e.h,r=[],n=0,s=null;s=t[n++];){var a=s.Copy().Scale(i,o,1);r.push(a)}return r},inner_shape_:function(){for(var t=this.points_,e=this.params_,i=WCT.geometry,o=e.w,r=e.h,n=[],s=0,a=t.length,_=null;_=t[s];s++){var l=(s+1)%a,d=(s+2)%a,h=t[l].SubstractPoint(_),c=t[d].SubstractPoint(t[l]),p=new i.Point(_.x*o,_.y*r),u=new i.Point(h.x*o,h.y*r),f=new i.Point(t[l].x*o,t[l].y*r),m=new i.Point(c.x*o,c.y*r),g=new i.Vector(p,u),y=new i.Vector(f,m);g=g.Normal(e.s),y=y.Normal(e.s);var b=g.Intersect(y);n.push(new i.Point(b.x,b.y))}return n},rotate_:function(){for(var t=arguments[0]||"points_",e=this.params_.r,i=this[t],o=e*Math.PI/180,r=Math.cos(o),n=Math.sin(o),s=[],a=[],_=[],l=0,d=null;d=i[l++];){var h=d.Copy().Move(-.5,-.5).Rotate(r,n).Move(.5,.5);s.push(h),a.push(h.x),_.push(h.y)}var c=Math.min.apply(null,a),p=Math.min.apply(null,_),u=Math.max.apply(null,a)-c,f=Math.max.apply(null,_)-p,m=c+u/2,g=p+f/2,y=arguments[1]||null;if(!y){var b=1<u?1/u:u,v=1<f?1/f:f;y=Math.min(b,v)}for(l=0,d=null;d=s[l++];)d.Move(-m,-g).Scale(y,y,y).Move(.5,.5);return this[t]=s,y},calc_hitarea_:function(t){for(var e=this.outer_shape_(),i=0,o=null;o=e[i++];)o.Move(t.x,t.y);this.hitmap_=e}},Shape.left=function(){Shape.apply(this,arguments)},Shape.left.prototype=new Shape,WCT.ExtendObject(Shape.left.prototype,{calc_points_:function(t){var e=t.h2/t.w,i=t.hb/t.h,o=t.ht/t.h;this.points_=WCT.geometry.Point.CreatePoints(0,.5,e,0,e,o,1,o,1,i,e,i,e,1)},calc_text_rect_:function(t){var e=t.h2-t.ht-t.s+t.s2,i=t.ht+t.s;this.textrect_={x:e,y:i,w:t.w-t.s-e,h:t.h-2*i}}}),Shape.right=function(){Shape.apply(this,arguments)},Shape.right.prototype=new Shape,WCT.ExtendObject(Shape.right.prototype,{calc_points_:function(t){var e=1-t.h2/t.w,i=t.hb/t.h,o=t.ht/t.h;this.points_=WCT.geometry.Point.CreatePoints(1,.5,e,1,e,i,0,i,0,o,e,o,e,0)},calc_text_rect_:function(t){var e=t.ht+t.s;this.textrect_={x:t.s,y:e,w:t.w-t.h2+t.ht-t.s2,h:t.h-2*e}}}),Shape.top=function(){Shape.apply(this,arguments)},Shape.top.prototype=new Shape,WCT.ExtendObject(Shape.top.prototype,{calc_points_:function(t){var e=t.w2/t.h,i=t.wb/t.w,o=t.wt/t.w;this.points_=WCT.geometry.Point.CreatePoints(.5,0,1,e,i,e,i,1,o,1,o,e,0,e)},calc_text_rect_:function(t){var e=t.wt+t.s,i=t.w2-t.wt-t.s+t.s2;this.textrect_={x:e,y:i,w:t.w-2*e,h:t.h-t.s-i}}}),Shape.bottom=function(){Shape.apply(this,arguments)},Shape.bottom.prototype=new Shape,WCT.ExtendObject(Shape.bottom.prototype,{calc_points_:function(t){var e=1-t.w2/t.h,i=t.wt/t.w,o=t.wb/t.w;this.points_=WCT.geometry.Point.CreatePoints(.5,1,0,e,i,e,i,0,o,0,o,e,1,e)},calc_text_rect_:function(t){var e=t.wt+t.s;this.textrect_={x:e,y:t.s,w:t.w-2*e,h:t.h-t.w2+t.wt-t.s2}}}),Shape.b_left=function(){Shape.apply(this,arguments)},Shape.b_left.prototype=new Shape,WCT.ExtendObject(Shape.b_left.prototype,{calc_points_:function(t){var e=t.h2/t.w;this.points_=WCT.geometry.Point.CreatePoints(e,0,1,0,1-e,.5,1,1,e,1,0,.5)},calc_text_rect_:function(t){this.textrect_={x:t.h2+t.s2-t.s,y:t.s,w:t.w-t.h-2*t.s2+t.s,h:t.h-2*t.s}}}),Shape.b_right=function(){Shape.apply(this,arguments)},Shape.b_right.prototype=new Shape,WCT.ExtendObject(Shape.b_right.prototype,{calc_points_:function(t){var e=t.h2/t.w;this.points_=WCT.geometry.Point.CreatePoints(e,.5,0,0,1-e,0,1,.5,1-e,1,0,1)},calc_text_rect_:function(t){this.textrect_={x:t.h2+t.s2,y:t.s,w:t.w-t.h-2*t.s2+t.s,h:t.h-2*t.s}}}),Shape.b_top=function(){Shape.apply(this,arguments)},Shape.b_top.prototype=new Shape,WCT.ExtendObject(Shape.b_top.prototype,{calc_points_:function(t){var e=t.w2/t.h;this.points_=WCT.geometry.Point.CreatePoints(.5,1-e,0,1,0,e,.5,0,1,e,1,1)},calc_text_rect_:function(t){this.textrect_={x:t.s,y:t.w2+t.s2-t.s,w:t.w-2*t.s,h:t.h-t.w-2*t.s2+t.s}}}),Shape.b_bottom=function(){Shape.apply(this,arguments)},Shape.b_bottom.prototype=new Shape,WCT.ExtendObject(Shape.b_bottom.prototype,{calc_points_:function(t){var e=t.w2/t.h;this.points_=WCT.geometry.Point.CreatePoints(.5,1,0,1-e,0,0,.5,e,1,0,1,1-e)},calc_text_rect_:function(t){this.textrect_={x:t.s,y:t.w2+t.s2,w:t.w-2*t.s,h:t.h-t.w-2*t.s2+t.s}}}),Shape.c_left=function(){Shape.apply(this,arguments)},Shape.c_left.prototype=new Shape,WCT.ExtendObject(Shape.c_left.prototype,{calc_points_:function(t){var e=t.h2/t.w;this.points_=WCT.geometry.Point.CreatePoints(0,.5,e,0,1,0,1,1,e,1)},calc_text_rect_:function(t){var e=t.h2+t.s2-t.s;this.textrect_={x:e,y:t.s,w:t.w-t.s-e,h:t.h-2*t.s}}}),Shape.c_right=function(){Shape.apply(this,arguments)},Shape.c_right.prototype=new Shape,WCT.ExtendObject(Shape.c_right.prototype,{calc_points_:function(t){var e=1-t.h2/t.w;this.points_=WCT.geometry.Point.CreatePoints(0,0,e,0,1,.5,e,1,0,1)},calc_text_rect_:function(t){this.textrect_={x:t.s,y:t.s,w:t.w-t.h2-t.s2,h:t.h-2*t.s}}}),Shape.c_top=function(){Shape.apply(this,arguments)},Shape.c_top.prototype=new Shape,WCT.ExtendObject(Shape.c_top.prototype,{calc_points_:function(t){var e=t.w2/t.h;this.points_=WCT.geometry.Point.CreatePoints(0,e,.5,0,1,e,1,1,0,1)},calc_text_rect_:function(t){var e=t.w2-t.s+t.s2;this.textrect_={x:t.s,y:e,w:t.w-2*t.s,h:t.h-t.s-e}}}),Shape.c_bottom=function(){Shape.apply(this,arguments)},Shape.c_bottom.prototype=new Shape,WCT.ExtendObject(Shape.c_bottom.prototype,{calc_points_:function(t){var e=1-t.w2/t.h;this.points_=WCT.geometry.Point.CreatePoints(0,0,1,0,1,e,.5,1,0,e)},calc_text_rect_:function(t){this.textrect_={x:t.s,y:t.s,w:t.w-2*t.s,h:t.h-t.w2-t.s2}}}),Shape.rect=function(){Shape.apply(this,arguments)},Shape.rect.prototype=new Shape,WCT.ExtendObject(Shape.rect.prototype,{calc_points_:function(){var t=WCT.geometry.Point;this.points_=t.CreatePoints(0,0,1,0,1,1,0,1);var e=this.params_,i=e.w,o=e.h,r=(e.s||1)/2,n=Math.max(BROWSER.IE7?12:1,Math.round(2*(i+o)/50));e=[],this.points_a_=e;for(var s,a=i-r,_=r;r<=a;a-=n)e.push(new t(a,_));for(s=o-(a=r);_<=s;_+=n)e.push(new t(a,_));for(_=o-r,s=i-r;a<=s;a+=n)e.push(new t(a,_));for(a=i-r;r<=_;_-=n)e.push(new t(a,_));e.push(new t(a,0))},calc_text_rect_:function(t){this.textrect_={x:t.s,y:t.s,w:t.w-2*t.s,h:t.h-2*t.s}}}),Shape.underline=function(){Shape.apply(this,arguments)},Shape.underline.prototype=new Shape,WCT.ExtendObject(Shape.underline.prototype,{Draw:function(t){this.params_.duration=0,this.DrawAnimated(t,arguments[2])},CalculateShapePos:function(t,e){var i=t.border||0,o=(t.offset||0)+i,r=2*o;return{x:e.x-o,y:e.y+e.h+o,w:2*Math.ceil((e.w+r)/2),h:i,z:Math.max(1,e.z-1)}},calc_points_:function(){var t=this.params_,e=t.w,i=(t.s||1)/2,o=Math.max(BROWSER.IE7?12:1,Math.round(e/20));t=[],this.points_a_=t;for(var r=WCT.geometry.Point,n=0,s=e;n<=s;n+=o)t.push(new r(n,i));t.push(new r(e,i))},calc_text_rect_:function(t){this.textrect_={x:t.s,y:t.s,w:t.w-2*t.s,h:t.h-2*t.s}}}),Shape.parallelogram_left=function(){Shape.apply(this,arguments)},Shape.parallelogram_left.prototype=new Shape,WCT.ExtendObject(Shape.parallelogram_left.prototype,{calc_points_:function(t){var e=t.wt/t.w;this.points_=WCT.geometry.Point.CreatePoints(0,1,.5-e,0,1,0,.5+e,1)},calc_text_rect_:function(t){var e=.5*t.w-t.wt+t.s;this.textrect_={x:e,y:t.s,w:t.w-2*e,h:t.h-2*t.s}}}),Shape.parallelogram_right=function(){Shape.apply(this,arguments)},Shape.parallelogram_right.prototype=new Shape,WCT.ExtendObject(Shape.parallelogram_right.prototype,{calc_points_:function(t){var e=t.wt/t.w;this.points_=WCT.geometry.Point.CreatePoints(0,0,.5+e,0,1,1,.5-e,1)},calc_text_rect_:function(t){var e=.5*t.w-t.wt+t.s;this.textrect_={x:e,y:t.s,w:t.w-2*e,h:t.h-2*t.s}}}),Shape.parallelogram_top=function(){Shape.apply(this,arguments)},Shape.parallelogram_top.prototype=new Shape,WCT.ExtendObject(Shape.parallelogram_top.prototype,{calc_points_:function(t){var e=t.ht/t.h;this.points_=WCT.geometry.Point.CreatePoints(0,.5-e,1,0,1,.5+e,0,1)},calc_text_rect_:function(t){var e=.5*t.h-t.ht+t.s;this.textrect_={x:t.s,y:e,w:t.w-2*t.s,h:t.h-2*e}}}),Shape.parallelogram_bottom=function(){Shape.apply(this,arguments)},Shape.parallelogram_bottom.prototype=new Shape,WCT.ExtendObject(Shape.parallelogram_bottom.prototype,{calc_points_:function(t){var e=t.ht/t.h;this.points_=WCT.geometry.Point.CreatePoints(0,0,1,.5-e,1,1,0,.5+e)},calc_text_rect_:function(t){var e=.5*t.h-t.ht+t.s;this.textrect_={x:t.s,y:e,w:t.w-2*t.s,h:t.h-2*e}}}),Shape.plus=function(){Shape.apply(this,arguments)},Shape.plus.prototype=new Shape,WCT.ExtendObject(Shape.plus.prototype,{calc_points_:function(t){var e,i;i=t.w>=t.h?(e=t.ht/t.w,t.ht/t.h):(e=t.wt/t.w,t.wt/t.h),this.points_=WCT.geometry.Point.CreatePoints(0,.5-i,.5-e,.5-i,.5-e,0,.5+e,0,.5+e,.5-i,1,.5-i,1,.5+i,.5+e,.5+i,.5+e,1,.5-e,1,.5-e,.5+i,0,.5+i)},calc_text_rect_:function(t){var e=.35*t.h+t.s2;this.textrect_={x:t.s,y:e,w:t.w-2*t.s,h:t.h-2*e}}}),Shape.isosceles_left=function(){Shape.apply(this,arguments)},Shape.isosceles_left.prototype=new Shape,WCT.ExtendObject(Shape.isosceles_left.prototype,{calc_points_:function(){this.points_=WCT.geometry.Point.CreatePoints(0,.5,1,0,1,1)},calc_text_rect_:function(t){var e=t.h2/2+t.s;this.textrect_={x:t.w2+t.s2-t.s,y:e,w:t.w2-t.s2,h:t.h-2*e}}}),Shape.isosceles_right=function(){Shape.apply(this,arguments)},Shape.isosceles_right.prototype=new Shape,WCT.ExtendObject(Shape.isosceles_right.prototype,{calc_points_:function(){this.points_=WCT.geometry.Point.CreatePoints(0,0,1,.5,0,1)},calc_text_rect_:function(t){var e=t.h2/2+t.s;this.textrect_={x:t.s,y:e,w:t.w2-t.s,h:t.h-2*e}}}),Shape.isosceles_top=function(){Shape.apply(this,arguments)},Shape.isosceles_top.prototype=new Shape,WCT.ExtendObject(Shape.isosceles_top.prototype,{calc_points_:function(){this.points_=WCT.geometry.Point.CreatePoints(.5,0,1,1,0,1)},calc_text_rect_:function(t){var e=t.w2/2+t.s;this.textrect_={x:e,y:t.h2+t.s2-t.s,w:t.w-2*e,h:t.h2-t.s2}}}),Shape.isosceles_bottom=function(){Shape.apply(this,arguments)},Shape.isosceles_bottom.prototype=new Shape,WCT.ExtendObject(Shape.isosceles_bottom.prototype,{calc_points_:function(){this.points_=WCT.geometry.Point.CreatePoints(0,0,1,0,.5,1)},calc_text_rect_:function(t){var e=t.w2/2+t.s;this.textrect_={x:e,y:t.s,w:t.w-2*e,h:t.h2-t.s2}}}),Shape.triangle_upper_left=function(){Shape.apply(this,arguments)},Shape.triangle_upper_left.prototype=new Shape,WCT.ExtendObject(Shape.triangle_upper_left.prototype,{calc_points_:function(){this.points_=WCT.geometry.Point.CreatePoints(0,0,1,0,0,1)},calc_text_rect_:function(t){this.textrect_={x:t.s,y:t.s,w:t.w2+t.s-2*t.s2,h:t.h2+t.s-2*t.s2}}}),Shape.triangle_upper_right=function(){Shape.apply(this,arguments)},Shape.triangle_upper_right.prototype=new Shape,WCT.ExtendObject(Shape.triangle_upper_right.prototype,{calc_points_:function(){this.points_=WCT.geometry.Point.CreatePoints(0,0,1,0,1,1)},calc_text_rect_:function(t){this.textrect_={x:t.w2+t.s,y:t.s,w:t.w2-2*t.s,h:t.h2-2*t.s}}}),Shape.triangle_lower_left=function(){Shape.apply(this,arguments)},Shape.triangle_lower_left.prototype=new Shape,WCT.ExtendObject(Shape.triangle_lower_left.prototype,{calc_points_:function(){this.points_=WCT.geometry.Point.CreatePoints(0,0,1,1,0,1)},calc_text_rect_:function(t){this.textrect_={x:t.s,y:t.h2+t.s,w:t.w2-2*t.s,h:t.h2-2*t.s}}}),Shape.triangle_lower_right=function(){Shape.apply(this,arguments)},Shape.triangle_lower_right.prototype=new Shape,WCT.ExtendObject(Shape.triangle_lower_right.prototype,{calc_points_:function(){this.points_=WCT.geometry.Point.CreatePoints(1,0,1,1,0,1)},calc_text_rect_:function(t){this.textrect_={x:t.w2+t.s,y:t.h2+t.s,w:t.w2-2*t.s,h:t.h2-2*t.s}}}),Shape.hexagon_horizontal=function(){Shape.apply(this,arguments)},Shape.hexagon_horizontal.prototype=new Shape,WCT.ExtendObject(Shape.hexagon_horizontal.prototype,{calc_points_:function(){this.points_=WCT.geometry.Point.CreatePoints(0,.5,.2315,0,.7685,0,1,.5,.7685,1,.2315,1)},calc_text_rect_:function(t){var e=.2315*t.w+t.s;this.textrect_={x:e,y:t.s,w:t.w-2*e,h:t.h-2*t.s}}}),Shape.hexagon_vertical=function(){Shape.apply(this,arguments)},Shape.hexagon_vertical.prototype=new Shape,WCT.ExtendObject(Shape.hexagon_vertical.prototype,{calc_points_:function(){this.points_=WCT.geometry.Point.CreatePoints(.5,0,1,.2315,1,.7685,.5,1,0,.7685,0,.2315)},calc_text_rect_:function(t){var e=.2315*t.h+t.s;this.textrect_={x:t.s,y:e,w:t.w-2*t.s,h:t.h-2*e}}}),Shape.rhombus=function(){Shape.apply(this,arguments)},Shape.rhombus.prototype=new Shape,WCT.ExtendObject(Shape.rhombus.prototype,{calc_points_:function(){this.points_=WCT.geometry.Point.CreatePoints(.5,0,1,.5,.5,1,0,.5)},calc_text_rect_:function(t){this.textrect_={x:.25*t.w+t.s,y:.25*t.h+t.s,w:t.w2-2*t.s,h:t.h2-2*t.s}}}),Shape.four_pointed_star=function(){Shape.apply(this,arguments)},Shape.four_pointed_star.prototype=new Shape,WCT.ExtendObject(Shape.four_pointed_star.prototype,{calc_points_:function(t){var e=t.wt/t.w,i=t.ht/t.h;this.points_=WCT.geometry.Point.CreatePoints(.5,0,.5+e,.5-i,1,.5,.5+e,.5+i,.5,1,.5-e,.5+i,0,.5,.5-e,.5-i)},calc_text_rect_:function(t){this.textrect_={x:.3*t.w-.1*t.wt,y:.3*t.h-.1*t.ht,w:.4*t.w+.2*t.wt,h:.4*t.h+.2*t.ht}}}),Shape.five_pointed_star=function(){Shape.four_pointed_star.apply(this,arguments)},Shape.five_pointed_star.prototype=new Shape.four_pointed_star,WCT.ExtendObject(Shape.five_pointed_star.prototype,{calc_points_:function(t){var e=4*t.wt/t.w,i=4*t.ht/t.h;this.points_=WCT.geometry.Point.CreatePoints(.8,1,.5,.5+.2588*i,.2,1,.5+-.1883*e,.5+.1228*i,0,.3839,.5+-.1171*e,.5+-.1161*i,.5,0,.5+.1116*e,.5+-.1161*i,1,.3839,.5+.1883*e,.5+.1228*i)}}),Shape.six_pointed_star=function(){Shape.four_pointed_star.apply(this,arguments)},Shape.six_pointed_star.prototype=new Shape.four_pointed_star,WCT.ExtendObject(Shape.six_pointed_star.prototype,{calc_points_:function(t){var e=t.wt*Math.sqrt(.5)/t.w,i=t.ht*Math.sqrt(.5)/t.h*1.13,o=.75*e,r=1.5*e;this.points_=WCT.geometry.Point.CreatePoints(0,.25,.5-o,.5-i,.5,0,.5+o,.5-i,1,.25,.5+r,.5,1,.75,.5+o,.5+i,.5,1,.5-o,.5+i,0,.75,.5-r,.5)}}),Shape.seven_pointed_star=function(){Shape.four_pointed_star.apply(this,arguments)},Shape.seven_pointed_star.prototype=new Shape.four_pointed_star,WCT.ExtendObject(Shape.seven_pointed_star.prototype,{calc_points_:function(t){var e=3*t.wt/t.w,i=3*t.ht/t.h;this.points_=WCT.geometry.Point.CreatePoints(0,.6417,.5+-.3396*e,.5+-.0523*i,.0955,.2014,.5+-.1553*e,.5+-.2986*i,.5,0,.5+.1553*e,.5+-.2986*i,.9045,.2014,.5+.3396*e,.5+-.0523*i,1,.6417,.5+.2714*e,.5+.2537*i,.7202,1,.5,.5+.3805*i,.2798,1,.5+-.2714*e,.5+.2537*i)}}),Shape.eight_pointed_star=function(){Shape.four_pointed_star.apply(this,arguments)},Shape.eight_pointed_star.prototype=new Shape.four_pointed_star,WCT.ExtendObject(Shape.eight_pointed_star.prototype,{calc_points_:function(t){var e=3*t.wt/t.w,i=3*t.ht/t.h;this.points_=WCT.geometry.Point.CreatePoints(0,.5,.5+-.3358*e,.5+-.1382*i,.1464,.1464,.5+-.1382*e,.5+-.3358*i,.5,0,.5+.1382*e,.5+-.3358*i,.8536,.1464,.5+.3382*e,.5+-.1382*i,1,.5,.5+.3382*e,.5+.1382*i,.8536,.8536,.5+.1382*e,.5+.3382*i,.5,1,.5+-.1382*e,.5+.3382*i,.1464,.8536,.5+-.3358*e,.5+.1382*i)}}),Shape.nine_pointed_star=function(){Shape.four_pointed_star.apply(this,arguments)},Shape.nine_pointed_star.prototype=new Shape.four_pointed_star,WCT.ExtendObject(Shape.nine_pointed_star.prototype,{calc_points_:function(t){var e=1+Math.sqrt(2),i=t.wt*e/t.w,o=t.ht*e/t.h;this.points_=WCT.geometry.Point.CreatePoints(0,.4335,.5+-.3336*i,.5+-.1993*o,.1984,.1203,.5+-.1138*i,.5+-.3793*o,.5,0,.5+.1138*i,.5+-.3793*o,.8016,.1203,.5+.3336*i,.5+-.1993*o,1,.4335,.5+.4297*i,.5+.0894*o,.9572,.7714,.5+.2938*i,.5+.3315*o,.7038,1,.5,.5+.4263*o,.2962,1,.5+-.2938*i,.5+.3315*o,.0428,.7714,.5+-.4297*i,.5+.0894*o)}}),Shape.ten_pointed_star=function(){Shape.four_pointed_star.apply(this,arguments)},Shape.ten_pointed_star.prototype=new Shape.four_pointed_star,WCT.ExtendObject(Shape.ten_pointed_star.prototype,{calc_points_:function(t){var e=1+Math.sqrt(2),i=t.wt*e/t.w,o=t.ht*e/t.h;this.points_=WCT.geometry.Point.CreatePoints(.5+-.4*i,.5,.0245,.3455,.5+-.3455*i,.5+-.2162*o,.2056,.096,.5+-.1225*i,.5+-.3755*o,.5,0,.5+.1225*i,.5+-.3755*o,.7944,.096,.5+.3455*i,.5+-.2162*o,.9755,.3455,.5+.4*i,.5,.9755,.6545,.5+.3455*i,.5+.2162*o,.7944,.904,.5+.1225*i,.5+.3755*o,.5,1,.5+-.1225*i,.5+.3755*o,.2056,.904,.5+-.3455*i,.5+.2162*o,.0245,.6545)}}),Shape.twelve_pointed_star=function(){Shape.four_pointed_star.apply(this,arguments)},Shape.twelve_pointed_star.prototype=new Shape.four_pointed_star,WCT.ExtendObject(Shape.twelve_pointed_star.prototype,{calc_points_:function(t){var e=t.wt/t.w,i=t.ht/t.h;this.points_=WCT.geometry.Point.CreatePoints(0,.5,.5+-.9659*e,.5+-.2588*i,.0669,.25,.5+-.7071*e,.5+-.7071*i,.25,.0669,.5+-.2588*e,.5+-.9659*i,.5,0,.5+.2588*e,.5+-.9659*i,.75,.0669,.5+.7071*e,.5+-.7071*i,.9331,.25,.5+.9659*e,.5+-.2588*i,1,.5,.5+.9659*e,.5+.2588*i,.9331,.75,.5+.7071*e,.5+.7071*i,.75,.9331,.5+.2588*e,.5+.9659*i,.5,1,.5+-.2588*e,.5+.9659*i,.25,.9331,.5+-.7071*e,.5+.7071*i,.0669,.75,.5+-.9659*e,.5+.2588*i)}}),Shape.my_pentagon_left=function(){Shape.apply(this,arguments)},Shape.my_pentagon_left.prototype=new Shape,WCT.ExtendObject(Shape.my_pentagon_left.prototype,{calc_points_:function(){this.points_=WCT.geometry.Point.CreatePoints(.4,0,1,.2,1,.8,.4,1,0,.5)},calc_text_rect_:function(t){var e=.4*t.w,i=.2*t.h+t.s;this.textrect_={x:e,y:i,w:t.w-t.s-e,h:t.h-2*i}}}),Shape.my_pentagon_right=function(){Shape.apply(this,arguments)},Shape.my_pentagon_right.prototype=new Shape,WCT.ExtendObject(Shape.my_pentagon_right.prototype,{calc_points_:function(){this.points_=WCT.geometry.Point.CreatePoints(.6,0,1,.5,.6,1,0,.8,0,.2)},calc_text_rect_:function(t){var e=.2*t.h+t.s;this.textrect_={x:t.s,y:e,w:.6*t.w-t.s,h:t.h-2*e}}}),Shape.my_pentagon_up=function(){Shape.apply(this,arguments)},Shape.my_pentagon_up.prototype=new Shape,WCT.ExtendObject(Shape.my_pentagon_up.prototype,{calc_points_:function(){this.points_=WCT.geometry.Point.CreatePoints(.5,0,1,.4,.8,1,.2,1,0,.4)},calc_text_rect_:function(t){var e=.2*t.w+t.s,i=.4*t.h;this.textrect_={x:e,y:i,w:t.w-2*e,h:t.h-t.s-i}}}),Shape.my_pentagon_down=function(){Shape.apply(this,arguments)},Shape.my_pentagon_down.prototype=new Shape,WCT.ExtendObject(Shape.my_pentagon_down.prototype,{calc_points_:function(){this.points_=WCT.geometry.Point.CreatePoints(.2,0,.8,0,1,.6,.5,1,0,.6)},calc_text_rect_:function(t){var e=.2*t.w+t.s;this.textrect_={x:e,y:t.s,w:t.w-2*e,h:.6*t.h-t.s}}}),Shape.heptagon=function(){Shape.apply(this,arguments)},Shape.heptagon.prototype=new Shape,WCT.ExtendObject(Shape.heptagon.prototype,{calc_points_:function(){this.points_=WCT.geometry.Point.CreatePoints(0,.6392,.0981,.2117,.5,0,.9019,.2117,1,.6392,.7284,1,.2716,1)},calc_text_rect_:function(t){var e=.15*t.w+t.s2,i=.15*t.h+t.s2;this.textrect_={x:e,y:i,w:t.w-2*e,h:t.h-2*i}}}),Shape.octagon=function(){Shape.heptagon.apply(this,arguments)},Shape.octagon.prototype=new Shape.heptagon,WCT.ExtendObject(Shape.octagon.prototype,{calc_points_:function(){this.points_=WCT.geometry.Point.CreatePoints(0,.5,.1464,.1464,.5,0,.8536,.1464,1,.5,.8536,.8536,.5,1,.1464,.8536)}}),Shape.decagon=function(){Shape.heptagon.apply(this,arguments)},Shape.decagon.prototype=new Shape.heptagon,WCT.ExtendObject(Shape.decagon.prototype,{calc_points_:function(){this.points_=WCT.geometry.Point.CreatePoints(0,.3434,.1969,.101,.5,0,.8031,.101,1,.3434,1,.6566,.8031,.899,.5,1,.1969,.899,0,.6566)}}),Shape.dodecagon=function(){Shape.heptagon.apply(this,arguments)},Shape.dodecagon.prototype=new Shape.heptagon,WCT.ExtendObject(Shape.dodecagon.prototype,{calc_points_:function(){this.points_=WCT.geometry.Point.CreatePoints(0,.5,.0669,.25,.25,.0669,.5,0,.75,.0669,.9331,.25,1,.5,.9331,.75,.75,.9331,.5,1,.25,.9331,.0669,.75)}}),Shape.trapezoid_left=function(){Shape.apply(this,arguments)},Shape.trapezoid_left.prototype=new Shape,WCT.ExtendObject(Shape.trapezoid_left.prototype,{calc_points_:function(t){var e=t.ht/t.h;this.points_=WCT.geometry.Point.CreatePoints(0,.5-e,1,0,1,1,0,.5+e)},calc_text_rect_:function(t){var e=.5*t.h-t.ht+t.s;this.textrect_={x:t.s,y:e,w:t.w-2*t.s,h:t.h-2*e}}}),Shape.trapezoid_right=function(){Shape.apply(this,arguments)},Shape.trapezoid_right.prototype=new Shape,WCT.ExtendObject(Shape.trapezoid_right.prototype,{calc_points_:function(t){var e=t.ht/t.h;this.points_=WCT.geometry.Point.CreatePoints(0,0,1,.5-e,1,.5+e,0,1)},calc_text_rect_:function(t){var e=.5*t.h-t.ht+t.s;this.textrect_={x:t.s,y:e,w:t.w-2*t.s,h:t.h-2*e}}}),Shape.trapezoid_up=function(){Shape.apply(this,arguments)},Shape.trapezoid_up.prototype=new Shape,WCT.ExtendObject(Shape.trapezoid_up.prototype,{calc_points_:function(t){var e=t.wt/t.w;this.points_=WCT.geometry.Point.CreatePoints(.5-e,0,.5+e,0,1,1,0,1)},calc_text_rect_:function(t){var e=.5*t.w-t.wt+t.s;this.textrect_={x:e,y:t.s,w:t.w-2*e,h:t.h-2*t.s}}}),Shape.trapezoid_down=function(){Shape.apply(this,arguments)},Shape.trapezoid_down.prototype=new Shape,WCT.ExtendObject(Shape.trapezoid_down.prototype,{calc_points_:function(t){var e=t.wt/t.w;this.points_=WCT.geometry.Point.CreatePoints(0,0,1,0,.5+e,1,.5-e,1)},calc_text_rect_:function(t){var e=.5*t.w-t.wt+t.s;this.textrect_={x:e,y:t.s,w:t.w-2*e,h:t.h-2*t.s}}}),Shape.left_right_arrow=function(){Shape.apply(this,arguments)},Shape.left_right_arrow.prototype=new Shape,WCT.ExtendObject(Shape.left_right_arrow.prototype,{calc_points_:function(t){var e=t.h2/t.w,i=t.ht/t.h,o=.005+e,r=e-.005;this.points_=WCT.geometry.Point.CreatePoints(1,.5,1-o,1,1-o,.5+i,r,.5+i,r,1,0,.5,r,0,r,.5-i,1-o,.5-i,1-o,0)},calc_text_rect_:function(t){var e=.5*t.h-t.ht+t.s;this.textrect_={x:t.h2,y:e,w:t.w-2*t.h2,h:t.h-2*e}}}),Shape.up_down_arrow=function(){Shape.apply(this,arguments)},Shape.up_down_arrow.prototype=new Shape,WCT.ExtendObject(Shape.up_down_arrow.prototype,{calc_points_:function(t){var e=t.wt/t.w,i=t.w2/t.h,o=i-.005,r=.005+i;this.points_=WCT.geometry.Point.CreatePoints(.5,1,0,1-r,.5-e,1-r,.5-e,o,0,o,.5,0,1,o,.5+e,o,.5+e,1-r,1,1-r)},calc_text_rect_:function(t){var e=.5*t.w-t.wt+t.s;this.textrect_={x:e,y:t.w2,w:t.w-2*e,h:t.h-2*t.w2}}}),Shape.triple_arrow=function(){Shape.apply(this,arguments)},Shape.triple_arrow.prototype=new Shape,WCT.ExtendObject(Shape.triple_arrow.prototype,{calc_points_:function(t){var e=t.wt/t.w*.5,i=t.ht/t.h*.5;this.points_=WCT.geometry.Point.CreatePoints(0,.8,.2,.6,.2,.8-i,.5-e,.8-i,.5-e,.2,.3,.2,.5,0,.7,.2,.5+e,.2,.5+e,.8-i,.8,.8-i,.8,.6,1,.8,.8,1,.8,.8+i,.2,.8+i,.2,1)},calc_text_rect_:function(t){var e=.2*t.w;this.textrect_={x:e,y:.8*t.h-.5*t.ht+t.s,w:t.w-2*e,h:t.ht-2*t.s}}}),Shape.quad_arrow=function(){Shape.apply(this,arguments)},Shape.quad_arrow.prototype=new Shape,WCT.ExtendObject(Shape.quad_arrow.prototype,{calc_points_:function(t){var e=t.wt/t.w*.5,i=t.ht/t.h*.5;this.points_=WCT.geometry.Point.CreatePoints(.5-e,.5-i,.5-e,.2,.3,.2,.5,0,.7,.2,.5+e,.2,.5+e,.5-i,.8,.5-i,.8,.3,1,.5,.8,.7,.8,.5+i,.5+e,.5+i,.5+e,.8,.7,.8,.5,1,.3,.8,.5-e,.8,.5-e,.5+i,.2,.5+i,.2,.7,0,.5,.2,.3,.2,.5-i)},calc_text_rect_:function(t){var e=.2*t.w;this.textrect_={x:e,y:.5*(t.h-t.ht)+t.s,w:t.w-2*e,h:t.ht-2*t.s}}}),Shape.left_up_arrow=function(){Shape.apply(this,arguments)},Shape.left_up_arrow.prototype=new Shape,WCT.ExtendObject(Shape.left_up_arrow.prototype,{calc_points_:function(t){var e=t.wt/t.w*.5,i=t.ht/t.h*.5;this.points_=WCT.geometry.Point.CreatePoints(0,.75,.25,.5,.25,.75-i,.75-e,.75-i,.75-e,.25,.5,.25,.75,0,1,.25,.75+e,.25,.75+e,.75+i,.25,.75+i,.25,1)},calc_text_rect_:function(t){this.textrect_={x:.25*t.w,y:.75*t.h-.5*t.ht+t.s,w:.5*(t.w+t.wt)-t.s,h:t.ht-2*t.s}}}),Shape.right_up_arrow=function(){Shape.apply(this,arguments)},Shape.right_up_arrow.prototype=new Shape,WCT.ExtendObject(Shape.right_up_arrow.prototype,{calc_points_:function(t){var e=t.wt/t.w*.5,i=t.ht/t.h*.5;this.points_=WCT.geometry.Point.CreatePoints(.25-e,.75+i,.25-e,.25,0,.25,.25,0,.5,.25,.25+e,.25,.25+e,.75-i,.75,.75-i,.75,.5,1,.75,.75,1,.75,.75+i)},calc_text_rect_:function(t){var e=.25*t.w-.5*t.wt+t.s;this.textrect_={x:e,y:.75*t.h-.5*t.ht+t.s,w:.75*t.w-e,h:t.ht-2*t.s}}}),Shape.left_down_arrow=function(){Shape.apply(this,arguments)},Shape.left_down_arrow.prototype=new Shape,WCT.ExtendObject(Shape.left_down_arrow.prototype,{calc_points_:function(t){var e=t.wt/t.w*.5,i=t.ht/t.h*.5;this.points_=WCT.geometry.Point.CreatePoints(.25,0,.25,.25-i,.75+e,.25-i,.75+e,.75,1,.75,.75,1,.5,.75,.75-e,.75,.75-e,.25+i,.25,.25+i,.25,.5,0,.25)},calc_text_rect_:function(t){this.textrect_={x:.25*t.w,y:.25*t.h-.5*t.ht+t.s,w:.5*t.w+.5*t.wt-t.s,h:t.ht-2*t.s}}}),Shape.right_down_arrow=function(){Shape.apply(this,arguments)},Shape.right_down_arrow.prototype=new Shape,WCT.ExtendObject(Shape.right_down_arrow.prototype,{calc_points_:function(t){var e=t.wt/t.w*.5,i=t.ht/t.h*.5;this.points_=WCT.geometry.Point.CreatePoints(.75,.25-i,.75,0,1,.25,.75,.5,.75,.25+i,.25+e,.25+i,.25+e,.75,.5,.75,.25,1,0,.75,.25-e,.75,.25-e,.25-i)},calc_text_rect_:function(t){var e=.25*t.w-.5*t.wt+t.s;this.textrect_={x:e,y:.25*t.h-.5*t.ht+t.s,w:.75*t.w-e,h:t.ht-2*t.s}}}),Shape.notched_arrow_left=function(){Shape.apply(this,arguments)},Shape.notched_arrow_left.prototype=new Shape,WCT.ExtendObject(Shape.notched_arrow_left.prototype,{calc_points_:function(t){var e=t.h2/t.w,i=t.ht/t.h;this.points_=WCT.geometry.Point.CreatePoints(0,.5,e,0,e,.5-i,1,.5-i,1-t.ht/t.w,.5,1,.5+i,e,.5+i,e,1)},calc_text_rect_:function(t){var e=t.ht+t.s2-t.s,i=.5*t.h-t.ht+t.s;this.textrect_={x:e,y:i,w:t.w-t.ht-t.s2-e,h:t.h-2*i}}}),Shape.notched_arrow_right=function(){Shape.apply(this,arguments)},Shape.notched_arrow_right.prototype=new Shape,WCT.ExtendObject(Shape.notched_arrow_right.prototype,{calc_points_:function(t){var e=t.h2/t.w,i=t.ht/t.h;this.points_=WCT.geometry.Point.CreatePoints(0,.5+i,t.ht/t.w,.5,0,.5-i,1-e,.5-i,1-e,0,1,.5,1-e,1,1-e,.5+i)},calc_text_rect_:function(t){var e=t.ht+t.s2,i=.5*t.h-t.ht+t.s;this.textrect_={x:e,y:i,w:t.w-2*e+t.s,h:t.h-2*i}}}),Shape.notched_arrow_up=function(){Shape.apply(this,arguments)},Shape.notched_arrow_up.prototype=new Shape,WCT.ExtendObject(Shape.notched_arrow_up.prototype,{calc_points_:function(t){var e=t.w2/t.h,i=t.wt/t.w;this.points_=WCT.geometry.Point.CreatePoints(0,e,.5,0,1,e,.5+i,e,.5+i,1,.5,1-t.wt/t.h,.5-i,1,.5-i,e)},calc_text_rect_:function(t){var e=.5*t.w-t.wt+t.s,i=t.wt+t.s2-t.s;this.textrect_={x:e,y:i,w:t.w-2*e,h:t.h-2*i-t.s}}}),Shape.notched_arrow_down=function(){Shape.apply(this,arguments)},Shape.notched_arrow_down.prototype=new Shape,WCT.ExtendObject(Shape.notched_arrow_down.prototype,{calc_points_:function(t){var e=t.w2/t.h,i=t.wt/t.w;this.points_=WCT.geometry.Point.CreatePoints(.5-i,0,.5,t.wt/t.h,.5+i,0,.5+i,1-e,1,1-e,.5,1,0,1-e,.5-i,1-e)},calc_text_rect_:function(t){var e=.5*t.w-t.wt+t.s,i=t.wt+t.s2;this.textrect_={x:e,y:i,w:t.w-2*e,h:t.h-2*i+t.s}}}),Shape.lightening=function(){Shape.apply(this,arguments)},Shape.lightening.prototype=new Shape,WCT.ExtendObject(Shape.lightening.prototype,{calc_points_:function(t){this.points_=WCT.geometry.Point.CreatePoints(0,.1785,.4067,0,.6101,.2857,.5254,.3392,.7627,.5535,.6779,.6071,1,1,.4745,.7035,.5508,.6428,.2627,.4464,.3389,.3928)},calc_text_rect_:function(t){var e=.2*t.w+t.s,i=.1*t.h+t.s;this.textrect_={x:e,y:i,w:e,h:i}}}),Shape.rounded_rectangle=function(){Shape.apply(this,arguments),this.points2_=null,this.points3_=null},Shape.rounded_rectangle.prototype=new Shape,Shape.rounded_rectangle.HitTest=function(t,e,i){if(!Shape.HitTest(t,e,[i.lt.edge,i.rt.edge,i.rb.edge,i.lb.edge]))return!1;var o=i.lt.circle.HasPoint(t,e),r=i.rt.circle.HasPoint(t,e),n=i.rb.circle.HasPoint(t,e),s=i.lb.circle.HasPoint(t,e),a=Shape.HitTest(t,e,i.lt.rect),_=Shape.HitTest(t,e,i.rt.rect),l=Shape.HitTest(t,e,i.rb.rect),d=Shape.HitTest(t,e,i.lb.rect);return(!a||o)&&(!_||r)&&(!l||n)&&(!d||s)},WCT.ExtendObject(Shape.rounded_rectangle.prototype,{Destructor:function(){this.points2_=null,this.points3_=null,Shape.prototype.Destructor.call(this)},Draw:function(t,e,i){e?(i&&this.points_.Draw(t,"fill",null,i),this.points2_.Draw(t,"fill",null,e)):i&&this.points_.Draw(t,"fill",this.points3_,i)},rotate_:function(){for(var t=this.params_,e=t.r*Math.PI/180,i=Math.cos(e),o=Math.sin(e),r=null,n=[this.points_,this.points2_,this.points3_],s=0,a=null;a=n[s++];){a.Move(-t.w2,-t.h2).Rotate(i,o).Move(t.w2,t.h2);var _=a.GetPoints(),l=Math.min.apply(null,_.x),d=Math.min.apply(null,_.y),h=Math.max.apply(null,_.x)-l,c=Math.max.apply(null,_.y)-d,p=l+h/2,u=d+c/2;if(!r){var f=h>t.w?t.w/h:h,m=c>t.h?t.h/c:c;r=Math.min(f,m)}a.Move(-p,-u).Scale(r,r,r).Move(t.w2,t.h2)}},calc_hitarea_:function(t){var e=WCT.geometry.Circle,i=this.points_.GetEdges(),o=e.FromObject(i.lt).Move(t.x,t.y),r=e.FromObject(i.rt).Move(t.x,t.y),n=e.FromObject(i.rb).Move(t.x,t.y),s=e.FromObject(i.lb).Move(t.x,t.y);this.hitmap_={lt:this.get_edge_area_(s,o,r),rt:this.get_edge_area_(o,r,n),rb:this.get_edge_area_(r,n,s),lb:this.get_edge_area_(n,s,o)}},calc_r_:function(t){if(t.legacy){var e=Math.max(t.wt,t.ht),i=Math.min(t.w,t.h)/2;return Math.min(i,e)}e=Math.max(0,Math.min(t.th/2,50))/100;return Math.min(t.w,t.h)*e},calc_points_:function(t){var e=WCT.geometry.Point,i=WCT.geometry.RoundedRect,o=this.calc_r_(t),r=new e(0,0),n=new e(t.w,t.h);this.points_=i.FromRect(r,n,o),r.Move(t.s,t.s),n.Move(-t.s,-t.s),o=Math.max(0,o-t.s),this.points2_=i.FromRect(r,n,o),this.points3_=i.FromInvertedRect(r,n,o)},calc_text_rect_:function(t){var e=this.calc_r_(t),i=t.s+(1-Math.sqrt(.5))*(e-t.s),o=2*i;this.textrect_={x:i,y:i,w:t.w-o,h:t.h-o}},get_edge_area_:function(t,e,i){var o=WCT.geometry.Vector,r=o.FromPoints(e,t),n=o.FromPoints(e,i),s=r.Coordinates(e.r),a=n.Coordinates(e.r),_=new o(s,n.r),l=new o(a,r.r),d=_.Intersect(l);return{edge:e,circle:new WCT.geometry.Circle(d.x,d.y,e.r),rect:[s,e,a,d]}}}),Shape.ellipse=function(){Shape.apply(this,arguments),this.points2_=null},Shape.ellipse.prototype=new Shape,Shape.ellipse.HitTest=function(t,e,i){return i.HasPoint(t,e)},WCT.ExtendObject(Shape.ellipse.prototype,{Destructor:function(){this.points2_=null,Shape.prototype.Destructor.call(this)},Draw:function(t,e,i){e?(i&&this.points_.Draw(t,"fill",null,i),this.points2_.Draw(t,"fill",null,e)):i&&this.DrawAnimated(t,i)},CalculateShapePos:function(t,e){var i=(t.offset||0)+(t.border||0),o=2*i,r=e.x-i,n=e.y-i,s=e.w+o,a=e.h+o,_=(Math.sqrt(2)-1)/2,l=Math.floor(r-s*_),d=Math.floor(n-a*_);return{x:l,y:d,w:Math.floor(s+2*(r-l)),h:Math.floor(a+2*(n-d)),z:Math.max(1,e.z-1)}},rotate_:function(){},calc_hitarea_:function(t){var e=this.points_.Copy();e.Move(t.x,t.y),this.hitmap_=e},calc_points_:function(t){var e=WCT.geometry.Ellipse;this.points_=new e(t.w2,t.h2,t.w2,t.h2),this.points2_=new e(t.w2,t.h2,t.w2-t.s,t.h2-t.s);var i=(t=this.params_).s,o=t.w/2,r=t.h/2,n=Math.PI/(BROWSER.IE7?15:30);t=[],this.points_a_=t;for(var s=WCT.geometry.Point,a=0;a>=-Math.PI;a-=n){var _=o+(o-i)*Math.cos(a),l=r+(r-i)*Math.sin(a);t.push(new s(_,l))}for(a=Math.PI;0<=a;a-=n){_=o+(o-i)*Math.cos(a),l=r+(r-i)*Math.sin(a);t.push(new s(_,l))}},calc_text_rect_:function(t){var e=Math.sqrt(2),i=(t.w-t.s)/e,o=(t.h-t.s)/e;this.textrect_={x:(t.w-i)/2,y:(t.h-o)/2,w:i,h:o}}}),Shape.cloud=function(){Shape.apply(this,arguments)},Shape.cloud.prototype=new Shape,Shape.cloud.HitTest=function(t,e,i){return!1},WCT.ExtendObject(Shape.cloud.prototype,{Draw:function(t){var e=arguments[1],i=arguments[2],o=this.params_;if(t.save(),i){var r=this.outer_shape_();t.beginPath();var n=r[0].Move(o.x,o.y).Round();t.moveTo(n.x,n.y);for(var s=1;s<16;){var a=r[s++].Move(o.x,o.y).Round(),_=r[s++].Move(o.x,o.y).Round(),l=r[s++].Move(o.x,o.y).Round();t.bezierCurveTo(a.x,a.y,_.x,_.y,l.x,l.y)}var d=r[16].Move(o.x,o.y).Round(),h=r[17].Move(o.x,o.y).Round();t.bezierCurveTo(d.x,d.y,h.x,h.y,n.x,n.y),t.closePath(),t.fillStyle=i,t.fill()}if(e){var c=this.inner_shape_();t.beginPath();n=c[0].Move(o.x,o.y).Round();t.moveTo(n.x,n.y);for(s=1;s<16;){a=c[s++].Move(o.x,o.y).Round(),_=c[s++].Move(o.x,o.y).Round(),l=c[s++].Move(o.x,o.y).Round();t.bezierCurveTo(a.x,a.y,_.x,_.y,l.x,l.y)}d=c[16].Move(o.x,o.y).Round(),h=c[17].Move(o.x,o.y).Round();t.bezierCurveTo(d.x,d.y,h.x,h.y,n.x,n.y),t.closePath(),t.fillStyle=e,t.fill()}t.restore()},outer_shape_:function(){for(var t=this.points_,e=this.params_,i=e.w,o=e.h,r=[],n=0,s=null;s=t[n++];){var a=s.Copy().Scale(i,o);r.push(a)}return r},inner_shape_:function(){for(var t=this.points_,e=this.params_,i=e.s,o=e.w-2*i,r=e.h-2*i,n=[],s=i/o,a=i/r,_=0,l=null;l=t[_++];){var d=l.Copy().Move(s,a).Scale(o,r);n.push(d)}return n},rotate_:function(){},calc_points_:function(t){this.points_=WCT.geometry.Point.CreatePoints(.13,.43,0,.54,0,.83,.33,.83,.4,1,.63,1,.7,.83,.97,.83,.97,.66,.87,.54,1,.2,.8,.14,.7,.26,.63,0,.4,.09,.4,.26,.23,0,.07,.09)},calc_text_rect_:function(t){t=this.points_;var e=this.params_,i=t[0].Copy().Scale(e.w,1).Move(e.s,0).Round().x,o=t[12].Copy().Scale(1,e.h).Move(0,e.s).Round().y,r=t[9].Copy().Scale(e.w,1).Move(-e.s,0).Round().x,n=t[3].Copy().Scale(1,e.h).Move(0,-e.s).Round().y;this.textrect_={x:i,y:o,w:r-i,h:n-o}}}),XRuler.prototype=new SlideControl,XRuler.clamp_ruler=function(t,e){e.res=Math.max(0,Math.min(Canvas.w(),e.val-0))},XRuler.set_ruler=function(t,e,i){this._draggers&&this._draggers.main.UpdatePos()},XRuler.prototype._remove_dom=function(){},XRuler.prototype.InitEdit=function(){this._draggers.main=new XRDragger(this,this._id,"drag"),this._draggers.main.Init()},YRuler.prototype=new SlideControl,YRuler.clamp_ruler=function(t,e){e.res=Math.max(0,Math.min(Canvas.h(),e.val-0))},YRuler.prototype._remove_dom=function(){},YRuler.prototype.InitEdit=function(){this._draggers.main=new YRDragger(this,this._id,"drag"),this._draggers.main.Init()},ImageLink.prototype=new RectControl,WCT.ExtendObject(ImageLink,{SetLink:function(t,e,i){EDIT_MODE&&this[i||t.onclick?"_removeLinkNote":"_addLinkNote"](),RectControl.SetLink.apply(this,arguments),this._update_hit_areas()},SetImage:function(t,e,i){this._ictl&&(i&&i.id||(i={id:"book_style:icons/"+this._link_type+".png"}),this._ictl.SetImage(i))},ImageLoaded:function(){var t=this._ictl;if(t){var e=this._obj,i=t.GetPosSize(),o=i?i.img_w:0,r=i?i.img_h:0;e.w==o&&e.h==r||(Env.onPropChange(this._id,"w",o),Env.onPropChange(this._id,"h",r),e.w=o,e.h=r),this._draggers&&this._draggers.main.SetWH(o,r),this._update_hit_areas&&this._update_hit_areas()}}}),WCT.ExtendObject(ImageLink.prototype,{OnRTMouseClick:TextControl.prototype.OnRTMouseClick,OnRTMouseEnter:TextControl.prototype.OnRTMouseEnter,OnRTMouseLeave:TextControl.prototype.OnRTMouseLeave,RTFireTrigger:TextControl.prototype.RTFireTrigger,_update_dom:function(t){},Terminate:function(){ctx.unregisterEventListener&&ctx.unregisterEventListener({control_id:this._id}),RectControl.prototype.Terminate.call(this)},OnEnvEvent:function(t){var e=this._obj;ctx.unregisterEventListener&&ctx.unregisterEventListener({control_id:this._id}),t.finished&&e.onfinish&&Page.RTFireTrigger(e.onfinish),"boolean"==typeof t.completed&&(t.completed&&e.oncomplete?Page.RTFireTrigger(e.oncomplete):!t.completed&&e.onincomplete&&Page.RTFireTrigger(e.onincomplete)),"boolean"==typeof t.passed&&(t.passed&&e.onpassed?Page.RTFireTrigger(e.onpassed):!t.passed&&e.onfailed&&Page.RTFireTrigger(e.onfailed))},SetLinkType:function(t){this._link_type=t;var e=this._obj?this._obj.image:null;if(!e||!e.id){var i="book_style:icons/"+t+".png";ImageLink.SetImage.call(this,this._obj,"image",{id:i})}},InitEdit:function(){var t=this._ictl.GetPosSize(),e=t?t.img_w:40,i=t?t.img_h:40,o=new ConstRectDragger(this,this._id,"main");o.Init({x:"x",y:"y",r:"r",z:"z"},{w:e,h:i,r:0,z:0}),o.UpdatePos(),this._draggers.main=o},_create_dom:function(){var t=$$("div");t.id=this._id+"#main#dom",t.className="ImageLink",t.setAttribute("role","button"),t.style.position="absolute",t.style.overflow="hidden",Canvas.Parent().appendChild(t);var e=this._obj,i=new ImageObject(this,ImageLink.ImageLoaded);i.SetSrcCtx(this._src_ctx),i.Create(t),this._ictl=i,!this._link_type||e.image&&e.image.id||ImageLink.SetImage.call(this,e,"image",e.image)},_addLinkNote:function(){var t=this._get_el("#main#note");if(t)t.style.display="block";else{(t=$$("img")).id=this._id+"#main#note",t.style.position="absolute",t.style.bottom="2px",t.style.right="2px";var e=to_producer_resource_("warning_overlay");t.setAttribute("src",e),this._get_el().appendChild(t)}},_removeLinkNote:function(){var t=this._get_el("#main#note");t&&(t.style.display="none")},_on_set_preview:function(t){EDIT_MODE&&(t?this._removeLinkNote():this._obj.link_to||this._addLinkNote())},OnDefaultEdit:function(){return Env.edit({ctlId:this._id,paramName:"link_to",posSize:this.GetHtmlPosSize(0)}),!0},_exec_link:function(){var t=this._link_to;if(-1!==t.search(":tourstop!")){var e=t.split(":");3===e.length&&(t=e[0]+":"+e[2])}ctx.registerEventListener&&ctx.registerEventListener({control_id:this._id,content_id:t}),RectControl.prototype._exec_link.call(this)}}),PageCanvas.prototype=new SlideControl,WCT.ExtendObject(PageCanvas,{ARROW_L:10,ARROW_NEXT:"ArrowNext",ARROW_EXT:"png",RULER_W:12,SNAPLINE_SPACE:14,RULER_BUFFER:10,SetShadow:function(t,e,i){this.CalcShadow()&&(Canvas.Base().style.boxShadow=this._shadow)},IgnoreFallbacks:function(){return 1==(arguments[0]||Canvas&&Canvas._obj||{}).ignore_fallbacks},SetTTSText:function(t,e,i){for(var o in Page.SetPlaceholderValue("ttstext",i),Controls)"page"!=o&&Controls[o].RTFireTrigger("update_placeholder",i);PageCanvas.HandleSubtitle()},HandleSubtitle:function(){var t=Page.GetConfig("show_tts_subtitle"),e=Page.GetPlaceholderValue("ttstext"),i=Canvas&&Canvas._obj&&Canvas._obj.pagesound;if(t&&e&&i){var o=Page.clientWidth,r=o/10,n=Canvas.x();if(!(n<0)){var s=Page.GetScale(),a=-(n*s-(r>>1))/s,_=Controls.page._obj.w*s,l=(0==a?_:o-r)/s,d=Controls.tts_subtitle;if(d)d.SetParam("text",e),d.SetParam("x",a),d.SetParam("w",l);else{var h=Page.GetConfig("subtitle_style");Page.AddControl({type:"subtitle",id:"tts_subtitle",x:a,y:0,w:l,h:0,z:2e3,padding:8,autosize:"h",opacity:75,text:e,align:h.align||"Center",background_color:h.background_color||"#000000",font_family:h.font_family||"Arial",font_size:h.font_size||"13",text_color:h.text_color||"#FFFFFF"},!0)}}}else Page.DeleteControl("tts_subtitle")},setTabIndex:function(t,e,i){Canvas.parent_obj_.tabIndex=i},SetTemplate:function(t,e,i){Page.SetTemplate(i)},SetStatusPosition:function(t,e,i){i!==Canvas.GetStatusPosition&&Canvas.SetStatusPosition(i)},show_toc:function(t,e,i){if(!EDIT_MODE&&i&&ctx.getToc){t=this._obj;var o=ctx.getToc();o&&(this.toc_=new Toc(o.toc,t.toc_position,t.toc_structure,t.toc_scroll))}},set_center_bg:function(){this._disable_dom_update||this._update_dom()},set_canvas_color:function(t,e,i){Canvas.Base().style.backgroundColor=i},clamp_wh:function(t,e){var i,o,r=2*Canvas.border();e=Math.max(10+r,e-0);var n={w:{arrow:["x0","x1"],"default":["x","w"]},h:{arrow:["y0","y1"],"default":["y","h"]}};for(var s in Controls){var a=Controls[s];if("page"!=s&&a&&a._obj){if(a.isStatusControl)continue;var _=a._obj,l=_.type;if("subtitle"===l)continue;var d="arrow"===l,h=d?l:"default";i=n[t][h][0],o=n[t][h][1];var c=_[i]||0,p=_[o]||0;e="bubble"===l?Math.max(c,e):d?Math.max(c,p,e):Math.max(c+p,e)}}return e},clamp_w:function(t,e){e.res=PageCanvas.clamp_wh("w",e.val)},clamp_h:function(t,e){e.res=PageCanvas.clamp_wh("h",e.val)},set_wh:function(t,e,i){var o=Canvas.Base(),r=$("base_obj#bgimage"),n="w"==e?"width":"height";if(i+="px",o.style[n]=i,r){var s=r.childNodes;r.style[n]=i;for(var a=0,_=null;_=s[a];a++)_.style[n]=i}arguments[3]||this._disable_dom_update||(this._update_dom(),Dragger.UpdateAll())},clamp_border:function(t,e){var i=Math.max(0,t.w-10>>1),o=Math.max(0,t.h-10>>1);e.res=Math.max(0,Math.min(i,o,e.val-0))},clamp_border_style:function(t,e){switch(e.val){case"":case"dotted":case"dashed":case"solid":case"double":case"groove":case"ridge":case"inset":case"window-inset":case"outset":e.res=e.val;break;case"none":default:e.res="none"}},set_border_style:function(t,e,i){this.set_border(t,"","none"==i?0:this._obj.border)},set_border_color:function(t,e,i){Canvas.Parent().style.borderColor=i},set_frame_image:function(t,e,i){var o=this.Frame(),r=i&&i.id?"url("+Context.ToAbsPath(i.id,this._src_ctx)+")":"";o.style.backgroundImage=r,o.style.backgroundSize=r?"cover":""},set_bg:function(t,e,i){this.Frame().style.backgroundColor=i,document.body.style.backgroundColor=i},set_skin:function(t,e,i){if(i!=this.skin_){var o=(this.skin_=i)||(FallbackValues&&FallbackValues.page&&FallbackValues.page.skin?FallbackValues.page.skin:"standard");Context.Set("book_style",o),this._disable_dom_update||Page.Refresh(),this.set_bg_image(t,"image",t.image),t.show_arrows&&!EDIT_MODE&&(this.set_show_arrows(t,"show_arrows",0),this.set_show_arrows(t,"show_arrows",t.show_arrows)),this._disable_dom_update||this._update_dom()}}}),WCT.ExtendObject(PageCanvas.prototype,{SetStatusPosition:function(t){this.status_position_=t,this._update_dom()},GetStatusPosition:function(){return this.status_position_},create_arrow:function(t,e,i){var o=this._id+"#",r="prev_btn_img"===e,n=ctx.cfg_tr(r?"BOOK_PREV_CHAPTER":"BOOK_NEXT_CHAPTER"),s=$$("div");s.id=o+t,s.tabIndex=this._obj.tabindex,s.title=n,s.setAttribute("aria-label",n),s.setAttribute("role","button"),s.style.position="fixed",s.style.top="50%",s.style[r?"left":"right"]=PageCanvas.ARROW_L+"px",s.style.zIndex=1e3,s.style.verticalAlign="middle",s.style.transform="translateY(-50%)",s.style.cursor="pointer";var a=r?"gotoPrevSlide":"gotoNextSlide";s.onclick=function(){ctx[a]&&ctx[a]()},s.onkeyup=function(t){var e=RT.normalize_evt(t);13!==e.button&&32!==e.button||ctx[a]&&ctx[a]()};var _=$$("img");return _.id=o+e,_.style.border="0",_.onmouseover=function(){this.src=this.src.replace(".gif","_highlight.gif")},_.onmouseout=function(){this.src=this.src.replace("_highlight","")},BROWSER.MOBILE&&(_.onload=function(t){this.offsetWidth&&(this.parentNode.style.width=this.offsetWidth+"px"),this.offsetHeight&&(this.parentNode.style.height=this.offsetHeight+"px")}),_.src=Context.ToAbsPath(i),s.appendChild(_),this.Frame().appendChild(s)},set_show_arrows:function(t,e,i){if(!EDIT_MODE){var o=this._get_el("#prev_btn"),r=this._get_el("#next_btn"),n=i&&ctx&&ctx.getToc&&ctx.getToc()||null;if(!n)return o&&this.Frame().removeChild(o),void(r&&this.Frame().removeChild(r));o=o||this.create_arrow("prev_btn","prev_btn_img","book_style:page/ArrowPrevious.gif"),r=r||this.create_arrow("next_btn","next_btn_img","book_style:page/ArrowNext.gif"),n.previousSlide?(o.style.visibility="visible",o.style.display=""):(o.style.visibility="hidden",o.style.display="none"),n.nextSlide?(r.style.visibility="visible",r.style.display=""):(r.style.visibility="hidden",r.style.display="none"),this._update_dom()}},clear_image:function(){if(BROWSER.IE&&window.Canvas){var t=Canvas.Base&&Canvas.Base();t&&"undefined"!=typeof t.style.filter&&(t.style.filter="",t.style.removeAttribute&&t.style.removeAttribute("filter"))}var e=$("base_obj#bgimage");e&&e.parentNode.removeChild(e)},track:function(){if(ctx.track){var t=this._obj;t.macro_uid&&ctx.track({id:"simple_macro",uid:t.macro_uid,caption:t.macro_caption})}},create_image:function(t,e){t?"number"!=typeof t.length&&(t=[t]):t=[null];var i=this._src_ctx,o="",r=this._obj,n=r.w||null,s=r.h||null,a="undefined"==typeof r.version,_=FallbackValues.page;_&&(o=_.image&&_.image.id||"",null==n&&(n=_.w||0),null==s&&(s=_.h||0));for(var l=0,d=t.length;l<d;l++){var h=t[l];!a||h&&""!=h.id||(t[l]={id:o,w:n,h:s},h=t[l]),h&&null!=h.id||(t[l]={id:o},h=t[l]),t[l].src=""!=h.id?Context.ToAbsPath(h.id,i):""}var c=$("base_obj#bgimage");if(c&&WCT.DeepEquals(this.bg_images_,t))return c;this.bg_images_=WCT.DeepCopy(t),this.clear_image(),(c=$$("div")).id="base_obj#bgimage",c.style.position="relative",WCT.dom.NotSelectable(c);var p=0;for(l=0,d=t.length;l<d;l++){var u=(h=t[l])&&h.src?h.src:"";if(u){var f=$$("img");f.id="base_obj#bgimage#"+l,WCT.dom.NotSelectable(f),e&&(WCT.image_watcher.Remove("base_obj#bgimage#"+l),WCT.image_watcher.Add(f)),f.src=u,f.alt=h.alt||"Screenshot",f.style.left="0",f.style.top="0",f.style.width=n+"px",f.style.height=s+"px",f.style.position="absolute",f.galleryImg=!1,c.appendChild(f),p++}}return p?(arguments[2]&&arguments[2].appendChild(c),c):null},set_bg_image:function(t,e,i){this.create_image(i,!0,Canvas.Base())},set_border:function(t,e,i){var o=Canvas.Parent();if(o.style.borderWidth=i+"px",0==i)o.style.borderStyle="none";else{var r=this._obj;o.style.borderStyle=r.border_style||"solid",o.style.borderColor=r.border_color||""}this._disable_dom_update||this._update_dom()},Terminate:function(){this.toc_&&(this.toc_=this.toc_.Destructor()),this.base_obj_=null,this.parent_obj_=null,this.frame_obj_=null,this.scrollbar_w_=null,this.scrollbar_h_=null,SlideControl.prototype.Terminate.call(this)},_remove_dom:function(){},SetMobileViewMode:function(t){Page.GetConfig("mobile_view_mode")!=t&&(Page.SetConfig("mobile_view_mode",t),this._update_dom())},OnViewResize:function(){this._update_dom()},FromFrame:function(t,e){return{x:t-this.can_x_-this.border(),y:e-this.can_y_-this.border()}},ApplyScaleToPos:function(t){var e=Page.GetScale(),i=Canvas.x(),o=Canvas.y();t.x=(t.x-i)*e+i,t.y=(t.y-o)*e+o},ToFrame:function(t,e){return{x:t+this.can_x_+this.border(),y:e+this.can_y_+this.border()}},GetClientWH:function(){if(!PLATFORM.IOS||BROWSER.IPHONE){var t=LESSON_EDIT?parent:window;Page.clientWidth=PLATFORM.WINCE?320:WCT.dom.GetWindowWidth(t),Page.clientHeight=WCT.dom.GetWindowHeight(t)}return{w:Page.clientWidth,h:Page.clientHeight}},GetSpaces:function(){var t={l:0,t:Toc.HEIGHT||0};return EDIT_MODE&&!BROWSER.MOBILE&&(t.l+=PageCanvas.RULER_W,t.t+=PageCanvas.RULER_W),t},AllowClamping:function(){return!this._obj.prevent_clamping},update_dom_edit_mode_:function(){var t=this.frame_obj_,e=this.parent_obj_,i=this.status_obj_;if(t&&e){var o=this.GetClientWH(),r=this.GetSpaces(),n="top"===this.status_position_,s=this._obj,a=2*this.border(),_=Page.GetScale();this.dspace_=PageCanvas.RULER_W+PageCanvas.RULER_BUFFER;var l=Math.round(_*(s.w+a+r.l+PageCanvas.SNAPLINE_SPACE)),d=Math.round(_*(s.h+a+r.t+PageCanvas.SNAPLINE_SPACE+this.sta_org_h_+this.dspace_+40)),h=0,c=0,p=o.w,u=o.h,f=s.background_image_centered;if(o.w>l?f&&(h=o.w-l>>1):BROWSER.MOBILE||(p=l+=this.scrollbar_w_),o.h>d?f&&(c=o.h-d>>1):BROWSER.MOBILE||(u=d+=this.scrollbar_h_),h+=r.l+PageCanvas.SNAPLINE_SPACE*_,c+=r.t+(PageCanvas.SNAPLINE_SPACE+this.dspace_)*_+(n?this.sta_org_h_*_:0),this.frame_w_==p&&this.frame_h_==u||(this.frame_w_=p,this.frame_h_=u,t.style.width=p+"px",t.style.height=u+"px"),BROWSER.IE){var m=document.documentElement,g=l+h*_>o.w?"":"hidden";t.style.overflowX=g,m.style.overflowX=g;var y=d+c*_>o.h?"":"hidden";t.style.overflowY=y,m.style.overflowY=y}this.can_x_=h,this.can_y_=c,e.style.left=h+"px",e.style.top=c+"px",this.sta_x_=h,i.style.left=h+"px",this.sta_y_=n?c-Math.round((this.dspace_+this.sta_org_h_+PageCanvas.SNAPLINE_SPACE)*_):this.sta_y_=c+Math.round((this.dspace_+s.h)*_),i.style.top=this.sta_y_+"px";var b=Math.round(s.w*_),v=Math.round(s.h*_),x=Math.round(s.w*_),w=Math.round(this.sta_org_h_*_);if(e.style.width=s.w+"px",e.style.height=s.h+"px",this.can_w_=b,this.can_h_=v,i.style.width=s.w+"px",i.style.height=this.sta_org_h_+"px",this.sta_w_=x,this.sta_h_=w,this.sta_ctls_in_line_=Math.floor(s.w/StatusControl.W),Dragger.UpdateAll(),Status.UpdateCtlsPos(),1!=_){var C=this._get_el("#prev_btn"),T=this._get_el("#next_btn");C&&(C.style.display="none"),T&&(T.style.display="none")}if(PLATFORM.IOS){m=document.documentElement;t.style.overflow="auto",m.style.overflow="auto"}}},update_dom_playback_:function(){var t=this.frame_obj_,e=this.parent_obj_,i=this.status_obj_,o="top"===this.status_position_;if(this.dspace_=PageCanvas.RULER_W+PageCanvas.RULER_BUFFER,t&&e){var r=this.GetClientWH(),n=this.GetSpaces();PLATFORM.WINCE&&(t.style.overflow="hidden",document.documentElement.style.overflow="hidden");var s=this._obj,a=2*this.border(),_=s.w+a+n.l+(EDIT_MODE?PageCanvas.SNAPLINE_SPACE:0),l=s.h+a+n.t+(EDIT_MODE?PageCanvas.SNAPLINE_SPACE+this.sta_org_h_+this.dspace_+40:0),d=0,h=0,c=r.w,p=r.h,u=s.background_image_centered;r.w>_?u&&(d=r.w-_>>1):EDIT_MODE&&!BROWSER.MOBILE&&(c=_),r.h>l?u&&(h=r.h-l>>1):EDIT_MODE&&!BROWSER.MOBILE&&(p=l);var f=1;if(!(BROWSER.IE&&BROWSER.VERSION<9||EDIT_MODE)){var m=Page.GetConfig(BROWSER.MOBILE?"mobile_view_mode":"view_mode"),g=!s.prevent_mobile_scale&&"100"!=m;if(this._obj.hide_scrollbars=this._obj.hide_scrollbars||g,g&&(_!=r.w||l!=r.h)){if(PLATFORM.WINDOWS||PLATFORM.WINTABLET){var y=document.getElementsByTagName("HTML")[0];y&&(y.style.overflow="hidden")}f=Math.floor(100*Math.min(r.w/_,r.h/l))/100,c=Math.floor(c/f),p=Math.floor(p/f),h=d=0,u&&(_<c&&(d=c-_>>1),l<p&&(h=p-l>>1))}RT.SetScale(f),BROWSER.MOBILE&&this.HideScrollbars(s.prevent_mobile_scale||!1)}d+=n.l+(EDIT_MODE?PageCanvas.SNAPLINE_SPACE:0),h+=n.t+(EDIT_MODE?PageCanvas.SNAPLINE_SPACE+this.dspace_+(o?this.sta_org_h_:0):0),this.frame_w_==c&&this.frame_h_==p||(this.frame_w_=c,this.frame_h_=p,t.style.width=c+"px",t.style.height=p+"px"),d==this.can_x_&&h==this.can_y_||(this.can_x_=d,this.can_y_=h,e.style.left=d+"px",e.style.top=h+"px",EDIT_MODE&&(this.sta_x_=d,this.sta_y_=o?h-this.sta_org_h_-this.dspace_-PageCanvas.SNAPLINE_SPACE:h+this.dspace_+s.h,i.style.left=d+"px",i.style.top=this.sta_y_+"px")),s.w==this.can_w_&&s.h==this.can_h_||(this.can_w_=s.w,this.can_h_=s.h,e.style.width=s.w+"px",e.style.height=s.h+"px",EDIT_MODE&&Editor&&(i.style.width=s.w+"px",i.style.height=this.sta_org_h_+"px",this.sta_w_=s.w,this.sta_h_=this.sta_org_h_)),this.toc_&&this.toc_.Resize()}},_update_dom:function(){EDIT_MODE&&!Editor||!this._obj||(EDIT_MODE&&!Editor.Preview()?this.update_dom_edit_mode_():this.update_dom_playback_())},Tick:function(t){t>=1e3*this._obj.autoplay&&(Ticker.Unregister(this._id),ctx.cfg_show("slide!next"))},Init:function(t){this.base_obj_=$("base_obj"),this.base_obj_.style.zoom=1;var e=this.parent_obj_=$("canvas");e.setAttribute("role","main");var i=this.frame_obj_=$("frame");i.style.backgroundImage="",i.style.backgroundSize="",i.setAttribute("role","application");var o=this.status_obj_=$("status");if(!EDIT_MODE&&!Editor){o.setAttribute("role","presentation");var r=t.screenreader_mode||"off";document.body.setAttribute("aria-live",r)}this.scrollbar_w_=WCT.dom.GetScrollbarWidth("se-stage"),this.scrollbar_h_=WCT.dom.GetScrollbarWidth("se-stage"),WCT.dom.NotSelectable(this.base_obj_),BROWSER.IE&&(e.setAttribute("unselectable","on"),e.unselectable=!0,i.setAttribute("unselectable","on"),i.unselectable=!0),LESSON_EDIT&&Page.ScrollToPos(Page.scrollLeft,Page.scrollTop),SlideControl.prototype.Init.call(this,t),this._update_dom(),"number"==typeof t.autoplay&&0<t.autoplay&&!EDIT_MODE&&Ticker.Register(this._id)},Base:function(){return this.base_obj_},Frame:function(){return this.frame_obj_},Parent:function(){return this.parent_obj_},Status:function(){return this.status_obj_},CreateBackgroundOverlay:function(t,e){var i=Math.max(this.w(),Page.clientWidth),o=Math.max(this.h(),Page.clientHeight),r=$$("div");return r.id=t,r.style.position="absolute",r.style.width=i+"px",r.style.height=o+"px",r.style.top="0",r.style.left="0",r.setAttribute("trigger_error_on_use",!1),r.style.backgroundColor=e,r.style.visibility="hidden",this.Frame().appendChild(r),r},RemoveBackgroundOverlay:function(t){if(t&&t.length)for(var e=this.Frame(),i=t.length-1;0<=i;i--){var o=$(t[i]);o&&e.removeChild(o)}},border:function(){var t=this._obj;return"none"!=t.border_style&&t.border||0},centered:function(){return this._obj.background_image_centered},w:function(){return this._obj.w},h:function(){return this._obj.h},FrameW:function(){return this.frame_w_},FrameH:function(){return this.frame_h_},x:function(){return this.can_x_+this.border()},y:function(){return this.can_y_+this.border()},StatusX:function(){return this.sta_x_},StatusY:function(){return this.sta_y_},StatusW:function(){return this.sta_w_},StatusH:function(){return this.sta_h_},SetStatusHeight:function(t){EDIT_MODE&&this.sta_org_h_!=t&&(this.sta_org_h_=t,Editor.Preview()?this.update_dom_playback_():this.update_dom_edit_mode_())},GetStaCtlsInLine:function(){return this.sta_ctls_in_line_},TransCoorSys:function(t){var e=t||{x:0,y:0},i=Editor.GetScale(),o=this.can_x_-this.sta_x_,r=this.can_y_-this.sta_y_;return{x:e.x+Math.round(o/i),y:e.y+Math.round(r/i)}},HideScrollbars:function(){var t=this.frame_obj_;if(t){if((BROWSER.CHROME||BROWSER.EDGECHR)&&1!==Page.GetScale()){var e=!1;for(var i in Controls)if(Controls.hasOwnProperty(i)&&"shape"===Controls[i].GetType()){e=!0;break}if(e)return void(t.style.overflow="")}var o="boolean"==typeof arguments[0]?arguments[0]:this._obj.hide_scrollbars;t.style.overflow=o?"hidden":"auto"}},OnRTMouseClick:function(t){this._obj.onclick&&Page.RTFireTrigger(this._obj.onclick)},_on_set_preview:function(t){this._update_dom()},CloseToc:function(){this.toc_&&this.toc_.Close()},SetBookStep:function(t,e){for(var i in Controls){var o=Controls[i];o.HandlesBookProgress&&o.HandlesBookProgress()&&Page.RTFireTrigger(i+".set_progress#"+t+"#"+e)}},RTFireTrigger:function(t,e){switch(t){case"enable_navigation":case"disable_navigation":Env.PreventNavigation(0===t.search("disable"));break;case"trainer":ctx.onTrainerTrigger&&ctx.onTrainerTrigger(e[0]);break;case"video_audio_play":ctx.OnVideoAudio&&ctx.OnVideoAudio("start",e);break;case"video_audio_finish":ctx.OnVideoAudio&&ctx.OnVideoAudio("stop",e);break;case"pause":Page.Pause(WCT.ClampBoolean(e[0]));break;case"book_progress":e&&2==e.length&&this.SetBookStep.apply(this,e);break;case"show_demo_help":ctx.showDemoHelp?ctx.showDemoHelp.apply(ctx,e):EDIT_MODE&&Editor.RuntimeInfo("Show Demo Help: "+e[0]);break;case"focus":this._obj.onfocus&&Page.RTFireTrigger(this._obj.onfocus);break;case"blur":this._obj.onblur&&Page.RTFireTrigger(this._obj.onblur);break;case"track":var i=(r=Controls[e[0]])&&r._obj;if(i&&window.ctx&&ctx.track){var o={id:"simple_macro",uid:i.macro_uid,caption:i.macro_caption};i.macro_description&&(o.description=i.macro_description),ctx.track(o)}break;case"ignore_sim_action":(r=Controls[e[0]])&&r._obj&&(r._obj.ignore_sim_action=!0);break;case"handle_sim_action":var r;(r=Controls[e[0]])&&r._obj&&(r._obj.ignore_sim_action=!1);break;case"t2_config":var n=e.cfg||e[0],s=e.value||e[1];ctx.setConfig?ctx.setConfig(n,s):EDIT_MODE&&Editor.RuntimeInfo("T2 Config: "+n);break;case"hide_panel":ctx.showPanel?ctx.showPanel(!1):EDIT_MODE&&Editor.RuntimeInfo("Hide Panel");break;case"show_panel":ctx.showPanel?ctx.showPanel(!0):EDIT_MODE&&Editor.RuntimeInfo("Show Panel");break;case"hide_mouse":window.Mouse&&Mouse.Hide();break;case"lesson_play":case"lesson_pause":case"lesson_restart":case"lesson_end":case"lesson_exit":case"lesson_startstop_print":case"lesson_startstop_details":ctx.lessonAction?ctx.lessonAction(t):EDIT_MODE&&Editor.RuntimeInfo(t.split("_").join(" "));break;case"task_next":ctx.gotoNextTask?ctx.gotoNextTask():EDIT_MODE&&Editor.RuntimeInfo("Next Task");break;case"task_prev":ctx.gotoPrevTask?ctx.gotoPrevTask():EDIT_MODE&&Editor.RuntimeInfo("Previous Task");break;case"task_jump":ctx.gotoTask?ctx.gotoTask(e):EDIT_MODE&&Editor.RuntimeInfo("Goto Task: "+e);break;case"slide_jump":ctx.gotoSlide?ctx.gotoSlide(e):EDIT_MODE&&Editor.RuntimeInfo("Goto Slide: "+e);break;case"tourstop_jump":e&&e.isArray&&(e=e[0]),ctx.gotoTourstop?ctx.gotoTourstop(e):EDIT_MODE&&Editor.RuntimeInfo("Goto Tourstop: "+e);break;case"share":ctx.cfg_show("action!share");break;case"next":ctx.gotoNextSlide?ctx.gotoNextSlide():EDIT_MODE?Editor.RuntimeInfo("Next Slide"):ctx.cfg_show("slide!next");break;case"prev":ctx.gotoPrevSlide?ctx.gotoPrevSlide():EDIT_MODE?Editor.RuntimeInfo("Previous Slide"):ctx.cfg_show("slide!previous");break;case"mute_Master":Media.Mute(!0),ctx.onMute&&ctx.onMute("Master");break;case"mute_Booksound":case"mute_Narrative":case"mute_Effects":var a=t.substr(5);Media.audio.Mute(a,!0),ctx.onMute&&ctx.onMute(a);break;case"play_Channel":Media.audio.Play(e[0]);break;case"unmute_Master":Media.Unmute(!0),ctx.onUnmute&&ctx.onUnmute("Master");break;case"unmute_Booksound":case"unmute_Narrative":case"unmute_Effects":a=t.substr(7);Media.audio.Unmute(a,!0),ctx.onUnmute&&ctx.onUnmute(a);break;case"togglemute_Master":var _="on"+(l=Media.mixer.Get("mute","Master",!0)?"Unmute":"Mute");Media[l](!0),ctx[_]&&ctx[_]("Master");break;case"togglemute_Booksound":case"togglemute_Narrative":case"togglemute_Effects":var l;a=t.substr(11),_="on"+(l=Media.mixer.Get("mute",a,!0)?"Unmute":"Mute");Media.audio[l](a,!0),ctx[_]&&ctx[_](a);break;case"incvol_Master":var d=Math.min((Media.mixer.Get("volume","Master",!0)||0)+10,100);Media.Volume(d,!0),ctx.onVolume&&ctx.onVolume("Master",d);break;case"incvol_Booksound":case"incvol_Narrative":case"incvol_Effects":a=t.substr(7),d=Math.min((Media.mixer.Get("volume",a,!0)||0)+10,100);Media.audio.Volume(a,d,!0),ctx.onVolume&&ctx.onVolume(a,d);break;case"decvol_Master":d="number"==typeof(d=Media.mixer.Get("volume","Master",!0))?Math.max(0,d-10):90,Media.Volume(d,!0),ctx.onVolume&&ctx.onVolume("Master",d);break;case"decvol_Booksound":case"decvol_Narrative":case"decvol_Effects":a=t.substr(7);d="number"==typeof(d=Media.mixer.Get("volume",a,!0))?Math.max(0,d-10):90,Media.audio.Volume(a,d,!0),ctx.onVolume&&ctx.onVolume(a,d);break;default:EDIT_MODE&&Editor.RuntimeInfo(this._id+" has no trigger: "+t)}},HandleWheelError:function(){return this._obj.handle_wheel_error||!1},on_channel_event_:function(t){var e=this._obj;"finish"===t&&e.onpagesoundfinish&&Page.RTFireTrigger(e.onpagesoundfinish)}}),WCT.ExtendObject(Dragger,{CLR_IDLE:"#6C6C6C",CLR_LOCKED:"#6C6C6C",CLR_SELECTED:"#D32030",CLR_ACTIVE_SELECTED:"#FF4336",CLR_ACTIVE:"#AB218E",CLR_PARENT_SEL:"#AB218E",CLR_HIDDEN:"#BFBFBF",CLR_RELATED:{source:"#D954BD",target:"#AB218e"},CLR_GUIDE_IDLE:"#000",GRP_CLR_SELECTED:"#9DC62D",GRP_CLR_ACTIVE_SELECTED:"#61A656",DRG_LINE_WIDTH:2,DRG_LINE_INACTIVE_WIDTH:1,DRG_RELATED_LINE_WIDTH:2,GRP_LINE_WIDTH:2,DRG_OPACITY:33,DRG_LINE_STYLE:"dotted",DRG_LINE_INACTIVE_STYLE:"dotted",GRP_LINE_STYLE:"dotted",DRG_RELATED_LINE_STYLE:"dotted",HANDLE_SIZE:8,INFO_THRESHOLD:8,GetGuideDrgClr:function(t,e){return Dragger[t?e?"CLR_LOCKED":"CLR_ACTIVE_SELECTED":"CLR_GUIDE_IDLE"]},SetIdleColor:function(t){this.CLR_IDLE=t?"#AB0000":"#808080"},UpdateAll:function(){for(var t in Draggers)Draggers[t].UpdatePos&&Draggers[t].UpdatePos(!0)},CopyRect:function(t,e){e.x=t.x,e.y=t.y,e.w=t.w,e.h=t.h,e.r=t.r,"undefined"!=typeof t.z&&(e.z=t.z),"undefined"!=typeof t.orientation&&(e.orientation=t.orientation),t.offset&&(e.offset={x:t.offset.x,y:t.offset.y}),t.spikeOffset&&(e.spikeOffset={x:t.spikeOffset.x,y:t.spikeOffset.y})},ApplyDeltaLimit:function(t,e){t.x=Math[0<t.x?"min":"max"](t.x,e.x),t.y=Math[0<t.y?"min":"max"](t.y,e.y)},HdlTextbox:{pos:{clamp:function(t,e){var i=Canvas.border(),o=i-Canvas.x()-t.x,r=i+Canvas.w()-t.x-10;e.x=Math.min(r,Math.max(o,e.x));var n=i-Canvas.y()-t.y,s=i+Canvas.h()-t.y-10;e.y=Math.min(s,Math.max(n,e.y))},apply:function(t,e){t.x+=e.x,t.y+=e.y}},t:{clamp:function(t,e){var i=Canvas.border(),o=i-Canvas.y()-t.y,r=i+Canvas.h()-t.y-10,n=t.h-t.minh;e.y=Math.min(r,Math.max(o,Math.min(n,e.y)))},apply:function(t,e){t.y=t.y+e.y,t.h=t.h-e.y}},l:{clamp:function(t,e){var i=Canvas.border(),o=i-Canvas.x()-t.x,r=i+Canvas.w()-t.x-10,n=t.w-t.minw;e.x=Math.min(r,Math.max(o,Math.min(n,e.x)))},apply:function(t,e){t.x=t.x+e.x,t.w=t.w-e.x}},r:{clamp:function(t,e){var i=t.minw-t.w;e.x<i&&(e.x=i)},apply:function(t,e){t.w+=e.x}},b:{clamp:function(t,e){var i=t.minh-t.h;e.y<i&&(e.y=i)},apply:function(t,e){t.h+=e.y}}},HdlCanvascontrol:{pos:{clamp:function(t,e){var i=Canvas.w()-t.x-t.w,o=Canvas.h()-t.y-t.h;e.x=Math.min(i,Math.max(-t.x,e.x)),e.y=Math.min(o,Math.max(-t.y,e.y))},apply:function(t,e){t.x+=e.x,t.y+=e.y}},t:{clamp:function(t,e){var i=t.h-t.minh;e.y=Math.max(-t.y,Math.min(i,e.y)),0<e.y?e.y=2*Math.floor((t.h+e.y)/2)-t.h:e.y=-(2*Math.floor((t.h-e.y)/2)-t.h)},apply:function(t,e){t.y=t.y+e.y,t.h=t.h-e.y}},l:{clamp:function(t,e){var i=t.w-t.minw;e.x=Math.max(-t.x,Math.min(i,e.x)),0<e.x?e.x=2*Math.floor((t.w+e.x)/2)-t.w:e.x=-(2*Math.floor((t.w-e.x)/2)-t.w)},apply:function(t,e){t.x=t.x+e.x,t.w=t.w-e.x}},r:{clamp:function(t,e){var i=t.minw-t.w,o=Canvas.w()-t.w-t.x;e.x=Math.min(o,Math.max(i,e.x)),0<e.x?e.x=2*Math.floor((t.w+e.x)/2)-t.w:e.x=-(2*Math.floor((t.w-e.x)/2)-t.w)},apply:function(t,e){t.w+=e.x}},b:{clamp:function(t,e){var i=t.minh-t.h,o=Canvas.h()-t.h-t.y;e.y=Math.min(o,Math.max(i,e.y)),0<e.y?e.y=2*Math.floor((t.h+e.y)/2)-t.h:e.y=-(2*Math.floor((t.h-e.y)/2)-t.h)},apply:function(t,e){t.h+=e.y}}},HdlHotspotquiz:{pos:{clamp:function(t,e,i){var o=i._parent,r=o._draggers.main._rect,n=o._obj.border,s=o.img_data_,a=o.container_info_,_=r.x+a.x+n,l=r.y+a.y+n,d=_+s.w-t.w,h=l+s.h-t.h,c=t.x+e.x,p=t.y+e.y;c<_&&(c=_),d<c&&(c=d),p<l&&(p=l),h<p&&(p=h),e.x=c-t.x,e.y=p-t.y},apply:function(t,e){t.x+=e.x,t.y+=e.y}},t:{clamp:function(t,e,i){var o=i._parent,r=o._draggers.main._rect,n=o._obj.border,s=o.container_info_,a=r.y+s.y+n,_=t.y+t.h,l=t.y+e.y;l<a&&(l=a),_<l&&(l=_),e.y=l-t.y},apply:function(t,e){t.y=t.y+e.y,t.h=t.h-e.y}},l:{clamp:function(t,e,i){var o=i._parent,r=o._draggers.main._rect,n=o._obj.border,s=o.container_info_,a=r.x+s.x+n,_=t.x+t.w,l=t.x+e.x;_<l&&(l=_),l<a&&(l=a),e.x=l-t.x},apply:function(t,e){t.x=t.x+e.x,t.w=t.w-e.x}},r:{clamp:function(t,e,i){var o=i._parent,r=o._draggers.main._rect,n=o.img_data_,s=o.container_info_,a=o._obj.border,_=t.x,l=r.x+s.x+n.w+a,d=t.x+t.w+e.x;l<d&&(d=l),d<_&&(d=_),e.x=d-(t.x+t.w)},apply:function(t,e){t.w+=e.x}},b:{clamp:function(t,e,i){var o=i._parent,r=o._draggers.main._rect,n=o._obj.border,s=o.img_data_,a=o.container_info_,_=t.y,l=r.y+a.y+s.h+n,d=t.y+t.h+e.y;d<_&&(d=_),l<d&&(d=l),e.y=d-(t.y+t.h)},apply:function(t,e){t.h+=e.y}}}}),BROWSER.MOBILE?Dragger.HANDLE_SIZE*=2.5:BROWSER.IE&&(Dragger.HANDLE_SIZE-=2),WCT.ExtendObject(Dragger.prototype,{hdl:{pos:{clamp:function(t,e){var i=Canvas.w()-t.w-t.x,o=Canvas.h()-t.h-t.y;e.x=Math.min(i,Math.max(-t.x,e.x)),e.y=Math.min(o,Math.max(-t.y,e.y))},apply:function(t,e){t.x+=e.x,t.y+=e.y}},t:{clamp:function(t,e){e.y=Math.max(-t.y,Math.min(t.h-t.minh,e.y))},apply:function(t,e){t.y=t.y+e.y,t.h=t.h-e.y}},l:{clamp:function(t,e){e.x=Math.max(-t.x,Math.min(t.w-t.minw,e.x))},apply:function(t,e){t.x=t.x+e.x,t.w=t.w-e.x}},r:{clamp:function(t,e){var i=Canvas.w()-t.w-t.x;e.x=Math.min(i,Math.max(t.minw-t.w,e.x))},apply:function(t,e){t.w+=e.x}},b:{clamp:function(t,e){var i=Canvas.h()-t.h-t.y;e.y=Math.min(i,Math.max(t.minh-t.h,e.y))},apply:function(t,e){t.h+=e.y}}},Destroy:function(){this.remove_rect_handles_(),this._parent=null;var t=this._get_el("state");t&&t.parentNode.removeChild(t),delete Draggers[this._id+"#"+this._sub_id]},setHandle:function(t){this.hdl=t},ParentId:function(){return this._id},SubId:function(){return this._sub_id},_get_el:function(t){return $(this.el_id_(t))},el_id_:function(t){return this._id+"#"+this._sub_id+"#"+t},get_drg_parent_:function(){return BROWSER.IE&&BROWSER.VERSION<9?document.body:Canvas.Frame()},create_handle_:function(t){var e=arguments[1]||this.get_drg_parent_(),i=Dragger.HANDLE_SIZE+"px",o=$$("div");o.id=this.el_id_(t),o.className=arguments[2]||"drag_handle",o.style.position="absolute",o.style.fontSize="0px",o.style.width=i,o.style.height=i,o.style.zIndex=99,e.appendChild(o)},remove_handle_:function(t){var e=this._get_el(t);e&&e.parentNode.removeChild(e)},show_handle_:function(t,e){var i=this._get_el(t);i&&(i.style.display=e?"block":"none")},remove_rect_handles_:function(){for(var t=["s","t","l","r","b","lt","lb","rt","rb"],e=0,i=null;i=t[e++];)this.remove_handle_(i)},update_handles_:function(t,e){for(var i=["t","l","r","b","lt","lb","rt","rb"],o=0,r=null;r=i[o++];){var n=this._get_el(r);n&&(n.style[t]=e)}},update_line_handles_:function(t,e,i){var o=this._get_el(t);o&&(o.style[e]=i)},show_rect_handles_:function(t){var e=arguments[1];if(e)for(var i in e)e[i]?this.show_handle_(i,t):this.show_handle_(i,!1);else for(var o=["t","l","r","b","lt","lb","rt","rb"],r=0,n=null;n=o[r++];)this.show_handle_(n,t);this._handles_visible=t},set_handle_pos_:function(t,e,i){var o=this._get_el(t);o&&(o.style.left=e+"px",o.style.top=i+"px")},get_rect_:function(){var t=Canvas.x(),e=Canvas.y(),i=Editor.GetScale(),o=this._rect;return{x:o.x*i+t,y:o.y*i+e,w:o.w*i,h:o.h*i,z:o.z}},get_show_data_:function(t){var e=Canvas.x(),i=Canvas.y(),o=Editor.GetScale(),r=Page.GetContentScale();return{x:Math.round((t.x-e)/o*r),xw:Math.round((t.x+t.w-e)/o*r),y:Math.round((t.y-i)/o*r),yh:Math.round((t.y+t.h-i)/o*r),w:Math.round(t.w/o*r),h:Math.round(t.h/o*r)}},Init:function(t){},SetSelected:function(t){this._selected!=t&&(this._selected=t,this.StateToDom())},Selected:function(){if(this._selected)return!0;var t=this._parent;if(t.IsGrouped()){var e=t.GetGroupId();return Draggers[e+"#main"].Selected()}return!1},StateToDom:function(){this._preview=Editor.Preview(),this._readonly=Editor.ReadOnly(),this._parent_active=this._parent.Id()==Editor.Active(),this._locked=this._parent._obj.locked,this._parent_sel=this._parent.Selected(),this._related=this._parent._related,this._refresh_dom()},UpdatePos:function(){},Locked:function(){return this._parent.Locked()},Hidden:function(){return this._parent.Hidden()},StartDrag:function(t){},Limit:function(t,e){},Apply:function(t,e){},ApplySpecial:function(t,e){},EndDrag:function(t){},RectSelect:function(t,e,i,o,r){},GetSnapPoints:function(t,e,i,o,r){},SetVisible:function(t){this._visible=t,this.StateToDom()},GetVisible:function(){return this._visible},HitTest:function(t,e){return null},isSelectable:function(){return!0}}),RectDragger.prototype=new Dragger,WCT.ExtendObject(RectDragger.prototype,{Destroy:function(){this.lim_=null,Dragger.prototype.Destroy.call(this)},LimitWH:function(t,e){this.lim_.w=t,this.lim_.h=e},_write_parent_rect:function(){var t=this._coords,e=this._rect,i=this._parent._obj,o=this._id;for(var r in t){var n=t[r],s=e[r];void 0!==s&&i[n]!=s&&(i[n]=s,n&&"offset"!=n&&"spikeOffset"!=n&&Env.onPropChange(o,n,s))}Env.AddHistory()},HitTest:function(t,e){if(!this._visible)return null;var i=this._parent,o=i._obj;if(!this._selected){var r=this.GetHitShape();if(Shape.HitTest(t,e,r)){var n=o.z;return"popup"==this._sub_id?n=o.textBoxZ:"hotspot"==this._sub_id&&(n+=1),{ctl_id:this._id,sub_id:this._sub_id,hdl_id:"sel",hdl_type:"sel",code:this._id+"#"+this._sub_id+"#sel",z:n}}return null}var s=this._rect,a=s.x,_=a+s.w,l=(a+_)/2,d=s.y,h=d+s.h,c=(d+h)/2,p=Editor.GetScale(),u=Dragger.HANDLE_SIZE/p+2,f=a-u,m=_+u,g=d-u,y=h+u;if(!pt_in_rect4(t,e,f,m,g,y))return null;var b=a-Dragger.DRG_LINE_WIDTH,v=_+Dragger.DRG_LINE_WIDTH,x=d-Dragger.DRG_LINE_WIDTH,w=h+Dragger.DRG_LINE_WIDTH,C=l-u/2,T=l+u/2,S=c-u/2,k=c+u/2,E="";if(i._editFields){var R=i.EditFieldHitTest.call(i,t+Canvas.x(),e+Canvas.y());R&&R.tid&&(E="text")}var O="";pt_in_rect4(t,e,f,a,g,d)?O="lt":pt_in_rect4(t,e,C,T,g,d)?O="t":pt_in_rect4(t,e,_,m,g,d)?O="rt":pt_in_rect4(t,e,f,a,S,k)?O="l":pt_in_rect4(t,e,_,m,S,k)?O="r":pt_in_rect4(t,e,f,a,h,y)?O="lb":pt_in_rect4(t,e,C,T,h,y)?O="b":pt_in_rect4(t,e,_,m,h,y)?O="rb":pt_in_rect(t,e,s)?O="pos_inner":pt_in_rect4(t,e,b,v,x,w)&&(O="pos");var I={ctl_id:this._id,sub_id:this._sub_id,hdl_id:O,hdl_type:E||O};return"pos_inner"==O?(I.hdl_id="pos",I.hdl_type=E||"pos",I.code=this._id+"#"+this._sub_id+"#pos",I.z=o.z,"popup"==this._sub_id?I.z=this._parent._obj.textBoxZ:"hotspot"==this._sub_id&&(I.z+=1),I):O?(I.code=this._id+"#"+this._sub_id+"#"+O,I.z=this._parent._obj.z+1e3,I):null},_read_parent_rect:function(){var t=this._coords,e=this._rect,i=this._parent._obj,o=!1;for(var r in t){var n=t[r],s=e[r];void 0!==s&&i[n]!=s&&(e[r]=i[n],o=!0)}return o},Init:function(t){this._coords=t,this._read_parent_rect();var e=$$("div");e.className="state_rect",e.id=this.el_id_("state"),e.style.position="absolute",e.style.zoom=1,e.style.zIndex=this._rect.z+(this._selected?2e3:0),e.style.display=this._visible?"":"none",this.get_drg_parent_().appendChild(e);var i=this.lim_;i.w||(this.create_handle_("l",e),this.create_handle_("r",e)),i.h||(this.create_handle_("t",e),this.create_handle_("b",e)),i.w||i.h||(this.create_handle_("lt",e),this.create_handle_("lb",e),this.create_handle_("rt",e),this.create_handle_("rb",e)),this._refresh_dom(),Draggers[this._id+"#"+this._sub_id]=this},UpdatePos:function(){(this._read_parent_rect()||arguments[0])&&this._refresh_dom()},info_w:24,info_h:12,_set_info_el:function(t,e,i,o,r,n,s){var a="inf_"+t,_=this._get_el(a);_?(_.style.left=e-this.info_w/2+"px",_.style.top=i-this.info_h/2+"px"):((_=$$("div")).className="info_el",_.style.left=e-this.info_w/2-1+"px",_.style.top=i-this.info_h/2-1+"px",_.id=this.el_id_(a),_=this.get_drg_parent_().appendChild(_)),_.innerHTML=o},_rem_info_el:function(t){var e=this._get_el("inf_"+t);e&&e.parentNode.removeChild(e)},_set_info:function(t,e){var i=0;t.w<2*this.info_w+20&&(i=this.info_w-t.w/2+10);var o=0;t.h<2*this.info_h+10&&(o=this.info_h-t.h/2+5);var r=t.x-20-this.info_w/2,n=t.y-16-this.info_h/2,s=this.get_show_data_(t);this._set_info_el("l",t.x-i,n,s.x,0,0,"lt"==e||"l"==e||"pos"==e||"lb"==e),this._set_info_el("w",t.x+t.w/2,n,s.w,-2,2,"pos"!=e&&"t"!=e&&"b"!=e),this._set_info_el("r",t.x+t.w+i,n,s.xw,0,0,"rt"==e||"pos"==e||"r"==e||"rb"==e),this._set_info_el("t",r,t.y-o,s.y,0,0,"t"==e||"pos"==e||"rt"==e||"lt"==e),this._set_info_el("h",r,t.y+t.h/2,s.h,0,0,"pos"!=e&&"l"!=e&&"r"!=e),this._set_info_el("b",r,t.y+t.h+o,s.yh,0,0,"b"==e||"pos"==e||"lb"==e||"rb"==e)},_rem_info:function(t){this._rem_info_el("l"),this._rem_info_el("w"),this._rem_info_el("r"),this._rem_info_el("t"),this._rem_info_el("h"),this._rem_info_el("b")},_refresh_dom:function(t){var e=this._get_el("state");if(e){LESSON_EDIT||set_opacity(e,100);var i=!1,o=this._selected;this._preview||!this._visible?e.style.display="none":(e.style.display="block",this.Hidden()?(e.style.border=(o?Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE:Dragger.DRG_LINE_INACTIVE_WIDTH+"px "+Dragger.DRG_LINE_STYLE)+" "+Dragger.CLR_HIDDEN,o||LESSON_EDIT||set_opacity(e,Dragger.DRG_OPACITY),i=!o,this.update_handles_("background-color",Dragger.CLR_HIDDEN)):this.Locked()?(e.style.border=(o?Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE:Dragger.DRG_LINE_INACTIVE_WIDTH+"px "+Dragger.DRG_LINE_STYLE)+" "+Dragger.CLR_LOCKED,o||LESSON_EDIT||set_opacity(e,Dragger.DRG_OPACITY),i=!o):o?this._parent_active?(e.style.border=Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE+" "+Dragger.CLR_ACTIVE_SELECTED,this.update_handles_("background-color",Dragger.CLR_ACTIVE_SELECTED)):(e.style.border=Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE+" "+Dragger.CLR_SELECTED,this.update_handles_("background-color",Dragger.CLR_SELECTED)):this._parent_active?(e.style.border=Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE+" "+Dragger.CLR_ACTIVE,this.update_handles_("background-color",Dragger.CLR_ACTIVE)):this._parent_sel?(e.style.border=Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE+" "+Dragger.CLR_PARENT_SEL,this.update_handles_("background-color",Dragger.CLR_PARENT_SEL)):this._related?(e.style.border=Dragger.DRG_RELATED_LINE_WIDTH+"px "+Dragger.DRG_RELATED_LINE_STYLE+" "+Dragger.CLR_RELATED[this._related],i=!0):LESSON_EDIT?e.style.border=Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE+" "+Dragger.CLR_IDLE:(e.style.border=Dragger.DRG_LINE_INACTIVE_WIDTH+"px "+Dragger.DRG_LINE_STYLE+" "+Dragger.CLR_IDLE,set_opacity(e,Dragger.DRG_OPACITY),i=!0));var r=this.get_rect_();t&&Editor.DragSelectionSize()<Dragger.INFO_THRESHOLD&&!arguments[1]?this._set_info(r,t):this._rem_info(),!this._preview&&this._visible&&(i?(e.style.left=r.x+"px",e.style.top=r.y+"px",e.style.width=Math.max(1,r.w-2)+"px",e.style.height=Math.max(1,r.h-2)+"px"):(e.style.left=r.x-Dragger.DRG_LINE_WIDTH+"px",e.style.top=r.y-Dragger.DRG_LINE_WIDTH+"px",e.style.width=r.w+"px",e.style.height=r.h+"px"),e.style.zIndex=r.z+(o?2e3:0));var n=!this.Locked()&&!this._preview&&this._visible&&this._selected&&"pos"!=t;n&&(this.set_handle_pos_("t",(r.w-Dragger.HANDLE_SIZE)/2,-Dragger.HANDLE_SIZE),this.set_handle_pos_("l",-Dragger.HANDLE_SIZE,(r.h-Dragger.HANDLE_SIZE)/2),this.set_handle_pos_("r",r.w,(r.h-Dragger.HANDLE_SIZE)/2),this.set_handle_pos_("b",(r.w-Dragger.HANDLE_SIZE)/2,r.h),this.set_handle_pos_("lt",-Dragger.HANDLE_SIZE,-Dragger.HANDLE_SIZE),this.set_handle_pos_("lb",-Dragger.HANDLE_SIZE,r.h),this.set_handle_pos_("rt",r.w,-Dragger.HANDLE_SIZE),this.set_handle_pos_("rb",r.w,r.h)),this._handles_visible!=n&&this.show_rect_handles_(n)}},StartDrag:function(t,e){Dragger.CopyRect(this._rect,this._orig_rect)},Limit:function(t,e){var i={x:e.x,y:e.y},o=this._parent._rd_get_min_rect(this._sub_id);switch(this._orig_rect.minw=o.w,this._orig_rect.minh=o.h,t.hdl_id){case"rt":this.hdl.t.clamp(this._orig_rect,i,this),this.hdl.r.clamp(this._orig_rect,i,this);break;case"rb":this.hdl.b.clamp(this._orig_rect,i,this),this.hdl.r.clamp(this._orig_rect,i,this);break;case"lb":this.hdl.b.clamp(this._orig_rect,i,this),this.hdl.l.clamp(this._orig_rect,i,this);break;case"lt":this.hdl.t.clamp(this._orig_rect,i,this),this.hdl.l.clamp(this._orig_rect,i,this);break;case"t":this.hdl.t.clamp(this._orig_rect,i,this);break;case"b":this.hdl.b.clamp(this._orig_rect,i,this);break;case"l":this.hdl.l.clamp(this._orig_rect,i,this);break;case"r":this.hdl.r.clamp(this._orig_rect,i,this);break;case"s":this.hdl.s&&this.hdl.s.clamp(this._rect,e,this);break;default:this.hdl.pos.clamp(this._orig_rect,i,this)}Dragger.ApplyDeltaLimit(e,i)},Apply:function(t,e){Dragger.CopyRect(this._orig_rect,this._rect);var i=t.hdl_id;switch(i){case"rt":this.hdl.t.apply(this._rect,e,this),this.hdl.r.apply(this._rect,e,this);break;case"rb":this.hdl.b.apply(this._rect,e,this),this.hdl.r.apply(this._rect,e,this);break;case"lb":this.hdl.b.apply(this._rect,e,this),this.hdl.l.apply(this._rect,e,this);break;case"lt":this.hdl.t.apply(this._rect,e,this),this.hdl.l.apply(this._rect,e,this);break;case"t":this.hdl.t.apply(this._rect,e,this);break;case"b":this.hdl.b.apply(this._rect,e,this);break;case"l":this.hdl.l.apply(this._rect,e,this);break;case"r":this.hdl.r.apply(this._rect,e,this);break;case"s":this.hdl.s&&this.hdl.s.apply(this._rect,e,this,t);break;default:this.hdl.pos.apply(this._rect,e,this),i="pos"}this._refresh_dom(i,arguments[2]),"pos"==i&&this._parent._rd_update_dom_pos?this.hotspotquiz&&"hotspot"==this._sub_id||this._parent._rd_update_dom_pos(this._sub_id,this._rect):"s"==i||this._parent._rd_update_dom_rect&&this._parent._rd_update_dom_rect(this._sub_id,this._rect)},EndDrag:function(t){this._write_parent_rect(),this._refresh_dom(!1)},RectSelect:function(t,e,i,o,r){return this._rect.x<=o&&this._rect.x+this._rect.w>=e&&this._rect.y<=r&&this._rect.y+this._rect.h>=i},GetHitShape:function(){var t=this._rect;return[{x:t.x,y:t.y},{x:t.x+t.w,y:t.y},{x:t.x+t.w,y:t.y+t.h},{x:t.x,y:t.y+t.h}]},GetSnapPoints:function(t,e,i,o,r){if(t.obj){var n=!1,s=!1,a=!1,_=!1,l=!1,d=!1;switch(o){case"lt":s=n=!0;break;case"lb":_=n=!0;break;case"rt":s=a=!0;break;case"rb":_=a=!0;break;case"t":s=!0;break;case"l":n=!0;break;case"r":a=!0;break;case"b":_=!0;break;case"s":break;default:l=!0;var h=LineDragger.DRAG_TYPE.substr(1),c=PolyLineDragger.DRAG_TYPE.substr(1),p=arguments[5];r==h||r==c?d=!0:"connector"!=p&&"arrow"!=p||(d=!0)}var u=this._rect;if((n||l)&&(add_snap_point(e,u.x,"l"),t.inner_border&&add_snap_point(e,u.x+t.inner_border,"l"),t.outer_border&&add_snap_point(e,u.x-t.outer_border,"l")),t.center&&l&&add_snap_point(e,u.x+Math.floor(u.w/2),"c"),a||l)add_snap_point(e,a=u.x+u.w,"r"),t.inner_border&&add_snap_point(e,a-t.inner_border,"r"),t.outer_border&&add_snap_point(e,a+t.outer_border,"r");if((s||l)&&(add_snap_point(i,u.y,"t"),t.inner_border&&add_snap_point(i,u.y+t.inner_border,"t"),t.outer_border&&add_snap_point(i,u.y-t.outer_border,"t")),t.center&&l&&add_snap_point(i,u.y+Math.floor(u.h/2),"m"),_||l)add_snap_point(i,_=u.y+u.h,"b"),t.inner_border&&add_snap_point(i,_-t.inner_border,"b"),t.outer_border&&add_snap_point(i,_+t.outer_border,"b");d&&40<u.w&&(add_snap_point(e,u.x+Math.floor(u.w/2)-16,"c"),add_snap_point(e,u.x+Math.floor(u.w/2),"c"),add_snap_point(e,u.x+Math.floor(u.w/2)+16,"c")),d&&40<u.h&&(add_snap_point(i,u.y+Math.floor(u.h/2)-16,"m"),add_snap_point(i,u.y+Math.floor(u.h/2),"m"),add_snap_point(i,u.y+Math.floor(u.h/2)+16,"m"))}},isSelectable:function(){return!(this._parent instanceof TextBox&&"popup"===this._sub_id)||this._visible}}),ConstRectDragger.prototype=new RectDragger,WCT.ExtendObject(ConstRectDragger.prototype,{SetWH:function(t,e){this._rect.w=t,this._rect.h=e,this._refresh_dom()},Init:function(t,e){this._coords=t,this._rect.w=e.w,this._rect.h=e.h;var i=$$("div");i.id=this.el_id_("state"),i.className="state_rect",this.get_drg_parent_().appendChild(i),this._refresh_dom(),Draggers[this._id+"#"+this._sub_id]=this},HitTest:function(t,e){if(!this._visible)return null;var i=this._rect,o=i.x,r=o+i.w,n=i.y,s=n+i.h;return pt_in_rect4(t,e,o-Dragger.DRG_LINE_WIDTH,r+Dragger.DRG_LINE_WIDTH,n-Dragger.DRG_LINE_WIDTH,s+Dragger.DRG_LINE_WIDTH)?this._selected?{ctl_id:this._id,sub_id:this._sub_id,hdl_id:"pos",hdl_type:"pos",code:this._id+"#"+this._sub_id+"#pos",z:this._parent._obj.z+1e3}:pt_in_rect(t,e,i)?{ctl_id:this._id,sub_id:this._sub_id,hdl_id:"sel",hdl_type:"sel",code:this._id+"#"+this._sub_id+"#sel",z:this._parent._obj.z}:null:null},_refresh_dom:function(t){var e=this._get_el("state");if(e){var i=this._selected;LESSON_EDIT||set_opacity(e,100);var o=!1;this._preview||!this._visible?e.style.display="none":(e.style.display="block",this.Hidden()?(e.style.border=(i?Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE:Dragger.DRG_LINE_INACTIVE_WIDTH+"px "+Dragger.DRG_LINE_STYLE)+" "+Dragger.CLR_HIDDEN,i||LESSON_EDIT||set_opacity(e,Dragger.DRG_OPACITY),o=!i):this.Locked()?(e.style.border=(i?Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE:Dragger.DRG_LINE_INACTIVE_WIDTH+"px  "+Dragger.DRG_LINE_STYLE)+" "+Dragger.CLR_LOCKED,i||set_opacity(e,Dragger.DRG_OPACITY),o=!i):i?this._parent_active?e.style.border=Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE+" "+Dragger.CLR_ACTIVE_SELECTED:e.style.border=Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE+" "+Dragger.CLR_SELECTED:this._parent_active?e.style.border=Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE+" "+Dragger.CLR_ACTIVE:this._parent_sel?e.style.border=Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE+" "+Dragger.CLR_PARENT_SEL:this._related?(e.style.border=Dragger.DRG_RELATED_LINE_WIDTH+"px "+Dragger.DRG_RELETED_LINE_STYLE+" "+Dragger.CLR_RELATED[this._related],o=!0):LESSON_EDIT?e.style.border=Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE+" "+Dragger.CLR_IDLE:(e.style.border=Dragger.DRG_LINE_INACTIVE_WIDTH+"px "+Dragger.DRG_LINE_STYLE+" "+Dragger.CLR_IDLE,set_opacity(e,Dragger.DRG_OPACITY),o=!0));var r=this.get_rect_();!this._preview&&this._visible&&(o?(e.style.left=r.x+"px",e.style.top=r.y+"px",e.style.width=Math.max(0,r.w-2)+"px",e.style.height=Math.max(0,r.h-2)+"px"):(e.style.left=r.x-Dragger.DRG_LINE_WIDTH+"px",e.style.top=r.y-Dragger.DRG_LINE_WIDTH+"px",e.style.width=r.w+"px",e.style.height=r.h+"px"),e.style.zIndex=i?this._rect.z+2e3:this._rect.z)}},Limit:function(t,e){var i={x:e.x,y:e.y};switch(t.hdl_id){case"rt":case"rb":case"lb":case"lt":case"t":case"b":case"l":case"r":case"s":break;default:this.hdl.pos.clamp(this._orig_rect,i)}Dragger.ApplyDeltaLimit(e,i)},Apply:function(t,e){switch(Dragger.CopyRect(this._orig_rect,this._rect),t.hdl_id){case"rt":case"rb":case"lb":case"lt":case"t":case"b":case"l":case"r":case"s":break;default:this.hdl.pos.apply(this._rect,e)}this._refresh_dom(!0,e),this._parent._rd_update_dom_pos?this._parent._rd_update_dom_pos(this._sub_id,this._rect):this._parent._rd_update_dom_rect&&this._parent._rd_update_dom_rect(this._sub_id,this._rect)},GetSnapPoints:function(t,e,i,o,r){if(t.obj){switch(o){case"lt":case"lb":case"rt":case"rb":case"t":case"l":case"r":case"b":case"s":return}var n=this._rect;add_snap_point(e,n.x,"l"),add_snap_point(e,n.x+n.w,"r"),add_snap_point(i,n.y,"t"),add_snap_point(i,n.y+n.h,"b"),t.center&&(add_snap_point(e,n.x+Math.floor(n.w/2),"c"),add_snap_point(i,n.y+Math.floor(n.h/2),"m"))}}}),StatusDragger.prototype=new Dragger,WCT.ExtendObject(StatusDragger.prototype,{get_drg_parent_:function(){return Canvas.Status()},SetWH:function(t,e){this._rect.w=t,this._rect.h=e,this._refresh_dom()},UpdatePos:function(){var t=$(this._id+"#"+this._sub_id+"#dom");this._rect.x=parseInt(t.style.left),this._rect.y=parseInt(t.style.top),this._refresh_dom()},Init:function(t,e){this._coords={},this._rect.w=t.w,this._rect.h=t.h;var i=Status.GetIdxByEleId(this._id+"#"+this._sub_id+"#dom"),o=Status.CalcCtlPos(i);this._rect.x=o.x,this._rect.y=o.y;var r=$$("div");r.id=this.el_id_("state"),r.className="state_rect",r.setAttribute("title",e),this.get_drg_parent_().appendChild(r),this._refresh_dom(),Draggers[this._id+"#"+this._sub_id]=this},RectSelect:function(t,e,i,o,r){var n=Canvas.TransCoorSys({x:e,y:i}),s=n.x,a=n.y,_=Canvas.TransCoorSys({x:o,y:r}),l=_.x,d=_.y;return this._rect.x<=l&&this._rect.x+this._rect.w>=s&&this._rect.y<=d&&this._rect.y+this._rect.h>=a},HitTest:function(t,e){if(!this._visible)return null;var i=this._rect,o=i.x,r=o+i.w,n=i.y,s=n+i.h;return pt_in_rect4(t,e,o-Dragger.DRG_LINE_WIDTH,r+Dragger.DRG_LINE_WIDTH,n-Dragger.DRG_LINE_WIDTH,s+Dragger.DRG_LINE_WIDTH)?this._selected?{ctl_id:this._id,sub_id:this._sub_id,hdl_id:"pos",hdl_type:"pos",code:this._id+"#"+this._sub_id+"#pos",z:this._parent._obj.z+1e3}:pt_in_rect(t,e,i)?{ctl_id:this._id,sub_id:this._sub_id,hdl_id:"sel",hdl_type:"sel",code:this._id+"#"+this._sub_id+"#sel",z:this._parent._obj.z}:null:null},_refresh_dom:function(t){var e=this._get_el("state");if(e){LESSON_EDIT||set_opacity(e,100),this._preview||!this._visible?e.style.display="none":(e.style.display="block",this.Locked()&&(this._selected?e.style.border=Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE+" "+(this._readonly?Dragger.CLR_LOCKED:Dragger.CLR_ACTIVE_SELECTED):e.style.border="none"));var i=this._rect;!this._preview&&this._visible&&(e.style.left=i.x-Dragger.DRG_LINE_WIDTH+"px",e.style.top=i.y-Dragger.DRG_LINE_WIDTH+"px",e.style.width=i.w+"px",e.style.height=i.h+"px",e.style.zIndex=this._selected?i.z+2e3:i.z)}}}),LineDragger.prototype=new Dragger,LineDragger.DRAG_TYPE=":ld",LineDragger.HandleCircleHead=function(t,e,i,o){var r,n=0,s=e?t.thickness*t.l0/2:t.thickness*t.l1/2,a=t.x0,_=t.x1,l=t.y0,d=t.y1,h=a<_,c=l<d,p=h?_-a:a-_,u=c?d-l:l-d,f=p*s/(p+u),m=u*s/(p+u);if(e){var g=h?a+f:a-f,y=c?l+m:l-m;r=new WCT.geometry.Circle(g,y,s)}else{g=h?_-f:_+f,y=c?d-m:d+m;r=new WCT.geometry.Circle(g,y,s)}return r.HasPoint(i,o)&&(n=1e3),n},WCT.ExtendObject(LineDragger.prototype,{Destroy:function(){for(var t=this._my.DRAG_TYPE,e=this._line.length;0<=e;e--){var i=this._get_el("p"+e+t);i&&i.parentNode.removeChild(i)}this._my=null,Dragger.prototype.Destroy.call(this)},limit_:function(t,e){var i=this._orig_line[t],o={x:e.x,y:e.y},r=Canvas.w(),n=Canvas.h(),s=i.x+o.x,a=i.y+o.y;s<0?o.x=-i.x:r<s&&(o.x=r-i.x),a<0?o.y=-i.y:n<a&&(o.y=n-i.y),Dragger.ApplyDeltaLimit(e,o)},move_:function(t,e){var i=this._line[t],o=this._orig_line[t];i.x=o.x+e.x,i.y=o.y+e.y},resize_:function(t,e,i,o){var r=this._line[t],n=this._orig_line[t][e],s=(n-o)*i;r[e]=Math.round(n+s)},get_min_max_:function(t){for(var e=this._orig_line,i=[],o=0,r=null;r=e[o];o++)i.push(r[t]);var n=i.min(),s=i.max();return{min:n,max:s,d:s-n}},_write_parent_line:function(){for(var t=this._line,e=this._parent._obj,i=this._id,o=0,r=null;r=t[o];o++){var n="x"+o,s="y"+o;e[n]!=r.x&&(e[n]=r.x,Env.onPropChange(i,n,r.x)),e[s]!=r.y&&(e[s]=r.y,Env.onPropChange(i,s,r.y))}Env.AddHistory()},_read_parent_line:function(){for(var t=this._parent._obj,e=this._line,i=0,o=null;o=e[i];i++){var r="x"+i,n="y"+i;o.x=t[r]||0,o.y=t[n]||0}},Init:function(t){for(var e=[],i=t-1;0<=i;i--)e.push({x:20,y:20});this._line=e,this._read_parent_line();var o=this._my.DRAG_TYPE;for(i=t-1;0<=i;i--)this.create_handle_("p"+i+o);Draggers[this._id+"#"+this._sub_id]=this},UpdatePos:function(){this._read_parent_line(),this._refresh_dom()},get_line_:function(){for(var t=Canvas.x(),e=Canvas.y(),i=Editor.GetScale(),o=[],r=0,n=null,s=this._line;n=s[r++];)o.push({x:BROWSER.IE8?(n.x+t)*i:n.x*i+t,y:BROWSER.IE8?(n.y+e)*i:n.y*i+e});return o},_refresh_dom:function(t){var e=!this._preview&&this._visible&&this._selected,i=this.get_line_(),o=this._my.DRAG_TYPE;if(e){for(var r=Dragger.HANDLE_SIZE>>1,n=0,s=null;s=i[n];n++)this.set_handle_pos_("p"+n+o,s.x-r,s.y-r);if(this.Hidden())for(n=0,s=null;s=i[n];n++)this.update_line_handles_("p"+n+o,"background-color",Dragger.CLR_HIDDEN);else if(this.Locked())for(n=0,s=null;s=i[n];n++)this.update_line_handles_("p"+n+o,"background-color",Dragger.CLR_LOCKED);else if(this._parent_sel)for(n=0,s=null;s=i[n];n++)this.update_line_handles_("p"+n+o,"background-color",Dragger.CLR_ACTIVE_SELECTED)}if(this._handles_visible!=e){for(n=i.length-1;0<=n;n--)this.show_handle_("p"+n+o,e);this._handles_visible=e}},StartDrag:function(t){for(var e=this._line,i=[],o=0,r=null;r=e[o];o++)i.push({x:r.x,y:r.y});this._orig_line=i},Limit:function(t,e){if("s"!=t.hdl_id){var i=Number(t.hdl_id.substr(1));if(!isNaN(i)&&0<=i&&i<this._line.length)this.limit_.call(this,i,e);else if("b"==t.hdl_id||"r"==t.hdl_id){var o="b"==t.hdl_id?"y":"x";this.get_min_max_.call(this,o).d||(e[o]=0)}else for(var r=this._orig_line.length-1;0<=r;r--)this.limit_.call(this,r,e)}},Apply:function(t,e){if("s"!=t.hdl_id){var i=Number(t.hdl_id.substr(1));if(!isNaN(i)&&0<=i&&i<this._line.length)this.move_.call(this,i,e);else if("b"==t.hdl_id||"r"==t.hdl_id){var o="b"==t.hdl_id?"y":"x",r=get_min_max_.call(this,o);if(0<r.d)for(var n=e[o]/r.d,s=this._line.length-1;0<=s;s--)this.resize_.call(this,s,o,n,r.min)}else for(s=this._line.length-1;0<=s;s--)this.move_.call(this,s,e);this._refresh_dom(),this.apply_.apply(this,arguments)}},apply_:function(){this._parent._update_line&&this._parent._update_line(this._sub_id,this._line)},EndDrag:function(t){this._write_parent_line(),this._refresh_dom(!1),this._parent._update_line&&this._parent._update_line(this._sub_id)},RectSelect:function(t,e,i,o,r){var n=this._line,s=this.GetHitShape(),a=n[0],_=n[1];if(n[0].x>n[1].x&&n[0].y>n[1].y&&(a=n[1],_=n[0]),CanvasArrow.calculateLineIPoint(a,_,{x:e,y:i},{x:e,y:r})||CanvasArrow.calculateLineIPoint(a,_,{x:e,y:i},{x:o,y:i})||CanvasArrow.calculateLineIPoint(a,_,{x:o,y:i},{x:o,y:r})||CanvasArrow.calculateLineIPoint(a,_,{x:e,y:r},{x:o,y:r})||a.x>=e&&_.x<=o&&a.y>=i&&_.y<=r)return!0;for(var l=0,d=s.length;l<d;l++){var h=s[l],c=s[(l+1)%d];if(a={x:h[0],y:h[1]},_={x:c[0],y:c[1]},CanvasArrow.calculateLineIPoint(a,_,{x:e,y:i},{x:e,y:r})||CanvasArrow.calculateLineIPoint(a,_,{x:e,y:i},{x:o,y:i})||CanvasArrow.calculateLineIPoint(a,_,{x:o,y:i},{x:o,y:r})||CanvasArrow.calculateLineIPoint(a,_,{x:e,y:r},{x:o,y:r}))return!0}return!1},GetSnapPoints:function(t,e,i,o,r){if(t.obj&&"s"!=o){var n=parseInt(o.substr(1)),s=this._line;if(t.selected&&!isNaN(n)&&s[n])add_snap_point(e,s[n].x,"l"),add_snap_point(i,s[n].y,"t");else for(var a=0;a<=s.length-1;a++)add_snap_point(e,s[a].x,"l"),add_snap_point(i,s[a].y,"t")}},GetHitShape:function(){var t=HitManager.getHitArea({ctl_id:this._id});return t&&t.shape||[]},HitTest:function(t,e){if(!this._visible)return null;var i=this._line,o={ctl_id:this._id,sub_id:this._sub_id,z:this._parent._obj.z},r=Editor.GetScale(),n=(Dragger.HANDLE_SIZE/r+2)/2,s="sel",a=Math.round((this._parent._obj.thickness+1)/2);a<4&&(a=4);var _=t-a,l=e-a,d=t+a,h=e+a;if(this._selected){var c={x0:i[0].x-n,y0:i[0].y-n,x1:i[0].x+n,y1:i[0].y+n},p={x0:i[1].x-n,y0:i[1].y-n,x1:i[1].x+n,y1:i[1].y+n};if(s="pos",pt_in_rect4(t,e,c.x0,c.x1,c.y0,c.y1))return o.hdl_type="p",o.hdl_id="p0",o.code=this._id+"#"+this._sub_id+"#p",o.z+=1e3,o;if(pt_in_rect4(t,e,p.x0,p.x1,p.y0,p.y1))return o.hdl_type="p",o.hdl_id="p1",o.code=this._id+"#"+this._sub_id+"#p",o.z+=1e3,o}if(this.RectSelect(s,_,l,d,h))return o.hdl_type=s,o.hdl_id=s,o.code=this._id+"#"+this._sub_id+"#sel",o;if("arrow"==this._parent._obj.type){var u=this.GetHitShape(),f=LineDragger.HandleCircleHead(this._parent._obj,!0,t,e),m=LineDragger.HandleCircleHead(this._parent._obj,!1,t,e);if(0<f||0<m||Shape.HitTest(t,e,u))return o.hdl_type=s,o.hdl_id=s,o.code=this._id+"#"+this._sub_id+"#sel",o.z+=1e3,o}return null}}),PolyLineDragger.prototype=new LineDragger,PolyLineDragger.DRAG_TYPE=":pld",WCT.ExtendObject(PolyLineDragger.prototype,{Destroy:function(){this._segments=null,LineDragger.prototype.Destroy.call(this)},_write_parent_line:function(){for(var t=this._line,e=this._parent._obj,i=this._id,o=0,r=!0,n=0;r;){for(var s=t.length-2;0<s;s--){var a=t[s-1].x,_=t[s-1].y,l=t[s].x,d=t[s].y,h=t[s+1].x,c=t[s+1].y;(a==l&&l==h||_==d&&d==c||a==l&&_==d||h==l&&c==d)&&(t.splice(s,1),o++)}n!=o?(r=!0,n=o):r=!1}var p=PolyLineDragger.DRAG_TYPE;for(s=0;s<=o;s++){var u=t.length+s;this.remove_handle_("p"+u+p)}o&&this._update_segments();for(var f=[],m=(s=0,null);m=t[s];s++)f.push(m.x,m.y);e.points!=f.join(",")&&(e.points=f.join(","),Env.onPropChange(i,"points",f.join(",")),Env.AddHistory()),this._parent._update_dom&&this._parent._update_dom()},_read_parent_line:function(){for(var t=this._line,e=this._parent._obj.points.split(","),i=0,o=0;e.length,p=t[i];o++,i++)p.x=parseInt(e[o])||0,o++,p.y=parseInt(e[o])||0},_update_segments:function(){for(var t=this._line,e={},i=1,o=t.length;i<o;i++)t[i-1].x==t[i].x?e[i-1]="v":t[i-1].y==t[i].y?e[i-1]="h":e[i-1]="d";this._segments=e},HitTest:function(t,e){if(this._visible){var i=this._line,o=this._segments,r={ctl_id:this._id,sub_id:this._sub_id,z:this._parent._obj.z},n="sel";if(this._selected){n="pos";for(var s=0;s<i.length;s++){var a=i[s];if(pt_in_rect4(t,e,a.x-4,a.x+4,a.y-4,a.y+4))return r.hdl_type="pld",r.hdl_id="p"+s,r.code=this._id+"#"+this._sub_id+"#p",r.z+=1e3,r}}var _=Math.round((this._parent._obj.thickness+1)/2);for(var l in _<4&&(_=4),o){var d=o[l],h=l-0;if("v"==d){var c=i[h].x,p=i[h].y,u=i[1+h].y;if(u<p){var f=p;p=u,u=f}if(0<h&&(p-=_),h<i.length-1&&(u+=_),pt_in_rect4(t,e,c-_,c+_,p,u))return r.hdl_type=n,r.hdl_id=n,r.code=this._id+"#"+this._sub_id+"#sel",r}else if("h"==d){var m=i[h].x,g=i[1+h].x,y=i[h].y;if(g<m){f=m;m=g,g=f}if(0<h&&(m-=_),h<i.length-1&&(g+=_),pt_in_rect4(t,e,m,g,y-_,y+_))return r.hdl_type=n,r.hdl_id=n,r.code=this._id+"#"+this._sub_id+"#sel",r}}return null}},Init:function(t){LineDragger.prototype.Init.apply(this,arguments),this._update_segments()},UpdatePos:function(){this._read_parent_line(),this._update_segments(),this._refresh_dom()},RectSelect:function(t,e,i,o,r){for(var n=this._line,s=n.length,a=n[0],_=1;_<s;_++){var l=n[_];if(CanvasArrow.calculateLineIPoint(a,l,{x:e,y:i},{x:e,y:r})||CanvasArrow.calculateLineIPoint(a,l,{x:e,y:i},{x:o,y:i})||CanvasArrow.calculateLineIPoint(a,l,{x:o,y:i},{x:o,y:r})||CanvasArrow.calculateLineIPoint(a,l,{x:e,y:r},{x:o,y:r})||a.x>=e&&l.x<=o&&a.y>=i&&l.y<=r)return!0;a=l}return!1},Limit:function(t,e){LineDragger.prototype.Limit.apply(this,arguments);var i=Number(t.hdl_id.substr(1)),o=this._orig_line;2<this._line.length&&("h"==this._segments[i-1]?this._line[i-1].y=o[i].y+e.y:"v"==this._segments[i-1]&&(this._line[i-1].x=o[i].x+e.x),"h"==this._segments[i]?this._line[i+1].y=o[i].y+e.y:"v"==this._segments[i]&&(this._line[i+1].x=o[i].x+e.x))},apply_:function(t){var e=Number(t.hdl_id.substr(1));if(this._parent._update_line){var i,o,r,n,s,a=this._line;if(2==a.length&&void 0!==e&&!isNaN(e))n=1==e?(s=-1,i=a[e-1].x,o=a[e-1].y,r=a[e].x,a[e].y):(s=1,i=a[e].x,o=a[e].y,r=a[e+1].x,a[e+1].y),o<=n?i<=r?n-o<r-i?a[e].y=a[e+s].y:a[e].x=a[e+s].x:n-o<i-r?a[e].y=a[e+s].y:a[e].x=a[e+s].x:i<=r?o-n<r-i?a[e].y=a[e+s].y:a[e].x=a[e+s].x:n-o<r-i?a[e].x=a[e+s].x:a[e].y=a[e+s].y,this._update_segments(),this._refresh_dom();this._parent._update_line(this._sub_id,this._line)}}}),XRDragger.prototype=new Dragger,WCT.ExtendObject(XRDragger.prototype,{Init:function(t){var e=$$("div");e.id=this.el_id_("line"),e.className="x_ruler",e.style.position="absolute",e.style.top="-10px",e.style.width="1px",e.style.borderRight="1px dashed #009DE0",e.style.display="none",e.style.zIndex=999999,e.style.fontSize="1px";var i=$$("div");i.className="info_el",i.id=this.el_id_("info"),e.appendChild(i),Canvas.Parent().appendChild(e);var o=$$("div");o.id=this.el_id_("handle"),o.style.position="absolute",o.style.top="-26px",o.style.width="9px",o.style.height="16px",o.className="x_handle",o.style.fontSize="1px",Canvas.Parent().appendChild(o),this.UpdatePos(),Draggers[this._id+"#"+this._sub_id]=this},_refresh_dom:function(t){var e=this._get_el("line"),i=this._get_el("handle"),o=this._get_el("info");if(this._preview||!this._visible)e&&(e.style.display="none"),i&&(i.style.display="none");else{var r=this._active||this._selected,n=this.Locked(),s=Dragger.GetGuideDrgClr(r,n);e&&(e.style.display=r?"block":"none",e.style.height=Canvas.h()+20+"px",e.style.left=this._x-1+"px"),i&&(i.style.display="block",i.style.backgroundColor=s,i.style.left=this._x-4+"px",n||(i.style.opacity=r?1:.66)),o&&(o.innerHTML=this._x)}},HitTest:function(t,e){var i=this._x-3,o=this._x+3;return pt_in_rect4(t,e,i,o,-25,Canvas.h())?this._selected?{ctl_id:this._id,sub_id:this._sub_id,hdl_id:"pos",hdl_type:"l",code:this._id+"#"+this._sub_id+"#pos",z:this._parent._obj.z+1e3}:pt_in_rect4(t,e,i,o,-25,-13)?{ctl_id:this._id,sub_id:this._sub_id,hdl_id:"sel",hdl_type:"sel",code:this._id+"#"+this._sub_id+"#sel",z:this._parent._obj.z}:null:null},Limit:function(t,e){var i={x:e.x,y:e.y};this._orig_x+i.x<0&&(i.x=-this._orig_x),this._orig_x+i.x>Canvas.w()&&(i.x=Canvas.w()-this._orig_x),Dragger.ApplyDeltaLimit(e,i)},Apply:function(t,e){this._x=this._orig_x+e.x,this._refresh_dom(!1,e)},StartDrag:function(t){var e=this._get_el("line");e&&WCT.dom.AddClass(e,"dragging"),this._orig_x=this._x},EndDrag:function(t){this._refresh_dom(!1);var e=this._get_el("line");e&&WCT.dom.RemoveClass(e,"dragging"),this._x!=this._orig_x&&(this._parent._obj.x=this._x,Env.onPropChange(this._id,"x",this._x),Env.AddHistory()),delete this._orig_x},Destroy:function(){var t=this._get_el("line");t&&t.parentNode.removeChild(t);var e=this._get_el("handle");e&&e.parentNode.removeChild(e),Dragger.prototype.Destroy.call(this)},UpdatePos:function(){this._x!=this._parent._obj.x&&(this._x=this._parent._obj.x,this._refresh_dom())},RectSelect:function(t,e,i,o,r){return this._x-5<=o&&this._x+10>=e&&-25<=r&&i<=-15},GetSnapPoints:function(t,e,i,o,r){"s"!=o&&t.ruler&&(add_snap_point(e,this._x,"l"),add_snap_point(e,this._x,"c"),add_snap_point(e,this._x,"r"))}}),YRDragger.prototype=new Dragger,WCT.ExtendObject(YRDragger.prototype,{Init:function(t){var e=$$("div");e.id=this.el_id_("line"),e.className="y_ruler",e.style.position="absolute",e.style.fontSize="0px",e.style.borderTop="1px dashed #009DE0",e.style.left="-10px",e.style.height="1px",e.style.zIndex=999999,e.style.display="none";var i=$$("div");i.className="info_el",i.id=this.el_id_("info"),e.appendChild(i),Canvas.Parent().appendChild(e);var o=$$("div");o.id=this.el_id_("handle"),o.style.position="absolute",o.style.left="-26px",o.style.height="9px",o.style.width="16px",o.className="y_handle",o.style.fontSize="1px",Canvas.Parent().appendChild(o),this.UpdatePos(),Draggers[this._id+"#"+this._sub_id]=this},_refresh_dom:function(t){var e=this._get_el("line"),i=this._get_el("handle"),o=this._get_el("info");if(this._preview||!this._visible)e&&(e.style.display="none"),i&&(i.style.display="none");else{var r=this._active||this._selected,n=this.Locked(),s=Dragger.GetGuideDrgClr(r,n);e&&(e.style.display=r?"block":"none",e.style.width=Canvas.w()+20+"px",e.style.top=this._y+"px"),i&&(i.style.display="block",i.style.backgroundColor=s,i.style.top=this._y-4+"px",n||(i.style.opacity=r?1:.66))}o&&(o.innerHTML=this._y)},HitTest:function(t,e){var i=Canvas.w(),o=this._y-3,r=this._y+3;return pt_in_rect4(t,e,-25,i,o,r)?this._selected?{ctl_id:this._id,sub_id:this._sub_id,hdl_id:"pos",hdl_type:"t",code:this._id+"#"+this._sub_id+"#pos",z:this._parent._obj.z+1e3}:pt_in_rect4(t,e,-25,-13,o,r)?{ctl_id:this._id,sub_id:this._sub_id,hdl_id:"sel",hdl_type:"sel",code:this._id+"#"+this._sub_id+"#sel",z:this._parent._obj.z}:null:null},Limit:function(t,e){var i={x:e.x,y:e.y};this._orig_y+i.y<0&&(i.y=-this._orig_y),this._orig_y+i.y>Canvas.h()&&(i.y=Canvas.h()-this._orig_y),Dragger.ApplyDeltaLimit(e,i)},Apply:function(t,e){this._y=this._orig_y+e.y,this._refresh_dom(!0,e)},StartDrag:function(t){var e=this._get_el("line");e&&WCT.dom.AddClass(e,"dragging"),this._orig_y=this._y},EndDrag:function(t){this._refresh_dom(!1);var e=this._get_el("line");e&&WCT.dom.RemoveClass(e,"dragging"),this._y!=this._orig_y&&(this._parent._obj.y=this._y,Env.onPropChange(this._id,"y",this._y),Env.AddHistory()),delete this._orig_y},Destroy:function(){var t=this._get_el("line");t&&t.parentNode.removeChild(t);var e=this._get_el("handle");e&&e.parentNode.removeChild(e),Dragger.prototype.Destroy.call(this)},UpdatePos:function(){this._y!=this._parent._obj.y&&(this._y=this._parent._obj.y,this._refresh_dom())},RectSelect:function(t,e,i,o,r){return this._y-5<=r&&this._y+10>=i&&-25<=o&&e<=-15},GetSnapPoints:function(t,e,i,o,r){"s"!=o&&t.ruler&&(add_snap_point(i,this._y,"l"),add_snap_point(i,this._y,"c"),add_snap_point(i,this._y,"r"))}}),BubbleDragger.prototype=new RectDragger,WCT.ExtendObject(BubbleDragger.prototype,{hdl:{pos:{clamp:function(t,e,i){e.x=Math.min(Canvas.w()-t.x,Math.max(-t.x,e.x)),e.y=Math.min(Canvas.h()-t.y,Math.max(-t.y,e.y))},apply:function(t,e,i){t.x+=e.x,t.y+=e.y}},t:{clamp:function(t,e,i){if("C"==t.orientation||("E"==t.orientation||"W"==t.orientation)&&3==i._parent.version){var o=(t.h-t.minh)/2;e.y>o&&(e.y=Math.floor(o))}else{o=t.h-t.minh;e.y>o&&(e.y=o)}},apply:function(t,e,i){t.offset.y=t.offset.y+e.y,"C"==t.orientation||("E"==t.orientation||"W"==t.orientation)&&3==i._parent.version?t.h=t.h-2*e.y:t.h=t.h-e.y}},l:{clamp:function(t,e,i){if("C"==t.orientation||"N"==t.orientation||"S"==t.orientation){var o=(t.w-t.minw)/2;e.x>o&&(e.x=Math.floor(o))}else{o=t.w-t.minw;e.x>o&&(e.x=o)}},apply:function(t,e,i){t.offset.x=t.offset.x+e.x,"C"==t.orientation||"N"==t.orientation||"S"==t.orientation?t.w=t.w-2*e.x:t.w=t.w-e.x}},r:{clamp:function(t,e,i){if("C"==t.orientation||"N"==t.orientation||"S"==t.orientation){var o=(t.minw-t.w)/2;e.x<o&&(e.x=Math.floor(o))}else{o=t.minw-t.w;e.x<o&&(e.x=o)}},apply:function(t,e,i){"C"==t.orientation||"N"==t.orientation||"S"==t.orientation?(t.offset.x=t.offset.x-e.x,t.w=t.w+2*e.x):t.w+=e.x}},b:{clamp:function(t,e,i){if("C"==t.orientation||("E"==t.orientation||"W"==t.orientation)&&3==i._parent.version){var o=(t.minh-t.h)/2;e.y<o&&(e.y=Math.floor(o))}else{o=t.minh-t.h;e.y<o&&(e.y=o)}},apply:function(t,e,i){"C"==t.orientation||("E"==t.orientation||"W"==t.orientation)&&3==i._parent.version?(t.offset.y=t.offset.y-e.y,t.h=t.h+2*e.y):t.h+=e.y}},s:{clamp:function(t,e,i){},apply:function(t,e,i,o){t.spikeOffset.x=e.x,t.spikeOffset.y=e.y;var r=i.calculateNewOrientation();r==t.orientation&&3!=i._parent.version||i.switchOrientation(r,o)}}},Init:function(t){this._coords=t,this._read_parent_rect();var e=this._rect.z,i=$$("div");i.className="state_rect",i.id=this.el_id_("state"),i.style.position="absolute",i.style.zoom=1,i.style.zIndex=this._selected?e+2e3:e,this.get_drg_parent_().appendChild(i),this.create_handle_("s",null,"spike_drag_handle");var o=this._get_el("s");o&&(o.style.zIndex=this._selected?e+2500:e),this.create_handle_("t",i),this.create_handle_("l",i),this.create_handle_("r",i),this.create_handle_("b",i),this.create_handle_("lt",i),this.create_handle_("lb",i),this.create_handle_("rt",i),this.create_handle_("rb",i),this._refresh_dom(),Draggers[this._id+"#"+this._sub_id]=this},get_rect_:function(){var t=Canvas.x(),e=Canvas.y(),i=Editor.GetScale(),o=this._rect;return{x:BROWSER.IE8?(o.x+t)*i:o.x*i+t,y:BROWSER.IE8?(o.y+e)*i:o.y*i+e,w:o.w*i,h:o.h*i,z:o.z,orientation:o.orientation,offset:{x:o.offset.x*i,y:o.offset.y*i},spikeOffset:{x:o.spikeOffset.x*i,y:o.spikeOffset.y*i}}},_refresh_dom:function(t){var e=this._get_el("state");if(e){LESSON_EDIT||set_opacity(e,100);var i=!1,o=this._selected;this._preview||!this._visible?e.style.display="none":(e.style.display="block",this.Hidden()?(e.style.border=(o?Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE:Dragger.DRG_LINE_INACTIVE_WIDTH+"px "+Dragger.DRG_LINE_STYLE)+" "+Dragger.CLR_HIDDEN,o||LESSON_EDIT||set_opacity(e,Dragger.DRG_OPACITY),i=!o,this.update_handles_("background-color",Dragger.CLR_HIDDEN)):this.Locked()?(e.style.border=(o?Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE:Dragger.DRG_LINE_INACTIVE_WIDTH+"px  "+Dragger.DRG_LINE_STYLE)+" "+Dragger.CLR_IDLE,o||set_opacity(e,Dragger.DRG_OPACITY),i=!o):o?this._parent_active?(e.style.border=Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE+" "+Dragger.CLR_ACTIVE_SELECTED,this.update_handles_("background-color",Dragger.CLR_ACTIVE_SELECTED)):(e.style.border=Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE+" "+Dragger.CLR_SELECTED,this.update_handles_("background-color",Dragger.CLR_SELECTED)):this._parent_active?e.style.border=Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE+" "+Dragger.CLR_ACTIVE:this._parent_sel?e.style.border=Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE+" "+Dragger.CLR_PARENT_SEL:this._related?(e.style.border=Dragger.DRG_RELATED_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE+" "+Dragger.CLR_RELATED[this._related],i=!0):LESSON_EDIT?e.style.border=Dragger.DRG_LINE_WIDTH+"px "+Dragger.DRG_LINE_STYLE+" "+Dragger.CLR_IDLE:(e.style.border=Dragger.DRG_LINE_INACTIVE_WIDTH+"px "+Dragger.DRG_LINE_INACTIVE_STYLE+" "+Dragger.CLR_IDLE,set_opacity(e,Dragger.DRG_OPACITY),i=!0));var r=this.get_rect_();if(t&&Editor.DragSelectionSize()<Dragger.INFO_THRESHOLD&&!arguments[1]){var n=this.get_show_data_(r),s=$(this.el_id_("info"));if(s=s?this._get_el("info"):((s=$$("div")).className="info_rect",s.style.left="0px",s.style.top="0px",s.style.position="absolute",s.id=this.el_id_("info"),s.style.zIndex=this._selected?this._rect.z+2e3:this._rect.z,this.get_drg_parent_().appendChild(s)),"pos"==t)s.innerHTML="<center>"+n.y+"<br><br><nobr>"+n.x+"&nbsp;&nbsp;&nbsp;"+n.xw+"</nobr><br><br>"+n.yh+"</center>";else if("s"==t){var a=this._parent.invert_orientation(r.orientation).toUpperCase();s.innerHTML="<center>"+Dict_get(a)+"</center>"}else s.innerHTML=n.w+" x "+n.h;var _=s.offsetWidth,l=s.offsetHeight;try{_<r.w-8&&l<r.h-8?(s.style.left=r.x+r.offset.x+(r.w-_)/2+"px",s.style.top=r.y+r.offset.y+(r.h-l)/2+"px"):"E"==this._rect.orientation||"EN"==this._rect.orientation||"ES"==this._rect.orientation||"TR"==this._rect.orientation||"BR"==this._rect.orientation?(s.style.top=r.y+r.offset.y-10+"px",s.style.left=r.x+r.offset.x+r.w+10+"px"):"W"==this._rect.orientation||"WN"==this._rect.orientation||"WS"==this._rect.orientation||"TL"==this._rect.orientation||"BL"==this._rect.orientation?(s.style.top=r.y+r.offset.y-10+"px",s.style.left=r.x+r.offset.x-_-10+"px"):("N"==this._rect.orientation||"NE"==this._rect.orientation||"NW"==this._rect.orientation||"C"==this._rect.orientation?s.style.top=r.y-l+r.offset.y-10+"px":s.style.top=r.y+r.h+r.offset.y+10+"px",s.style.left=r.x+r.offset.x+r.w/2-_/2+"px")}catch(f){}}else if(!1===t){var d=this._get_el("info");d&&d.parentNode.removeChild(d)}!this._preview&&this._visible&&(i?(e.style.left=r.x+r.offset.x+"px",e.style.top=r.y+r.offset.y+"px",e.style.width=Math.max(0,r.w-2)+"px",e.style.height=Math.max(0,r.h-2)+"px"):(e.style.left=r.x+r.offset.x-Dragger.DRG_LINE_WIDTH+"px",e.style.top=r.y+r.offset.y-Dragger.DRG_LINE_WIDTH+"px",e.style.width=r.w+"px",e.style.height=r.h+"px"),e.style.zIndex=this._selected?this._rect.z+2e3:this._rect.z);var h="offset"==t?!this.Locked()&&!this._preview&&this._visible&&this._selected&&this._handles_visible:!this.Locked()&&!this._preview&&this._visible&&this._selected&&"pos"!=t;if(h){var c=Math.max(Math.round(r.x+r.spikeOffset.x-Dragger.HANDLE_SIZE/2),0),p=Math.max(Math.round(r.y+r.spikeOffset.y-Dragger.HANDLE_SIZE/2),0);this.set_handle_pos_("s",c,p);var u=this._get_el("s");u&&(u.style.zIndex=this._selected?this._rect.z+2500:this._rect.z),this.set_handle_pos_("t",(r.w-Dragger.HANDLE_SIZE)/2,-Dragger.HANDLE_SIZE),this.set_handle_pos_("l",-Dragger.HANDLE_SIZE,(r.h-Dragger.HANDLE_SIZE)/2),this.set_handle_pos_("r",r.w,(r.h-Dragger.HANDLE_SIZE)/2),this.set_handle_pos_("b",(r.w-Dragger.HANDLE_SIZE)/2,r.h),this.set_handle_pos_("lt",-Dragger.HANDLE_SIZE,-Dragger.HANDLE_SIZE),this.set_handle_pos_("lb",-Dragger.HANDLE_SIZE,r.h),this.set_handle_pos_("rt",r.w,-Dragger.HANDLE_SIZE),this.set_handle_pos_("rb",r.w,r.h)}this._handles_visible==h&&this._last_orientation==this._rect.orientation||(this._last_orientation=this._rect.orientation,this.show_rect_handles_(h,this._get_handles_by_orientation()))}},StartDrag:function(t){this.dragging=!0,"s"==t.hdl_id&&(this.changingOrientation=!0,this.oriX=this._rect.x,this.oriY=this._rect.y,this.oriOrientation=this._rect.orientation),Dragger.CopyRect(this._rect,this._orig_rect)},EndDrag:function(t){this.dragging=!1,this.changingOrientation=!1;var e=this._parent;"s"==t.drag_hdl_id&&(this.oriX==this._rect.x&&this.oriY==this._rect.y&&this.oriOrientation==this._rect.orientation||(Env.onPropChange(this._id,"x",e._obj.x),Env.onPropChange(this._id,"y",e._obj.y),Env.onPropChange(this._id,"orientation",e._obj.orientation),Env.AddHistory())),this._rect.spikeOffset={x:0,y:0},this._write_parent_rect(),this._refresh_dom(!1),e._update_dom(!0)},_write_parent_rect:function(){var t=this._coords,e=this._rect,i=this._parent,o=i._obj,r=this._id;for(var n in t){var s=t[n],a=e[n];if(void 0!==a&&o[s]!=a&&(i[s]=a,o[s]=a,s&&"offset"!=s&&"spikeOffset"!=s)){if("w"===s||"h"===s){var _=Page.GetContentScale();1!==_&&(a*=_)}Env.onPropChange(r,s,a)}}Env.AddHistory()},_update_rect_from_parent:function(){var t={},e=!1;for(var i in this._coords){var o=this._coords[i];"undefined"!=typeof this._rect[i]&&this._parent._obj[o]!=this._rect[i]&&(this._rect[i]=this._parent._obj[o],e=t[i]=!0)}if(!this.disable_write_values)for(var i in t){(o=this._coords[i])&&"offset"!=o&&"spikeOffset"!=o&&Env.onPropChange(this._id,o,this._rect[i])}return e},UpdateFromParent:function(){this.dragging||(this._update_rect_from_parent()&&this._refresh_dom(),Editor&&Editor.HandleGroupChange(this._parent))},_get_handles_by_orientation:function(){if(3==this._parent.version)switch(this._parent.invert_orientation(this._rect.orientation)){case"n":return{s:!0,t:!1,l:!0,r:!0,b:!0,lt:!1,lb:!0,rt:!1,rb:!0};case"s":return{s:!0,t:!0,l:!0,r:!0,b:!1,lt:!0,lb:!1,rt:!0,rb:!1};case"es":case"br":case"se":return{s:!0,t:!0,l:!0,r:!1,b:!1,lt:!0,lb:!1,rt:!1,rb:!1};case"ws":case"bl":case"sw":return{s:!0,t:!0,l:!1,r:!0,b:!1,lt:!1,lb:!1,rt:!0,rb:!1};case"tr":case"en":case"ne":return{s:!0,t:!1,l:!0,r:!1,b:!0,lt:!1,lb:!0,rt:!1,rb:!1};case"e":return{s:!0,t:!0,l:!0,r:!1,b:!0,lt:!0,lb:!0,rt:!1,rb:!1};case"wn":case"tl":case"nw":return{s:!0,t:!1,l:!1,r:!0,b:!0,lt:!1,lb:!1,rt:!1,rb:!0};case"w":return{s:!0,t:!0,l:!1,r:!0,b:!0,lt:!1,lb:!1,rt:!0,rb:!0};case"c":default:return{s:!0,t:!0,l:!0,r:!0,b:!0,lt:!0,lb:!0,rt:!0,rb:!0}}switch(this._parent.invert_orientation(this._rect.orientation)){case"n":return{s:!0,t:!1,l:!0,r:!0,b:!0,lt:!1,lb:!0,rt:!1,rb:!0};case"s":return{s:!0,t:!0,l:!0,r:!0,b:!1,lt:!0,lb:!1,rt:!0,rb:!1};case"se":return{s:!0,t:!0,l:!0,r:!1,b:!1,lt:!0,lb:!1,rt:!1,rb:!1};case"sw":return{s:!0,t:!0,l:!1,r:!0,b:!1,lt:!1,lb:!1,rt:!0,rb:!1};case"ne":case"e":return{s:!0,t:!1,l:!0,r:!1,b:!0,lt:!1,lb:!0,rt:!1,rb:!1};case"nw":case"w":return{s:!0,t:!1,l:!1,r:!0,b:!0,lt:!1,lb:!1,rt:!1,rb:!0};case"c":default:return{s:!0,t:!0,l:!0,r:!0,b:!0,lt:!0,lb:!0,rt:!0,rb:!0}}},calculateNewOrientation:function(){var t={};return Dragger.CopyRect(this._rect,t),t.spikeX=t.x+t.spikeOffset.x,t.spikeY=t.y+t.spikeOffset.y,t.x=t.x+t.offset.x,t.y=t.y+t.offset.y,t.spikeY=this._rect.y+t.spikeOffset.y,t.spikeX>=t.x&&t.spikeX<=t.x+t.w&&t.spikeY>=t.y&&t.spikeY<=t.y+t.h?t.orientation="c":3==this._parent.version?t.spikeX<t.x&&t.spikeY>=t.y&&t.spikeY<=t.y+t.h?t.spikeY>=t.y+t.h/3&&t.spikeY<=t.y+2*t.h/3?t.orientation="w":t.spikeY<=t.y+t.h/3?t.orientation="wn":t.orientation="ws":t.spikeX>t.x+t.w&&t.spikeY>=t.y&&t.spikeY<=t.y+t.h?t.spikeY>=t.y+t.h/3&&t.spikeY<=t.y+2*t.h/3?t.orientation="e":t.spikeY<=t.y+t.h/3?t.orientation="en":t.orientation="es":t.spikeY>t.y+t.h?t.spikeX>=t.x+t.w/3&&t.spikeX<=t.x+2*t.w/3?t.orientation="s":t.spikeX<=t.x+t.w/3?t.spikeX<=t.x?t.orientation="bl":t.orientation="sw":t.spikeX>=t.x+t.w?t.orientation="br":t.orientation="se":t.spikeX>=t.x+t.w/3&&t.spikeX<=t.x+2*t.w/3?t.orientation="n":t.spikeX<=t.x+t.w/3?t.spikeX<=t.x?t.orientation="tl":t.orientation="nw":t.spikeX>=t.x+t.w?t.orientation="tr":t.orientation="ne":t.spikeX<t.x&&t.spikeY>=t.y&&t.spikeY<=t.y+t.h?t.orientation="w":t.spikeX>t.x+t.w&&t.spikeY>=t.y&&t.spikeY<=t.y+t.h?t.orientation="e":t.spikeY>t.y+t.h?t.spikeX>=t.x+t.w/3&&t.spikeX<=t.x+2*t.w/3?t.orientation="s":t.spikeX<=t.x+t.w/3?t.orientation="sw":t.orientation="se":t.spikeX>=t.x+t.w/3&&t.spikeX<=t.x+2*t.w/3?t.orientation="n":t.spikeX<=t.x+t.w/3?t.orientation="nw":t.orientation="ne",this._parent.invert_orientation(t.orientation).toUpperCase()},switchOrientation:function(t,e){if(!this.rendering_){this.rendering_=!0;var i=this._rect;i.orientation=t;var o=this._parent.change_orientation(t),r=Editor.GetScale();Editor.SetMouseDown({screenX:e.downX+(o.x-o.oldX)*r,screenY:e.downY+(o.y-o.oldY)*r}),i.x=o.x,i.y=o.y,i.offset.x=o.offsetX,i.offset.y=o.offsetY,i.spikeOffset.x=i.spikeOffset.x-o.x+o.oldX,i.spikeOffset.y=i.spikeOffset.y-o.y+o.oldY,Dragger.CopyRect(i,this._orig_rect),this.rendering_=!1}},GetSnapPoints:function(t,e,i,o,r){if(t.obj){var n=!1,s=!1,a=!1,_=!1,l=!1;switch(o){case"lt":s=n=!0;break;case"lb":_=n=!0;break;case"rt":s=a=!0;break;case"rb":_=a=!0;break;case"t":s=!0;break;case"l":n=!0;break;case"r":a=!0;break;case"b":_=!0;break;case"s":break;default:l=!0}(n||l)&&(t.center&&l&&add_snap_point(e,this._rect.x,"l"),add_snap_point(e,this._rect.offset.x+this._rect.x,"l"),t.inner_border&&add_snap_point(e,this._rect.offset.x+this._rect.x+t.inner_border,"l"),t.outer_border&&add_snap_point(e,this._rect.offset.x+this._rect.x-t.outer_border,"l")),t.center&&l&&add_snap_point(e,this._rect.offset.x+this._rect.x+Math.floor(this._rect.w/2),"c"),(a||l)&&(add_snap_point(e,a=this._rect.offset.x+this._rect.x+this._rect.w,"r"),t.inner_border&&add_snap_point(e,a-t.inner_border,"r"),t.outer_border&&add_snap_point(e,a+t.outer_border,"r")),(n||a||l)&&add_snap_point(e,this._rect.x,"l"),(s||l)&&(t.center&&l&&add_snap_point(i,this._rect.y,"t"),add_snap_point(i,this._rect.offset.y+this._rect.y,"t"),t.inner_border&&add_snap_point(i,this._rect.offset.y+this._rect.y+t.inner_border,"t"),t.outer_border&&add_snap_point(i,this._rect.offset.y+this._rect.y-t.outer_border,"t")),t.center&&l&&add_snap_point(i,this._rect.offset.y+this._rect.y+Math.floor(this._rect.h/2),"m"),(_||l)&&(add_snap_point(i,_=this._rect.offset.y+this._rect.y+this._rect.h,"b"),t.inner_border&&add_snap_point(i,_-t.inner_border,"b"),t.outer_border&&add_snap_point(i,_+t.outer_border,"b")),(_||a||s)&&add_snap_point(i,this._rect.y,"t")}},RectSelect:function(t,e,i,o,r){var n=this._rect;return n.x+n.offset.x<=o&&n.x+n.offset.x+n.w>=e&&n.y+n.offset.y<=r&&n.y+n.offset.y+n.h>=i},HitTest:function(t,e){if(!this._visible)return null;var i=this._rect,o=i.x+i.offset.x,r=o+i.w,n=(o+r)/2,s=i.y+i.offset.y,a=s+i.h,_=(s+a)/2,l=Editor.GetScale(),d=Dragger.HANDLE_SIZE/l+2,h=o-d,c=r+d,p=s-d,u=a+d;if(!pt_in_rect4(t,e,h,c,p,u)&&"C"==i.orientation)return null;var f=n-d/2,m=n+d/2,g=_-d/2,y=_+d/2,b=BROWSER.MOBILE?10:0,v=Dragger.HANDLE_SIZE/l+2,x=Math.max(Math.round(i.x+i.spikeOffset.x-v/2),0)-b,w=Math.max(Math.round(i.y+i.spikeOffset.y-v/2),0)-b,C=x+v+2*b,T=w+v+2*b,S="";if(this._selected){var k=this._get_handles_by_orientation();k.lt&&pt_in_rect4(t,e,h,o,p,s)?S="lt":k.t&&pt_in_rect4(t,e,f,m,p,s)?S="t":k.rt&&pt_in_rect4(t,e,r,c,p,s)?S="rt":k.l&&pt_in_rect4(t,e,h,o,g,y)?S="l":k.r&&pt_in_rect4(t,e,r,c,g,y)?S="r":k.lb&&pt_in_rect4(t,e,h,o,a,u)?S="lb":k.b&&pt_in_rect4(t,e,f,m,a,u)?S="b":k.rb&&pt_in_rect4(t,e,r,c,a,u)?S="rb":k.s&&pt_in_rect4(t,e,x,C,w,T)&&(S="s")}var E={ctl_id:this._id,sub_id:this._sub_id,hdl_id:S,hdl_type:S};return S?(E.code=this._id+"#"+this._sub_id+"#"+S,E.z=this._parent._obj.z+1e3):pt_in_rect4(t,e,h,c,p,u)?(E.hdl_id="dom",E.code=this._id+"#"+this._sub_id+"#dom",E.z=this._parent._obj.z):E=null,E}}),HotSpotDragger.prototype=new RectDragger,WCT.ExtendObject(HotSpotDragger.prototype,{_write_hotspot_rect:function(){var t=this._id,e=this._parent,i=e.container_info_,o=e._obj,r=this._rect,n=this._coords,s=1/e.img_data_.scale;for(var a in n){var _=n[a],l=r[a];if(void 0!==l){var d={hotspot_x:"x",hotspot_y:"y"}[_];d&&(l-=o[d]+o.border+i[d]),l=parseInt(s*l),o[_]!=l&&(o[_]=l,Env.onPropChange(t,_,l))}}Env.AddHistory()},_read_hotspot_rect:function(){var t=this._coords,e=this._parent,i=e.container_info_,o=e._obj,r=this._rect,n=1/e.img_data_.scale,s=!1;for(var a in t){var _=t[a],l=o[_];if(void 0!==l){l=parseInt(l/n);var d={hotspot_x:"x",hotspot_y:"y"}[_];d&&(l+=o[d]+o.border+i[d]),l!=r[a]&&(r[a]=l,s=!0)}}return s},Init:function(t){this._coords=t,"hotspot"==this._sub_id?this._read_hotspot_rect():this._read_parent_rect();var e=this._rect.z,i=$$("div");i.id=this.el_id_("state"),i.className="state_rect",i.style.position="absolute",i.style.zoom=1,i.style.zIndex=this._selected?e+2e3:e,i.style.display=this._visible?"":"none",this.get_drg_parent_().appendChild(i),this.create_handle_("t",i),this.create_handle_("l",i),this.create_handle_("r",i),this.create_handle_("b",i),this.create_handle_("lt",i),this.create_handle_("lb",i),this.create_handle_("rt",i),this.create_handle_("rb",i),this._refresh_dom(),Draggers[this._id+"#"+this._sub_id]=this},StartDrag:function(t,e){Dragger.CopyRect(this._rect,this._orig_rect);var i=Draggers[this._id+"#hotspot"];i&&i._parent.setHotspotPreview(!1),"main"==this._sub_id&&(this.orig_img_data_=WCT.DeepCopy(this._parent.img_data_),this.pos_drg_=e&&"pos"==e.hdl_type.substr(0,3),this.orig_ctl_pos_={x:this._parent._obj.x,y:this._parent._obj.y},i&&(i.SetVisible(!1),i.StartDrag(t)))},EndDrag:function(t){"hotspot"==this._sub_id?this._write_hotspot_rect():this._write_parent_rect(),this._refresh_dom(!1),this._parent._update_dom&&this._parent._update_dom();var e=Draggers[this._id+"#hotspot"];if(e&&e._parent.setHotspotPreview(!0),"main"==this._sub_id&&e){var i=this._parent,o=i._obj,r=e._rect,n=o.x,s=o.y,a=this.orig_ctl_pos_,_=i.img_data_,l=this.orig_img_data_.w,d=_.w;if(l!=d){r.x-=a.x,r.y-=a.y;var h=d/l;r.w=Math.max(10,parseInt(r.w*h)),r.h=Math.max(10,parseInt(r.h*h)),r.x=Math.max(0,parseInt(r.x*h)),r.y=Math.max(0,parseInt(r.y*h)),r.x+=this.pos_drg_?a.x:n,r.y+=this.pos_drg_?a.y:s}e.SetVisible(!0),e.UpdatePos()}this.pos_drg_="",this.orig_ctl_pos_={},this.orig_img_data_={}},ApplySpecial:function(t,e,i){var o=t.hdl_type,r=Draggers[this._id+"#hotspot"];r&&"pos"==o&&"main"==i._sub_id&&(r.Apply(t,e),this.orig_ctl_pos_={x:r._parent._obj.x,y:r._parent._obj.y})},UpdatePos:function(){var t=arguments[0];"hotspot"==this._sub_id?(this._read_hotspot_rect()||t)&&this._refresh_dom():(this._read_parent_rect()||t)&&this._refresh_dom()},GetSnapPoints:function(t,e,i,o,r){"hotspot"!=this._sub_id&&RectDragger.prototype.GetSnapPoints.call(this,t,e,i,o,r)}}),GroupDragger.prototype=new ConstRectDragger,WCT.ExtendObject(GroupDragger.prototype,{SetWH:function(t,e){this._rect.w=t,this._rect.h=e,this._refresh_dom()},Init:function(t,e){this._coords=t,this._rect.w=e.w,this._rect.h=e.h;var i=$$("div");i.id=this.el_id_("state"),i.className="state_rect",this.get_drg_parent_().appendChild(i),this._refresh_dom(),Draggers[this._id+"#"+this._sub_id]=this},HitTest:function(t,e){if(!this._visible)return null;for(var i=this._parent.GetGroup(!0),o=null,r=0,n=i.length;r<n;r++){var s=i[r],a=Draggers[s+"#main"].HitTest(t,e);a&&(!o||a.z>o.z)&&(o=a)}return o?{ctl_id:this._id,sub_id:this._sub_id,hdl_id:"pos",hdl_type:"pos",code:this._id+"#"+this._sub_id+"#pos",z:this._parent._obj.z||0}:null},RectSelect:function(t,e,i,o,r){for(var n=this._parent.GetGroup(!0),s=0,a=n.length;s<a;s++){var _=n[s],l=Draggers[_+"#main"];if(l&&l.RectSelect(t,e,i,o,r))return!0}return!1},_refresh_dom:function(t){var e=this._get_el("state");if(e){LESSON_EDIT||set_opacity(e,100);var i=this._selected,o=!1;this._preview||!this._visible?e.style.display="none":(e.style.display="block",this.Locked()?(e.style.border=(i?Dragger.GRP_LINE_WIDTH+"px "+Dragger.GRP_LINE_STYLE:Dragger.DRG_LINE_INACTIVE_WIDTH+"px "+Dragger.GRP_LINE_STYLE)+" "+Dragger.CLR_IDLE,i||set_opacity(e,Dragger.DRG_OPACITY),o=!i):this._selected?e.style.border=Dragger.GRP_LINE_WIDTH+"px "+Dragger.GRP_LINE_STYLE+" "+(this._parent_active?Dragger.GRP_CLR_ACTIVE_SELECTED:Dragger.GRP_CLR_SELECTED):(e.style.border=Dragger.DRG_LINE_INACTIVE_WIDTH+"px "+Dragger.GRP_LINE_STYLE+" "+Dragger.CLR_IDLE,set_opacity(e,Dragger.DRG_OPACITY),o=!0));var r=this.get_rect_();t&&Editor.DragSelectionSize()<Dragger.INFO_THRESHOLD&&!arguments[1]&&this._selected?this._set_info(r,t):this._rem_info(),!this._preview&&this._visible&&(o?(e.style.left=r.x+"px",e.style.top=r.y+"px",e.style.width=Math.max(1,r.w-2)+"px",e.style.height=Math.max(1,r.h-2)+"px"):(e.style.left=r.x-Dragger.GRP_LINE_WIDTH+"px",e.style.top=r.y-Dragger.GRP_LINE_WIDTH+"px",e.style.width=r.w+"px",e.style.height=r.h+"px"),e.style.zIndex=this._selected?r.z+2e3:r.z)}},Limit:function(t,e){var i={x:e.x,y:e.y};this.hdl.pos.clamp(this._orig_rect,i),Dragger.ApplyDeltaLimit(e,i)},Apply:function(t,e){switch(Dragger.CopyRect(this._orig_rect,this._rect),t.hdl_id){case"rt":case"rb":case"lb":case"lt":case"t":case"b":case"l":case"r":case"s":break;default:this.hdl.pos.apply(this._rect,e)}this._refresh_dom(!0);var i=this._parent;i._rd_update_dom_pos?i._rd_update_dom_pos(this._sub_id,this._rect):i._rd_update_dom_rect&&i._rd_update_dom_rect(this._sub_id,this._rect),this.do_for_all_group_("Apply",t,e)},do_for_all_group_:function(t,e,i){for(var o=this._parent.GetGroup(!0),r=o.length-1,n=0;n<=r;n++){var s=Controls[o[n]];s&&s._draggers.main[t](e,i,!0)}},_read_parent_rect:function(){var t=this._parent,e=t.GetGroup(!0);if(e&&e.length){var i=GetRectForControls(e);if(i)return i.z=t.GetZIndex(),this._rect=i,!0}return!1},StartDrag:function(t,e){Dragger.CopyRect(this._rect,this._orig_rect),this.do_for_all_group_("StartDrag",t,e)},EndDrag:function(t){this.do_for_all_group_("EndDrag",t),this._write_parent_rect(),this._refresh_dom(!1),this._parent.UpdateDom&&this._parent.UpdateDom(this._rect)}}),TextBox.prototype=new SlideControl,WCT.ExtendObject(TextBox,{LINK_TYPE_MAP:{open_textwindow:{icon:"open_textwindow",popup:null},"default":{icon:"open_textwindow",popup:null},open_moreInfoBtn:{icon:"open_moreInfoBtn",popup:"info"},moreInfo:{icon:"open_moreInfoBtn",popup:"info"},open_tipsBtn:{icon:"open_tipsBtn",popup:"tip"},tips:{icon:"open_tipsBtn",popup:"tip"}},ClampPadding:function(t,e){clamp_padding.call(this,t,e,{w:"textBoxW",h:"textBoxH"})},ClampBorder:function(t,e){clamp_border.call(this,t,e,{w:"textBoxW",h:"textBoxH"})},ClampPopupXY:function(t,e){var i=e.name.charAt(7).toLowerCase(),o={x:"w",y:"h"}[i],r=Canvas[i](),n=Canvas[o](),s=Canvas.border();e.val=Math.min(s-r,Math.max(n+s-10,e.val-0))},SetOpacity:function(t,e,i){(BROWSER.IE7||BROWSER.IE8)&&(i=100),set_ctrl_opacity.call(this,t,e,i,!0)},SetPopupOpacity:function(t,e,i){EDIT_MODE&&t.hide_textbox_in_editor||((BROWSER.IE7||BROWSER.IE8)&&(i=100),Editor||this.popup_open_?handle_visibility.call(this,t.hide_textbox_in_editor||t.hidden,i,!1,this._popupFader):handle_visibility.call(this,!0,i,!1,this._popupFader))},SetHidden:function(t,e,i){if(set_hidden.call(this,t,e,i,!0),EDIT_MODE&&Editor&&!Editor.Preview()){var o=t.hide_textbox_in_editor?0:i?Fader.HIDE_OPACITY:t.popup_opacity;handle_visibility.call(this,i,o,!1,this._popupFader)}},SetShadow:function(t,e,i){if(this.CalcShadow("box_shadow")){var o=this._get_el("#popup#dom");o&&(o.style.boxShadow=this._box_shadow)}},SetPopupXY:function(t,e,i){var o=this._get_el("#popup#dom");if(o){var r={X:"left",Y:"top"}[e.charAt(e.length-1)];o.style[r]=i+"px"}!1!==arguments[3]&&(this._draggers&&this._draggers.popup.UpdatePos(),this._update_hit_areas&&this._update_hit_areas())},SetZ:function(t,e,i){set_z.call(this,t,e,i),Page.UpdateControl(t.id,"textBoxZ",1e3+i)},SetPopupZ:function(t,e,i){Env.onPropChange(t.id,"textBoxZ",i);var o=this._get_el("#popup#dom");o&&(o.style.zIndex=i,this._draggers&&this._draggers.popup.UpdatePos())},SetPopupType:function(t,e,i){this.SetLinkType(i),this._tctl&&(i=(TextBox.LINK_TYPE_MAP[i]||TextBox.LINK_TYPE_MAP["default"]).popup,this._tctl.SetTypeIcon(i))},SetBorderStyle:function(t,e,i){var o=this._tctl;if(o){if(i){var r=TextBox.GetBorderTextObjectObject(t);o.SetTitleClass(""),o.SetBorderStyle(r),o.SetCustomBorderStyle(null)}else o.SetTitleClass("titleLine"),o.SetCustomBorderStyle(BorderObject.POPUP_STYLE);var n=this._rd_get_min_rect("popup");n&&(n.w>t.textBoxW||n.h>t.textBoxH)&&(n.w>t.textBoxW&&(t.textBoxW=n.w),n.h>t.textBoxH&&(t.textBoxH=n.h),this._rd_update_dom_rect&&this._rd_update_dom_rect("popup",t),this._draggers&&this._draggers.popup.UpdatePos(),this._update_hit_areas&&this._update_hit_areas())}},HidePopup:function(t,e,i){var o=i?0:t.hidden?Fader.HIDE_OPACITY:t.popup_opacity;handle_visibility.call(this,i,o,!1,this._popupFader);var r=this._draggers&&this._draggers.popup;r&&(r.SetVisible(!t.hide_textbox_in_editor),Editor.SelectDrag(t.id,"popup",!i),i&&this._draggers.main.SetSelected(!0))},GetBorderTextObjectObject:function(t){var e=WCT.DeepCopy(t);return e.x=t.textBoxX,e.y=t.textBoxY,e.w=t.textBoxW,e.h=t.textBoxH,delete e.textBoxX,delete e.textBoxY,delete e.textBoxW,delete e.textBoxH,e}}),WCT.ExtendObject(TextBox.prototype,{SetDirection:TextControl.prototype.SetDirection,SetLinkType:function(t){t=(TextBox.LINK_TYPE_MAP[t]||TextBox.LINK_TYPE_MAP["default"]).icon,ImageLink.prototype.SetLinkType.call(this,t)},InitEdit:function(){ImageLink.prototype.InitEdit.call(this);var t=new RectDragger(this,this._id,"popup");t.setHandle(Dragger.HdlTextbox),t.Init({x:"textBoxX",y:"textBoxY",w:"textBoxW",h:"textBoxH",z:"textBoxZ"}),t.UpdatePos(),t.SetVisible(!this._obj.hide_textbox_in_editor),this._draggers.popup=t},_create_dom:function(){var t=this._obj;this.SetLinkType(t.textBox_type),ImageLink.prototype._create_dom.apply(this,arguments),this._get_el().className="TexBox";var e=$$("div");e.id=this._id+"#popup#dom",e.className="TextBox",e.tabIndex=t.tabindex,e.setAttribute("role","dialog"),e.setAttribute("aria-hidden","true"),e.style.position="absolute",e.style.backgroundColor="transparent",e.style.overflow="hidden",Canvas.Parent().appendChild(e);var i=TextBox.GetBorderTextObjectObject(t),o=new BorderTextObject(this._id,{uid:t.id+"#main"});o.SetCustomBorderStyle(BorderObject.POPUP_STYLE),o.EnableIFrame(!0),o.SetSrcCtx(this._src_ctx),o.SetTitleClass(t.border_style?"":"titleLine"),o.Create(e,i);var r=(this._tctl=o).GetUid();e.setAttribute("aria-labelledby",r+"#BO#title"),e.setAttribute("aria-describedby",r+"#TO#text"),TextBox.HidePopup.call(this,t,"trigger_error_on_use",t.trigger_error_on_use)},_rd_get_min_rect:function(t){return"popup"==t?TextControl.prototype._rd_get_min_rect.apply(this,arguments):{w:0,h:0}},_rd_update_dom_pos:function(t,e){"main"!=t?this._update_popup(e):RectControl.prototype._rd_update_dom_pos.apply(this,arguments)},_rd_update_dom_rect:function(t,e){"popup"==t&&this._update_popup(e)},_update_dom:function(t){},_update_popup:function(t){if(!this._disable_dom_update){var e=this._obj,i=null!=t.textBoxX?t.textBoxX:null!=t.x?t.x:e.textBoxX,o=null!=t.textBoxY?t.textBoxY:null!=t.y?t.y:e.textBoxY;TextBox.SetPopupXY.call(this,e,"textBoxX",i,!1),TextBox.SetPopupXY.call(this,e,"textBoxY",o,!1),BorderTextObject.SetControlWH.call(this,e,"textBoxW",t.textBoxW||t.w,!1),BorderTextObject.SetControlWH.call(this,e,"textBoxH",t.textBoxH||t.h,!1),this._update_hit_areas()}},_remove_dom:function(){var t=this._get_el("#popup#dom");t&&t.parentNode.removeChild(t),this._box_shadow="",SlideControl.prototype._remove_dom.call(this)},OnRTKeyDown:function(t){"close"===t.hdl_id&&(this._tctl.SetIconState("close","a"),this.RTClosePopup())},OnRTMouseEnter:function(t){"main"==t.sub_id&&this._obj.hover_mode&&this.RTOpenPopup(),"popup"==t.sub_id&&"closeimg"==t.hdl_id&&this._tctl&&this._tctl.SetIconState("close","h")},OnRTMouseLeave:function(t){"main"==t.sub_id&&this._obj.hover_mode&&this.RTClosePopup(),"popup"==t.sub_id&&"closeimg"==t.hdl_id&&this._tctl.SetIconState("close","")},OnRTMouseDown:function(t){if("popup"==t.sub_id&&"closeimg"==t.hdl_id&&this._tctl.SetIconState("close","a"),"popup"==t.sub_id&&!t.hdl_id.indexOf("draghandle")){RT.setCapture(this._id),RT.SetDrag(this._id),this.in_move_=!0;var e=this._obj;this.start_x_=this.start_x_||e.textBoxX,this.start_y_=this.start_y_||e.textBoxY,this.start_cx_=t.canvasX,this.start_cy_=t.canvasY,this.drag_sel_=document.onselectstart,document.onselectstart=function(){return!1},WCT.dom.IOSOpacitySwitch(this._get_el("#popup#dom"))}},OnRTMouseMove:function(t){if(this.in_move_){var e={x:this.start_x_+t.canvasX-this.start_cx_,y:this.start_y_+t.canvasY-this.start_cy_};this._limit_popup_pos(e);var i=this._get_el("#popup#dom");i.style.left=e.x+"px",i.style.top=e.y+"px",t.hasToBeCancelled=!0}},OnRTMouseUp:function(t){if("popup"==t.sub_id&&"closeimg"==t.hdl_id&&this._tctl.SetIconState("close","h"),"popup"==t.sub_id&&!t.hdl_id.indexOf("draghandle")&&this.in_move_){RT.releaseCapture(),RT.SetDrag(null),this.in_move_=!1;var e={x:this.start_x_+t.canvasX-this.start_cx_,y:this.start_y_+t.canvasY-this.start_cy_};this._limit_popup_pos(e),this.start_x_=e.x,this.start_y_=e.y;var i=this._get_el("#popup#dom");i.style.left=e.x+"px",i.style.top=e.y+"px",document.onselectstart=this.drag_sel_,this.drag_sel_=null,this._update_hit_areas()}},OnRTMouseClick:function(t){"main"!=t.sub_id||this._obj.hover_mode&&!BROWSER.MOBILE||this[this.popup_open_?"RTClosePopup":"RTOpenPopup"](),"popup"==t.sub_id&&"closeimg"==t.hdl_id&&this.RTClosePopup()},RTClosePopup:function(){if(this.popup_open_){var t=this._obj;t.onpopuphide&&Page.RTFireTrigger(t.onpopuphide),this._popupFader[t.fadeing?"FadeOut":"Hide"](),this.popup_open_=!1,this._get_el("#popup#dom").setAttribute("aria-hidden","true");var e=this._get_el("#main#dom"),i=t.fadeing?t.fade_out_time:0;WCT.SetTimeout(function(){e.focus()},i,this),this.do_track_(),this._update_hit_areas()}},RTOpenPopup:function(){if(!this.popup_open_){var t=this._obj;t.onpopupshow&&Page.RTFireTrigger(t.onpopupshow);var e=this._popupFader,i=t.popup_opacity||100;e.SetOpacity(i),t.fadeing||e.SetHideOpacity(i),e[t.fadeing?"FadeIn":"Show"](),t.fadeing||e.SetHideOpacity(0),this.popup_open_=!0;var o=this._get_el("#popup#dom");o.setAttribute("aria-hidden","false");var r=t.fadeing?t.fade_in_time:0;WCT.SetTimeout(function(){o.focus()},r,this),this.do_track_(),this._update_hit_areas()}},do_track_:function(){var t=this.popup_open_,e=this._obj;window.ctx&&(ctx.track&&ctx.track({id:"slide_user_action_textbox_"+(t?"open":"close"),uid:e.uid,slide_id:Context.Get("slide"),textbox_id:this._id,textbox_type:e.textBox_type,textbox_content:e.text}),e.uid&&ctx.setStore&&ctx[t?"setStore":"remStore"]("textbox_"+e.uid,"open"))},_limit_popup_pos:function(t){var e=this._obj,i=Canvas.x(),o=Canvas.y(),r=Canvas.w(),n=Canvas.h(),s=Canvas.centered()?i+r-e.textBoxW:Page.clientWidth-e.textBoxW,a=Canvas.centered()?o+n-e.textBoxH:Page.clientHeight-e.textBoxH;t.x=Math.min(Math.max(t.x,-i),s),t.y=Math.min(Math.max(t.y,-o),a)},OnResize:function(t){var e={x:this.start_x_,y:this.start_y_};this._limit_popup_pos(e),this.start_x_=e.x,this.start_y_=e.y;var i=this._get_el("#popup#dom");i.style.left=e.x,i.style.top=e.y,this._update_hit_areas()},_update_hit_areas:function(){RectControl.prototype._update_hit_areas.call(this);var t=this._id;if(this.popup_open_){if(this._tctl){var e=this._obj,i=this._tctl.GetPosSize(!0),o=this.start_x_||e.textBoxX,r=this.start_y_||e.textBoxY,n=1e3===e.textBoxZ?e.textBoxZ+e.z:e.textBoxZ;if(HitManager.setHitArea({ctl_id:t,sub_id:"popup",hdl_id:"dom",cursor:"default",type:"rect",x:o,y:r,w:e.textBoxW,h:e.textBoxH,z:e.hover_mode?e.z-.1:n}),!e.hover_mode){if(i.drag)for(var s=0,a=null;a=i.drag[s];s++)HitManager.setHitArea({ctl_id:t,sub_id:"popup",hdl_id:"draghandle_"+s,cursor:"move",type:"rect",x:o+a.x,y:r+a.y,w:a.w,h:a.h,z:n+.1});else if(i.title){var _=i.title.x,l=i.title.w;i.icon&&(_=Math.min(i.title.x,i.icon.x),l=Math.max(i.title.x+i.title.w,i.icon.x+i.icon.w)-_),HitManager.setHitArea({ctl_id:t,sub_id:"popup",hdl_id:"draghandle",cursor:"move",type:"rect",x:o+_,y:r+i.title.y,w:l,h:i.title.h,z:n+.1})}i.close&&HitManager.setHitArea({ctl_id:t,sub_id:"popup",hdl_id:"closeimg",cursor:"pointer",type:"rect",x:o+i.close.x,y:r+i.close.y,w:i.close.w,h:i.close.h,z:n+.2})}}}else HitManager.clearHitArea({ctl_id:t,sub_id:"popup"})},_on_set_preview:function(t){var e=this._obj,i=!e.hide_textbox_in_editor&&!e.hidden;t?i=!!(e.uid&&window.ctx&&ctx.getStore)&&"open"==ctx.getStore("textbox_"+e.uid):(this.start_x_=null,this.start_y_=null);var o=this._popupFader,r=t?0:o.GetHideOpacity();o.SetDomVis(i?0:100),o.SetOpacity(e.popup_opacity||100),o.SetHideOpacity(r),o[i?"Show":"Hide"](),this.popup_open_=i,this._update_hit_areas()},RTFireTrigger:function(t,e){if(0===t.search("group_")&&RectControl.prototype.RTFireTrigger.apply(this,arguments))return!0;switch(t){case"show":case"fade_in":this.RTOpenPopup();break;case"hide":case"fade_out":this.RTClosePopup();break;case"toggle":case"fade_toggle":this[this.popup_open_?"RTClosePopup":"RTOpenPopup"]();break;case"update_placeholder":var i=this._obj;TextObject.UpdateFromControl.call(this,i,"text",i.text)}},OnDefaultEdit:function(){return Env.edit({ctlId:this._id,paramName:"text",posSize:this.GetHtmlPosSize(),paramW:"textBoxW",paramH:"textBoxH",extInfo:this._obj}),!0},GetHtmlPosSize:function(){var t=this._obj,e=this._tctl.GetPosSize(!0),i={x:Canvas.x()+t.textBoxX+e.text.x,y:Canvas.y()+t.textBoxY+e.text.y,w:e.text.w,h:e.text.h};return Canvas.ApplyScaleToPos(i),i.x-=Page.scrollLeft,i.y-=Page.scrollTop,i}}),Bubble.prototype=new RectControl,Bubble.Styles={},Bubble.SetText=function(t,e,i){if(i=replace_placeholder(i=_escapeFontFamily(i)),i=(i=Page.HighlightHtmlString(i)).replace(/<span style="font-weight:bold">\s*&nbsp;\s*<\/span>/,""),WCT.Previewer.closePreview(),this[e]!=i){var o=Context.ResolveHtmlString(i,this._src_ctx);o=WCT.PreventXSS(o),this[e+"_res"]=EDIT_MODE&&Editor&&!Editor.Preview()?o.replace(/autoplay=["|']true["|']/gi,""):o;var r=this._get_el("#main#txt");if(!r)return;this[e]=i,r.innerHTML=o,WCT.image_watcher.AddImagesInside(r)?(this.SetTimeout(!1),this.wait_image_=WCT.image_watcher.Observe(Bubble.OnImage,this)):this._update_main_rectV3()}},Bubble.OnImage=function(){this.resizeUpscaledImages_(),WCT.image_watcher.StopObserving(this.wait_image_),this.wait_image_=null,this.buffer_added_=this._preventWidthChange=!1,this.SetTimeout(!0)},Bubble.SetZ=function(t,e,i){this._get_el().style.zIndex=i,this._update_dom(EDIT_MODE),EDIT_MODE&&(document.body.visibility="hidden",document.body.visibility="visible",document.body.visibility="")},Bubble.SetStyle=function(t,e,i){if(this[e]!=i)if(this[e]=i,this.controlValuesSet_=!1,"undefined"==typeof Bubble.Styles[i]){var o=Env.LoadFile("bubble!"+i+":bubble.txt");Bubble.SetStyleCb.call(this,o,i),XRAY_WEB_LESSON_EDITOR&&!o&&LoadFile("bubble!_default::bubble.txt",Bubble.SetStyleCb,[this,"_default"])}else Bubble.SetStyleCb.call(this,Bubble.Styles[i],i)},Bubble.SetStyleCb=function(t,e){var i=Bubble.Styles[e];if(i)this.imgBase_=i.img_base,this._styleParams=i.style_params,this.spriteMap_=i.sprite_map;else if(t){var o=Context.ToAbsPath("bubble!"+e+":")+"/";-1==o.search("http://")&&-1==o.search("file://")&&":"==o.charAt(1)&&(o="file://"+o);var r={},n=Bubble.Imagedir(t,Bubble_legacy_configuration_data_);Bubble.Configurator(n,r,Bubble_configuration_data_),this.imgBase_=o,this._styleParams=r,this.spriteMap_=this._getSpriteMap(),i={img_base:o,style_params:r,sprite_map:this.spriteMap_},Bubble.Styles[e]=i}else if(EDIT_MODE||top.DEBUG||NO_ALERT)EDIT_MODE&&Env.showMessageInWindow("wysiwyg:bubblestyle_missing",e);else{t=ctx.cfg_tr?ctx.cfg_tr("BUBBLESTYLE_NOT_FOUND"):"Bubblestyle not found";alert(t+": "+e)}if(i){this.controlValuesSet_=!0,this.version=i.style_params.version;var s=this._obj;s.oriorientation&&(s.orientation=this._getNextPossibleOrientation(s.oriorientation),this.orientation=this.invert_orientation(s.orientation))}this._disable_dom_update||(this._remove_dom(),this._create_dom()),this._waitForTransition&&(this._disable_dom_update||!EDIT_MODE)||this.ShowAfterTransition()},Bubble.SetOrientation=function(t,e,i){var o=this._getNextPossibleOrientation(i),r=this._obj;r[e]=o,r.oriorientation=i,this[e]=this.invert_orientation(o),this._disable_dom_update||this.settingOrientation_||(this.settingOrientation_=!0,this._update_main_rect(),this.settingOrientation_=!1)},Bubble.UpdateDom=function(t,e,i){this[e]!=i&&(this[e]=i,this._update_dom())},Bubble.SetHidden=function(t,e,i){if(!i&&this.IsGrouped()){var o=this.GetGroupId();Controls[o].isHidden()&&(i=!0)}if((!Page.MR_SHOW_TASK_BUBBLE&&t.mr_bubble_task||!Page.MR_SHOW_EXPL_BUBBLE&&t.mr_bubble_expl)&&(i=!0,t.hidden=!0,BROWSER.IE)){var r=this._get_el("#main#txt");r&&(r.style.display="")}if(!this.anti_flicker_||!i){if(!this._waitForTransition){var n=this._fader;arguments[4]||!t.fadeing||EDIT_MODE&&!this.preview?i?(!EDIT_MODE||Editor.Preview()?n.SetHideOpacity(0):t.opacity<Fader.HIDE_OPACITY?n.SetHideOpacity(t.opacity*Fader.HIDE_OPACITY/100):n.SetHideOpacity(Fader.HIDE_OPACITY),n.Hide()):(n.SetHideOpacity(t.opacity),n.Show()):n[i?"FadeOut":"FadeIn"]();var s=this._draggers&&this._draggers.main||null;s&&(LESSON_EDIT&&s.SetVisible(!i),s._refresh_dom()),arguments[3]||i||this._update_main_rect();var a=this._get_el("#iframeMain");a&&(a.style.visibility=i?"hidden":"visible");var _=this._get_el("#clone");_&&(_.style.visibility=i?"hidden":"visible")}this._update_hit_areas()}},Bubble.UpdateMainRectV3=function(t){var e=Controls&&Controls[t]||null;e&&(e.TimeoutID=0,e._update_main_rectV3())},WCT.ExtendObject(Bubble.prototype,{MoveHome:function(){},MoveTo:function(){},_create_dom:function(){this._originalObj=WCT.DeepCopy(this._obj);var t=$$("div"),e=this._id;t.id=e+"#main#dom",t.className="Bubble",t.setAttribute("role",BROWSER.IE?"region":"dialog"),t.setAttribute("aria-labelledby",e+"#main#title"),t.setAttribute("aria-describedby",e+"#main#txt"),t.style.width="0",t.style.height="0",t.style.zIndex=this._obj.z,t.style.visibility="hidden",t.style.left="-1000px",t.style.top="-1000px",this.createIFrameMain_(Canvas.Parent()),Canvas.Parent().appendChild(t)},Init:function(t){t.offset={x:0,y:0},this.auto_size_=!0,RectControl.prototype.Init.call(this,t),(EDIT_MODE||T2)&&this.ShowAfterTransition()},InitEdit:function(){var t=this._draggers;t.main=new BubbleDragger(this,this._id,"main"),t.main.Init({x:"x",y:"y",w:"w",h:"h",z:"z",orientation:"orientation",offset:"offset"},!0),t.main.UpdatePos()},GetBoundaryRect:function(){return null},_rd_get_min_rect:function(t){"main"==t||NO_ALERT||alert("_rd_get_min_rect called with sub_id "+t);var e=this._styleParams,i=this.getBodyPaddings_(),o=this.orientation,r=i.l_+i.r_,n=e["spike_dock_"+o+"_w"];switch(o){case"n":case"s":r=i.l_+i.r_+n;break;case"ne":case"se":r=i.l_+2*i.r_+n;break;case"nw":case"sw":r=2*i.l_+i.r_+n}var s=i.t_+i.b_;switch(o){case"e":case"en":case"es":case"w":case"wn":case"ws":s=i.t_+i.b_+e["spike_dock_"+o+"_h"]}if(this.closable){var a=e.title_off_left-e.close_off_x+e.close_w;r<a&&(r=a)}var _=this.getTextPaddings_();return r=Math.max(r,_.l_+_.r_),s=Math.max(s,_.t_+_.b_),{w:r=2*Math.round(r/2),h:s=2*Math.round(s/2)}},_rd_update_dom_pos:function(t,e){this._update_main_rectV3(e,!0)},_rd_update_dom_rect:function(t,e){e||this._update_main_rect()},_update_dom:function(t){t&&(this.buffer_added_=!1,this._preventWidthChange=!1),this._disable_dom_update||this._update_main_rect()},resizeUpscaledImages_:function(){var t=Page.GetContentScale();if(t&&1!=t){for(var e=this._originalObj,i=this._get_el().getElementsByTagName("img"),o=!1,r=0,n=null;n=i[r++];)-1!==n.src.search(/fieldicon.*\.png/)&&(n.style.width=parseInt(n.offsetWidth/t)+"px",o=!0);!EDIT_MODE&&o&&1!==t&&(this.SetParam("w",e.w),this.SetParam("h",e.h),this._update_dom(!0))}},SetTimeout:function(t){this.TimeoutID&&(WCT.ClearTimeout(this.TimeoutID),this.TimeoutID=0),t&&(this.TimeoutID=WCT.SetTimeout(Bubble.UpdateMainRectV3,1,Bubble,[this._id]))},_remove_dom:function(){this.SetTimeout(!1);var t=this._get_el("#iframeMain");t&&t.parentNode.removeChild(t);var e=this._get_el("#clone");e&&e.parentNode.removeChild(e),this.flag_iframe_created_=!1,RectControl.prototype._remove_dom.call(this)},getSimplifiedOrientation:function(){return this._styleParams.edge_per_orientation?SIMPL_ORI_MAP[this.orientation]||"n":""},getBodyPaddings_:function(){var t=this._styleParams;return{t_:t[this._with_caption||3!=t.version&&this.movable?"edge_n_with_caption_h":"edge_n_h"]||0,l_:t.edge_e_w||0,r_:t.edge_w_w||0,b_:t.edge_s_h||0}},getTextPaddings_:function(){var t=this._styleParams;if(3!=t.version)return this.getBodyPaddings_();var e=this._obj.title,i="string"==typeof e&&""!=e.trim(),o=this.closable,r=this.movable;if(t.edge_per_orientation){var n=this.getSimplifiedOrientation();return{t_:t["content_padding"+("n"==n?"_"+n:(o||r?"_movable":"")+(i?"_with_caption":""))+"_top"]||0,l_:t["content_padding_"+n+"_left"]||0,r_:t["content_padding_"+n+"_right"]||0,b_:t["content_padding_"+n+"_bottom"]||0}}return{t_:t["content_padding"+(o||r?"_movable":"")+(i?"_with_caption":"")+"_top"]||0,l_:t.content_padding_left||0,r_:t.content_padding_right||0,b_:t.content_padding_bottom||0}},getTextDimensions_:function(){var t=this.getTextPaddings_();return{w_:Math.max(0,this._obj.w-t.l_-t.r_),h_:Math.max(0,this.height_-t.t_-t.b_)}},_getTextFragment:function(t){var e=this._styleParams,i=this._id+"#main#"+t.id;return['<div class="',t.className,'" id="',i,'" ','data-placeholder="Enter text here..." ',t.title?'title="'+t.title+'" ':"",'style="z-index:',t.z,";cursor:",t.cursor,";","left:",t.x,"px;top:",t.y,"px;width:",t.w,"px;height:",t.h,"px;",_escapeFontFamily(e.content_font_family?"font-family:"+e.content_font_family+";":""),e.content_font_size?"font-size:"+e.content_font_size+";":"",e.content_font_color?"color:"+e.content_font_color+";":"",e.content_bold?"font-weight:bold;":"",e.content_italic?"font-style:italic;":"",e.content_underline?"text-decoration:underline;":"","display:",t.display,';">',t.html,"</div>"].join("")},_getTitleFragment:function(t){var e=this._styleParams,i=this._id+"#main#"+t.id;return['<div class="',t.className,'" id="',i,'" role="heading" ',t.title?'title="'+t.title+'" ':"",'style="z-index:',t.z,";","cursor:",t.cursor,";",_escapeFontFamily(e.title_font_family?"font-family:"+e.title_font_family+";":""),"font-size:",e.title_font_size,";","color:",e.title_font_color,";",e.title_bold?"font-weight:bold;":"",e.title_italic?"font-style:italic;":"",e.title_underline?"text-decoration:underline;":"","left:",t.x,"px;top:",t.y,"px;width:",t.w,"px;height:",t.h,"px;","display:",t.display,';">',t.html,"</div>"].join("")},_getImageFragment:function(t){var e=this._styleParams.use_gifs?".gif":".png",i=t.title?'title="'+t.title+'" ':"",o="block"===t.display?"":"display:"+t.display+";",r=t.z?"z-index:"+t.z+";":"",n=t.title?'aria-label="'+t.title+'" ':"",s=this._id+"#main#"+t.id;return['<div class="dgoBU dgoBUbtn" role="button" tabindex="',this._obj.tabindex,'" id="',s,'" ',i,n,'style="left:',t.x,"px;top:",t.y,"px;width:",t.w,"px;height:",t.h,"px;",r,o,'cursor:pointer;">','<img class="dgoBU" role="presentation" id="',s,'_sub" ',i,'src="',this.imgBase_,t.sprite,e,'" ','style="cursor:',t.cursor,";","left:",t.spriteX,"px;top:",t.spriteY,"px;","width:",t.imageW,"px;height:",t.imageH,'px;" />',"</div>"].join("")},_getBGImgFragment:function(t){var e=this._styleParams.use_gifs?".gif":".png",i=t.title?'title="'+t.title+'" ':"",o=this._id+"#main#"+t.id,r=t.z?"z-index:"+t.z+";":"",n="default"===t.cursor?"":"cursor:"+t.cursor+";",s="block"===t.display?"":"display:"+t.display+";",a=t.w2?Math.round(t.spriteX*t.w2/t.spriteW)+t.x2+"px "+(Math.round(t.spriteY*t.h2/t.spriteH)+t.y2)+"px;":t.spriteX+"px "+t.spriteY+"px;",_=t.w2?"background-size:"+Math.round(t.w2*t.imageW/t.spriteW)+"px "+Math.round(t.h2*t.imageH/t.spriteH)+"px;":"";return['<div class="dgoBU" id="',o,'" ',i,'style="',r,n,"left:",t.x,"px;top:",t.y,"px;width:",t.w,"px;height:",t.h,"px;",s,"background-position:",a,_,"background-image:url(",this.imgBase_,t.sprite,e,');"></div>'].join("")},_fragmentToDomString:function(t,e){if(!EDIT_MODE&&!e.show)return"";var i=arguments[2]||null,o=this._styleParams,r=o.version<3,n={id:t,className:e.className,title:e.title,x:e.x,y:e.y,w:e.w,h:e.h,display:e.show?"block":"none",cursor:e.handcursor?"move":"default",z:e.zIndex||0,imageW:r?e.w:o.sprite_w,imageH:r?e.h:o.sprite_h};i&&(n.sprite=i.sprite,n.spriteX=i.sprite_x,n.spriteY=i.sprite_y,n.spriteW=i.sprite_w,n.spriteH=i.sprite_h);var s=null;switch(e.type){case"stretchcut":n.x2=e.x2,n.y2=e.y2,n.w2=e.w2,n.h2=e.h2,s="_getBGImgFragment";break;case"button":s="_getImageFragment";break;case"title":n.html=e.innerHTML,s="_getTitleFragment";break;case"text":n.html=e.innerHTML,s="_getTextFragment";break;default:i&&(s="_getBGImgFragment")}return s?this[s](n):""},_fragmentListToDomString:function(){var t=this.fragmentList_,e=this.spriteMap_,i=[];for(var o in t){var r=t[o];i.push(this._fragmentToDomString(o,r,e[r.sprite]))}return i.join("")},_getLegacySpriteMap:function(){var t=this._styleParams,e={background:"body",corner_tl:t.new_style?"corner21_nw":"corner1_nw",corner_tl_movable:"corner_nw",corner_tl_with_caption:"corner1_nw",corner_tl_movable_with_caption:"corner_nw",corner_tr:t.new_style?"corner21_ne":"corner1_ne",corner_tr_movable:"corner_ne",corner_tr_with_caption:"corner1_ne",corner_tr_movable_with_caption:"corner_ne",corner_bl:"corner_sw",corner_br:"corner_se",edge_n:t.new_style?"edge21_n":"edge1_n",edge_n_movable:"edge_n",edge_n_with_caption:"edge1_n",edge_n_movable_with_caption:"edge_n",edge_e:"edge_e",edge_w:"edge_w",edge_s:"edge_s",fill_n:t.new_style?"edge21_n":"edge1_n",fill_n_movable:"edge_n",fill_n_with_caption:"edge1_n",fill_n_movable_with_caption:"edge_n",connect_nw:t.use_connects?t.new_style?"connect21_nw":"connect1_nw":"edge01_n",connect_nw_movable:t.use_connects?"connect_nw":"edge0_n",connect_nw_with_caption:t.use_connects?"connect1_nw":"edge01_n",connect_nw_movable_with_caption:t.use_connects?"connect_nw":"edge0_n",connect_n:t.use_connects?t.new_style?"connect21_n":"connect1_n":"edge01_n",connect_n_movable:t.use_connects?"connect_n":"edge0_n",connect_n_with_caption:t.use_connects?"connect1_n":"edge01_n",connect_n_movable_with_caption:t.use_connects?"connect_n":"edge0_n",connect_ne:t.use_connects?t.new_style?"connect21_ne":"connect1_ne":"edge01_n",connect_ne_movable:t.use_connects?"connect_ne":"edge0_n",connect_ne_with_caption:t.use_connects?"connect1_ne":"edge01_n",connect_ne_movable_with_caption:t.use_connects?"connect_ne":"edge0_n",spike_nw:"spike1_nw",spike_nw_movable:"spike_nw",spike_nw_with_caption:"spike1_nw",spike_nw_movable_with_caption:"spike_nw",spike_n:"spike1_n",spike_n_movable:"spike_n",spike_n_with_caption:"spike1_n",spike_n_movable_with_caption:"spike_n",spike_ne:"spike1_ne",spike_ne_movable:"spike_ne",spike_ne_with_caption:"spike1_ne",spike_ne_movable_with_caption:"spike_ne",fill_e:"edge_e",connect_e:t.use_connects?"connect_e":"edge0_e",spike_e:"spike_e",fill_s:"edge_s",connect_sw:t.use_connects?"connect_sw":"edge0_s",connect_s:t.use_connects?"connect_s":"edge0_s",connect_se:t.use_connects?"connect_se":"edge0_s",spike_sw:"spike_sw",spike_s:"spike_s",spike_se:"spike_se",fill_w:"edge_w",connect_w:t.use_connects?"connect_w":"edge0_w",spike_w:"spike_w",min:"min_moz",close:"close_moz"};for(var i in e)e[i]={sprite:e[i],sprite_x:0,sprite_y:0};return e.min.sprite_w=t.min_w,e.min.sprite_h=t.min_h,e.close.sprite_w=t.close_w,e.close.sprite_h=t.close_h,e},_getSpriteMap:function(){var t=this._styleParams;if(t.version<3)return this._getLegacySpriteMap();var e={background:1,corner_tl:1,corner_tl_n:1,corner_tl_e:1,corner_tl_w:1,corner_tl_s:1,corner_tl_movable:1,corner_tl_with_caption:1,corner_tl_movable_with_caption:1,corner_tr:1,corner_tr_n:1,corner_tr_e:1,corner_tr_w:1,corner_tr_s:1,corner_tr_movable:1,corner_tr_with_caption:1,corner_tr_movable_with_caption:1,corner_bl:1,corner_bl_n:1,corner_bl_e:1,corner_bl_w:1,corner_bl_s:1,corner_br:1,corner_br_n:1,corner_br_e:1,corner_br_w:1,corner_br_s:1,edge_n:1,edge_n_n:1,edge_n_e:1,edge_n_w:1,edge_n_s:1,edge_n_movable:1,edge_n_with_caption:1,edge_n_movable_with_caption:1,edge_s:1,edge_s_n:1,edge_s_e:1,edge_s_w:1,edge_s_s:1,edge_w:1,edge_w_n:1,edge_w_e:1,edge_w_w:1,edge_w_s:1,edge_e:1,edge_e_n:1,edge_e_e:1,edge_e_w:1,edge_e_s:1,spike_tl:1,spike_tl_movable:1,spike_tl_with_caption:1,spike_tl_movable_with_caption:1,spike_tr:1,spike_tr_movable:1,spike_tr_with_caption:1,spike_tr_movable_with_caption:1,spike_bl:1,spike_br:1,fill_n:1,fill_n_n:1,fill_n_e:1,fill_n_w:1,fill_n_s:1,fill_n_movable:1,fill_n_with_caption:1,fill_n_movable_with_caption:1,connect_n:1,connect_n_n:1,connect_n_e:1,connect_n_w:1,connect_n_s:1,connect_n_movable:1,connect_n_with_caption:1,connect_n_movable_with_caption:1,spike_nw:1,spike_nw_movable:1,spike_nw_with_caption:1,spike_nw_movable_with_caption:1,spike_n:1,spike_n_movable:1,spike_n_with_caption:1,spike_n_movable_with_caption:1,spike_ne:1,spike_ne_movable:1,spike_ne_with_caption:1,spike_ne_movable_with_caption:1,fill_s:1,fill_s_n:1,fill_s_e:1,fill_s_w:1,fill_s_s:1,connect_s:1,connect_s_n:1,connect_s_e:1,connect_s_w:1,connect_s_s:1,spike_sw:1,spike_s:1,spike_se:1,fill_e:1,fill_e_n:1,fill_e_e:1,fill_e_w:1,fill_e_s:1,connect_e:1,connect_e_n:1,connect_e_e:1,connect_e_w:1,connect_e_s:1,spike_en:1,spike_en_movable:1,spike_en_with_caption:1,spike_en_movable_with_caption:1,spike_e:1,spike_es:1,fill_w:1,fill_w_n:1,fill_w_e:1,fill_w_w:1,fill_w_s:1,connect_w:1,connect_w_n:1,connect_w_e:1,connect_w_w:1,connect_w_s:1,spike_wn:1,spike_wn_movable:1,spike_wn_with_caption:1,spike_wn_movable_with_caption:1,spike_w:1,spike_ws:1,min:1,close:1};for(var i in e){var o={sprite:"sprite"};e[i]=o;var r=i.split("_"),n=0<=i.indexOf("_with_caption");switch(r[0]){case"spike":o.sprite_x=-t[i+"_x"],o.sprite_y=-t[i+"_y"],o.sprite_w=t["spike_"+r[1]+"_w"],o.sprite_h=n?t["spike_"+r[1]+"_with_caption_h"]:t["spike_"+r[1]+"_h"];continue;case"min":case"close":o.sprite_x=-t[i+"_x"],o.sprite_y=-t[i+"_y"],o.sprite_w=t[i+"_w"],o.sprite_h=t[i+"_h"];continue}switch(r[1]){case"tl":case"bl":case"w":o.sprite_w=t.edge_w_w;break;case"tr":case"br":case"e":o.sprite_w=t.edge_e_w;break;default:o.sprite_w=t.body_w}switch(r[1]){case"tl":case"tr":case"n":o.sprite_h=n?t.edge_n_with_caption_h:t.edge_n_h;break;case"bl":case"br":case"s":o.sprite_h=t.edge_s_h;break;default:o.sprite_h=t.body_h}switch(i){case"fill_n_e":case"fill_n_w":case"fill_n_s":o.sprite_x=-t["edge_"+r[2]+"_"+r[1]+"_x"],o.sprite_y=-t["edge_"+r[2]+"_"+r[1]+"_y"];continue;case"connect_n_movable":case"connect_n_with_caption":case"connect_n_movable_with_caption":var s=i.replace(/connect/,"edge").replace(/_n/,"_n_gradient");o.sprite_x=-t[s+"_x"],o.sprite_y=-t[s+"_y"];continue}switch(r[0]){case"background":o.sprite_x=-t.body_x,o.sprite_y=-t.body_y;break;case"fill":s=i.replace(/fill/,"edge");o.sprite_x=-t[s+"_x"],o.sprite_y=-t[s+"_y"];break;case"connect":s=i.replace(/connect/,"edge");o.sprite_x=-t[s+"_gradient_x"],o.sprite_y=-t[s+"_gradient_y"];break;default:o.sprite_x=-t[i+"_x"],o.sprite_y=-t[i+"_y"]}}return e},_getFragmentList:function(t){var e=this._obj,i=this._styleParams,o=3==i.version,r=i.version<3,n=t||e,s="string"==typeof e.title&&""!=e.title.trim();s||(e.title="");var a=this.closable,_=this.movable,l=this.orientation,d="";9<=i.edge_n_with_caption_h&&(d=WCT.EncodeTagBrackets(e.title.trim()));var h=(a||s)&&!i.edge_per_orientation;this._with_caption=h;var c="",p="",u="",f="",m="",g="",y="";if(i.edge_per_orientation){var b="_"+this.getSimplifiedOrientation();y=g=m=f=u=c=b}else if(o)p=u=c=(_?"_movable":"")+(h?"_with_caption":"");else{var v=l.charAt(0),x=l.substr(1);_&&(c="_movable"),i.new_style&&h&&(c+="_with_caption"),p=c,u="n"==v?x+c:x,"n"!=v&&"s"!=v||(f=x)}var w=h?"_with_caption_":"_",C=this.getTextPaddings_(),T=this.getBodyPaddings_(),S=T.t_,k=T.b_,E=T.l_,R=T.r_,O=this._rd_get_min_rect("main"),I=2*Math.round((n.w-E-R)/2),M=2*Math.round((n.h-S-k)/2),D=Math.max(I+E+R,O.w),P=Math.max(M+S+k,O.h);n.w<D&&(n.w=D,I=n.w-E-R),n.h<P&&(n.h=P,M=n.h-S-k);var A=S+M,W=E+I,z=0,j=0,L=0,H=0,F=0,B=0,N=0,G=0,$=Math.round((n.w-i.spike_dock_s_w)/2),U=0,q=Math.round((n.w-i.spike_n_w)/2),X=0,Y=E-i.spike_tl_w,V=S-i["spike_tl"+w+"h"],Q=i.spike_tl_w,K=i["spike_tl"+w+"h"],Z=W,J=S-i["spike_tr"+w+"h"],tt=i.spike_tr_w,et=i["spike_tr"+w+"h"],it=E-i.spike_bl_w,ot=A,rt=i.spike_n_w,nt=i["spike_n"+w+"h"],st=i["spike_nw"+w+"h"],at=i["spike_ne"+w+"h"],_t=W,lt=S+i.spike_dock_en_h-i["spike_en"+w+"h"],dt=i.spike_en_w,ht=i["spike_en"+w+"h"],ct=W,pt=A-i.spike_dock_es_h,ut=E-i.spike_wn_w,ft=S+i.spike_dock_wn_h-i["spike_wn"+w+"h"],mt=i.spike_wn_w,gt=i["spike_wn"+w+"h"],yt=E-i.spike_ws_w,bt=A-i.spike_dock_ws_h,vt=0,xt=0,wt=0,Ct=0;X=o?(L=W-i.spike_dock_ne_w,H=S-i["spike_ne"+w+"h"],z=E+i.spike_dock_nw_w-i.spike_nw_w,j=S-i["spike_nw"+w+"h"],N=W-i.spike_dock_se_w,G=A,F=E+i.spike_dock_sw_w-i.spike_sw_w,U=B=A,S-i["spike_n"+w+"h"]):(L=E+I-i.spike_ne_w,H=-i["spike_ne"+w+"h"]+i.spike_dock_overlap,z=E,j=-i.spike_nw_h+i.spike_dock_overlap,N=E+I-i.spike_se_w,G=e.h-i.spike_dock_overlap,F=E,B=e.h-i.spike_dock_overlap,U=e.h-i.spike_dock_overlap,-i["spike_n"+w+"h"]+i.spike_dock_overlap);var Tt=0,St=0,kt=0,Et=0,Rt=0,Ot=0,It=0,Mt=0,Dt=0,Pt=i["spike_dock_"+l+"_w"]||0,At=0,Wt=0,zt=i["spike_dock_"+l+"_w"]||0,jt=S,Lt=0,Ht=i["spike_dock_"+l+"_h"]||0,Ft=S,Bt=0,Nt=i["spike_dock_"+l+"_h"]||0,Gt=0,$t=0,Ut=0,qt=S+i.spike_dock_en_h,Xt=0,Yt=Math.max(0,M-i.spike_dock_en_h),Vt=S+i.spike_dock_w_h,Qt=0,Kt=Math.max(0,M-i.spike_dock_w_h),Zt=0,Jt=0,te=0,ee=0;if(i.edge_per_orientation){var ie=this.getSimplifiedOrientation();Zt=Math.max(0,n.w-i["title_off_"+ie+"_left"]-(a&&"e"!==ie?-i.close_off_x:i["title_off_"+ie+"_right"])-(a?-i.min_off_x+i.close_w:0)),Jt=Math.max(0,C.t_-i["title_off_"+ie+"_top"]),te=i["title_off_"+ie+"_left"],ee=i["title_off_"+ie+"_top"]}else Zt=Math.max(0,n.w-i.title_off_left-(a?-i.close_off_x:i.title_off_right)-(a?-i.min_off_x+i.close_w:0)),Jt=Math.max(0,C.t_-i.title_off_top),te=i.title_off_left,ee=i.title_off_top;var oe=n.w+i.close_off_x-i.close_w,re=Math.max(0,n.w-C.l_-C.r_),ne=Math.max(0,n.h-C.t_-C.b_);switch(this.IsRTL()&&a&&((i=WCT.DeepCopy(i)).title_off_left+=i.close_w-i.close_off_x,Zt-=i.close_w,oe=-i.close_off_x),l){case"n":Tt=Math.round((I-i.spike_dock_n_w)/2),Mt=E+Math.round((I-i.spike_dock_n_w)/2),Dt=-Math.round((I-i.spike_dock_n_w)/2),Rt=I-Math.round((I-i.spike_dock_n_w)/2)-i.spike_dock_n_w,Ot=E+i.spike_dock_n_w+Math.round((I-i.spike_dock_n_w)/2),It=-i.spike_dock_n_w-Math.round((I-i.spike_dock_n_w)/2);break;case"s":St=Math.round((I-i.spike_dock_s_w)/2),At=E+Math.round((I-i.spike_dock_s_w)/2),Wt=-Math.round((I-i.spike_dock_s_w)/2),Gt=I-Math.round((I-i.spike_dock_s_w)/2)-i.spike_dock_s_w,$t=E+i.spike_dock_s_w+Math.round((I-i.spike_dock_s_w)/2),Ut=-i.spike_dock_s_w-Math.round((I-i.spike_dock_s_w)/2);break;case"ne":o?(Tt=I-i.spike_dock_ne_w,Mt=E+I-i.spike_dock_ne_w,Dt=-I+i.spike_dock_ne_w):(Tt=Math.max(0,I-i.spike_ne_w),Mt=Math.max(0,E+Tt),Rt=i.spike_ne_w-Pt,Ot=Mt+Pt);break;case"nw":o?(Mt=E,Dt=0,Rt=I-i.spike_dock_nw_w,Ot=E+i.spike_dock_nw_w,It=-i.spike_dock_nw_w):(Ot=(Mt=E+(Tt=i.spike_nw_w-i.spike_dock_nw_w))+Pt,Rt=Math.max(0,I-Ot+E));break;case"se":o?(St=I-i.spike_dock_se_w,At=E+I-i.spike_dock_se_w,Wt=-I+i.spike_dock_se_w):(St=Math.max(0,I-i.spike_se_w),At=Math.max(0,E+St),Gt=i.spike_se_w-zt,$t=At+zt);break;case"sw":o?(At=E,Wt=0,Gt=I-i.spike_dock_sw_w,$t=E+i.spike_dock_sw_w,Ut=-i.spike_dock_sw_w):($t=(At=E+(St=i.spike_sw_w-i.spike_dock_sw_w))+zt,Gt=Math.max(0,I-$t+E))}if(o){switch(l){case"e":kt=Math.round((M-i.spike_dock_e_h)/2),jt=S+Math.round((M-i.spike_dock_e_h)/2),Lt=-Math.round((M-i.spike_dock_e_h)/2),qt=S+i.spike_dock_e_h+Math.round((M-i.spike_dock_e_h)/2),Xt=-i.spike_dock_e_h-Math.round((M-i.spike_dock_e_h)/2),Yt=M-Math.round((M-i.spike_dock_e_h)/2)-i.spike_dock_e_h;break;case"en":Lt=0,qt=(jt=S)+i.spike_dock_en_h,Xt=-i.spike_dock_en_h,Yt=M-i.spike_dock_en_h;break;case"es":kt=M-i.spike_dock_es_h,jt=S+M-i.spike_dock_es_h,Lt=-M+i.spike_dock_es_h;break;case"w":Et=Math.round((M-i.spike_dock_w_h)/2),Ft=S+Math.round((M-i.spike_dock_w_h)/2),Bt=-Math.round((M-i.spike_dock_w_h)/2),Vt=S+i.spike_dock_w_h+Math.round((M-i.spike_dock_w_h)/2),Qt=-i.spike_dock_w_h-Math.round((M-i.spike_dock_w_h)/2),Kt=M-Math.round((M-i.spike_dock_w_h)/2)-i.spike_dock_w_h;break;case"wn":Bt=0,Vt=(Ft=S)+i.spike_dock_wn_h,Qt=-i.spike_dock_wn_h,Kt=M-i.spike_dock_wn_h;break;case"ws":Et=M-i.spike_dock_ws_h,Ft=S+M-i.spike_dock_ws_h,Bt=-M+i.spike_dock_ws_h;break;default:Et=kt=0}vt=W,xt=S+Math.round((M-i.spike_e_h)/2),wt=E-i.spike_w_w,Ct=S+Math.round((M-i.spike_w_h)/2)}else vt=e.w-i.spike_dock_overlap,xt=T.t_+i.spike_dock_e_h-i.spike_e_h,wt=-i.spike_w_w,Ct=S+i.spike_dock_w_h-i.spike_w_h;var se=r?"sprite":"stretchcut",ae="s"==l||"se"==l||"sw"==l,_e="n"==l||"ne"==l||"nw"==l,le="w"==l||"wn"==l||"ws"==l,de="e"==l||"en"==l||"es"==l;return this.completeFragments({background:{type:se,x:E,y:S,w:I,h:M,sprite:"background",show:!0},edge_n:{type:se,x:E,w:I,h:S,sprite:"edge_n"+c,show:!_e,handcursor:_},edge_s:{type:se,x:E,y:A,w:I,h:k,sprite:"edge_s"+y,show:!ae},edge_w:{type:se,y:S,w:E,h:M,sprite:"edge_w"+y,show:!le},edge_e:{type:se,x:W,y:S,w:R,h:M,sprite:"edge_e"+y,show:!de},corner_tl:{w:E,h:S,sprite:"corner_tl"+c,title:d,show:r||"tl"!=l&&"nw"!=l&&"wn"!=l,handcursor:_},corner_tr:{x:W,w:R,h:S,sprite:"corner_tr"+c,title:d,show:r||"tr"!=l&&"ne"!=l&&"en"!=l,handcursor:_},corner_bl:{y:A,w:E,h:k,sprite:"corner_bl"+y,show:r||"bl"!=l&&"sw"!=l&&"ws"!=l},corner_br:{x:W,y:A,w:R,h:k,sprite:"corner_br"+y,show:r||"br"!=l&&"se"!=l&&"es"!=l},spike_tl:{x:Y,y:V,w:Q,h:K,sprite:"spike_tl"+p,show:"tl"==l},spike_tr:{x:Z,y:J,w:tt,h:et,sprite:"spike_tr"+p,show:"tr"==l},spike_bl:{x:it,y:ot,w:i.spike_bl_w,h:i.spike_bl_h,sprite:"spike_bl",show:"bl"==l},spike_br:{x:W,y:A,w:i.spike_br_w,h:i.spike_br_h,sprite:"spike_br",show:"br"==l},fill1_n:{type:se,x:E,w:Tt,h:S,w2:I,sprite:"fill_n"+c,title:d,show:_e,handcursor:_},connect_n:{type:se,x:Mt,w:Pt,h:S,x2:Dt,w2:I,sprite:"connect_n"+u,title:d,show:_e,handcursor:_},fill2_n:{type:se,x:Ot,w:Rt,h:S,x2:It,w2:I,sprite:"fill_n"+c,title:d,show:_e,handcursor:_},spike_nw:{x:z,y:j,w:i.spike_nw_w,h:st,sprite:"spike_nw"+p,show:"nw"==l,zIndex:5},spike_n:{x:q,y:X,w:rt,h:nt,sprite:"spike_n"+p,show:"n"==l,zIndex:5},spike_ne:{x:L,y:H,w:i.spike_ne_w,h:at,sprite:"spike_ne"+p,show:"ne"==l,zIndex:5},fill1s:{type:se,x:E,y:A,w:St,h:k,w2:I,sprite:"fill_s"+y,show:ae},connect_s:{type:se,x:At,y:A,w:zt,h:k,x2:Wt,w2:I,sprite:"connect_s"+f,show:ae},fill2s:{type:se,x:$t,y:A,w:Gt,h:k,x2:Ut,w2:I,sprite:"fill_s"+y,show:ae},spike_sw:{x:F,y:B,w:i.spike_sw_w,h:i.spike_sw_h,sprite:"spike_sw",show:"sw"==l},spike_s:{x:$,y:U,w:i.spike_s_w,h:i.spike_s_h,sprite:"spike_s",show:"s"==l},spike_se:{x:N,y:G,w:i.spike_se_w,h:i.spike_se_h,sprite:"spike_se",show:"se"==l},fill1e:{type:se,x:W,y:S,w:R,h:kt,h2:M,sprite:"fill_e"+y,show:"e"==l||"es"==l},connect_e:{type:se,x:W,y:jt,w:R,h:Ht,y2:Lt,h2:M,sprite:"connect_e"+m,show:de},fill2e:{type:se,x:W,y:qt,w:R,h:Yt,y2:Xt,h2:M,sprite:"fill_e"+y,show:"e"==l||"en"==l},spike_en:{x:_t,y:lt,w:dt,h:ht,sprite:"spike_en"+p,show:"en"==l},spike_e:{x:vt,y:xt,w:i.spike_e_w,h:i.spike_e_h,sprite:"spike_e",show:"e"==l},spike_es:{x:ct,y:pt,w:i.spike_es_w,h:i.spike_es_h,sprite:"spike_es",show:"es"==l},fill1w:{type:se,y:S,w:E,h:Et,h2:M,sprite:"fill_w"+y,show:"w"==l||"ws"==l},connect_w:{type:se,y:Ft,w:E,h:Nt,y2:Bt,h2:M,sprite:"connect_w"+g,show:le},fill2w:{type:se,y:Vt,w:E,h:Kt,y2:Qt,h2:M,sprite:"fill_w"+y,show:"w"==l||"wn"==l},spike_wn:{x:ut,y:ft,w:mt,h:gt,sprite:"spike_wn"+p,show:"wn"==l},spike_w:{x:wt,y:Ct,w:i.spike_w_w,h:i.spike_w_h,sprite:"spike_w",show:"w"==l},spike_ws:{x:yt,y:bt,w:i.spike_ws_w,h:i.spike_ws_h,sprite:"spike_ws",show:"ws"==l},title:{type:"title",className:"dgoBU",x:te,y:ee,w:Zt,h:Jt,title:d,show:""!=d||_,handcursor:_,innerHTML:d,zIndex:10},close:{type:"button",x:oe,y:i.close_off_y,w:i.close_w,h:i.close_h,sprite:"close",title:Dict_get("CLOSEBUBBLE"),show:a,handcursor:!0,zIndex:15},txt:{type:"text",className:(this.classname||"dgoBUmain")+" dgo_text_container",x:C.l_,y:C.t_,w:re,h:ne,show:!0,innerHTML:this.text_res||"",zIndex:15}})},do_bubble_apply:function(){var t=this._get_el();if(t){var e=this._obj;e.offset=this._getOffset(),t.style.overflow="visible",t.style.top=e.offset.y+e.y+"px",t.style.left=e.offset.x+e.x+"px",t.style.width=e.w+"px",t.style.height=e.h+"px",t.style.visibility="hidden",this.anti_flicker_=!0,Bubble.SetText.call(this,e,"text",e.text,!0),this.fragmentList_=this._getFragmentList(),t.innerHTML=this._fragmentListToDomString(),this.text=replace_placeholder(e.text);var i=this._get_el("#main#txt");i&&WCT.image_watcher.AddImagesInside(i)?(this.SetTimeout(!1),this.wait_image_=WCT.image_watcher.Observe(Bubble.OnImage,this)):this.SetTimeout(!0),WCT.Previewer.setPreviewForTag(i,"img"),WCT.Previewer.setPreviewForTag(i,"video")}},_update_main_rect:function(){if(this.moving)this._update_main_rectV3(i,!0);else{var t=this._get_el()&&this._get_el("#main#txt");if(t){var e=!1,i=this._obj,o=this.getTextPaddings_(),r=Math.max(i.w-o.l_-o.r_,0)+"px",n=Math.max(i.h-o.t_-o.b_,0)+"px",s=t.firstChild;!s||"expl_bub"!=s.className||s.style.width==r&&s.style.height==n||(s.id=this._id+"#expl_bub",s.style.visibility="visible",e=!0,s.style.width=r,s.style.height=n),t.style.top=o.t_+"px",t.style.width==r&&t.style.height==n||(e=!0,t.style.width=r,t.style.height=n),e?this.SetTimeout(!0):this._update_main_rectV3()}}},_getNextPossibleOrientation:function(t){var e=this._styleParams.allowed_orientations;if(!e||0<=e.indexOf(","+t+","))return t;var i=["TL","NW","N","NE","TR","EN","E","ES","BR","SE","S","SW","BL","WS","W","WN"],o=i.indexOf(t);if(0<=o)for(var r=1,n=i.length;r<n;r++)if(o+r<n){if(0<=e.indexOf(","+i[o+r]+","))return i[o+r]}else{if(!(0<=o-r))break;if(0<=e.indexOf(","+i[o-r]+","))return i[o-r]}return"C"},_getOffset:function(){var t=this._obj,e=this.getBodyPaddings_(),i=this._styleParams,o=this._with_caption?"_with_caption_":"_",r=this.orientation;if(3==i.version)switch(r){case"tl":return{x:i.spike_tl_w-e.l_-i.spike_tl_tip_offset_x,y:i["spike_tl"+o+"h"]-e.t_+i.spike_tl_tip_offset_y};case"tr":return{x:-i.spike_tr_w+e.r_+i.spike_tr_tip_offset_x-t.w,y:i["spike_tr"+o+"h"]-e.t_+i.spike_tr_tip_offset_y};case"nw":return{x:e.l_+i.spike_dock_nw_w-i.spike_nw_w-i.spike_nw_tip_offset_x,y:i["spike_nw"+o+"h"]-e.t_+i.spike_nw_tip_offset_y};case"ne":return{x:-t.w+e.r_+i.spike_dock_ne_w-i.spike_ne_w+i.spike_ne_tip_offset_x,y:i["spike_ne"+o+"h"]-e.t_+i.spike_ne_tip_offset_y};case"n":return{x:(-t.w>>1)+i.spike_n_tip_offset_x,y:i["spike_n"+o+"h"]-e.t_+i.spike_n_tip_offset_y};case"bl":return{x:i.spike_bl_w-e.l_-i.spike_bl_tip_offset_x,y:-t.h-i.spike_bl_h+e.b_-i.spike_bl_tip_offset_y};case"br":return{x:-i.spike_br_w+e.r_+i.spike_br_tip_offset_x-t.w,y:-t.h-i.spike_br_h+e.b_-i.spike_br_tip_offset_y};case"sw":return{x:e.l_+i.spike_dock_sw_w-i.spike_sw_w-i.spike_sw_tip_offset_x,y:-t.h-i.spike_sw_h+e.b_-i.spike_sw_tip_offset_y};case"se":return{x:-t.w+e.r_+i.spike_dock_se_w-i.spike_se_w+i.spike_se_tip_offset_x,y:-t.h-i.spike_se_h+e.b_-i.spike_se_tip_offset_y};case"s":return{x:(-t.w>>1)-i.spike_s_tip_offset_x,y:-t.h-i.spike_s_h+e.b_-i.spike_s_tip_offset_y};case"wn":return{x:i.spike_wn_w-e.l_+i.spike_wn_tip_offset_x,y:-i["spike_wn"+o+"h"]+i.spike_dock_wn_h-i.spike_wn_tip_offset_y};case"ws":return{x:i.spike_ws_w-e.l_+i.spike_ws_tip_offset_x,y:-t.h+i.spike_ws_h-i.spike_dock_ws_h+i.spike_ws_tip_offset_y};case"w":return{x:i.spike_w_w-e.l_-i.spike_w_tip_offset_x,y:-e.t_-(t.h-e.t_-e.b_>>1)+i.spike_w_tip_offset_y};case"en":return{x:-t.w-i.spike_en_w+e.r_-i.spike_en_tip_offset_x,y:-i["spike_en"+o+"h"]+i.spike_dock_en_h-i.spike_en_tip_offset_y};case"es":return{x:-t.w-i.spike_es_w+e.r_-i.spike_es_tip_offset_x,y:-t.h+i.spike_es_h-i.spike_dock_es_h+i.spike_es_tip_offset_y};case"e":return{x:-t.w-i.spike_e_w+e.r_+i.spike_e_tip_offset_x,y:-e.t_-(t.h-e.t_-e.b_>>1)+i.spike_e_tip_offset_y};default:return{x:-t.w>>1,y:-t.h>>1}}switch(r){case"nw":return{x:-e.l_,y:i["spike_nw"+o+"h"]+i.spike_nw_tip_offset_y-i.spike_dock_overlap};case"ne":return{x:-t.w+e.r_,y:i["spike_ne"+o+"h"]+i.spike_ne_tip_offset_y-i.spike_dock_overlap};case"n":return{x:(-t.w>>1)+i.spike_n_tip_offset_x,y:i.spike_n_h+i.spike_n_tip_offset_y-i.spike_dock_overlap};case"sw":return{x:-e.l_,y:-t.h-i.spike_sw_h-i.spike_sw_tip_offset_y+i.spike_dock_overlap};case"se":return{x:-t.w+e.r_,y:-t.h-i.spike_se_h-i.spike_se_tip_offset_y+i.spike_dock_overlap};case"s":return{x:(-t.w>>1)-i.spike_s_tip_offset_x,y:-t.h-i.spike_s_h-i.spike_s_tip_offset_y+i.spike_dock_overlap};case"w":return{x:i.spike_w_w-i.spike_w_tip_offset_x-i.spike_dock_overlap,y:-e.t_-i.spike_dock_w_h+i.spike_w_h-i.spike_w_tip_offset_y};case"e":return{x:-t.w-i.spike_e_w+i.spike_e_tip_offset_x+i.spike_dock_overlap,y:-e.t_-i.spike_dock_e_h+i.spike_e_h-i.spike_e_tip_offset_y};default:return{x:-t.w>>1,y:-t.h>>1}}},completeFragments:function(t){for(var e in t){var i=t[e];i.type||(i.type="sprite"),"number"!=typeof i.x&&(i.x=0),"number"!=typeof i.y&&(i.y=0),"number"!=typeof i.x2&&(i.x2=0),"number"!=typeof i.y2&&(i.y2=0),"number"!=typeof i.w2&&(i.w2=i.w),"number"!=typeof i.h2&&(i.h2=i.h)}return t},applyDifferencesToDom:function(t){var e=this._get_el();if(e){var i=this._styleParams,o=this.spriteMap_,r=this.imgBase_,n=this.fragmentList_;for(var s in n){var a=n[s];if((y=t[s])&&(EDIT_MODE||!a.show||y.show)){var _=y.sprite?o[y.sprite]:null;for(var l in a){var d=a[l],h=y[l],c="fill"===s.substring(0,4)||"connect"===s.substring(0,7);if(d!=h||c)if(g=this._get_el("#main#"+s)){var p=y.w,u=y.h;switch(3<=i.version&&(p=i.sprite_w,u=i.sprite_h),l){case"show":g.style.display=h?"block":"none";break;case"handcursor":g.style.cursor=h?"pointer":"default";break;case"x":g.style.left=h+"px";break;case"y":g.style.top=h+"px";break;case"w":if("txt"==s)break;g.style.width=h+"px";break;case"h":if("txt"==s)break;g.style.height=h+"px";break;case"w2":case"h2":if("txt"==s)break;if(_){f=this._calcBackground(y,_,p,u);g.style.backgroundPosition=f.pos,g.style.backgroundSize=f.size}break;case"innerHTML":g.innerHTML=h||"";break;case"title":g.title=h||"";break;case"sprite":if(o[d].sprite_x!=o[h].sprite_x||o[d].sprite_y!=o[h].sprite_y)if("stretchcut"==y.type){if(_){var f=this._calcBackground(y,_,p,u);g.style.backgroundPosition=f.pos,g.style.backgroundSize=f.size}}else g.style.backgroundPosition=o[h].sprite_x+"px "+o[h].sprite_y+"px";if(o[d].sprite!=o[h].sprite){var m=i.use_gifs?".gif":".png";"stretchcut"==y.type?g.src=r+o[h].sprite+m:g.style.backgroundImage="url("+r+o[h].sprite+m+")"}}}}}else{var g;(g=this._get_el("#main#"+s))&&g.parentNode.removeChild(g)}}for(s in t){a=n[s];var y=t[s];if(!a||!EDIT_MODE&&!a.show&&y.show){var b=this._fragmentToDomString(s,y,o[y.sprite]);BROWSER.IE?e.insertAdjacentHTML("beforeEnd",b):e.innerHTML=e.innerHTML+b}}this.fragmentList_=t}},_calcBackground:function(t,e,i,o){return{pos:Math.round(t.w2*e.sprite_x/e.sprite_w)+t.x2+"px "+(Math.round(t.h2*e.sprite_y/e.sprite_h)+t.y2)+"px",size:Math.round(t.w2*i/e.sprite_w)+"px "+Math.round(t.h2*o/e.sprite_h)+"px"}},_calculateProperBufferWidth:function(t){var e=window.getComputedStyle(t),i=parseInt(e.fontSize)/2;isNaN(i)||(this.txt_buffer_=Math.ceil(i))},_update_main_rectV3:function(t,e){var i=this._obj,o=t||i,r=!1,n=this._get_el("#main#txt");if(n){var s=this.IsRTL()?"rtl":"ltr";n.style.direction=s,n.setAttribute("dir",s);var a=this._rd_get_min_rect("main"),_=this.getTextPaddings_(),l=this.getBodyPaddings_();if(!this._preventWidthChange){var d=!this.buffer_added_&&this.auto_size_;d&&this._calculateProperBufferWidth(n);var h=n.scrollWidth||n.offsetWidth,c=this.auto_size_?Math.max(h+_.l_+_.r_,a.w):Math.min(h+_.l_+_.r_,a.w),p=this.txt_buffer_;if(o.w<c&&(h=(o.w=c)-_.l_-_.r_,n.style.width=h+"px",r=!0),r&&!e)return void this.SetTimeout(!0);if(d&&(n.style.width=h+p+"px",this.buffer_added_=!0),this._preventWidthChange=!0,this.buffer_added_)return void this.SetTimeout(!0)}var u=n.scrollHeight||n.offsetHeight,f=this.auto_size_?Math.max(u+_.t_+_.b_,a.h):Math.min(u+_.t_+_.b_,a.h);if(f=2*Math.round((f-l.t_-l.b_)/2)+l.t_+l.b_,o.h<f&&(u=(o.h=f)-_.t_-_.b_,n.style.height=u+"px",r=!0),!r||e){var m=this._getFragmentList(o);this.applyDifferencesToDom(m);var g=this._draggers;i.offset=this._getOffset(),(n=this._get_el())&&(n.style.width=i.w+"px",n.style.height=i.h+"px",g&&g.main.dragging&&!t||(n.style.left=i.offset.x+o.x+"px",n.style.top=i.offset.y+o.y+"px"),BROWSER.IE&&n.offsetWidth);var y=$(this._id+"#expl_bub");if(y&&(y.style.visibility=""),EDIT_MODE){var b=this._styleParams.allowed_orientations.toLowerCase(),v=this.fragmentList_;for(var x in v)if(0==x.indexOf("spike")){var w=","+this.invert_orientation(x.substr(6))+",";(n=this._get_el("#main#"+x))&&(!b||0<=b.indexOf(w)&&!this.moving&&!v[x].show&&(this.changingOrientation_||g.main.changingOrientation)?(n.style.display="block",n.style.opacity=.1):(n.style.display=v[x].show?"block":"none",n.style.opacity=1))}g&&g.main.UpdateFromParent()}var C=!1;this.anti_flicker_&&(this.anti_flicker_=!1,this._fader&&(this._fader._dom_vis=0),C=!0),Bubble.SetHidden.call(this,i,"hidden",i.hidden,!0,C),this.setIframeIfForMain_(),this._waitForTransition&&this.PrepareTransition(!0),this._update_hit_areas()}else this.SetTimeout(!0)}else this._update_hit_areas()},_update_hit_areas:function(){if(HitManager.clearHitControl(this._id),!this.isHidden()){var t=this.fragmentList_;if(t){var e=this._obj,i=this._id;this.closable&&HitManager.setHitArea({ctl_id:i,sub_id:"main",hdl_id:"close_sub",x:t.close.x+e.x+e.offset.x,y:t.close.y+e.y+e.offset.y,w:t.close.w,h:t.close.h,z:e.z+.2,type:"rect",cursor:"pointer"}),HitManager.setHitArea({ctl_id:i,sub_id:"main",hdl_id:"dom",x:e.x+e.offset.x,y:e.y+e.offset.y,w:e.w,h:e.h,z:e.z,type:"rect",cursor:e.movable?"move":"default"})}}},setIframeIfForMain_:function(){if(!BROWSER.MOBILE){var t=this._get_el(),e=this._get_el("#iframeMain");t&&e&&(e.style.display="block",e.style.left=t.style.left,e.style.top=t.style.top,e.style.width=t.style.width,e.style.height=t.style.height,e.style.zIndex=t.style.zIndex)}},manageBubbleClone_:function(){if(BROWSER.FIREFOX&&RT&&1!==RT.GetScale()){var t=this._get_el();if(!t)return;var e=this._get_el("#clone");e&&e.parentNode.removeChild(e),(e=t.cloneNode(!0)).style.left=parseInt(t.style.left)+1+"px",e.style.top=parseInt(t.style.top)+1+"px",e.style.zIndex=e.style.zIndex-1,function o(t){if(t.id&&-1!==t.id.search(/#main#txt$/)&&(t.innerHTML=""),t.id="",t.children&&t.children.length)for(var e=0,i=null;i=t.children[e++];)o(i)}(e),e.id=this._id+"#clone",Canvas.Parent().appendChild(e)}},createIFrameMain_:function(t){if(!BROWSER.MOBILE){if(this.flag_iframe_created_)return null;this.flag_iframe_created_=!0;var e=$$("iframe");return BROWSER.IE&&e.setAttribute("allowTransparency","true"),e.id=this._id+"#iframeMain",e.name=this._id+"#iframeMain",e.tabIndex=-1,e.frameBorder="0",e.style.borderWidth="0",e.style.width="1px",e.style.height="1px",e.style.overflow="hidden",e.style.position="absolute",e.style.backgroundColor="transparent",e.style.display="none",e.src="about:blank",e.setAttribute("role","presentation"),t.appendChild(e),e}},invert_orientation:function(t){return this.controlValuesSet_&&3!=this._styleParams.version?INVERTED_ORI_MAP[t]||"c":INVERTED_ORI_MAP_V3[t]||"c"},change_orientation:function(t){var e=this._obj;this.moving||(e.oriorientation=t,t=this._getNextPossibleOrientation(e.oriorientation)),this.orientation=this.invert_orientation(t),e.orientation=t.toUpperCase();var i=e.x,o=e.y,r=this._getOffset();return e.x+=e.offset.x-r.x,e.y+=e.offset.y-r.y,e.offset={x:r.x,y:r.y},this.moving||(e.x=Math.min(Math.max(0,e.x),Canvas.w()),e.y=Math.min(Math.max(0,e.y),Canvas.h()),this.changingOrientation_=!0,this.auto_size_=!1,this._update_main_rectV3(e),this.auto_size_=!0,this.changingOrientation_=!1),{x:e.x,y:e.y,oldX:i,oldY:o,offsetX:e.offset.x,offsetY:e.offset.y}},ShowAfterTransition:function(){if(this._waitForTransition=!1,this._fader){var t=this._obj,e=t.hidden;t.hidden=!0,this._fader.InitPreview(),t.hidden=e}this.controlValuesSet_&&this.do_bubble_apply()},PrepareTransition:function(){this._waitForTransition=!0;var t=this._get_el("#iframeMain");t&&(t.style.visibility="hidden");var e=this._get_el();e&&(e.style.visibility="hidden");var i=this._draggers&&this._draggers.main||null;i&&(LESSON_EDIT&&i.SetVisible(!1),i._refresh_dom())},hdl_close_evt_:function(t,e,i){var o=this._get_el("#main#"+t);if(o){var r=this._styleParams;if(3==r.version){var n=r[(t=t.substr(0,t.length-4))+e+"x"],s=r[t+e+"y"];null!=n&&(o.style.left=-n+"px"),null!=s&&(o.style.top=-s+"px")}else if(r.new_style&&r.animate_buttons){t=t.substr(0,t.length-3),t+="_moz";var a=r.use_gifs?".gif":".png",_=this.imgBase_+t+i+a;o.src=_}}},OnRTMouseEnter:function(t){"close_sub"!=t.hdl_id&&this.hdl_close_evt_(t.hdl_id,"_active_","_inv")},OnRTMouseLeave:function(t){"close_sub"!=t.hdl_id&&this.hdl_close_evt_(t.hdl_id,"_","")},OnRTMouseDown:function(t){var e=t.hdl_id;if("close_sub"==e)return this.hdl_close_evt_("close_sub","_pressed_",""),!0;if("dom"==e&&this.movable){var i=this._obj;return this.startMouseX_=t.canvasX,this.startMouseY_=t.canvasY,RT.setCapture(this._id),RT.SetDrag(this._id),"undefined"==typeof this.saveOrientation&&(this.saveOrientation=this.orientation,this.saveX=i.x,this.saveY=i.y),this.moving=!0,this.change_orientation("C"),this.startX_=i.x,this.startY_=i.y,this.move_trigger_fired_=!1,document.documentElement.style.cursor="move",!(t.hasToBeCancelled=!0)}},OnRTMouseMove:function(t){if(this.moving){var e=window.event||null;if(e&&WCT.dom.isLink(e.target))return!0;var i=this._obj,o=this.startX_-this.startMouseX_+t.canvasX,r=this.startY_-this.startMouseY_+t.canvasY,n=Canvas.x(),s=Canvas.y(),a=i.w/2,_=i.h/2,l=Canvas.centered()?n+Canvas.w()-a:Page.clientWidth-a,d=Canvas.centered()?s+Canvas.h()-_:Page.clientHeight-_;return i.x=Math.max(Math.min(o,l),a-n),i.y=Math.max(Math.min(r,d),_-s),this._update_main_rectV3(),t.hasToBeCancelled=!0,!this.move_trigger_fired_&&i.onbeginmove&&(Page.RTFireTrigger(i.onbeginmove),this.move_trigger_fired_=!0),!1}},OnRTMouseUp:function(t){this.moving&&(this.moving=!1,document.documentElement.style.cursor="",RT.releaseCapture(),RT.SetDrag(null)),"close_sub"==t.hdl_id&&this.hdl_close_evt_("close_sub","_active_","_inv")},OnRTMouseClick:function(t){"close"!=t.hdl_id&&"close_sub"!=t.hdl_id||this.RTFireTrigger("close")},RTFireTrigger:function(t,e){var i=this._obj;switch(t){case"show":case"fade_in":return i.onvisible&&this._fader.RegisterCallback("onend",this.HandleFaderEnd,this),i.onshow&&Page.RTFireTrigger(i.onshow),void this.SetParam("hidden",!1);case"hide":case"fade_out":return i.onhidden&&this._fader.RegisterCallback("onend",this.HandleFaderEnd,this),i.onhide&&Page.RTFireTrigger(i.onhide),void this.SetParam("hidden",!0);case"set_text":Bubble.SetText.call(this,i,"text",e),i.h=10,this._update_main_rect(),ok=!0;break;case"close":return this.SetParam("hidden",!0),void(i.onclose&&Page.RTFireTrigger(i.onclose));case"restore":return this.moving=!0,"string"==typeof this.saveOrientation&&(this.SetParam("hidden",!0),this.change_orientation(this.invert_orientation(this.saveOrientation)),delete this.saveOrientation,"undefined"!=typeof this.saveX&&"undefined"!=typeof this.saveY&&(i.x=this.saveX,i.y=this.saveY,delete this.saveX,delete this.saveY,this._update_main_rectV3())),this.SetParam("hidden",!1),this.moving=!1,void(i.onrestore&&Page.RTFireTrigger(i.onrestore));case"update_placeholder":return void Bubble.SetText.call(this,i,"text",i.text)}RectControl.prototype.RTFireTrigger.apply(this,arguments)},_on_set_preview:function(t){var e=this._obj;t?this._fader.ChangeSubId(["#main#dom","#main#spike_"+this.orientation]):("string"==typeof this.saveOrientation&&(this.moving=!0,this.change_orientation(this.invert_orientation(this.saveOrientation)),this.moving=!1,delete this.saveOrientation,"undefined"!=typeof this.saveX&&"undefined"!=typeof this.saveY&&(e.x=this.saveX,e.y=this.saveY,delete this.saveX,delete this.saveY)),this._fader.ChangeSubId("#main#dom")),this.preview=t},GetHtmlPosSize:function(t){var e={x:0,y:0,w:0,h:0};if(1==t){var i=this._get_el("#main#txt");i&&((e=getHtmlPosSize(i,!0)).x-=1,e.y+=1,Canvas.ApplyScaleToPos(e),e.x-=Page.scrollLeft,e.y-=Page.scrollTop,e.w-=2,e.h-=2)}else{var o=this._get_el(),r=this._get_el("#spike#dom");if(o&&r)e=UnionPosSize(getHtmlPosSize(o),getHtmlPosSize(r));else if(o)e=getHtmlPosSize(o);else{var n=this._get_el("#main#table");n&&(e=getHtmlPosSize(n))}}return e},OnDefaultEdit:function(){var t=this.GetHtmlPosSize(1),e=60<t.w&&30<t.h,i=e?"w":"",o=e?"h":"";return Env.edit({ctlId:this._id,paramName:"text",posSize:this.GetHtmlPosSize(1),paramW:i,paramH:o,extInfo:this._obj}),!0}}),function(){function parse_(text,legacy_definition){var atts={},value=null;if("string"==typeof text)try{value=eval("("+text+")")}catch(e){value=null}else"object"==typeof text&&(value=text);if("object"==typeof value&&value){for(var key in value)atts[key]=value[key];return atts}for(var ImageDirRegExpr2=/^(?:\s)*([a-zA-Z0-9_.]+)(?:\s)*(?:[:|=|:=])+(?:\s)*([0-9\-]+)(?:\s)*$/gm,ImageDirRegExpr3=/^(?:\s)*([a-zA-Z0-9_.]+)(?:\s)*(?:[:|=|:=])+(?:\s)*"([^"]*)"(?:\s)*$/gm,ImageDirRegExpr4=/\[_start_([^\]]+)\]([^\[]*?)\[_end_[^\]]+\]/gm,valuesArray,sectionValuesArray;null!=(valuesArray=ImageDirRegExpr4.exec(text));){for(;null!=(sectionValuesArray=ImageDirRegExpr2.exec(valuesArray[2]));)atts[valuesArray[1]]||(atts[valuesArray[1]]={}),atts[valuesArray[1]][sectionValuesArray[1]]=sectionValuesArray[2]-0;for(;null!=(sectionValuesArray=ImageDirRegExpr3.exec(valuesArray[2]));)atts[valuesArray[1]]||(atts[valuesArray[1]]={}),atts[valuesArray[1]][sectionValuesArray[1]]=sectionValuesArray[2]+""}for(text=text.replace(ImageDirRegExpr4,"");null!=(valuesArray=ImageDirRegExpr2.exec(text));)atts[valuesArray[1]]=valuesArray[2]-0;for(;null!=(valuesArray=ImageDirRegExpr3.exec(text));)atts[valuesArray[1]]=valuesArray[2]+"";return convert_legacy_(atts,legacy_definition)}function convert_legacy_(t,e){var i={};for(var o in e)if(e[o].new_att){var r=t[o];void 0===r&&(r=e[o].dflt),void 0!==r&&(i[e[o].new_att]=r)}var n={innerBorder_:null,imagesBorderWidth_:null,captionInnerHeight_:null,captionBorderHeight_:null,spikeTipOffset_:null,images_min_moz_width_:null,images_min_moz_height_:null,images_close_moz_width_:null,images_close_moz_height_:null,images_min_moz_offX_:null,images_min_moz_offY_:null,images_close_moz_offX_:null,images_close_moz_offY_:null};for(var s in n)n[s]=t[s],"undefined"==typeof n[s]&&(n[s]=e[s].dflt);var a=2==t.version_?n.captionBorderHeight_:0,_=2*n.imagesBorderWidth_,l=n.innerBorder_+n.imagesBorderWidth_,d=n.captionInnerHeight_+a+_,h=t.newStyle_?n.innerBorder_+a+_:d;return i.edge_s_h=l,i.edge_e_w=l,i.edge_w_w=l,i.edge_s_h=l,i.edge_n_with_caption_h=d,i.edge_n_h=h,i.spike_ne_tip_offset_x=n.spikeTipOffset_,i.spike_e_tip_offset_y=n.spikeTipOffset_,BROWSER.IE||(i.min_w=n.images_min_moz_width_,i.min_h=n.images_min_moz_height_,i.close_w=n.images_close_moz_width_,i.close_h=n.images_close_moz_height_,i.min_off_x=n.images_min_moz_offX_,i.min_off_y=n.images_min_moz_offY_,i.close_off_x=n.images_close_moz_offX_,i.close_off_y=n.images_close_moz_offY_),i}Bubble.Imagedir=function(t,e){return parse_(t,e)}}(),function(){function s(t,e,i){var o=null;for(e=i[e]?i[e].dflt_att:null;e&&null==o;)o=t[e]||null,e=i[e]?i[e].dflt_att:null;return o}function a(t,e){for(var i=null;t&&e[t]&&null==i;)i=e[t].dflt,t=e[t].dflt_att;return i}Bubble.Configurator=function(t,e,i){var o=i;for(var r in o)"undefined"!=typeof o[r].dflt&&(e[r]=o[r].dflt);for(var r in o){var n=t[r];if(null==n&&"undefined"!=typeof o[r].dflt_att&&null==(n=s(t,r,o))&&null==(n=a(r,o))&&EDIT_MODE)return void(NO_ALERT||alert("Bubble: default value not found in bubble.txt: "+r));null!=n&&("allowed_orientations"==r?(n=n.replace(/ |\r|\n|\t/g,"").toUpperCase(),e[r]=","+n+","):e[r]=n)}}}();var Bubble_legacy_configuration_data_={version_:{new_att:"version",dflt:1},newStyle_:{new_att:"new_style",dflt:0},enlightStyle_:{new_att:"enlight_style",dflt:0},fontColor_:{new_att:"font_color",dflt:-1},backgroundColor_:{new_att:"background_color",dflt:-1},animateButtons_:{new_att:"animate_buttons",dflt:0},textStyle_:{new_att:"text_style",dflt:"StyleA"},useGIFs_:{new_att:"use_gifs",dflt:0},imagesBorderWidth_:{dflt:1},innerBorder_:{dflt:9},spikeDockWidth_:{new_att:"spike_dock_w",dflt:20},spikeWidth_:{new_att:"spike_w",dflt:40},spikeHorHeight_:{new_att:"spike_e_h",dflt:30},spikeLength_:{new_att:"spike_h",dflt:61},spikeDockOverlap_:{new_att:"spike_dock_overlap",dflt:0},useConnects_:{new_att:"use_connects",dflt:0},captionBorderHeight_:{dflt:0},captionInnerHeight_:{dflt:10},images_min_width_:{new_att:"min_w",dflt:8},images_min_height_:{new_att:"min_h",dflt:8},images_close_width_:{new_att:"close_w",dflt:8},images_close_height_:{new_att:"close_h",dflt:8},images_min_offX_:{new_att:"min_off_x",dflt:-2},images_min_offY_:{new_att:"min_off_y",dflt:2},images_close_offX_:{new_att:"close_off_x",dflt:-6},images_close_offY_:{new_att:"close_off_y",dflt:2},images_min_moz_width_:{dflt:8},images_min_moz_height_:{dflt:8},images_close_moz_width_:{dflt:8},images_close_moz_height_:{dflt:8},images_min_moz_offX_:{dflt:-2},images_min_moz_offY_:{dflt:2},images_close_moz_offX_:{dflt:-7},images_close_moz_offY_:{dflt:2},image_included_:{new_att:"image_included",dflt:""},image_included_width_:{new_att:"image_included_w",dflt:0},image_included_height_:{new_att:"image_included_h",dflt:0},image_included_left_:{new_att:"image_included_x",dflt:0},image_included_top_:{new_att:"image_included_y",dflt:0},image_included_valign_:{new_att:"image_included_valign",dflt:"top"},image_included_align_:{new_att:"image_included_align",dflt:"left"},image_included_placeholder_width_:{new_att:"image_included_placeholder_w",dflt:-1},image_included_placeholder_height_:{new_att:"image_included_placeholder_h",dflt:-1},image_included_space_:{new_att:"image_included_space",dflt:0},image_included_position_:{new_att:"image_included_position",dflt:"w"},allowed_orientations_:{new_att:"allowed_orientations",dflt:",n,s,e,w,c,ne,nw,se,sw,"},bubble_filter_:{new_att:"bubble_filter",dflt:""},spikeTipOffset_:{dflt:0}},Bubble_configuration_data_={version:{dflt:1},new_style:{dflt:0},enlight_style:{dflt:0},font_color:{dflt:-1},background_color:{dflt:-1},animate_buttons:{dflt:0},text_style:{dflt:"StyleA"},spike_dock_overlap:{dflt:0},use_connects:{dflt:0},image_included:{dflt:""},image_included_w:{dflt:0},image_included_h:{dflt:0},image_included_x:{dflt:0},image_included_y:{dflt:0},image_included_valign:{dflt:"top"},image_included_align:{dflt:"left"},image_included_placeholder_w:{dflt:-1},image_included_placeholder_h:{dflt:-1},image_included_space:{dflt:0},image_included_position:{dflt:"w"},bubble_filter:{dflt:""},spike_tip_offset:{dflt:0},use_gifs:{dflt:!1},sprite_w:{dflt:554},sprite_h:{dflt:860},body_x:{dflt:0},body_y:{dflt:0},body_w:{dflt:120},body_h:{dflt:120},edge_w:{dflt:10},edge_n_h:{dflt_att:"edge_w"},edge_n_with_caption_h:{dflt_att:"edge_n_h"},edge_s_h:{dflt_att:"edge_n_h"},edge_e_w:{dflt_att:"edge_w"},edge_w_w:{dflt_att:"edge_w"},spike_dock_w:{dflt:20},spike_dock_n_w:{dflt_att:"spike_dock_w"},spike_dock_ne_w:{dflt_att:"spike_dock_w"},spike_dock_nw_w:{dflt_att:"spike_dock_ne_w"},spike_dock_s_w:{dflt_att:"spike_dock_n_w"},spike_dock_se_w:{dflt_att:"spike_dock_ne_w"},spike_dock_sw_w:{dflt_att:"spike_dock_nw_w"},spike_dock_e_h:{dflt_att:"spike_dock_w"},spike_dock_wn_h:{dflt_att:"spike_dock_ne_w"},spike_dock_ws_h:{dflt_att:"spike_dock_wn_h"},spike_dock_w_h:{dflt_att:"spike_dock_e_h"},spike_dock_en_h:{dflt_att:"spike_dock_wn_h"},spike_dock_es_h:{dflt_att:"spike_dock_ws_h"},spike_w:{dflt:40},spike_h:{dflt:61},spike_corner_w:{dflt:61},spike_corner_h:{dflt:61},spike_n_w:{dflt_att:"spike_dock_n_w"},spike_ne_w:{dflt_att:"spike_w"},spike_nw_w:{dflt_att:"spike_ne_w"},spike_s_w:{dflt_att:"spike_dock_s_w"},spike_se_w:{dflt_att:"spike_ne_w"},spike_sw_w:{dflt_att:"spike_nw_w"},spike_e_w:{dflt_att:"spike_h"},spike_en_w:{dflt_att:"spike_e_w"},spike_es_w:{dflt_att:"spike_en_w"},spike_w_w:{dflt_att:"spike_e_w"},spike_wn_w:{dflt_att:"spike_w_w"},spike_ws_w:{dflt_att:"spike_wn_w"},spike_tl_w:{dflt_att:"spike_corner_w"},spike_tr_w:{dflt_att:"spike_corner_w"},spike_bl_w:{dflt_att:"spike_corner_w"},spike_br_w:{dflt_att:"spike_corner_w"},spike_n_h:{dflt_att:"spike_h"},spike_n_with_caption_h:{dflt_att:"spike_n_h"},spike_ne_h:{dflt_att:"spike_n_h"},spike_ne_with_caption_h:{dflt_att:"spike_n_with_caption_h"},spike_nw_h:{dflt_att:"spike_ne_h"},spike_nw_with_caption_h:{dflt_att:"spike_ne_with_caption_h"},spike_s_h:{dflt_att:"spike_n_h"},spike_se_h:{dflt_att:"spike_ne_h"},spike_sw_h:{dflt_att:"spike_nw_h"},spike_e_h:{dflt:30},spike_en_h:{dflt_att:"spike_w"},spike_en_with_caption_h:{dflt_att:"spike_en_h"},spike_es_h:{dflt_att:"spike_en_h"},spike_w_h:{dflt_att:"spike_e_h"},spike_wn_h:{dflt_att:"spike_en_h"},spike_wn_with_caption_h:{dflt_att:"spike_en_with_caption_h"},spike_ws_h:{dflt_att:"spike_wn_h"},spike_tl_h:{dflt_att:"spike_corner_h"},spike_tl_with_caption_h:{dflt_att:"spike_tl_h"},spike_tr_h:{dflt_att:"spike_corner_h"},spike_tr_with_caption_h:{dflt_att:"spike_tl_with_caption_h"},spike_bl_h:{dflt_att:"spike_corner_h"},spike_br_h:{dflt_att:"spike_corner_h"},min_w:{dflt:8},min_h:{dflt_att:"min_w"},close_w:{dflt_att:"min_w"},close_h:{dflt_att:"min_h"},min_off_x:{dflt:-2},min_off_y:{dflt_att:"title_off_top"},close_off_x:{dflt:-6},close_off_y:{dflt_att:"min_off_y"},allowed_orientations:{dflt:",N,S,E,W,C,NE,NW,SE,SW,EN,ES,WN,WS,TL,TR,BL,BR,"},spike_tip_offset_x:{dflt_att:"spike_tip_offset"},spike_tip_offset_y:{dflt_att:"spike_tip_offset"},spike_n_tip_offset_x:{dflt_att:"spike_tip_offset_x"},spike_n_tip_offset_y:{dflt_att:"spike_tip_offset_y"},spike_ne_tip_offset_x:{dflt_att:"spike_tip_offset_x"},spike_ne_tip_offset_y:{dflt_att:"spike_tip_offset_y"},spike_nw_tip_offset_x:{dflt_att:"spike_ne_tip_offset_x"},spike_nw_tip_offset_y:{dflt_att:"spike_ne_tip_offset_y"},spike_s_tip_offset_x:{dflt_att:"spike_n_tip_offset_x"},spike_s_tip_offset_y:{dflt_att:"spike_n_tip_offset_y"},spike_se_tip_offset_x:{dflt_att:"spike_ne_tip_offset_x"},spike_se_tip_offset_y:{dflt_att:"spike_ne_tip_offset_y"},spike_sw_tip_offset_x:{dflt_att:"spike_nw_tip_offset_x"},spike_sw_tip_offset_y:{dflt_att:"spike_nw_tip_offset_y"},spike_e_tip_offset_x:{dflt_att:"spike_tip_offset_x"},spike_e_tip_offset_y:{dflt_att:"spike_tip_offset_y"},spike_en_tip_offset_x:{dflt_att:"spike_e_tip_offset_x"},spike_en_tip_offset_y:{dflt_att:"spike_e_tip_offset_y"},spike_es_tip_offset_x:{dflt_att:"spike_en_tip_offset_x"},spike_es_tip_offset_y:{dflt_att:"spike_en_tip_offset_y"},spike_w_tip_offset_x:{dflt_att:"spike_e_tip_offset_x"},spike_w_tip_offset_y:{dflt_att:"spike_e_tip_offset_y"},spike_wn_tip_offset_x:{dflt_att:"spike_en_tip_offset_x"},spike_wn_tip_offset_y:{dflt_att:"spike_en_tip_offset_y"},spike_ws_tip_offset_x:{dflt_att:"spike_wn_tip_offset_x"},spike_ws_tip_offset_y:{dflt_att:"spike_wn_tip_offset_y"},spike_tl_tip_offset_x:{dflt_att:"spike_tip_offset_x"},spike_tl_tip_offset_y:{dflt_att:"spike_tip_offset_y"},spike_tr_tip_offset_x:{dflt_att:"spike_tl_tip_offset_x"},spike_tr_tip_offset_y:{dflt_att:"spike_tl_tip_offset_y"},spike_bl_tip_offset_x:{dflt_att:"spike_tl_tip_offset_x"},spike_bl_tip_offset_y:{dflt_att:"spike_tl_tip_offset_y"},spike_br_tip_offset_x:{dflt_att:"spike_tr_tip_offset_x"},spike_br_tip_offset_y:{dflt_att:"spike_tr_tip_offset_y"},content_padding_top:{dflt_att:"edge_n_h"},content_padding_left:{dflt_att:"edge_e_w"},content_padding_right:{dflt_att:"edge_w_w"},content_padding_bottom:{dflt_att:"edge_s_h"},content_padding_with_caption_top:{dflt_att:"edge_n_with_caption_h"},content_padding_movable_top:{dflt_att:"content_padding_top"},content_padding_movable_with_caption_top:{dflt_att:"content_padding_with_caption_top"},title_off_left:{dflt_att:"content_padding_left"},title_off_top:{dflt:1},title_off_right:{dflt_att:"content_padding_right"},title_off_n_top:{dflt_att:"title_off_top"},title_off_w_top:{dflt_att:"title_off_top"},title_off_s_top:{dflt_att:"title_off_top"},title_off_e_top:{dflt_att:"title_off_top"},title_off_n_left:{dflt_att:"title_off_left"},title_off_w_left:{dflt_att:"title_off_left"},title_off_s_left:{dflt_att:"title_off_left"},title_off_e_left:{dflt_att:"title_off_left"},title_off_n_right:{dflt_att:"title_off_right"},title_off_w_right:{dflt_att:"title_off_right"},title_off_s_right:{dflt_att:"title_off_right"},title_off_e_right:{dflt_att:"title_off_right"},title_font_color:{dflt:"black"},title_font_size:{dflt:"9px"},title_font_family:{dflt:"Arial"},title_bold:{dflt:!1},title_italic:{dflt:!1},title_underline:{dflt:!1},content_font_color:{},content_font_size:{},content_font_family:{},content_bold:{},content_italic:{},content_underline:{},spike_n_x:{dflt:0},spike_ne_x:{dflt:0},spike_nw_x:{dflt:0},spike_e_x:{dflt_att:"spike_tr_x"},spike_en_x:{dflt_att:"spike_e_x"},spike_es_x:{dflt_att:"spike_e_x"},spike_w_x:{dflt:0},spike_wn_x:{dflt_att:"spike_w_x"},spike_ws_x:{dflt_att:"spike_w_x"},spike_s_x:{dflt_att:"spike_n_x"},spike_se_x:{dflt_att:"spike_ne_x"},spike_sw_x:{dflt_att:"spike_nw_x"},spike_tl_x:{dflt:0},spike_tr_x:{dflt_att:"spike_br_x"},spike_bl_x:{dflt_att:"spike_tl_x"},spike_br_x:{dflt:0},spike_n_movable_x:{dflt_att:"spike_n_x"},spike_ne_movable_x:{dflt_att:"spike_ne_x"},spike_nw_movable_x:{dflt_att:"spike_nw_x"},spike_wn_movable_x:{dflt_att:"spike_wn_x"},spike_en_movable_x:{dflt_att:"spike_en_x"},spike_tl_movable_x:{dflt_att:"spike_tl_x"},spike_tr_movable_x:{dflt_att:"spike_tr_x"},spike_n_with_caption_x:{dflt_att:"spike_n_x"},spike_ne_with_caption_x:{dflt_att:"spike_ne_x"},spike_nw_with_caption_x:{dflt_att:"spike_nw_x"},spike_wn_with_caption_x:{dflt_att:"spike_wn_x"},spike_en_with_caption_x:{dflt_att:"spike_en_x"},spike_tl_with_caption_x:{dflt_att:"spike_tl_x"},spike_tr_with_caption_x:{dflt_att:"spike_tr_x"},spike_n_movable_with_caption_x:{dflt_att:"spike_n_movable_x"},spike_ne_movable_with_caption_x:{dflt_att:"spike_ne_movable_x"},spike_nw_movable_with_caption_x:{dflt_att:"spike_nw_movable_x"},spike_wn_movable_with_caption_x:{dflt_att:"spike_wn_movable_x"},spike_en_movable_with_caption_x:{dflt_att:"spike_en_movable_x"},spike_tl_movable_with_caption_x:{dflt_att:"spike_tl_movable_x"},spike_tr_movable_with_caption_x:{dflt_att:"spike_tr_movable_x"},spike_n_y:{dflt:0},spike_ne_y:{dflt_att:"spike_n_y"},spike_nw_y:{dflt_att:"spike_n_y"},spike_e_y:{dflt:0},spike_en_y:{dflt:0},spike_es_y:{dflt:0},spike_w_y:{dflt_att:"spike_e_y"},spike_wn_y:{dflt_att:"spike_en_y"},spike_ws_y:{dflt_att:"spike_es_y"},spike_s_y:{dflt:0},spike_se_y:{dflt_att:"spike_s_y"},spike_sw_y:{dflt_att:"spike_se_y"},spike_tl_y:{dflt:0},spike_tr_y:{dflt_att:"spike_tl_y"},spike_bl_y:{dflt_att:"spike_br_y"},spike_br_y:{dflt:0},spike_n_movable_y:{dflt_att:"spike_n_y"},spike_ne_movable_y:{dflt_att:"spike_n_movable_y"},spike_nw_movable_y:{dflt_att:"spike_ne_movable_y"},spike_wn_movable_y:{dflt_att:"spike_en_movable_y"},spike_en_movable_y:{dflt_att:"corner_tr_movable_y"},spike_tl_movable_y:{dflt_att:"spike_tl_y"},spike_tr_movable_y:{dflt_att:"spike_tl_movable_y"},spike_n_with_caption_y:{dflt_att:"spike_n_y"},spike_ne_with_caption_y:{dflt_att:"spike_n_with_caption_y"},spike_nw_with_caption_y:{dflt_att:"spike_ne_with_caption_y"},spike_wn_with_caption_y:{dflt_att:"spike_en_with_caption_y"},spike_en_with_caption_y:{dflt_att:"corner_tr_with_caption_y"},spike_tl_with_caption_y:{dflt_att:"spike_tl_y"},spike_tr_with_caption_y:{dflt_att:"spike_tl_with_caption_y"},spike_n_movable_with_caption_y:{dflt_att:"spike_n_movable_y"},spike_ne_movable_with_caption_y:{dflt_att:"spike_n_movable_with_caption_y"},spike_nw_movable_with_caption_y:{dflt_att:"spike_ne_movable_with_caption_y"},spike_wn_movable_with_caption_y:{dflt_att:"spike_en_movable_with_caption_y"},spike_en_movable_with_caption_y:{dflt_att:"corner_tr_movable_with_caption_y"},spike_tl_movable_with_caption_y:{dflt_att:"spike_tl_movable_y"},spike_tr_movable_with_caption_y:{dflt_att:"spike_tl_movable_with_caption_y"},edge_n_x:{dflt_att:"body_x"},edge_e_x:{dflt_att:"corner_tr_x"},edge_s_x:{dflt_att:"body_x"},edge_w_x:{dflt_att:"corner_tl_x"},edge_n_with_caption_x:{dflt_att:"edge_n_x"},edge_n_movable_x:{dflt_att:"edge_n_x"},edge_n_movable_with_caption_x:{dflt_att:"edge_n_movable_x"},edge_n_gradient_x:{dflt_att:"edge_n_x"},edge_e_gradient_x:{dflt_att:"edge_e_x"},edge_s_gradient_x:{dflt_att:"edge_s_x"},edge_w_gradient_x:{dflt_att:"edge_w_x"},edge_n_gradient_with_caption_x:{dflt_att:"edge_n_gradient_x"},edge_n_gradient_movable_x:{dflt_att:"edge_n_gradient_x"},edge_n_gradient_movable_with_caption_x:{dflt_att:"edge_n_gradient_movable_x"},edge_n_y:{dflt_att:"corner_tl_y"},edge_e_y:{dflt_att:"body_y"},edge_s_y:{dflt_att:"corner_bl_y"},edge_w_y:{dflt_att:"body_y"},edge_n_with_caption_y:{dflt_att:"corner_tl_with_caption_y"},edge_n_movable_y:{dflt_att:"corner_tl_movable_y"},edge_n_movable_with_caption_y:{dflt_att:"corner_tl_movable_with_caption_y"},edge_n_gradient_y:{dflt_att:"edge_n_y"},edge_e_gradient_y:{dflt_att:"edge_e_y"},edge_s_gradient_y:{dflt_att:"edge_s_y"},edge_w_gradient_y:{dflt_att:"edge_w_y"},edge_n_gradient_with_caption_y:{dflt_att:"edge_n_gradient_y"},edge_n_gradient_movable_y:{dflt_att:"edge_n_gradient_y"},edge_n_gradient_movable_with_caption_y:{dflt_att:"edge_n_gradient_movable_y"},corner_tl_x:{dflt:0},corner_tr_x:{dflt_att:"corner_br_x"},corner_bl_x:{dflt_att:"corner_tl_x"},corner_br_x:{dflt:0},corner_tl_movable_x:{dflt_att:"corner_tl_x"},corner_tr_movable_x:{dflt_att:"corner_tr_x"},corner_tl_with_caption_x:{dflt_att:"corner_tl_movable_x"},corner_tr_with_caption_x:{dflt_att:"corner_tr_movable_x"},corner_tl_movable_with_caption_x:{dflt_att:"corner_tl_movable_x"},corner_tr_movable_with_caption_x:{dflt_att:"corner_tr_movable_x"},corner_tl_y:{dflt:0},corner_tr_y:{dflt_att:"corner_tl_y"},corner_bl_y:{dflt_att:"corner_br_y"},corner_br_y:{dflt:0},corner_tl_movable_y:{dflt_att:"corner_tl_y"},corner_tr_movable_y:{dflt_att:"corner_tl_movable_y"},corner_tl_with_caption_y:{dflt_att:"corner_tl_y"},corner_tr_with_caption_y:{dflt_att:"corner_tl_with_caption_y"},corner_tl_movable_with_caption_y:{dflt_att:"corner_tl_movable_y"},corner_tr_movable_with_caption_y:{dflt_att:"corner_tl_movable_with_caption_y"},min_x:{dflt:0},min_active_x:{dflt_att:"min_x"},min_pressed_x:{dflt_att:"min_x"},close_x:{dflt:0},close_active_x:{dflt_att:"close_x"},close_pressed_x:{dflt_att:"close_x"},max_x:{dflt:0},max_active_x:{dflt_att:"max_x"},max_pressed_x:{dflt_att:"max_x"},max_selected_x:{dflt_att:"max_x"},min_y:{dflt:0},min_active_y:{dflt_att:"min_y"},min_pressed_y:{dflt_att:"min_y"},close_y:{dflt:0},close_active_y:{dflt_att:"close_y"},close_pressed_y:{dflt_att:"close_y"},max_y:{dflt:0},max_active_y:{dflt_att:"max_y"},max_pressed_y:{dflt_att:"max_y"},max_selected_y:{dflt_att:"max_y"},edge_per_orientation:{dflt:!1},edge_n_n_x:{dflt_att:"edge_n_x"},edge_e_n_x:{dflt_att:"edge_e_x"},edge_s_n_x:{dflt_att:"edge_s_x"},edge_w_n_x:{dflt_att:"edge_w_x"},edge_n_e_x:{dflt_att:"edge_n_x"},edge_e_e_x:{dflt_att:"corner_br_s_x"},edge_s_e_x:{dflt_att:"edge_s_x"},edge_w_e_x:{dflt_att:"edge_w_x"},edge_n_s_x:{dflt_att:"edge_n_x"},edge_e_s_x:{dflt_att:"edge_e_x"},edge_s_s_x:{dflt_att:"edge_s_x"},edge_w_s_x:{dflt_att:"edge_w_x"},edge_n_w_x:{dflt_att:"edge_n_x"},edge_e_w_x:{dflt_att:"edge_e_x"},edge_s_w_x:{dflt_att:"edge_s_x"},edge_w_w_x:{dflt_att:"corner_tl_n_x"},edge_n_n_y:{dflt_att:"corner_tl_n_y"},edge_e_n_y:{dflt_att:"edge_e_y"},edge_s_n_y:{dflt_att:"edge_s_y"},edge_w_n_y:{dflt_att:"edge_w_y"},edge_n_e_y:{dflt_att:"edge_n_y"},edge_e_e_y:{dflt_att:"edge_e_y"},edge_s_e_y:{dflt_att:"edge_s_y"},edge_w_e_y:{dflt_att:"edge_w_y"},edge_n_s_y:{dflt_att:"edge_n_y"},edge_e_s_y:{dflt_att:"edge_e_y"},edge_s_s_y:{dflt_att:"corner_br_s_y"},edge_w_s_y:{dflt_att:"edge_w_y"},edge_n_w_y:{dflt_att:"edge_n_y"},edge_e_w_y:{dflt_att:"edge_e_y"},edge_s_w_y:{dflt_att:"edge_s_y"},edge_w_w_y:{dflt_att:"edge_w_y"},edge_n_n_gradient_x:{dflt_att:"edge_n_gradient_x"},edge_e_n_gradient_x:{dflt_att:"edge_e_gradient_x"},edge_s_n_gradient_x:{dflt_att:"edge_s_gradient_x"},edge_w_n_gradient_x:{dflt_att:"edge_w_gradient_x"},edge_n_e_gradient_x:{dflt_att:"edge_n_gradient_x"},edge_e_e_gradient_x:{dflt_att:"edge_e_gradient_x"},edge_s_e_gradient_x:{dflt_att:"edge_s_gradient_x"},edge_w_e_gradient_x:{dflt_att:"edge_w_gradient_x"},edge_n_s_gradient_x:{dflt_att:"edge_n_gradient_x"},edge_e_s_gradient_x:{dflt_att:"edge_e_gradient_x"},edge_s_s_gradient_x:{dflt_att:"edge_s_gradient_x"},edge_w_s_gradient_x:{dflt_att:"edge_w_gradient_x"},edge_n_w_gradient_x:{dflt_att:"edge_n_gradient_x"},edge_e_w_gradient_x:{dflt_att:"edge_e_gradient_x"},edge_s_w_gradient_x:{dflt_att:"edge_s_gradient_x"},edge_w_w_gradient_x:{dflt_att:"edge_w_gradient_x"},edge_n_n_gradient_y:{dflt_att:"edge_n_gradient_y"},edge_e_n_gradient_y:{dflt_att:"edge_e_gradient_y"},edge_s_n_gradient_y:{dflt_att:"edge_s_gradient_y"},edge_w_n_gradient_y:{dflt_att:"edge_w_gradient_y"},edge_n_e_gradient_y:{dflt_att:"edge_n_gradient_y"},edge_e_e_gradient_y:{dflt_att:"edge_e_gradient_y"},edge_s_e_gradient_y:{dflt_att:"edge_s_gradient_y"},edge_w_e_gradient_y:{dflt_att:"edge_w_gradient_y"},edge_n_s_gradient_y:{dflt_att:"edge_n_gradient_y"},edge_e_s_gradient_y:{dflt_att:"edge_e_gradient_y"},edge_s_s_gradient_y:{dflt_att:"edge_s_gradient_y"},edge_w_s_gradient_y:{dflt_att:"edge_w_gradient_y"},edge_n_w_gradient_y:{dflt_att:"edge_n_gradient_y"},edge_e_w_gradient_y:{dflt_att:"edge_e_gradient_y"},edge_s_w_gradient_y:{dflt_att:"edge_s_gradient_y"},edge_w_w_gradient_y:{dflt_att:"edge_w_gradient_y"},content_padding_n_top:{dflt_att:"content_padding_top"},content_padding_e_top:{dflt_att:"content_padding_top"},content_padding_s_top:{dflt_att:"content_padding_top"},content_padding_w_top:{dflt_att:"content_padding_top"},content_padding_n_left:{dflt_att:"content_padding_left"},content_padding_e_left:{dflt_att:"content_padding_left"},content_padding_s_left:{dflt_att:"content_padding_left"},content_padding_w_left:{dflt_att:"content_padding_left"},content_padding_n_right:{dflt_att:"content_padding_right"},content_padding_e_right:{dflt_att:"content_padding_right"},content_padding_s_right:{dflt_att:"content_padding_right"},content_padding_w_right:{dflt_att:"content_padding_right"},content_padding_n_bottom:{dflt_att:"content_padding_bottom"},content_padding_e_bottom:{dflt_att:"content_padding_bottom"},content_padding_s_bottom:{dflt_att:"content_padding_bottom"},content_padding_w_bottom:{dflt_att:"content_padding_bottom"},corner_tl_n_x:{dflt_att:"corner_tl_x"},corner_tl_e_x:{dflt_att:"corner_tl_x"},corner_tl_s_x:{dflt_att:"corner_tl_x"},corner_tl_w_x:{dflt_att:"corner_tl_n_x"},corner_tr_n_x:{dflt_att:"corner_br_s_x"},corner_tr_e_x:{dflt_att:"corner_tr_n_x"},corner_tr_s_x:{dflt_att:"corner_tr_x"},corner_tr_w_x:{dflt_att:"corner_tr_x"},corner_bl_n_x:{dflt_att:"corner_bl_x"},corner_bl_e_x:{dflt_att:"corner_bl_x"},corner_bl_s_x:{dflt_att:"corner_tl_n_x"},corner_bl_w_x:{dflt_att:"corner_bl_s_x"},corner_br_n_x:{dflt_att:"corner_br_x"},corner_br_e_x:{dflt_att:"corner_br_s_x"},corner_br_s_x:{dflt_att:"corner_br_x"},corner_br_w_x:{dflt_att:"corner_br_x"},corner_tl_n_y:{dflt_att:"corner_tl_y"},corner_tl_e_y:{dflt_att:"corner_tl_y"},corner_tl_s_y:{dflt_att:"corner_tl_y"},corner_tl_w_y:{dflt_att:"corner_tl_n_y"},corner_tr_n_y:{dflt_att:"corner_tl_n_y"},corner_tr_e_y:{dflt_att:"corner_tr_n_y"},corner_tr_s_y:{dflt_att:"corner_tr_y"},corner_tr_w_y:{dflt_att:"corner_tr_y"},corner_bl_n_y:{dflt_att:"corner_bl_y"},corner_bl_e_y:{dflt_att:"corner_bl_y"},corner_bl_s_y:{dflt_att:"corner_br_s_y"},corner_bl_w_y:{dflt_att:"corner_bl_s_y"},corner_br_n_y:{dflt_att:"corner_br_y"},corner_br_e_y:{dflt_att:"corner_br_s_y"},corner_br_s_y:{dflt_att:"corner_br_y"},corner_br_w_y:{dflt_att:"corner_br_y"}},SIMPL_ORI_MAP={n:"n",ne:"n",nw:"n",tl:"n",tr:"n",s:"s",se:"s",sw:"s",bl:"s",br:"s",e:"e",en:"e",es:"e",w:"w",wn:"w",ws:"w"},INVERTED_ORI_MAP={nw:"se",NW:"se",n:"s",N:"s",ne:"sw",NE:"sw",e:"w",E:"w",se:"nw",SE:"nw",s:"n",S:"n",sw:"ne",SW:"ne",w:"e",W:"e"},INVERTED_ORI_MAP_V3={tl:"br",TL:"br",br:"tl",BR:"tl",tr:"bl",TR:"bl",bl:"tr",BL:"tr",wn:"es",WN:"es",ws:"en",WS:"en",en:"ws",EN:"ws",es:"wn",ES:"wn",nw:"se",NW:"se",n:"s",N:"s",ne:"sw",NE:"sw",e:"w",E:"w",se:"nw",SE:"nw",s:"n",S:"n",sw:"ne",SW:"ne",w:"e",W:"e"};function iFrameControl(){RectControl.call(this),this._hdx={src:{to_dom:iFrameControl.set_src},padding:{to_dom:set_padding,clamp:clamp_padding},border:{to_dom:set_border,clamp:clamp_border},border_color:{to_dom:set_border_color,clamp:clamp_color},background_color:{to_dom:set_background_color,clamp:clamp_color},z:{to_dom:set_z,clamp:clamp_z},w:{to_dom:set_w,clamp:clamp_w},h:{to_dom:set_h,clamp:clamp_h},x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},fade_in_time:{to_dom:set_fade_time,clamp:clamp_time},fade_out_time:{to_dom:set_fade_time,clamp:clamp_time},opacity:{to_dom:set_ctrl_opacity,clamp:clamp_opacity},hidden:{to_dom:set_hidden},locked:{to_dom:set_locked}},this._fader=new Fader(this,"#main#dom")}function ImageControl(){RectControl.call(this),this._hdx={image:{to_dom:ImageControl.SetImage},alt_txt:{to_dom:ImageControl.SetAltText},padding:{to_dom:set_padding,clamp:clamp_padding},padding_t:{to_dom:set_padding,clamp:clamp_padding},padding_r:{to_dom:set_padding,clamp:clamp_padding},padding_b:{to_dom:set_padding,clamp:clamp_padding},padding_l:{to_dom:set_padding,clamp:clamp_padding},border:{to_dom:set_border,clamp:clamp_border},border_t:{to_dom:set_border,clamp:clamp_border},border_r:{to_dom:set_border,clamp:clamp_border},border_b:{to_dom:set_border,clamp:clamp_border},border_l:{to_dom:set_border,clamp:clamp_border},border_color:{to_dom:set_border_color,clamp:clamp_color},background_color:{to_dom:ImageControl.SetBackgroundColor,clamp:clamp_color},href:{to_dom:RectControl.SetLink},tooltip:{to_dom:set_tooltip},z:{to_dom:set_z,clamp:clamp_z},w:{to_dom:ImageControl.SetWH,clamp:clamp_w},h:{to_dom:ImageControl.SetWH,clamp:clamp_h},x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},hidden:{to_dom:set_hidden},trigger_error_on_use:{to_dom:set_trigger_error_on_use},fade_in_time:{to_dom:set_fade_time,clamp:clamp_time},fade_out_time:{to_dom:set_fade_time,clamp:clamp_time},zoomable:{to_dom:ImageControl.SetZoom,clamp:clamp_boolean},keep_aspect:{to_dom:ImageControl.SetKeepAspect,clamp:clamp_boolean},shadow_show:{to_dom:ImageControl.SetShadow},shadow_color:{to_dom:ImageControl.SetShadow,clamp:clamp_color},shadow_trans:{to_dom:ImageControl.SetShadow,clamp:clamp_trans},shadow_blur:{to_dom:ImageControl.SetShadow},shadow_spread:{to_dom:ImageControl.SetShadow},shadow_h:{to_dom:ImageControl.SetShadow},shadow_v:{to_dom:ImageControl.SetShadow},opacity:{to_dom:ImageControl.SetOpacity,clamp:clamp_ctrl_opacity},tabindex:{to_dom:ImageControl.setTabIndex,clamp:clampTabIndex},locked:{to_dom:set_locked}},this._fader=new Fader(this,"#main#dom")}function SpriteControl(){RectControl.call(this),this._hdx={image:{to_dom:SpriteControl.SetImage},alt_txt:{to_dom:SpriteControl.SetAltText},border:{to_dom:SpriteControl.set_sprite_border,clamp:clamp_border},border_color:{to_dom:set_border_color,clamp:clamp_color},background_color:{to_dom:set_background_color,clamp:clamp_color},href:{to_dom:RectControl.SetLink},tooltip:{to_dom:set_tooltip},z:{to_dom:set_z,clamp:clamp_z},w:{to_dom:set_w,clamp:clamp_w},h:{to_dom:set_h,clamp:clamp_h},x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},offset_left:{to_dom:SpriteControl.SetOffset,clamp:SpriteControl.clamp_offset},offset_top:{to_dom:SpriteControl.SetOffset,clamp:SpriteControl.clamp_offset},repeat_x:{to_dom:SpriteControl.set_repeat,clamp:clamp_boolean},repeat_y:{to_dom:SpriteControl.set_repeat,clamp:clamp_boolean},hidden:{to_dom:set_hidden,clamp:clamp_boolean},trigger_error_on_use:{to_dom:set_trigger_error_on_use,clamp:clamp_boolean},fade_in_time:{to_dom:set_fade_time,clamp:clamp_time},fade_out_time:{to_dom:set_fade_time,clamp:clamp_time},shadow_show:{to_dom:ImageControl.SetShadow},shadow_color:{to_dom:ImageControl.SetShadow,clamp:clamp_color},shadow_trans:{to_dom:ImageControl.SetShadow,clamp:clamp_trans},shadow_blur:{to_dom:ImageControl.SetShadow},shadow_spread:{to_dom:ImageControl.SetShadow},shadow_h:{to_dom:ImageControl.SetShadow},shadow_v:{to_dom:ImageControl.SetShadow},opacity:{to_dom:set_ctrl_opacity,clamp:clamp_ctrl_opacity},tabindex:{to_dom:ImageControl.setTabIndex,clamp:clampTabIndex}},this._fader=new Fader(this,"#main#dom")}function Toc(t,e,i,o){this.toc_=t,this.pos_=e,this.struct_="tabbedflat"==i?"tabbedflat":"flat",this.scroll_=o,this.skin_=Toc.SKIN,this.opened_=null,this.invisible_=null,this.widths_=null,this._tabindex=0,this.create_()}function InputTextControl(){RectControl.call(this),this._hdx={text:{to_dom:InputTextControl.SetPlaintext},textarea:{clamp:clamp_boolean,to_dom:InputTextControl.RebuildElement},password:{clamp:clamp_boolean,to_dom:InputTextControl.RebuildElement},disabled:{to_dom:set_disabled,clamp:clamp_boolean},hide_scrollbars:{to_dom:set_hide_scrollbars,clamp:clamp_boolean},tooltip:{to_dom:set_tooltip},case_sensitive:{clamp:clamp_boolean},confirmation_tab:{clamp:clamp_boolean},confirmation_enter:{clamp:clamp_boolean},affirmation_button:{clamp:clamp_boolean},confirmation_blur:{clamp:clamp_boolean},font_family:{to_dom:set_font_styles,clamp:clamp_font_family},font_size:{to_dom:set_font_styles,clamp:clamp_font_size},text_color:{to_dom:set_font_styles,clamp:clamp_color},align:{to_dom:set_font_styles,clamp:clamp_align},bold:{to_dom:set_font_styles,clamp:clamp_boolean},italic:{to_dom:set_font_styles,clamp:clamp_boolean},underline:{to_dom:set_font_styles,clamp:clamp_boolean},background_color:{to_dom:set_background_color,clamp:clamp_color},border:{to_dom:set_input_border,clamp:clamp_input_border},set_border_color:{to_dom:use_input_border_color,clamp:clamp_boolean},border_color:{clamp:clamp_input_border_color,to_dom:set_input_border_color},border_style:{clamp:PageCanvas.clamp_border_style,to_dom:set_input_border_style},padding:{to_dom:set_padding,clamp:clamp_padding},x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},z:{to_dom:set_z,clamp:clamp_z},w:{to_dom:set_w,clamp:clamp_w},h:{to_dom:set_h,clamp:clamp_h},hidden:{to_dom:set_hidden},fire_events:{clamp:clamp_boolean},form_mode:{clamp:clamp_boolean},shadow_show:{to_dom:ImageControl.SetShadow},shadow_color:{to_dom:ImageControl.SetShadow,clamp:clamp_color},shadow_trans:{to_dom:ImageControl.SetShadow,clamp:clamp_trans},shadow_blur:{to_dom:ImageControl.SetShadow},shadow_spread:{to_dom:ImageControl.SetShadow},shadow_h:{to_dom:ImageControl.SetShadow},shadow_v:{to_dom:ImageControl.SetShadow},opacity:{to_dom:set_ctrl_opacity,clamp:clamp_ctrl_opacity}},this.ignore_blur_=null,this.re_compiled_=null}function InputRadioControl(){RectControl.call(this),this._hdx={disabled:{to_dom:InputRadioControl.set_disabled,clamp:clamp_boolean},radio:{to_dom:InputRadioControl.rebuild_element,clamp:clamp_boolean},radiogroupname:{to_dom:InputRadioControl.set_group_name},checked:{to_dom:InputRadioControl.set_checked,clamp:clamp_boolean},choose:{to_dom:InputRadioControl.set_choose,clamp:clamp_boolean},cursorhand:{to_dom:InputRadioControl.set_cursorhand,clamp:clamp_boolean},hide_scrollbars:{to_dom:set_hide_scrollbars,clamp:clamp_boolean},w:{to_dom:InputRadioControl.set_radio_w,clamp:InputRadioControl.clamp_radio_wh},h:{to_dom:InputRadioControl.set_radio_h,clamp:InputRadioControl.clamp_radio_wh},x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},z:{to_dom:set_z,clamp:clamp_z},hidden:{to_dom:set_hidden},tooltip:{to_dom:set_tooltip},fire_events:{clamp:clamp_boolean},form_mode:{clamp:clamp_boolean},tabindex:{to_dom:setTabIndex,clamp:clampTabIndex}},this.dom_radio_=null,this.dom_gname_=null,this.force_check_=null}function InputSelectControl(){RectControl.call(this),this._hdx={values:{to_dom:InputSelectControl.SetValues},cursorhand:{to_dom:InputSelectControl.set_cursor,clamp:clamp_boolean},font_family:{to_dom:set_font_styles,clamp:clamp_font_family},font_size:{to_dom:set_font_styles,clamp:clamp_font_size},text_color:{to_dom:set_font_styles,clamp:clamp_color},bold:{to_dom:set_font_styles,clamp:clamp_boolean},italic:{to_dom:set_font_styles,clamp:clamp_boolean},background_color:{to_dom:set_background_color,clamp:clamp_color},disabled:{to_dom:set_disabled,clamp:clamp_boolean},x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},w:{to_dom:set_w,clamp:clamp_w},h:{to_dom:set_h,clamp:clamp_h},z:{to_dom:set_z,clamp:clamp_z},hidden:{to_dom:set_hidden},fire_events:{clamp:clamp_boolean},form_mode:{clamp:clamp_boolean},shadow_show:{to_dom:ImageButton.SetShadow},shadow_color:{to_dom:ImageControl.SetShadow,clamp:clamp_color},shadow_trans:{to_dom:ImageControl.SetShadow,clamp:clamp_trans},shadow_blur:{to_dom:ImageControl.SetShadow},shadow_spread:{to_dom:ImageControl.SetShadow},shadow_h:{to_dom:ImageControl.SetShadow},shadow_v:{to_dom:ImageControl.SetShadow},opacity:{to_dom:set_ctrl_opacity,clamp:clamp_ctrl_opacity}},this.list_=null,this.list2_=null,this.sel_=-1}function ActivityControl(){RectControl.call(this),this._hdx={process_title:{to_dom:ActivityControl.set_text},font_family:{to_dom:ActivityControl.set_font_family,clamp:clamp_font_family},font_size:{to_dom:ActivityControl.set_font_size,clamp:clamp_font_size},text_color:{to_dom:ActivityControl.set_color,clamp:clamp_color},align:{to_dom:set_font_styles,clamp:clamp_align},delete_icon:{to_dom:ActivityControl.show_delete_icon},plus_icon:{to_dom:ActivityControl.show_plus_icon},edit_icon:{to_dom:ActivityControl.show_edit_icon},hide_role:{to_dom:ActivityControl.hide_role},subdivision_link:{to_dom:ActivityControl.set_subdivision_link},attachment_caption_0:{to_dom:ActivityControl.set_attachment_link},attachment_caption_1:{to_dom:ActivityControl.set_attachment_link},attachment_caption_2:{to_dom:ActivityControl.set_attachment_link},attachment_caption_3:{to_dom:ActivityControl.set_attachment_link},attachment_caption_4:{to_dom:ActivityControl.set_attachment_link},attachment_caption_5:{to_dom:ActivityControl.set_attachment_link},attachment_caption_6:{to_dom:ActivityControl.set_attachment_link},attachment_caption_7:{to_dom:ActivityControl.set_attachment_link},attachment_caption_8:{to_dom:ActivityControl.set_attachment_link},attachment_caption_9:{to_dom:ActivityControl.set_attachment_link},attachment_link_0:{to_dom:ActivityControl.set_attachment_link},attachment_link_1:{to_dom:ActivityControl.set_attachment_link},attachment_link_2:{to_dom:ActivityControl.set_attachment_link},attachment_link_3:{to_dom:ActivityControl.set_attachment_link},attachment_link_4:{to_dom:ActivityControl.set_attachment_link},attachment_link_5:{to_dom:ActivityControl.set_attachment_link},attachment_link_6:{to_dom:ActivityControl.set_attachment_link},attachment_link_7:{to_dom:ActivityControl.set_attachment_link},attachment_link_8:{to_dom:ActivityControl.set_attachment_link},attachment_link_9:{to_dom:ActivityControl.set_attachment_link},forceDownload_0:{to_dom:ActivityControl.set_attachment_link},forceDownload_1:{to_dom:ActivityControl.set_attachment_link},forceDownload_2:{to_dom:ActivityControl.set_attachment_link},forceDownload_3:{to_dom:ActivityControl.set_attachment_link},forceDownload_4:{to_dom:ActivityControl.set_attachment_link},forceDownload_5:{to_dom:ActivityControl.set_attachment_link},forceDownload_6:{to_dom:ActivityControl.set_attachment_link},forceDownload_7:{to_dom:ActivityControl.set_attachment_link},forceDownload_8:{to_dom:ActivityControl.set_attachment_link},forceDownload_9:{to_dom:ActivityControl.set_attachment_link},role:{to_dom:ActivityControl.set_text},font_family_role:{to_dom:ActivityControl.set_font_family,clamp:clamp_font_family},font_size_role:{to_dom:ActivityControl.set_font_size,clamp:clamp_font_size},text_color_role:{to_dom:ActivityControl.set_color,clamp:clamp_color},align_role:{to_dom:ActivityControl.set_align,clamp:clamp_align},background_color_role:{to_dom:ActivityControl.set_background_color,clamp:clamp_color},note:{to_dom:ActivityControl.set_note},border_color:{to_dom:ActivityControl.set_border_color,clamp:clamp_color},background_color:{to_dom:ActivityControl.set_background_color,clamp:clamp_color},shadow_show:{to_dom:ImageControl.SetShadow},shadow_color:{to_dom:ImageControl.SetShadow,clamp:clamp_color},shadow_trans:{to_dom:ImageControl.SetShadow,clamp:clamp_trans},shadow_blur:{to_dom:ImageControl.SetShadow},shadow_spread:{to_dom:ImageControl.SetShadow},shadow_h:{to_dom:ImageControl.SetShadow},shadow_v:{to_dom:ImageControl.SetShadow},border:{to_dom:set_border,clamp:clamp_border},hide_scrollbars:{to_dom:set_hide_scrollbars},tooltip:{to_dom:set_tooltip},z:{to_dom:set_z,clamp:clamp_z},w:{to_dom:set_w,clamp:clamp_w},h:{to_dom:ActivityControl.set_h,clamp:clamp_h},x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},hidden:{to_dom:set_hidden},locked:{to_dom:set_locked},trigger_error_on_use:{to_dom:set_trigger_error_on_use},fade_in_time:{to_dom:set_fade_time,clamp:clamp_time},fade_out_time:{to_dom:set_fade_time,clamp:clamp_time},opacity:{to_dom:set_ctrl_opacity,clamp:clamp_ctrl_opacity},tabindex:{to_dom:setTabIndex,clamp:clampTabIndex}},this.attachments_=[],this.attachments_visible_=!1,this.note_visible_=!1,this.img_info_={subdiv_icon:{offset_l:2,offset_t:2,offset_w:16,offset_h:16,visible:!1},clip_icon:{offset_l:20,offset_t:2,offset_w:16,offset_h:16,visible:!1},bubble_icon:{offset_r:2,offset_t:2,offset_w:16,offset_h:16,visible:!1},delete_icon:{offset_r:2,offset_t:2,offset_w:16,offset_h:16,visible:!1},plus_icon:{offset_r:21,offset_t:3,offset_w:16,offset_h:16,visible:!1},edit_icon:{offset_r:22,offset_t:3,offset_w:16,offset_h:16,visible:!1}},this._fader=new Fader(this,"#main#dom")}function _Mouse(){this.cur_x_=400,this.cur_y_=300,this.id_="page#mouse",this.visible_=!1,this.first_=!1}function MouseControl(){RectControl.call(this),this._hdx={x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},w:{to_dom:set_w,clamp:clamp_w},h:{to_dom:set_h,clamp:clamp_h},z:{to_dom:set_z,clamp:clamp_z},duration:{clamp:clamp_time}}}function Typist(){StatusControl.call(this),this._hdx.time={clamp:clamp_time},this.icon_id_=6}function DropDownAni(){StatusControl.call(this),this.wait_after_mouse_=!1,this.max_height_=480;var t=this._hdx;t.duration={clamp:clamp_time},t.wait_mouse={clamp:clamp_time},this.icon_id_=7}function pt_in_rect4(t,e,i,o,r,n){return i<=t&&r<=e&&t<o&&e<n}function pt_in_rect(t,e,i){return t>=i.x&&e>=i.y&&t<i.x+i.w&&e<i.y+i.h}function sort_z(t,e){return e.z-t.z}iFrameControl.prototype=new RectControl,iFrameControl.set_src=function(t,e,i){var o=this._get_el("#main#iframe"),r="about:blank",n=!1,s=!1;i&&(n=WCT.address.IsExternal(i),s=WCT.address.IsFile(i),r=n||s?Context.ToAbsPath(i,this._src_ctx):Context.GetBase()+"/index.html?show="+i),""!=o.src&&(this._remove_dom(),this._create_dom(),this._update_dom(),o=this._get_el("#main#iframe"),set_hidden.call(this,t,"hidden",t.hidden));var a=this._get_el("#main#cover");if(EDIT_MODE){var _=this._id,l=['<div class="wrapper"><TABLE id="',_,'#main#infoTable" class="se-frame-object">','<TR style="background-color:#cccccc">','<TH style="text-align:right;padding:5px">Type</TH>',"<TD>HTML</TD>","</TR>",'<TR style="background-color:#cccccc">','<TH style="text-align:right;padding:5px">Source</TH>','<TD style="padding:5px" id="',_,'#main#src">',n||s?r:t.src,"</TD>","</TR>","</TABLE>"];a.innerHTML=l.join("")}EDIT_MODE&&!Editor.Preview()||(o.src=r)},WCT.ExtendObject(iFrameControl.prototype,{_create_dom:function(){var t=this._obj,e=$$("div");e.id=this._id+"#main#dom",e.className="iFrameControl",e.style.position="absolute",e.style.margin="0",e.style.zIndex=t.z,e.style.overflow="hidden",e.style.visibility="hidden";var i=$$("iframe");i.style.width="100%",i.style.height="100%",i.style.borderWidth=0,i.style.overflow="auto",i.frameBorder="0",i.style.position="absolute",i.id=this._id+"#main#iframe",i.className="iFrameControl",i.allowTransparency=!0,i.setAttribute("title",t.name);var o=$$("div");o.id=this._id+"#main#cover",o.style.position="absolute",o.style.overlow="hidden",o.style.zIndex=t.z,e.appendChild(i),e.appendChild(o),Canvas.Parent().appendChild(e)},_on_set_preview:function(t){var e=this._obj;iFrameControl.set_src.call(this,e,"src",t?e.src:"about:blank"),set_padding.call(this,e,"padding",e.padding),set_border.call(this,e,"border",e.border),set_background_color.call(this,e,"background_color",e.background_color);var i=this._get_el("#main#cover");i&&(i.style.display=t?"none":""),this._get_el("#main#iframe").style.display=t?"":"none"},_update_dom:function(t){if(!this._disable_dom_update){RectControl.prototype._update_dom.call(this,t);var e=this._obj,i=this._get_el();if(i){i.style.borderColor=e.border_color,i.style.borderStyle=e.border?"solid":"none",i.style.borderWidth=e.border;var o=this._get_el("#main#cover");if(o){var r=t||e,n=2*(e.border+e.padding);o.style.left=e.padding+"px",o.style.top=e.padding+"px",o.style.width=r.w-n+"px",o.style.height=r.h-n+"px",o.style.backgroundColor="#f2f2f2";var s=this._get_el("#main#iframe");s&&(s.tabIndex=e.tabindex,s.style.left=e.padding+"px",s.style.top=e.padding+"px",s.style.width=r.w-n+"px",s.style.height=r.h-n+"px",s.style.display=EDIT_MODE&&!Editor.Preview()?"none":"",this._update_hit_areas())}}}},OnDefaultEdit:function(){return Env.edit({ctlId:this._id,paramName:"src",posSize:this.GetHtmlPosSize(0)}),!0}}),ImageControl.prototype=new RectControl,ImageControl.prototype.Init=function(t){SlideControl.prototype.Init.call(this,t),this._init=!0;var e=this._obj.image?this._obj.image.id:"";Page.IsInCreate()||e||Env.onDefaultEdit(this._id)},WCT.ExtendObject(ImageControl,{ZOOM_ICON:{id:"book_style:icons/zoom.png",id_h:"book_style:icons/zoom_active.png",x:-3,y:3,w:19,h:19},SetShadow:function(){if(this.CalcShadow()){var t=this._get_el();t&&(t.style.boxShadow=this._shadow)}},setTabIndex:function(t,e,i){var o=this._get_el();o&&(o.tabIndex=t.tabindex,(t.href||t.onclick||t.onleave||t.onenter)&&o.setAttribute("role",t.href?"link":"button"))},SetOpacity:function(t,e,i){if(BROWSER.IE7||BROWSER.IE8){var o=t&&t.image?t.image.id:"",r=-1!=o.search(/.png$/i);o&&!r||(i=100)}set_ctrl_opacity.call(this,t,e,i)},SetBackgroundColor:function(t,e,i){set_background_color.apply(this,arguments),this._update_hit_areas()},SetImage:function(t,e,i){this._ictl&&(this._ictl.SetImage(i),this._update_dom())},SetAltText:function(t,e,i){this._ictl&&(this._ictl.SetAltText(i),this._update_dom())},SetKeepAspect:function(t,e,i){this._ictl&&(this._ictl.SetConfig("keep_aspect",i),this._init=!0,ImageControl.ImageLoaded.call(this))},CalcWH:function(t){var e=this._obj,i=null!=arguments[1]?arguments[1]:e[t],o=this.msie5_?0:get_padding(e)[t],r=get_border(e)[t];return Math.max(1,i-o-r)},ImageLoaded:function(){var t=this._ictl;if(t){var e=t.GetPosSize();if(e){var i=this._obj,o=ImageControl.CalcWH.call(this,"w"),r=ImageControl.CalcWH.call(this,"h"),n=EDIT_MODE&&Editor&&!Editor.Preview()&&!Page.IsInCreate()&&!this._init;this._init&&(this._init=!1),(o>e.img_w||r>e.img_h)&&n?(i.w=e.img_w+i.w-o,i.h=e.img_h+i.h-r,Env.onPropChange(this._id,"w",i.w),Env.onPropChange(this._id,"h",i.h),this._draggers&&this._draggers.main.UpdatePos(),this._update_dom()):(t.Fit(o,r),this._update_hit_areas&&this._update_hit_areas())}else this._update_dom()}},SetWH:function(t,e,i){var o=this._get_el(),r=ImageControl.CalcWH.call(this,e,i);if(o.style["w"==e?"width":"height"]=r+"px",this._ictl){var n="w"==e?r:null,s="h"==e?r:null;this._ictl.Fit(n,s)}!1!==arguments[3]&&(this._rd_update_dom_rect&&this._rd_update_dom_rect(),this._draggers&&this._draggers.main.UpdatePos(),this._update_hit_areas&&this._update_hit_areas())},SetZoom:function(t,e,i){var o=this._ictl;o&&o.SetConfig("show_zoom_icon",i?ImageControl.ZOOM_ICON:null),this._update_hit_areas()}}),WCT.ExtendObject(ImageControl.prototype,{_create_dom:function(){var t=this._obj,e=t.alt_txt||"",i=$$("div");i.id=this._id+"#main#dom",i.className="ImageControl",i.style.position="absolute",i.style.overflow="hidden",i.setAttribute("role","figure"),i.setAttribute("aria-label",e),Canvas.Parent().appendChild(i);var o=new ImageObject(this,ImageControl.ImageLoaded,this._id+"#main");o.SetSrcCtx(this._src_ctx),o.Create(i),o.SetConfig("use_image_watcher",!0),o.SetConfig("keep_aspect",t.keep_aspect),t.zoomable&&(ImageControl.ZOOM_ICON.alt_txt=e,ImageControl.ZOOM_ICON.tabindex=t.tabindex,o.SetConfig("show_zoom_icon",ImageControl.ZOOM_ICON)),this._ictl=o},_remove_dom:function(){this.hide_zoomed_image_(),RectControl.prototype._remove_dom.call(this)},_update_dom:function(t){if(!this._disable_dom_update){var e=this._obj,i=t||e;set_x.call(this,e,"x",i.x,!1),set_y.call(this,e,"y",i.y,!1),ImageControl.SetWH.call(this,e,"w",i.w,!1),ImageControl.SetWH.call(this,e,"h",i.h,!1),this._update_hit_areas()}},_update_hit_areas:function(){if(HitManager.clearHitControl(this._id),!this.isHidden()){var t=this._obj,e="default";this._cursor?e=this._cursor:(this._link_to||t.ondown||t.onclick||t.ondblclick)&&(e="pointer");var i=this._ictl?this._ictl.GetPosSize():null,o=get_border(t),r=get_padding(t),n={ctl_id:this._id,sub_id:"main",hdl_id:"dom",cursor:e,type:"rect",x:t.x,y:t.y,w:t.w,h:t.h,z:t.z};t.background_color&&"transparent"!=t.background_color||o.w||o.h?HitManager.setHitArea(n):i?(n.x=t.x+i.x+r.l,n.y=t.y+i.y+r.t,n.w=i.w,n.h=i.h,HitManager.setHitArea(n)):HitManager.clearHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"dom"}),i&&i.zoom?((n=WCT.DeepCopy(n)).hdl_id="zoom",n.cursor="pointer",n.x=t.x+o.l+r.l+i.x+i.zoom.x,n.y=t.y+o.t+r.t+i.y+i.zoom.y,n.w=i.zoom.w,n.h=i.zoom.h,n.z+=t.z+.1,HitManager.setHitArea(n)):HitManager.clearHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"zoom"})}},OnRTMouseUp:function(t){"main"==t.sub_id&&"zoom"!=t.hdl_id&&this.set_image_("mouseup")},OnRTMouseLeave:function(t){"main"==t.sub_id&&("zoom"==t.hdl_id?this._ictl&&this._ictl.SetConfig("zoom_icon_state",null):this.set_image_("mouseout")),this._obj.onleave&&!arguments[1]&&Page.RTFireTrigger(this._obj.onleave)},OnRTMouseEnter:function(t){"main"==t.sub_id&&("zoom"==t.hdl_id?this._ictl&&this._ictl.SetConfig("zoom_icon_state","h"):this.set_image_("mouseover")),this._obj.onenter&&!arguments[1]&&Page.RTFireTrigger(this._obj.onenter)},OnRTMouseDown:function(t){"main"==t.sub_id&&"zoom"!=t.hdl_id&&this.set_image_("mousedown")},OnRTMouseClick:function(t){switch(t.sub_id){case"popup":this.hide_zoomed_image_();break;case"main":"zoom"==t.hdl_id?(this._ictl&&this._ictl.SetConfig("zoom_icon_state",null),this.show_zoomed_image_()):(this._obj.onclick&&Page.RTFireTrigger(this._obj.onclick),this._exec_link())}},OnViewResize:function(){this.hide_zoomed_image_()},show_zoomed_image_:function(){var t=Canvas.FrameW(),e=Canvas.FrameH(),i=Page.scrollTop,o=Page.scrollLeft,r=t-30,n=e-30,s=this._ictl.GetPosSize(),a=s.img_w,_=s.img_h;r<a?(_=_*r/a,a=r,n<_&&(a=a*n/_,_=n)):n<_&&(a=a*n/_,_=n,r<a&&(_=_*r/a,a=r)),a<r?r=a+30:r+=30,_<n?n=_+30:n+=30;var l=Math.max(0,(t-r)/2),d=Math.max(0,(e-n)/2),h=this._get_el("#popup#dom");if(!h){var c=this._obj,p=this._id,u=c.alt_txt||"";(h=$$("div")).style.position="absolute",h.style.width=r+"px",h.style.height=n+"px",h.style.backgroundColor="white",h.style.top=d+i+"px",h.style.left=l+o+"px",h.id=p+"#popup#dom",h.tabIndex=c.tabindex,h.setAttribute("role","dialog"),h.setAttribute("aria-modal","true"),h.setAttribute("aria-label",ctx.cfg_tr("FULLSCREEN")+" "+u),h.setAttribute("trigger_error_on_use",!1);var f=ctx.cfg_tr("CLOSE"),m=$$("img");m.id=p+"#popup#close",m.style.position="absolute",m.style.top="0",m.style[this.IsRTL()?"left":"right"]="0",m.style.cursor="pointer",m.src=Context.ToAbsPath("skin:navigator_close_normal.gif"),m.tabIndex=c.tabindex,m.alt="",m.setAttribute("title",f),m.setAttribute("aria-label",f+" "+u),m.setAttribute("role","button"),m.setAttribute("trigger_error_on_use",!1);var g=$$("img");g.id=p+"#popup#zoom_image",g.src=Context.ToAbsPath(c.image.id,this._src_ctx),g.alt=c.alt_txt,g.style.position="absolute",g.style.top="15px",g.style.left="15px",g.style.width=a+"px",g.style.height=_+"px",g.setAttribute("trigger_error_on_use",!1),h.appendChild(m),h.appendChild(g),set_opacity(h,0);var y=SIM_MODE?"#BBB":"#333",b=Canvas.CreateBackgroundOverlay(p+"#popup#background",y);set_opacity(b,45),b.style.visibility="hidden";var v=Canvas.CreateBackgroundOverlay(p+"#popup#tbackground","transparent");v.appendChild(h),v.style.visibility="hidden",HitManager.setHitArea({ctl_id:p,sub_id:"popup",hdl_id:"background",x:-Canvas.x(),y:-Canvas.y(),w:t,h:e,z:c.z+1e3,type:"rect",cursor:"default"}),opacity(h,0,100,500),hide_all_windowed_objects(),WCT.SetTimeout(function(){h.focus()}.bind(this),500)}},RTFireTrigger:function(t,e){"hide"==t&&this.hide_zoomed_image_(),TextControl.prototype.RTFireTrigger.apply(this,arguments)},hide_zoomed_image_:function(t){var e=this._get_el("#popup#dom");e&&(e.parentNode.removeChild(e),Canvas.RemoveBackgroundOverlay([this._id+"#popup#background",this._id+"#popup#tbackground"]),HitManager.clearHitArea({ctl_id:this._id,sub_id:"popup",hdl_id:"background"}),show_all_windowed_objects(),this._get_el("#main#zoom").focus())},OnDefaultEdit:function(){return Env.edit({ctlId:this._id,paramName:"image",posSize:this.GetHtmlPosSize(0)}),!0},SetDirection:function(t){var e=WCT.IsLanguageRTL(t)?"rtl":"";this._direction=e,this._ictl&&this._ictl.SetConfig("direction",e)},_on_set_preview:function(t){t||this.hide_zoomed_image_()},set_image_:function(t){var e=this._ictl;if(e){var i=this._obj,o="mouseup"==t?"image_mouseover":"image_"+t;i[o]&&i[o].id||(o="image"),e.SetImage(i[o],e.Fit,e)}}}),SpriteControl.prototype=new RectControl,SpriteControl.prototype.Init=function(t){SlideControl.prototype.Init.call(this,t),this._init=!0;var e=this._obj.image?this._obj.image.id:"";Page.IsInCreate()||e||Env.onDefaultEdit(this._id)},WCT.ExtendObject(SpriteControl,{SetOffset:function(t,e,i){var o=this._obj,r="offset_left"==e?i:o.offset_left,n="offset_top"==e?i:o.offset_top;0<r&&(r=-r),0<n&&(n=-n),this._get_el().style.backgroundPosition=r+"px "+n+"px"},clamp_offset:function(t,e){if(EDIT_MODE){var i="offset_left"==e.name,o=t.image,r=o&&(i?o.w:o.h)||0,n=Math.abs(e.val);e.res=r&&r<n?r:n}else e.res=e.val},set_sprite_border:function(t,e,i){var o=this._get_el();0<i?(o.style.borderStyle="solid",o.style.borderWidth=i+"px"):(o.style.borderStyle="none",o.style.borderWidth="0px");var r=2*i,n=Math.max(1,t.w-r),s=Math.max(1,t.h-r);o.style.width=n+"px",o.style.height=s+"px",this._rd_update_dom_rect&&this._rd_update_dom_rect()},SetImage:function(t,e,i){var o=this._get_el();o&&(o.style.backgroundImage="none",i&&i.id&&(o.style.backgroundImage="url("+Context.ToAbsPath(i.id,this._src_ctx)+")",null!=i.x&&null!=i.y?(t.offset_left=i.x,t.offset_top=i.y):null!=i.x?t.offset_left=i.x:null!=i.y&&(t.offset_top=i.y)))},SetAltText:function(t,e,i){var o=this._get_el();o&&o.setAttribute("aria-label",i)},set_repeat:function(t,e,i){var o=this._get_el();if(o){var r=this._obj,n="repeat_x"==e?i:r.repeat_x,s="repeat_y"==e?i:r.repeat_y;o.style.backgroundRepeat=n&&s?"repeat":n?"repeat-x":s?"repeat-y":"no-repeat"}}}),WCT.ExtendObject(SpriteControl.prototype,{RTFireTrigger:TextControl.prototype.RTFireTrigger,_create_dom:function(){var t=$$("div");t.id=this._id+"#main#dom",t.className="SpriteControl",t.style.position="absolute",t.style.overflow="hidden",t.setAttribute("role","img"),Canvas.Parent().appendChild(t)},_remove_hit_areas:function(){HitManager.clearHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"dom"}),HitManager.clearHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"img"})},_update_hit_areas:function(){if(HitManager.clearHitControl(this._id),!this.isHidden()){var t=this._obj,e=this._link_to||t.ondown||t.onclick||t.ondblclick,i=this._cursor||e?"pointer":"default";HitManager.setHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"dom",x:t.x,y:t.y,w:t.w,h:t.h,z:t.z,type:"rect",cursor:i})}},OnRTMouseClick:function(t){this._obj.onclick&&Page.RTFireTrigger(this._obj.onclick),this._exec_link()},OnRTMouseEnter:function(t){this.set_image_("mouseover"),this._obj.onenter&&Page.RTFireTrigger(this._obj.onenter)},OnRTMouseLeave:function(t){this.set_image_("mouseout"),this._obj.onleave&&Page.RTFireTrigger(this._obj.onleave)},OnRTMouseUp:function(t){this.set_image_("mouseup")},OnRTMouseDown:function(t){this.set_image_("mousedown")},OnRTKeyUp:function(t){13!==t.button&&32!==t.button||this.OnRTMouseClick(t)},_on_set_preview:function(t){this._update_hit_areas()},OnDefaultEdit:function(){return Env.edit({ctlId:this._id,paramName:"image",posSize:this.GetHtmlPosSize(0)}),!0},set_image_:function(t){var e=this._obj,i="mouseup"==t?"image_mouseover":"image_"+t;e[i]&&e[i].id||(i="image"),SpriteControl.SetImage.call(this,e,"image",e[i]),SpriteControl.SetOffset.call(this,e,"offset_left",e.offset_left),SpriteControl.SetOffset.call(this,e,"offset_top",e.offset_top)}}),Toc.MAINNAVI_MAX_W=200,Toc.POPUP_MAX_W=500,Toc.HEIGHT=0,Toc.SKIN={background_color:"#DAE1E9",font_family:"Arial",border_left:"1px solid #A7B5C2",border_top:"1px solid #A7B5C2",border_right:"1px solid #7A7A7A",border_bottom:"1px solid #7A7A7A",padding_left:10,padding_right:10,h:24,text:{line_height:20,margin_left:5,margin_right:5,margin_top:2,margin_bottom:2,white_space:"nowrap",cursor:"pointer",background_color:"#DAE1E9",background_color_h:"#1E4B74",text_color:"#000",text_color_h:"#fff",font_size:13,font_weight:"bold",text_overflow:"ellipsis",overflow:"hidden"},popup:{background_color:"#DAE1E9",border_left:"1px solid #A7B5C2",border_top:"1px solid #A7B5C2",border_right:"1px solid #7A7A7A",border_bottom:"1px solid #7A7A7A",font_size:12,overflow_y:"auto",overflow_x:"hidden",padding_left:5,padding_right:5},popup_text:{cursor:"pointer",line_height:21,background_color:"#DAE1E9",background_color_h:"#1E4B74",text_color:"#000",text_color_h:"#fff",white_space:"nowrap",text_overflow:"ellipsis",overflow:"hidden"}},Toc.Close=function(t){t=WCT.event.Standardize(t),WCT.event.StopObserving("click",Toc.Close);var e=Canvas&&Canvas.toc_;if(e){for(var i=t.target;i&&"body"!=WCT.dom.GetNodeName(i)&&"toc"!=i.id;)i=i.parentNode;if(!i||"toc"!=i.id)e.Close();else{var o=(t.target.id||"").split("_popup_")[1],r=Number(o),n=e.toc_.GetList();if(isNaN(r)||!n[r])return void e.Close();for(var s=n[r];s&&"slide"!=s.tclass;)s=n[++r];e.Close(),s&&ctx.cfg_show("slide!"+s.uid)}}},Toc.prototype=function(){function _(t){if("keyup"!==(t=WCT.event.Standardize(t)).type||13===t.button||32===t.button){var e=null,i=null,o=null,r=!1,n=!1,s=t.target,a=t.targetName;"span"===a?(e=Number(s.getAttribute("lidx")),isNaN(e)&&(e=null),i=s.getAttribute("tclass")||null,o=s.getAttribute("uid")||null):"div"===a&&(s.getAttribute("rm")?r=!0:null!=(e=s.getAttribute("lidx"))&&(isNaN(e)&&(e=null),i=s.getAttribute("tclass")||null,o=s.getAttribute("uid")||null,n=!0));var _=Canvas&&Canvas.toc_||null;if(_&&(null!=e||r)){var l=n?_.skin_.popup_text:_.skin_.text;switch(t.type){case"mouseover":var d=l.text_color_h||l.text_color||"#000",h=l.background_color_h||l.background_color||"#fff";WCT.skin.Apply(s,{text_color:d,background_color:h}),null!=_.opened_&&(r?"rm"!=_.opened_&&c.call(_,"rm",s):e==_.opened_||n||c.call(_,e,s));break;case"mouseout":d=l.text_color||"#000",h=l.background_color||"#fff";WCT.skin.Apply(s,{text_color:d,background_color:h});break;case"click":if(PLATFORM.IOS)break;case"keyup":case"touchend":if(r)c.call(_,"rm",s);else if("slide"==i)_.Close(),ctx.cfg_show("slide!"+o);else{if(n)return!0;c.call(_,e,s)}}return WCT.event.Cancel(t)}}}function c(t,e){if(this.opened_!=t){null!=this.opened_&&this.Close(),this.opened_=t;var i=[],o=this.toc_.GetList(),r=0;if("rm"==t){r=o[this.invisible_].level-1;for(var n=this.invisible_,s=null;s=o[n];n++)i.push(s)}else{r=o[t].level;for(n=t+1,s=null;(s=o[n])&&!(s.level<=r);n++)i.push(s)}if(i.length){e.setAttribute("aria-expanded","true");var a=this.skin_,_=e.offsetLeft,l=e.offsetTop+e.offsetHeight;a.text.margin_left&&(_-=a.text.margin_left),a.text.margin_bottom&&(l+=a.text.margin_bottom),_+="px",l+="px";var d=$$("iframe");d.id=t+"_iframe",d.tabIndex=-1,d.setAttribute("role","presentation"),d.style.position="absolute",d.frameBorder="0",d.style.borderWidth="0",d.style.left=_,d.style.top=l,d.style.zIndex=1001;var h=$$("div");h.id=t+"_popup",WCT.skin.Apply(h,a.popup),h.style.position="absolute",h.style.left=_,h.style.top=l,h.style.zIndex=1001;var c,p="tabbedflat"==this.struct_;for(n=0,s=null;s=i[n];n++){var u=$$("div");u.onclick=function(){},u.id=t+"_popup_"+s.list_idx,u.tabIndex=this._tabindex,WCT.skin.Apply(u,a.popup_text),a.popup_text.line_height&&(u.style.height=a.popup_text.line_height+"px"),u.setAttribute("role","menuitem"),u.setAttribute("lidx",s.list_idx),u.setAttribute("tclass",s.tclass),u.setAttribute("uid",s.uid),u.setAttribute("title",s.caption),u.appendChild($$2(s.caption)),h.appendChild(u),0===n&&(c=u),"slide"!=s.tclass&&(u.style.fontWeight="bold"),p&&(u.style.paddingLeft=10*(s.level-r-1)+"px")}var f=e.parentNode;f.appendChild(d),f.appendChild(h),c&&c.focus();var m=WCT.skin.GetBorderWidth(a.popup),g=WCT.skin.GetPaddingWidth(a.popup),y=h.clientWidth-g;y>Toc.POPUP_MAX_W?(h.style.width=Toc.POPUP_MAX_W+"px",d.style.width=Toc.POPUP_MAX_W+g+m+"px"):(h.style.width=y+"px",d.style.width=y+g+m+"px");var b=WCT.skin.GetBorderHeight(a.popup),v=WCT.skin.GetPaddingHeight(a.popup),x=Page.clientHeight-WCT.dom.GetPosition(h).top-5,w=h.clientHeight-v;x<=w?(h.style.height=x-v-b+"px",d.style.height=x+"px"):(h.style.height=w+"px",d.style.height=w+v+b+"px"),function C(){if(null==this.opened_)return;var t=$(this.opened_+"_popup"),e=$(this.opened_+"_iframe");if(!t||!e)return;var i=t.parentNode.offsetLeft;i+t.offsetLeft+t.offsetWidth>Page.clientWidth&&(e.style.left="",e.style.right=-i+"px",t.style.left="",t.style.right=-i+"px")}.call(this),WCT.event.Observe("click",Toc.Close)}}else this.Close()}return{Destructor:function(){this.Close(),this.toc_=null,this.opened_=null,this.invisible_=null,this.widths_=null,WCT.event.StopObserving("click",Toc.Close),Toc.HEIGHT=0;var t=$("toc");return t&&(t.onmouseoever=null,t.onmouseout=null,t.onclick=null,t.parentNode.removeChild(t)),null},Resize:function(){var t=this.skin_,e=$("toc");if(e&&t){this.Close();var i,o=Canvas.border(),r=0,n=0;i="slide_top"==this.pos_?(r=Canvas.x()-o,n=Canvas.y()-o-(t.h||0),Canvas.w()+2*o):Canvas.FrameW(),i-=WCT.skin.GetBorderWidth(t)+WCT.skin.GetPaddingWidth(t),e.style.left=r+"px",e.style.top=n+"px",e.style.width=i+"px",function c(t,e){for(var i=this.widths_||[],o=!0,r=null,n=WCT.skin.GetMarginWidth(this.skin_.text),s=[],a=0,_=null,l=t.childNodes;_=l[a];a++){var d,h=WCT.dom.GetNodeName(_);if("span"==h)null!=i[a]?d=i[a]:(d=Math.min(_.clientWidth+1,Toc.MAINNAVI_MAX_W-n),i.push(d)),0<(e-=d+n)?(_.style.width=d+"px",_.style.display=""):(_.style.display="none",s.push(Number(_.getAttribute("lidx"))),o=!1);else"div"==h&&"1"==_.getAttribute("rm")&&(r=_)}this.widths_||(this.widths_=i),this.invisible_=o?null:s.min(),r&&(r.style.display=o?"none":"block")}.call(this,e,i)}},Close:function(){var t=this.opened_;if(null!=t){if(WCT.event.StopObserving("click",Toc.Close),t){var e=document.querySelectorAll('[lidx="'+t+'"]'),i=$(t+"_iframe"),o=$(t+"_popup");e[0]&&e[0].setAttribute("aria-expanded","false"),o&&o.parentNode.removeChild(o),i&&i.parentNode.removeChild(i)}this.opened_=null}},create_:function(){var t=this.skin_;if(t&&!$("toc")){d=$$("div"),d.id="toc",d.setAttribute("role","navigation"),d.setAttribute("aria-label",ctx.cfg_tr("TOC")),d.style.clear="left",WCT.skin.Apply(d,t),Toc.HEIGHT=t.h,Canvas.Frame().appendChild(d);for(var e="flat"===this.struct_,i=e?"button":"link",o=this.toc_.GetList(),r=0,n=null;n=o[r];r++)if(1==n.level){var s=$$("span");s.onclick=function(){},s.id=d.id+"#main#entry-"+n.list_idx,s.tabIndex=this._tabindex,s.setAttribute("role",i),s.style.cssFloat="left",s.setAttribute("lidx",n.list_idx),s.setAttribute("tclass",n.tclass),s.setAttribute("uid",n.uid),s.setAttribute("title",n.caption),WCT.skin.Apply(s,t.text),s.appendChild($$2(n.caption)),e&&(s.setAttribute("aria-haspopup","true"),s.setAttribute("aria-expanded","false")),d.appendChild(s)}var a=$$("div");a.onclick=function(){},WCT.skin.Apply(a,t.text),a.style.position="absolute",a.style.right=0,a.style.top=0,a.style.display="none",a.setAttribute("rm","1"),a.appendChild($$2(">")),d.appendChild(a),d.onmouseover=_,d.onmouseout=_,d.onclick=_,d.onkeyup=_,PLATFORM.IOS&&(d.ontouchend=_)}}}}(),InputTextControl.prototype=new RectControl,InputTextControl.RebuildElement=function(t,e,i){this._in_creation||(this._in_creation=!0,this._remove_dom(),this._create_dom(),this.ToDom(),this._update_dom(),this._in_creation=!1)},InputTextControl.SetPlaintext=function(t,e,i){var o=this._get_el();"undefined"!=typeof o.value?(o.value=i,o.setAttribute("value",i)):o.innerText=i},WCT.ExtendObject(InputTextControl.prototype,{Terminate:function(){this.re_compiled_=null,RectControl.prototype.Terminate.call(this)},_create_dom:function(){var t=this._obj,e=null;t.textarea?(e=$$("textarea")).name=this._id:(e=WCT.dom.CreateInputElement(t.password?"password":"text",this._id),"undefined"!=typeof t.max_length&&-1<t.max_length&&e.setAttribute("maxLength",t.max_length)),e.id=this._id+"#main#dom",e.className="InputTextControl",e.style.position="absolute",BROWSER.MOBILE&&(e.setAttribute("autocapitalize","off"),e.setAttribute("autocorrect","off")),"number"==typeof t.tabindex&&e.setAttribute("tabindex",t.tabindex),Canvas.Parent().appendChild(e),this._update_hit_areas()},_remove_dom:function(){var t=this._get_el();t&&(WCT.event.StopObserving("blur",rt_hdl_blur,t),WCT.event.StopObserving("focus",rt_hdl_focus,t)),RectControl.prototype._remove_dom.call(this)},_update_dom:function(t){if(!this._disable_dom_update){var e=RectControl.prototype._update_dom.apply(this,arguments),i=this._get_el();if(i){var o=this._obj;if(i.style.direction=this._direction,o.msie5){var r=t||o;i.style.padding="0px",i.style.width=r.w+"px",i.style.height=r.h+"px"}null==e.h||o.textarea||(i.style.lineHeight=e.h+"px")}}},Tick:function(){this.check_(!1)},check_:function(t){var e=this._get_el();if(e){var i=this._obj,o=e.value;if(o!=this.last_txt_)this.last_txt_=o,i.set_variable&&Page.SetVariable(i.set_variable,o),i.onchange&&Page.RTFireTrigger(i.onchange,{value:o});else if(!t)return;var r=this.normalize_text_(o),n=this.target_text_;n.isArray||(n=[n]);for(var s="",a=0,_=n.length;a<_;a++){var l=n[a];if((this.re_compiled_?!!this.re_compiled_.exec(r):r==l)&&!arguments[1]){if(i.fire_events&&i.oncorrectanswer)return void Page.RTFireTrigger(i.oncorrectanswer,this._id,a)}else if((t||i.form_mode)&&i.fire_events&&i.onwronganswer){s=Dict_get("EXER_YOURINPUT").replace(/@1_input_/g,o||"")+" "+Dict_get("EXER_TEXTINPUT").replace(/@1/g,l.toLowerCase()||"").replace(/@2/g,i.fieldname||"")}}!arguments[2]&&s&&Page.RTFireTrigger(i.onwronganswer,s,this._id)}},OnRTMouseClick:function(t){var e=this._obj;e.onclick&&Page.RTFireTrigger(e.onclick)},OnRTKeyDown:function(t){var e=t.altKey||t.ctrlKey||t.shiftKey,i=this._obj,o=!0,r=!1;i.form_mode&&(r=!(o=i.form_affirmation||!1));var n=i.confirmation_enter,s=i.confirmation_tab,a=9==t.keyCode,_=13==t.keyCode,l=i.enforce_value,d=WCT.event.hotkey.GetKey(t),h=Env.GetConfig("keys_show_highlight");if(l&&d!==h){var c=this._get_el(),p=c.value,u=p.length,f=l.length;return l.isPrefix(p)||(p="",u=0),u<f?c.value=p+l.charAt(u):u==f&&i.onenforced&&(a&&s||_&&n)&&Page.RTFireTrigger(i.onenforced),WCT.event.Cancel(t._orig_)}return a?(this.check_(!0,(!s||e)&&o,!s),"number"!=typeof i.tabindex&&(t.hasToBeCancelled=!0)):_&&(n&&!e||r?this.check_(!0,null,!n):i.textarea||this.check_(!0,!0,!n)),!0},OnRTBlur:function(t){if(this.ignore_blur_)return this.ignore_blur_=null,!1;var e=this._obj;e.confirmation_blur&&(e.enforce_value?e.onenforced&&(this._get_el().value.length!=e.enforce_value.length&&!1!==e.check_full_text||Page.RTFireTrigger(e.onenforced)):this.check_(!0));return!0},OnRTFocus:function(){var t=this._obj;if(!1===t.check_full_text){var e=this._get_el();e&&e.blur(),t.check_full_text_anim?Page.RTFireTrigger(t.check_full_text_anim):(e&&(e.value=t.text_full),t.check_full_text_next&&Page.RTFireTrigger(t.check_full_text_next))}var i=Controls[t.task_bubble];if(i){var o=i._obj,r=o.h>>1;i.SetParam("y",t.y+r);var n=o.w>>1,s=o.x-n,a=s+o.w,_=t.x+t.w;if(t.x<=s&&s<=_||t.x<=a&&a<=_){var l=t.x-o.w+n-10;0<=l?i.SetParam("x",l):i.SetParam("x",_+n+10)}}},OnRTMouseDown:function(t){var e;PLATFORM.IOS&&(e=this._get_el())&&WCT.event.CreateAndDispatchEvent("TouchEvent","touchstart",e);("transparent"==this._obj.background_color||BROWSER.IE)&&(e=this._get_el())&&e.focus()},prepare_re_:function(){if(this.re_compiled_=null,this._obj.regexp&&0<this._obj.regexp.length){var t=this._obj.regexp,i="";"/"==t.substr(0,1)&&(i=t.substr(t.lastIndexOf("/")+1),t=t.substr(1,t.lastIndexOf("/")-1));try{var o=new RegExp(t,i);this.re_compiled_=o}catch(e){EDIT_MODE&&!NO_ALERT&&alert(this._obj.name+" Bad RegExp: "+this._obj.regexp)}}},_on_set_preview:function(t){var e=this._get_el();if(t){var i=this._obj;e.value=i.text,this.last_txt_=e.value,this.prepare_re_(),this.target_text_=this.normalize_text_(i.text_full,!0),(i.fire_events||i.set_variable)&&(i.confirmation_blur&&WCT.event.Observe("blur",rt_hdl_blur,e),BROWSER.MOBILE&&WCT.event.Observe("blur",function(t){window.parent&&window.parent.scrollTo(0,0)},e),WCT.event.Observe("focus",rt_hdl_focus,e),i.confirmation_tab||i.confirmation_enter||i.affirmation_button||i.confirmation_blur||(Ticker.Register(this._id,!0),this.have_ticker_=!0))}else WCT.event.StopObserving("blur",rt_hdl_blur,e),WCT.event.StopObserving("focus",rt_hdl_focus,e),this.have_ticker_&&(Ticker.Unregister(this._id),delete this.have_ticker_)},RTFireTrigger:function(t,i){var o=this._get_el();if(o){var r=this._obj;switch(t){case"show":r.hidden=!1,set_hidden.call(this,r,"hidden",r.hidden),r.onshow&&Page.RTFireTrigger(r.onshow);break;case"hide":r.hidden=!0,set_hidden.call(this,r,"hidden",r.hidden),r.onhide&&Page.RTFireTrigger(r.onhide);break;case"toggle":this.RTFireTrigger(r.hidden?"show":"hide",i);break;case"focus":try{o.focus(),BROWSER.IE&&(this.ignore_blur_=!0,o.blur(),o.focus())}catch(e){}break;case"blur":try{o.blur()}catch(e){}break;case"selectall":try{o.selectAll()}catch(e){}break;case"checkvalue":r.affirmation_button&&this.check_(!0);break;case"enable":o.setAttribute("readOnly",0);break;case"disable":o.setAttribute("readOnly",1),o.blur();break;case"activate":r.form_mode&&!r.form_affirmation&&this.check_(!0);break;case"set_text":i.isArray&&(i=i[0]),this.SetParam("text",i||"");break;case"correct":r.oncorrectanswer&&Page.RTFireTrigger(r.oncorrectanswer,this._id);break;default:EDIT_MODE&&Editor.RuntimeInfo("no trigger: "+t)}}},normalize_text_:function(t){var e=[];t.isArray||(t=[t]);for(var i=0,o=t.length;i<o;i++)for(e[i]=t[i];t[i]=e[i],e[i]=t[i].replace(/\r\n/g,"\r").replace(/\n\r/g,"\r").replace(/\n/g,"\r").replace(/\r\r/g,"\r").replace(/^\r/g,"").replace(/\r$/g,""),t[i]!=e[i];);if(!this._obj.case_sensitive&&!this.re_compiled_)for(i=0,o=e.length;i<o;i++)e[i]=e[i].toUpperCase();return arguments[1]?e:e[0]},_update_hit_areas:function(){if(HitManager.clearHitControl(this._id),!this.isHidden()){var t=this._obj;HitManager.setHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"dom",type:"rect",cursor:t.noeditcursor?"default":"text",x:t.x,y:t.y,w:t.w,h:t.h,z:t.z})}}}),InputRadioControl.prototype=new RectControl,WCT.ExtendObject(InputRadioControl,{set_disabled:function(t,e,i){var o=this._get_el("#main#check");o.disabled=i,o.setAttribute("aria-disabled",i)},set_checked:function(t,e,i){var o=this._get_el("#main#check");i&&this._setAllUncheckedExceptThis(),this._obj.last_checked=i,this._obj.checked=i,o.checked=i,o.setAttribute("aria-checked",!!i)},set_choose:function(t,e,i){if(LESSON_EDIT){var o=this._get_el("#main#check");i||this._setAllUncheckedExceptThis(),this._obj.last_checked=!i,this._obj.choose=i,this._obj.checked=!i,o.checked=!i,o.setAttribute("aria-checked",!i)}},set_radio_w:function(t,e,i){this._get_el().style.width=i+"px";var o=this._get_el("#main#check");o.style.left=Math.max(i-13>>1,0)+"px",o.style.width="13px",this._rd_update_dom_rect&&this._rd_update_dom_rect(),this._draggers&&this._draggers.main.UpdatePos()},set_radio_h:function(t,e,i){this._get_el().style.height=i+"px";var o=this._get_el("#main#check");o.style.top=Math.max(i-13>>1,0)+"px",o.style.height="13px",this._rd_update_dom_rect&&this._rd_update_dom_rect(),this._draggers&&this._draggers.main.UpdatePos()},clamp_radio_wh:function(t,e){e.res=Math.max(13,e.val-0)},rebuild_element:function(t,e,i){var o=this._get_el("#main#check");if(o&&(this.dom_radio_!=t.radio||this.dom_gname_!=t.radiogroupname)){var r=o.parentNode;this.create_input_(r),r.removeChild(r.firstChild),this._update_dom()}},set_group_name:function(t,e,i){this._setFirstChecked(),InputRadioControl.rebuild_element.call(this,t,e,i)},set_cursorhand:function(t,e,i){var o=i?"pointer":"";this._cursor=o;var r=this._get_el(),n=this._get_el("#main#check");r&&(r.style.cursor=o),n&&(n.style.cursor=o)}}),WCT.ExtendObject(InputRadioControl.prototype,{create_input_:function(t){var e,i=this._obj;i.radio?e=WCT.dom.CreateInputElement("radio",i.radiogroupname):(e=$$("input")).type="checkbox",e.id=this._id+"#main#check",e.className="InputRadioControl",e.style.position="relative",e.setAttribute("aria-label",i.name),"number"==typeof i.tabindex&&e.setAttribute("tabindex",i.tabindex),t.appendChild(e),this.dom_radio_=i.radio,this.dom_gname_=i.radiogroupname},_create_dom:function(){var t=$$("div");t.id=this._id+"#main#dom",t.className="InputRadioControl",t.style.display="block",t.style.position="absolute",t.style.overflow="visible",this.create_input_(t),Canvas.Parent().appendChild(t)},_cancelChanges:function(t){var e=t||window.event,i=(e.srcElement||e.target).id.split("#")[0];InputRadioControl.set_checked.call(this,this._obj,"checked",this._obj.checked),Controls[i]&&Controls[i]._setFirstChecked()},_setFirstChecked:function(){var t=this._obj;if("inputradio"===t.type&&t.radio&&t.radiogroupname){var e=t.radiogroupname,i=!1;for(var o in Controls){var r=Controls[o];if(r){var n=r._obj;if("inputradio"===n.type&&n.radio&&n.radiogroupname===e)if(i){if(n.checked){r.SetParam("checked",!1),this._get_el("#main#check").setAttribute("aria-checked",!1)}}else n.checked&&(i=!0,InputRadioControl.set_checked.call(r,n,"checked",1))}}}},_setAllUncheckedExceptThis:function(){var t=this._obj,e=arguments[0]||!1;if("inputradio"===t.type&&t.radio&&t.radiogroupname){var i=t.radiogroupname;for(var o in Controls){var r=Controls[o];if(r){var n=r._obj;if("inputradio"===n.type&&n.radio&&n.radiogroupname===i&&r!==this&&n.checked)e||r.SetParam("checked",!1),r._get_el("#main#check").setAttribute("aria-checked",!1)}}}},_rd_get_min_rect:function(t){return{w:13,h:13}},_update_dom:function(t){if(!this._disable_dom_update){RectControl.prototype._update_dom.call(this,t);var e=this._get_el();if(e&&(e.style.padding="0",e.style.margin="0",e.style.fontSize="1px"),e=this._get_el("#main#check")){var i=t||this._obj;e.style.padding="0",e.style.margin="0";var o=this.IsRTL()?"right":"left";e.style[o]=Math.max(i.w-13>>1,0)+"px",e.style.top=Math.max(i.h-13>>1,0)+"px",e.style.width="13px",e.style.height="13px",this._update_hit_areas()}}},Tick:function(t){var e=this._get_el("#main#check");if(e){this.last_tick_=t;var i=this._obj,o=e.checked;o!=i.last_checked?(i.last_checked=o,i.onchange&&Page.RTFireTrigger(i.onchange),i.set_variable&&Page.SetVariable(i.set_variable,o?"1":"0"),o?i.oncheck&&Page.RTFireTrigger(i.oncheck):i.onuncheck&&Page.RTFireTrigger(i.onuncheck),this.Check(!0)):null!=this.force_check_&&t>=this.force_check_&&(this.Check(!1),this.force_check_=null)}},Check:function(t){var e=this._get_el("#main#check");if(e){var i=this._obj;!e.checked&&i.radio&&t||(e.checked==as_boolean(i.choose)?i.oncorrectanswer&&(Page.RTFireTrigger(i.oncorrectanswer,this._id),t&&!this.force_check_&&EventMaster.IgnoreNextForTarget(this._id)):i.onwronganswer&&(Page.RTFireTrigger(i.onwronganswer,null,this._id),t&&!this.force_check_&&EventMaster.IgnoreNextForTarget(this._id)))}},OnRTMouseDown:function(t){if(BROWSER.MOBILE){var e=this._get_el("#main#check");e&&e.type&&(e.checked="radio"===e.type||!e.checked,this.force_check_=null==this.last_tick_||this.last_tick_+200)}},OnRTMouseClick:function(t){this._obj.onclick&&Page.RTFireTrigger(this._obj.onclick),this._setAllUncheckedExceptThis(!0);var e=this._get_el("#main#check");e.setAttribute("aria-checked",!as_boolean(e.getAttribute("aria-checked"))),13!==t.button&&32!==t.button||(e.checked="radio"===e.type||!e.checked),this.force_check_=null==this.last_tick_||this.last_tick_+200},OnMouseClick:function(t){this._cancelChanges(t)},OnMouseDblClick:function(t){this._cancelChanges(t)},_on_set_preview:function(t){var e=this._obj;(e.fire_events||e.set_variable)&&(t?Ticker.Register(this._id,!0):Ticker.Unregister(this._id))},RTFireTrigger:function(t,i){var o=this._get_el("#main#check");if(o){var r=this._obj;switch(t){case"show":r.hidden=!1,set_hidden.call(this,r,"hidden",r.hidden),r.onshow&&Page.RTFireTrigger(r.onshow);break;case"hide":r.hidden=!0,set_hidden.call(this,r,"hidden",r.hidden),r.onhide&&Page.RTFireTrigger(r.onhide);break;case"toggle":return this.RTFireTrigger(r.hidden?"show":"hide",i);case"focus":try{o.focus()}catch(e){}break;case"check":o.checked||(o.checked=!0,o.setAttribute("aria-checked",!0)),r.last_checked=!0,this.force_check_=null,r.oncheck&&Page.RTFireTrigger(r.oncheck);break;case"uncheck":o.checked&&(o.checked=!1,o.setAttribute("aria-checked",!1)),r.last_checked=!1,this.force_check_=null,r.onuncheck&&Page.RTFireTrigger(r.onuncheck);break;case"togglecheck":o.setAttribute("aria-checked",!o.checked),o.checked=!o.checked;break;case"checkvalue":this.Check(!1);break;case"enable":this.SetParam("disabled",!1);break;case"disable":this.SetParam("disabled",!0);break;case"activate":Ticker.Register(this._id,!0),r.form_mode&&this.Check(!1);break;case"deactivate":Ticker.Unregister(this._id);break;default:EDIT_MODE&&Editor.RuntimeInfo("no trigger: "+t)}}}}),InputSelectControl.prototype=new RectControl,InputSelectControl.set_cursor=function(t,e,i){SlideControl.set_cursor.call(this,i?"pointer":"")},InputSelectControl.SetValues=function(t,e,i){var o=-1,r=null,n=null,s=0;if(i){for(s=(r=(i=WCT.CleanupHTMLString(i)).split("\n")).length;1<s&&""==r[s-1];)r.pop(),s--;n=new Array(s);for(var a=s-1;0<=a;a--)0<=r[a].indexOf("{*}")?(n[a]={v:a,t:r[a].substr(3)},o=a,t.set_variable&&Page.SetVariable(t.set_variable,n[a].t)):n[a]={v:a,t:r[a]};this.sel_=o,this.list_=r,this.list2_=n}var _=this._get_el();if(_&&(_.innerHTML="",s)){var l=this._id+"#option#";for(a=0;a<s;a++){var d=n[a].t,h=a,c=d.indexOf("|");0<=c&&(h=d.substr(0,c),d=d.substr(c+1),n[a].t=d);var p=$$("option");p.id=l+h,p.value=h,p.innerHTML=d,_.appendChild(p)}0<=o&&(t.choose_nr==o||t.choose_text==n[o].t?(o=-1,this.sel_=o,_.onfocus=function(){this.selectedIndex="-1"}):o<s&&(_.selectedIndex=o))}},WCT.ExtendObject(InputSelectControl.prototype,{Terminate:function(){this.list_=null,this.list2_=null,RectControl.prototype.Terminate.call(this)},InitEdit:function(){RectControl.prototype.InitEdit.call(this,arguments[0],!1,!0)},_create_dom:function(){var t=WCT.dom.CreateElementMSIE("select",null,this._id);t.id=this._id+"#main#dom",t.className="InputSelectControl",t.size="1",t.style.position="absolute";var e=this._obj;"number"==typeof e.tabindex&&t.setAttribute("tabindex",e.tabindex),Canvas.Parent().appendChild(t)},_remove_dom:function(){var t=this._get_el();t&&this.have_event_handler_&&(WCT.event.StopObserving("change",rt_hdl_change,t),delete this.have_event_handler_),RectControl.prototype._remove_dom.call(this)},OnRTMouseClick:function(t){this._obj.onclick&&Page.RTFireTrigger(this._obj.onclick),EventMaster.IgnoreNextForTarget(this._id)},OnRTChange:function(t){this.check_()},check_:function(){var t=this._get_el(),e=t?t.selectedIndex:-1;if(!(e<0||e==this.sel_&&!arguments[0])){var i=this._obj,o=this.list2_[e],r=o&&o.t||"",n=o&&o.v||"";if(i.set_variable&&Page.SetVariable(i.set_variable,r),i.onchange&&Page.RTFireTrigger(i.onchange,{text:r,value:n}),e==i.choose_nr||i.choose_nr<0&&r==i.choose_text)i.oncorrectanswer&&Page.RTFireTrigger(i.oncorrectanswer,this._id);else if(i.onwronganswer){var s=Dict_get("EXER_YOURINPUT").replace(/@1_input_/g,r),a=Dict_get("EXER_SELECT").replace(/@1/g,i.choose_text||"");Page.RTFireTrigger(i.onwronganswer,s+" "+a,this._id)}this.sel_=e}},RTFireTrigger:function(t,i){var o=this._get_el();if(o){var r=this._obj;switch(t){case"show":r.hidden=!1,set_hidden.call(this,r,"hidden",r.hidden),r.onshow&&Page.RTFireTrigger(r.onshow);break;case"hide":r.hidden=!0,set_hidden.call(this,r,"hidden",r.hidden),r.onhide&&Page.RTFireTrigger(r.onhide);break;case"toggle":return this.RTFireTrigger(r.hidden?"show":"hide",i);case"focus":try{o.focus()}catch(e){}break;case"checkvalue":this.check_(!0);break;case"select":this.SelectItem(r.choose_nr);break;case"activate":r.form_mode&&this.check_(!0);break;default:EDIT_MODE&&Editor.RuntimeInfo("no trigger: "+t)}}},_on_set_preview:function(t){var e=this._get_el();t?(this._obj.fire_events||this._obj.set_variable)&&(WCT.event.Observe("change",rt_hdl_change,e),this.have_event_handler_=!0):this.have_event_handler_&&(WCT.event.StopObserving("change",rt_hdl_change,e),delete this.have_event_handler_)},SelectItem:function(t){this._get_el().selectedIndex=t,this.sel_=t}}),ActivityControl.prototype=new RectControl,WCT.ExtendObject(ActivityControl,{LINK_HEIGHT:20,set_h:function(t,e,i){i?set_h.call(this,t,e,i):i=this._obj.h;var o=this._get_el("#main#process_title");if(o){var r=ActivityControl.LINK_HEIGHT,n=this._get_el("#main#role").offsetHeight,s=o.offsetHeight,a=i-r-n-2*(this._obj.border+this._obj.padding);o.style.top=Math.max(r,(a-s>>1)+r)+"px"}},set_text:function(t,e,i){var o=this._get_el("#main#"+e);i=replace_placeholder(i),i=Context.ResolveHtmlString(i,this._src_ctx),i=Page.HighlightHtmlString(i),o.innerHTML=i,ActivityControl.set_h.call(this)},set_font_family:function(t,e,i){var o=0<e.search("_role")?"role":"process_title";this._get_el("#main#"+o).style.fontFamily=i,ActivityControl.set_h.call(this)},set_font_size:function(t,e,i){var o=0<e.search("_role")?"role":"process_title",r=this._get_el("#main#"+o),n=Controls&&Controls.page||null;if(i){var s=n&&n._obj&&n._obj.fontsizeInPt?"pt":"px";r.style.fontSize=i+s}ActivityControl.set_h.call(this)},set_color:function(t,e,i){var o=0<e.search("_role")?"role":"process_title";this._get_el("#main#"+o).style.color=i},set_background_color:function(t,e,i){var o=0<e.search("_role")?"role":"dom";this._get_el("#main#"+o).style.backgroundColor=i},set_border_color:function(t,e,i){set_border_color.call(this,t,e,i),this._get_el("#main#role").style.borderTop="1px solid "+i},set_align:function(t,e,i){var o=0<e.search("_role")?"role":"process_title";this._get_el("#main#"+o).style.textAlign=get_correct_align(i)},show_delete_icon:function(t,e,i){var o=this._get_el("#main#delete");i?(o.style.display="block",o.style.display=""):o.style.display="none",this.img_info_.delete_icon.visible=!!i,this._update_hit_areas()},hide_role:function(t,e,i){var o=i?"hidden":"visible";this._get_el("#main#role").style.visibility=o},show_plus_icon:function(t,e,i){var o=this._get_el("#main#plus");i?(o.style.display="block",o.style.display=""):o.style.display="none",this.img_info_.plus_icon.visible=!!i,this._update_hit_areas()},show_edit_icon:function(t,e,i){var o=this._get_el("#main#edit");i?(o.style.display="block",o.style.display=""):o.style.display="none",this.img_info_.edit_icon.visible=!!i,this._update_hit_areas()},set_subdivision_link:function(t,e,i){var o=this._get_el("#main#subdiv");i?(o.style.display="block",o.style.display=""):o.style.display="none",this._subdivision_link=i,this.img_info_.subdiv_icon.visible=!!i,this._update_hit_areas()},set_attachment_link:function(t,e,i){var o=parseInt(e.substr(e.lastIndexOf("_")+1)),r=-1!==e.indexOf("link")?"link":-1!==e.indexOf("caption")?"caption":"forceDownload",n=this.attachments_,s=n.length;n[o]||(n[o]={}),n[o][r]=i;for(var a=!1,_=0;_<s;_++)if(n[_]&&n[_].link){a=!0;break}var l=this._get_el("#main#clip");a?(l.style.display="block",l.style.display=""):l.style.display="none",this.img_info_.clip_icon.visible=a,this._update_hit_areas()},set_note:function(t,e,i){var o=this._get_el("#main#bubble");i?(o.style.display="block",o.style.display=""):o.style.display="none",this.img_info_.bubble_icon.visible=!!i,this._update_hit_areas()}}),WCT.ExtendObject(ActivityControl.prototype,{Terminate:function(){this.attachments_=null,this.img_info_=null,RectControl.prototype.Terminate.call(this)},_create_dom:function(){var t=$$("div"),e=this._id;t.id=e+"#main#dom",t.className="ActivityControl",t.setAttribute("role","group"),t.setAttribute("aria-labelledby",e+"#main#process_title"),t.setAttribute("aria-describedby",e+"#main#role"),t.style.position="absolute",t.style.overflow="hidden";var i=this._obj;(i.onclick||i.onleave||i.onenter)&&t.setAttribute("role","button");var o=$$("div");o.id=e+"#main#linkline",o.setAttribute("role","banner"),o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.overflow="hidden",o.style.height=ActivityControl.LINK_HEIGHT+"px",o.style.lineHeight=ActivityControl.LINK_HEIGHT+"px",o.style.width="100%",o.style.verticalAlign="middle",t.appendChild(o);for(var r=this.get_todo_(),n=0,s=null;s=r[n];n++){var a=$$("div"),_={l:{d:"left",i:"offset_l"},r:{d:"right",i:"offset_r"}}[s.off||"l"];a.id=e+s.id,a.tabIndex=i.tabindex,a.setAttribute("role","button"),a.style.display="none",a.style.position="absolute",a.style.width=s.ico.offset_w+"px",a.style.height=s.ico.offset_h+"px",a.style[_.d]=s.ico[_.i]+"px",a.style.top=s.ico.offset_t+"px",set_trans_bg(a,s.bg,!1),o.appendChild(a);var l={"#main#clip":"SLIDE_SHOWATTACH","#main#plus":"SLIDE_ADD","#main#edit":"SLIDE_EDIT","#main#delete":"SLIDE_DELETE","#main#subdiv":"SLIDE_OPEN","#main#bubble":"SLIDE_MOREINFO"};l.hasOwnProperty(s.id)&&a.setAttribute("title",ctx.cfg_tr(l[s.id]))}var d=$$("div");d.id=e+"#main#process_title",d.setAttribute("role","heading"),d.className="dgo_text_container",d.setAttribute("data-placeholder","Enter process title...");var h=d.style;h.position="absolute",h.top=ActivityControl.LINK_HEIGHT+"px",h.left="0",h.overflow="hidden",h.width="100%",t.appendChild(d);var c=$$("div");c.id=e+"#main#role",c.className="dgo_text_container",c.setAttribute("data-placeholder","Enter role name...");var p=c.style;p.position="absolute",p.bottom="0",p.left="0",p.overflow="hidden",p.paddingTop="2px",p.paddingBottom="2px",p.width="100%",p.minHeight="15px",p.verticalAlign="middle",t.appendChild(c),Canvas.Parent().appendChild(t),this._update_hit_areas()},_remove_dom:function(){this.hide_attachments_(),this.hide_note_(),RectControl.prototype._remove_dom.call(this)},_update_dom:function(t){RectControl.prototype._update_dom.call(this,t),ActivityControl.set_h.call(this),this._update_hit_areas()},_update_hit_areas:function(){if(HitManager.clearHitControl(this._id),!this.isHidden()){var t=this._obj,e="default";if(this._cursor?e=this._cursor:(this._link_to||t.ondown||t.onclick||t.ondblclick)&&(e="pointer"),!t.hidden){HitManager.setHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"dom",x:t.x,y:t.y,w:t.w,h:t.h,z:t.z,type:"rect",cursor:e});var i=this.IsRTL(),o=0,r=this.img_info_.subdiv_icon;r.visible&&(o=i?t.x+t.w-t.border-r.offset_w-r.offset_l:t.x+t.border+r.offset_l,this.set_hitarea_(o,"subdiv"));var n=this.img_info_.clip_icon;n.visible&&(o=i?t.x+t.w-t.border-n.offset_l-n.offset_w:t.x+t.border+n.offset_l,this.set_hitarea_(o,"clip"));var s=this.img_info_.bubble_icon;s.visible&&(o=i?t.x+t.border+s.offset_r:t.x+t.w-t.border-s.offset_r-s.offset_w,this.set_hitarea_(o,"bubble"));var a=this.img_info_.delete_icon;a.visible&&(o=i?t.x+a.offset_r:t.x+t.w-a.offset_r-a.offset_w,this.set_hitarea_(o,"delete"));var _=this.img_info_.plus_icon;_.visible&&(o=i?t.x+_.offset_r:t.x+t.w-_.offset_r-_.offset_w,this.set_hitarea_(o,"plus"));var l=this.img_info_.edit_icon;l.visible&&(o=i?t.x+l.offset_r:t.x+t.w-l.offset_r-l.offset_w,this.set_hitarea_(o,"edit"))}}},set_hitarea_:function(t,e){var i=this._obj,o=this.img_info_[e+"_icon"];HitManager.setHitArea({ctl_id:this._id,sub_id:"main",hdl_id:e,x:t,y:i.y+i.border+o.offset_t,w:o.offset_w,h:o.offset_h,z:i.z+.4,type:"rect",cursor:"pointer"})},_exec_link:function(){this._subdivision_link&&(pauseMedia(),ctx.cfg_show(this._subdivision_link,!1,null,null))},show_attachments_:function(){if(!this.attachments_visible_){var t=this._obj,e=this.IsRTL(),i=[],o=getNewWindowFormatString(t),r="true";"undefined"!=typeof t.openInNewWindow&&(r=t.openInNewWindow?"true":"false");for(var n=this.attachments_,s=0,a=n.length;s<a;s++){var _;if((_=n[s])&&_.link){var l=WCT.CleanupHTMLString(_.caption?Page.HighlightHtmlString(_.caption):_.link),d=_.link;if(_.forceDownload){var h=d.split("?");d=h[0]+"?download=1"+(h[1]?"&"+h[1]:"")}i.push("<a onclick=\"ctx.cfg_show('",d,"', ",r,", '",o,'\')" role="listitem" ','tabindex="',t.tabindex,'"','style="text-decoration:none;color:#000;font-size:8pt;',t.font_family?"font-family:"+t.font_family:"",';" ','href="javascript:void(0);">',l,"</a><br/>")}}if(!(_=this._get_el("#main#attachment"))){(_=$$("div")).id=this._id+"#main#attachment",_.className="attachment",_.setAttribute("role","list");var c=_.style;c.position="absolute",c.backgroundColor="#fff",c.border="1px solid "+(t.border_color||"#666"),c.zIndex="1000",c.padding="4px",c.direction=e?"rtl":"",Canvas.Frame().appendChild(_)}_.innerHTML=i.join("");var p=this.img_info_.clip_icon,u=_.offsetWidth||0,f=e?t.x+t.w-p.offset_l-p.offset_w-u:t.x+p.offset_l+p.offset_w,m=t.y,g=Canvas.ToFrame(f,m),y=Canvas.FrameW();e?-f>Canvas.x()&&(g.x=0,g.y=g.y+20):g.x+u>y&&(g.x=Math.max(0,y-u),g.y=g.y+20),_.style.left=g.x+"px",_.style.top=g.y+"px",HitManager.setHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"attachment",x:f,y:m,w:u,h:_.offsetHeight,z:t.z+.6,type:"rect"}),this.attachments_visible_=!0,(a=_.getElementsByTagName("a")[0])&&a.focus()}},show_note_:function(){if(!this.note_visible_){var t=this._obj,e=this.IsRTL(),i=this._get_el("#main#note");i||((i=$$("div")).style.position="absolute",i.id=this._id+"#main#note",i.style.visibility="hidden",i.style.backgroundColor="#fff",i.style.border="1px solid "+(t.border_color||"#666"),i.style.borderColor=t.border_color,i.style.zIndex="1000",i.style.padding="4px",i.style.fontFamily=t.font_family||"",i.style.color="#000",i.style.fontSize="8pt",i.setAttribute("dir",e?"rtl":"ltr"),i.setAttribute("role","note"),i.tabIndex=t.tabindex,i.className="note dgo_text_container",i.style.visibility="visible",Canvas.Frame().appendChild(i),i.focus());var o=Context.ResolveHtmlString(t.note,this._src_ctx);o=replace_placeholder(o),o=Page.HighlightHtmlString(o),i.innerHTML=o;var r=i.offsetWidth||200,n=t.x+(e?-r:t.w),s=t.y,a=Canvas.ToFrame(n,s),_=Canvas.FrameW();e?r>Canvas.x()&&(a.x=0,a.y=a.y+20):a.x+r>_&&(a.x=Math.max(0,_-r),a.y=a.y+20),a.x-=1,i.style.left=a.x+"px",i.style.top=a.y+"px",this.note_visible_=!0}},hide_note_:function(){if(this.note_visible_){var t=this._get_el("#main#note");t&&(Canvas.Frame().removeChild(t),HitManager.clearHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"note"}),this.note_visible_=!1),this._get_el("#main#bubble").focus()}},hide_attachments_:function(){if(this.attachments_visible_){var t=this._get_el("#main#attachment");t&&(Canvas.Frame().removeChild(t),HitManager.clearHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"attachment"}),this.attachments_visible_=!1)}},get_todo_:function(){var t=this.img_info_;return[{id:"#main#subdiv",ico:t.subdiv_icon,bg:"book_style:arrow_down.png"},{id:"#main#clip",ico:t.clip_icon,bg:"book_style:clip.png"},{id:"#main#bubble",ico:t.bubble_icon,bg:"book_style:min_bubble.png",off:"r"},{id:"#main#delete",ico:t.delete_icon,bg:location.href.replace(/[\\\/][^\\\/]+[\\\/][^\\\/]*$/gi,"/resources/se_del.png"),off:"r"},{id:"#main#plus",ico:t.plus_icon,bg:location.href.replace(/[\\\/][^\\\/]+[\\\/][^\\\/]*$/gi,"/resources/se_add.png"),off:"r"},{id:"#main#edit",ico:t.edit_icon,bg:location.href.replace(/[\\\/][^\\\/]+[\\\/][^\\\/]*$/gi,"/resources/se_edit.png"),off:"r"}]},SetDirection:function(t){SlideControl.prototype.SetDirection.call(this,t);for(var e=this.get_todo_(),i=0,o=null;o=e[i];i++){var r=this._get_el(o.id),n={l:{d:"left",i:"offset_l"},r:{d:"right",i:"offset_r"}}[o.off||"l"];r.style.left="",r.style.right="",this.IsRTL()?r.style["left"==n.d?"right":"left"]=o.ico[n.i]+"px":r.style[n.d]=o.ico[n.i]+"px"}this._update_hit_areas()},OnRTMouseClick:function(t){switch(t.hdl_id){case"subdiv":this.hide_attachments_(),this.hide_note_(),this._exec_link();break;case"clip":this.hide_note_(),this[this.attachments_visible_?"hide_attachments_":"show_attachments_"](),RT.AddHook("click",ActivityControl.prototype.HidePopups,this._id);break;case"bubble":this.hide_attachments_(),this[this.note_visible_?"hide_note_":"show_note_"](),RT.AddHook("click",ActivityControl.prototype.HidePopups,this._id);break;case"delete":ctx&&ctx.cfg_show(this._id+".delete");break;default:this.img_info_.plus_icon.visible?ctx&&ctx.cfg_show(this._id+".plus"):this.img_info_.edit_icon.visible&&ctx&&ctx.cfg_show(this._id+".edit"),this.hide_attachments_(),this.hide_note_(),this._obj&&this._obj.onclick&&Page.RTFireTrigger(this._obj.onclick)}},OnRTMouseEnter:function(t){this._obj.onenter&&Page.RTFireTrigger(this._obj.onenter)},OnRTMouseLeave:function(t){this._obj.onleave&&Page.RTFireTrigger(this._obj.onleave)},RTFireTrigger:function(t,e){if(RectControl.prototype.RTFireTrigger.apply(this,arguments))return!0;var i=this._obj;switch(t){case"follow_link":this._exec_link();break;case"update_placeholder":ActivityControl.set_text.call(this,i,"process_title",i.process_title),ActivityControl.set_text.call(this,i,"role",i.role);break;default:EDIT_MODE&&Editor.RuntimeInfo("no trigger: "+t)}},OnViewResize:function(){(this.attachments_visible_||this.note_visible_)&&(this.hide_attachments_(),this.hide_note_(),this.note_visible_&&this.show_note_(),this.attachments_visible_&&this.show_attachments_())},_on_set_preview:function(t){t||(this.hide_attachments_(),this.hide_note_(),this.attachments_visible_=!1,this.note_visible_=!1)},HidePopups:function(t){var e=null;t.target&&(e=t.target.split("#").slice(-1)[0]),"bubble"!==e&&this.note_visible_&&this.hide_note_(),"clip"!==e&&this.attachments_visible_&&this.hide_attachments_()},OnDefaultEdit:function(t){var e=this._obj,i=WCT.DeepCopy(e),o={id:""},r=Canvas.ToFrame(t.canvasX,t.canvasY),n=getHtmlPosSize(this._get_el("#main#role"),!0),s=getHtmlPosSize(this._get_el(),!0);return s.h-=n.h,r.x=Math.round(r.x),r.y=Math.round(r.y),pt_in_rect4(r.x,r.y,s.x,s.x+s.w,s.y,s.y+s.h)?(o.id="process_title",o.pos=s,o.pos.y+=ActivityControl.LINK_HEIGHT):pt_in_rect4(r.x,r.y,n.x,n.x+n.w,n.y,n.y+n.h)&&(o.id="role",o.pos=n,i.background_color=e.background_color_role,i.text_color=e.text_color_role,i.font_size=e.font_size_role,i.font_family=e.font_family_role,i.align=e.align_role),o.id&&(o.pos.x-=1,o.pos.w-=2,o.pos.y+=1,o.pos.h-=2,Canvas.ApplyScaleToPos(o.pos),o.pos.x-=Page.scrollLeft,o.pos.y-=Page.scrollTop,Env.edit({ctlId:this._id,paramName:o.id,posSize:o.pos,extInfo:i})),!0}}),WCT.ExtendObject(_Mouse,{IsEnter:function(t){return 0<=t.chain.search(/-enter$/)?1:2},IsDrag:function(t){var e=t.chain;if(0<=e.search(/-mousedown.*-mouseup/))return 0;if(0<=e.search(/-mousedown.*-leave$/))return 1;if(0<=e.search(/-mousedown.*-mousemove$/))for(var i=0,o=null;o=t[i++];)if("mousedown"==o.type){var r=t.length-1;if(16<=Math.abs(o.canvasX-t[r].canvasX)+Math.abs(o.canvasY-t[r].canvasY))return 1;break}return 2},IsDrop:function(t){var e=t.chain;return e.search(/-mousedown|-click/)<0?0<=e.search(/-mouseup$/)?1:2:0},IsClick:function(t){var e=t.chain;if(0<=e.search(/(-mousedown.*?-mouseup.*?-mousedown.*?(-mouseup|-click))$|(-dblclick)/))return 0;if("-click"==e)return-1;var i=t.length-1,o=t[i];if(0<=e.search(/-click$/)){if(null==o.button)for(var r=i-1;0<=r;r--)if(null!=t[r].button){o.button=t[r].button;break}return 1}return 3===o.button&&0<=e.search(/-mousedown.*?-mouseup$/)?1:(BROWSER.EDGE||BROWSER.CHROME||BROWSER.FIREFOX)&&2===o.button&&0<=e.search(/-mousedown.*?-mouseup$/)?1:2},IsDblClick:function(t){var e=t.chain,i=t.length-1,o=t[i];if(0<=e.search(/-dblclick$/)){if(null==o.button)for(var r=i-1;0<=r;r--)if(null!=t[r].button){o.button=t[r].button;break}return 1}if((BROWSER.IE||BROWSER.SAFARI)&&(3==o.button||2==o.button)&&0<=e.search(/(-mousedown.*?-mouseup.*?-mousedown.*?(-mouseup|-click))$/))return 1;var n=e.indexOf("-mouseup");if(0<=n){var s=e.indexOf("-mousedown",n+1);if(0<=s){var a=e.indexOf("-click",n+1);if(s<a||a<0)return-(n+8)}}return 2}}),_Mouse.prototype={Terminate:function(){this.skin_=null,this.client_=null,this.mod_ctrl_off_=null,this.mod_alt_off_=null,this.mod_shift_off_=null},SetSkin:function(t){this.skin_=t},Show:function(){if(!this.visible_){this.check_skin_();var t=this.skin_||{w:0,h:0},e=$$("div");e.id=this.id_,e.style.position="absolute",e.style.left=this.cur_x_+"px",e.style.top=this.cur_y_+"px",e.style.width=t.w+"px",e.style.height=t.h+"px",e.style.zIndex=1e5,e.style.backgroundRepeat="no-repeat",Canvas.Parent().appendChild(e),this.set_mouse_("idle"),this.visible_=!0}},Hide:function(){if(this.visible_){Mouse.StopAni();var t=$(this.id_);t&&t.parentNode.removeChild(t),this.cur_url_=null,this.visible_=!1}},Tick:function(t){if("move"==this.phase_){var e=0<this.ani_dur_?WCT.Ease.SineOut(t/this.ani_dur_):0,i=1-4*Math.pow(e-.5,2),o=this.dx_,r=this.dy_;this.set_pos_(this.start_x_+o*e+i*r*.03,this.start_y_+r*e-i*-(Math.abs(o)+Math.abs(r)-50)*.07)}switch(t-=this.ani_dur_,this.phase_){case"move":if(t<0)break;this.set_pos_(this.tar_x_,this.tar_y_),this.show_modifiers_();var n=null;switch(this.pmax_=null,this.action_){case"drag":case"rdrag":this.pmax_=2,n="mousedown";case"lclick":case"mclick":case"rclick":this.pmax_=this.pmax_||3,n=n||"click";case"ldblclick":case"mdblclick":case"rdblclick":this.set_mouse_(this.action_+"1"),this.phase_="click",this.pcount_=1,this.pmouse_="2",this.pmax_=this.pmax_||5,n=n||"dclick";break;case"drop":case"rdrop":this.phase_="drop",this.pcount_=1;break;default:this.StopAni(!0)}n&&this.play_sound_(n);break;case"click":t>=this.click_dur_/this.pmax_*this.pcount_&&(this.pcount_+1>this.pmax_?this.StopAni(!0):(this.set_mouse_(this.action_+this.pmouse_),this.pmouse_=this.pcount_++%2?"1":"2"));break;case"drop":if(t>=this.click_dur_/2*this.pcount_)if(2==++this.pcount_){var s="drop"==this.action_?"drag1":"rdrag1";this.hide_drag_img_(),this.set_mouse_(s),this.play_sound_("mouseup")}else this.StopAni(!0)}},StartAni:function(t,e){if(this.StopAni(),this.visible_){!1===Env.GetConfig("disable_fx")&&(Media.audio.Unmute("mouse_fx"),Media.audio.Autostart("mouse_fx",!1),Media.audio.Loop("mouse_fx",!1),Media.audio.Volume("mouse_fx",100)),this.first_&&(this.first_=!1,this.cur_x_=.5*Page.clientWidth,this.cur_y_=.5*Page.clientHeight),this.start_x_=this.cur_x_,this.start_y_=this.cur_y_,this.tar_x_=e.x,this.tar_y_=e.y,this.dx_=this.tar_x_-this.start_x_,this.dy_=this.tar_y_-this.start_y_,this.client_=t,this.action_=e.action,this.ani_dur_=e.duration,this.click_dur_=0,this.drag_img_=null,this.mod_ctrl_=e.ctrl||!1,this.mod_alt_=e.alt||!1,this.mod_shift_=e.shift||!1;var i="move";switch(this.action_){case"lclick":case"mclick":case"rclick":case"drag":case"rdrag":this.click_dur_=Math.min(this.ani_dur_/3*2,1e3),this.set_mouse_(i);break;case"ldblclick":case"mdblclick":case"rdblclick":this.click_dur_=Math.min(this.ani_dur_/3*2,1200),this.set_mouse_(i);break;case"dragdrop":this.action_="drop";case"drop":i="drag2";case"rdrop":"move"==i&&(i="rdrag2");case"ndrop":this.click_dur_=Math.min(this.ani_dur_/3*2,1e3);var o=e.drag_image;o&&o.id?(this.drag_img_=o.id,this.drag_off_x_=e.drag_off_x||0,this.drag_off_y_=e.drag_off_y||0):this.drag_img_=null,this.show_drag_img_(),"move"!=i&&this.show_modifiers_(),this.set_mouse_(i);break;case"enter":default:this.action_="move",this.set_mouse_("move")}this.ani_dur_-=this.click_dur_,this.phase_="move",Ticker.RegisterJS(this,"mouseanimator")}},StopAni:function(){if("idle"!=this.phase_&&(Ticker.UnregisterJS("mouseanimator"),this.hide_drag_img_(),this.hide_modifiers_(),this.set_mouse_("idle"),this.phase_="idle",arguments[0])){var t=this.client_;t&&t._ani_finished_cb&&(this.client_=null,t._ani_finished_cb())}},set_mouse_:function(t){var e=$(this.id_),i=this.skin_?this.skin_[t]||this.skin_.idle:null;e&&i&&(e.style.backgroundPosition=i.x+"px "+i.y+"px",i.id!=this.cur_url_&&(e.style.backgroundImage="url("+i.id+")",this.cur_url_=i.id))},show_drag_img_:function(){if(this.drag_img_){var t=createSourceContext({_this:"slide"}),e=$$("img");e.id=this.id_+"#dragimg",e.style.position="absolute",e.style.left=this.cur_x_+this.drag_off_x_+"px",e.style.top=this.cur_y_+this.drag_off_y_+"px",e.style.zIndex=99999,e.src=Context.ToAbsPath(this.drag_img_,t),Canvas.Parent().appendChild(e)}},hide_drag_img_:function(){var t=$(this.id_+"#dragimg");t&&t.parentNode.removeChild(t)},show_modifier_:function(t){var e=$(this.id_+"#modifier_"+t),i=this.skin_&&this.skin_.modifiers||null;!e&&i&&i[t]&&((e=$$("div")).id=this.id_+"#modifier_"+t,e.style.position="absolute",e.style.width=i.w+"px",e.style.height=i.h+"px",e.style.backgroundPosition=i[t].x+"px "+i[t].y+"px",e.style.backgroundRepeat="no-repeat",e.style.backgroundImage="url("+i[t].id+")",e.style.zIndex=99999,Canvas.Parent().appendChild(e))},move_modifier_:function(t){var e=$(this.id_+"#modifier_"+t);if(e){var i=this["mod_"+t+"_off_"]||{x:0,y:0};e.style.left=this.cur_x_+i.x+"px",e.style.top=this.cur_y_+i.y+"px"}},hide_modifier_:function(t){var e=$(this.id_+"#modifier_"+t);e&&e.parentNode.removeChild(e)},show_modifiers_:function(){var t=this.skin_||{w:0,h:0},e=t.modifiers&&t.modifiers.h||0,i=0;this.mod_ctrl_&&(this.mod_ctrl_off_={x:t.w,y:i},this.show_modifier_("ctrl"),this.move_modifier_("ctrl"),i+=e),this.mod_alt_&&(this.mod_alt_off_={x:t.w,y:i},this.show_modifier_("alt"),this.move_modifier_("alt"),i+=e),this.mod_shift_&&(this.mod_shift_off_={x:t.w,y:i},this.show_modifier_("shift"),this.move_modifier_("shift"))},hide_modifiers_:function(){this.mod_ctrl_&&this.hide_modifier_("ctrl"),this.mod_alt_&&this.hide_modifier_("alt"),this.mod_shift_&&this.hide_modifier_("shift")},play_sound_:function(t){if(!1===Env.GetConfig("disable_fx")){var e="adaptable!sim_sounds:"+t+".wav",i=createSourceContext({_this:"slide"});Media.audio.Source("mouse_fx",e,i),Media.audio.Play("mouse_fx")}},set_pos_:function(t,e){this.cur_x_=t,this.cur_y_=e;var i=this.id_,o=$(i);if(o&&(o.style.left=t+"px",o.style.top=e+"px"),this.mod_ctrl_&&this.move_modifier_("ctrl"),this.mod_alt_&&this.move_modifier_("alt"),this.mod_shift_&&this.move_modifier_("shift"),this.drag_img_){var r=$(i+"#dragimg");r&&(r.style.left=t+this.drag_off_x_+"px",r.style.top=e+this.drag_off_y_+"px")}},check_skin_:function(){if(!this.skin_){var s=Context.Resolve("skin:mouse.txt");if(s=Env.LoadFile(s),"string"==typeof s)try{s=eval("("+s+")")}catch(e){s=null}if(s&&s.standard){var url=Context.ToAbsPath("skin:")+"/";this.extend_skin_urls_(s.standard,url),this.skin_=s.standard}else this.skin_=null}},extend_skin_urls_:function(t,e){for(var i in t)"object"==typeof t[i]&&t[i]&&(t[i].id?t[i].id=e+t[i].id:this.extend_skin_urls_(t[i],e))}},Mouse=new _Mouse,MouseControl.prototype=new RectControl,MouseControl.DEF_BG="#FEBAFE",MouseControl.HI_BG="#BAFEFE",WCT.ExtendObject(MouseControl.prototype,{InitEdit:function(){RectControl.prototype.InitEdit.call(this,{w:24,h:24,r:0,z:1e3})},_create_dom:function(){var t=$$("div");t.id=this._id+"#main#dom",t.className="MouseControl",t.style.position="absolute",t.style.overflow="hidden",t.style.padding="0px",t.style.textAlign="center",t.style.fontFamily="Courier New",t.style.fontSize="1pt",t.style.backgroundColor=MouseControl.DEF_BG,Canvas.Parent().appendChild(t)},_ani_finished_cb:function(){var t=this._obj;if(t){if(t.debug){var e=this._get_el();e&&(e.style.backgroundColor=MouseControl.DEF_BG)}t.onfinish&&Page.RTFireTrigger(t.onfinish)}},RTFireTrigger:function(t,e){var i=null;switch(this._obj.debug&&(i=this._get_el()),t){case"start":i&&(i.style.backgroundColor=MouseControl.HI_BG),Mouse.Show(),Mouse.StartAni(this,this._obj),this._obj.onstart&&Page.RTFireTrigger(this._obj.onstart);break;case"stop":Mouse.StopAni(),this._obj.onstop&&Page.RTFireTrigger(this._obj.onstop),i&&(i.style.backgroundColor=MouseControl.DEF_BG);break;default:EDIT_MODE&&Editor.RuntimeInfo("No Trigger "+t+" in "+this._obj.name)}},_on_set_preview:function(t){RectControl.prototype._on_set_preview.call(this,t),t||Mouse.Hide()}}),Typist.prototype=new StatusControl,WCT.ExtendObject(Typist.prototype,{start_ani_:function(){var t=this._obj,e=Controls[t.target];if(e&&"inputtext"==e._obj.type){if(this._cursor=0,Mouse.Hide(),!1===Env.GetConfig("disable_fx")){Media.audio.Unmute("key_fx"),Media.audio.Autostart("key_fx",!1),Media.audio.Loop("key_fx",!1),Media.audio.Source("key_fx","adaptable!sim_sounds:key.wav",this._src_ctx),Media.audio.Volume("key_fx",20)}this._last_time=0,Ticker.Register(this._id),t.onstart&&Page.RTFireTrigger(t.onstart)}},stop_ani_:function(){if(Ticker.Unregister(this._id),t.target){var t=this._obj;t.onstop&&Page.RTFireTrigger(t.onstop)}},finish_ani_:function(){var t=this._obj;t.onfinish&&Page.RTFireTrigger(t.onfinish),Ticker.Unregister(this._id)},Tick:function(t){var e=this._obj,i=e.target_value,o=Controls[e.target];if(e.max_duration&&t>=e.max_duration)return o.SetParam("text",i),void this.finish_ani_();if("sound"==this._state){if(1<++this._sound_ticks){var r=i.substr(0,++this._cursor);r!=i&&(r+="|"),o.SetParam("text",r),this._state=""}}else{var n=t-this._last_time;50<Math.random()*n&&(this._last_time=t,!1===Env.GetConfig("disable_fx")&&Media.audio.Play("key_fx",!0),this._state="sound",this._sound_ticks=0)}this._cursor>=i.length&&this.finish_ani_()},RTFireTrigger:function(t,e){switch(t){case"start":this.start_ani_();break;case"stop":this.stop_ani_();break;default:EDIT_MODE&&Editor.RuntimeInfo("No Trigger "+t+" in "+this._obj.name)}}}),DropDownAni.prototype=new StatusControl,DropDownAni.DEF_BG="#FFFFFF",DropDownAni.DEF_FC="#000000",DropDownAni.HI_BG="#3399FF",DropDownAni.HI_FC="#FFFFFF",WCT.ExtendObject(DropDownAni.prototype,{Terminate:function(){this.close_(),StatusControl.prototype.Terminate.call(this)},RTFireTrigger:function(t,e){switch(t){case"start":this.start_ani_();break;case"stop":this.close_("onstop");break;case"mouse_start":var i=Controls[this._obj.target],o=Controls[this._id+"_m"];if(!i||!o||!this.open_())break;if(!(s=this._get_el("#drowpdown#item"+this.target_id_)))break;BROWSER.IE||s.scrollIntoView(!1);var r=i._obj,n=s.offsetTop-s.parentNode.scrollTop+r.y+r.h+(s.offsetHeight>>1);o.SetParam("x",r.x+(r.w>>1)),o.SetParam("y",n),o.SetParam("w",r.w),o.SetParam("h",r.h),o.SetParam("duration",this.ani_time_),o.SetParam("onfinish",this._id+".mouse_finished"),Page.RTFireTrigger(o.Id()+".start");break;case"mouse_finished":var s,a=this._obj;(s=this._get_el("#drowpdown#item"+this.target_id_))?(s.style.backgroundColor=DropDownAni.HI_BG,s.style.color=DropDownAni.HI_FC,this.wait_after_mouse_=!0,Ticker.Register(this._id)):a.onfinish&&Page.RTFireTrigger(a.onfinish);break;default:EDIT_MODE&&Editor.RuntimeInfo("No Trigger "+t+" in "+this._obj.name)}},Tick:function(t){var e=this._obj;if(this.wait_after_mouse_)t>=(e.wait_mouse||0)&&this.close_("onfinish");else if(!(t-this.last_time_<this.switch_time_))if(this.last_time_=t,this.last_highlighted_id_==this.target_id_)this.close_("onfinish");else{var i=this._get_el("#drowpdown#item"+this.last_highlighted_id_++),o=this._get_el("#drowpdown#item"+this.last_highlighted_id_);i&&(i.style.backgroundColor=DropDownAni.DEF_BG,i.style.color=DropDownAni.DEF_FC),o&&(o.style.backgroundColor=DropDownAni.HI_BG,o.style.color=DropDownAni.HI_FC,o.scrollIntoView(!1))}},start_ani_:function(){var t=this._obj,e=Controls[t.target],i=e&&e._obj;if(i&&"inputselect"==i.type)if(t.onstart&&Page.RTFireTrigger(t.onstart),this.target_id_=-1,t.use_mouse){var o=t.duration-(t.wait_mouse||0),r=o>>1,n={type:"mouse",id:this._id+"_m",x:i.x+(i.w>>1),y:i.y+(i.h>>1),w:i.w,h:i.h,z:1e3,duration:r,action:"string"==typeof t.action_mouse?t.action_mouse:"lclick",onfinish:this._id+".mouse_start"};this.ani_time_=o-r,Page.AddControl(n),Page.RTFireTrigger(n.id+".start")}else this.last_time_=0,this.last_highlighted_id_=-1,this.switch_time_=1,this.open_()&&Ticker.Register(this._id)},open_:function(){var t=this._get_el("#drowpdown#main");if(!t){var e=this._obj,i=Controls[e.target],o=i._obj;(t=$$("div")).id=this._id+"#drowpdown#main",t.style.position="absolute",t.style.direction=this._direction,t.style.overflowX="hidden",t.style.overflowY="auto",t.style.fontFamily=o.font_family,t.style.fontSize=o.font_size+"pt",t.style.top=o.y+o.h+"px",t.style.left=o.x+"px",t.style.width=o.w-2+"px",t.style.border="1px solid black",t.style.zIndex=o.z+1,t.style.backgroundColor=o.background_color,t.style.maxHeight=this.max_height_+"px";var r=Number(e.choose_nr);isNaN(r)&&(r=-1);var n=[],s=i.list2_;if(s)for(var a=e.choose_text,_=0,l=s.length;_<l;_++){var d,h=s[_].t;(d=$$("div")).id=this._id+"#drowpdown#item"+_,d.innerHTML=h,d.style.overflow="hidden",d.style.paddingLeft="2px",d.style.width=o.w+"px",t.appendChild(d),0<=r?r==_&&n.push(_):h==a&&n.push(_)}else(d=$$("div")).id=this._id+"#drowpdown#item0",d.innerHTML="",d.style.overflow="hidden",d.style.paddingLeft="2px",d.style.width=o.w+"px",t.appendChild(d),n.push(0);Canvas.Parent().appendChild(t);var c=-1;if(0<=r){var p=n.indexOf(r);0<=p&&(c=n[p])}if(-1==c){if(!n.length)return!1;c=n[0]}return this.target_id_=c,this.switch_time_=e.duration/(c+1),!0}},close_:function(){Ticker.Unregister(this._id);var t=this._get_el("#drowpdown#main");t&&t.parentNode.removeChild(t),this.wait_after_mouse_=!1;var e=this._obj,i=Controls[e.target],o=i&&i._obj;o&&"inputselect"==o.type&&i.SelectItem(this.target_id_),Page.DeleteControl(this._id+"_m"),arguments[0]&&e[arguments[0]]&&Page.RTFireTrigger(e[arguments[0]])},_on_set_preview:function(t){StatusControl.prototype._on_set_preview.call(this,t),t||(this.close_("onstop"),Mouse.Hide())}});var HitManager={DEBUG:0,hit_area_:[],ext_hit_area_:[],ext_min_w_:60,ext_min_h_:60,Cleanup:function(){this.hit_area_=[],this.ext_hit_area_=[]},GetExtHitareaHeight:function(){return this.ext_min_h_},GetExtHitareaWidth:function(){return this.ext_min_w_},setHitArea:function(t){BROWSER.MOBILE&&this.set_extended_hitarea_(t);var e=this.get_hit_area_index_(t),i=this.hit_area_;if(-1==e)i.push(t);else{var o=i[e];for(var r in t)o[r]=t[r]}this.hit_area_=i.sort(sort_z),HitManager.DEBUG&&this.show_hit_areas_()},set_extended_hitarea_:function(t){var e=!1;if("rect"===(t=WCT.DeepCopy(t)).type){var i=Page.GetScale(),o=t.ext_min_w_||this.ext_min_w_,r=t.ext_min_h_||this.ext_min_h_;o=parseInt(o/i),r=parseInt(r/i);var n=t.w,s=t.h;n<o&&(e=!0,t.x=t.x-(o-n)/2,t.w=o),s<r&&(e=!0,t.y=t.y-(r-s)/2,t.h=r)}else t.extendedShape&&(e=!0,t.shape=t.extendedShape,delete t.extendedShape);if(e){var a=this.get_hit_area_index_(t,!0);t.cursor="";var _=this.ext_hit_area_;if(-1==a)_.push(t);else{var l=_[a];for(var d in t)l[d]=t[d]}this.ext_hit_area_=_.sort(sort_z)}},clearHitArea:function(t){for(var e=this.hit_area_,i=this.get_hit_area_index_(t);0<=i;)HitManager.DEBUG&&this.remove_hit_area_(this.hit_area_[i]),e.splice(i,1),i=this.get_hit_area_index_(t);for(e=this.ext_hit_area_,i=this.get_hit_area_index_(t,!0);0<=i;)e.splice(i,1),i=this.get_hit_area_index_(t,!0)},clearHitControl:function(t){this.clearHitArea({ctl_id:t})},recreateExtendedHitAreas:function(){this.ext_hit_area_=[];for(var t=this.hit_area_,e=0,i=null;i=t[e++];)this.set_extended_hitarea_(i)},getHitObjectAt:function(t,e,i){var o=this.hit_area_,r=i||1,n=this.find_hit_area_(o,t,e,r);if(BROWSER.MOBILE){var s=this.find_hit_area_(this.ext_hit_area_,t,e,r);if(s&&(!n||s.z>n.z))return s}return n},find_hit_area_:function(t,e,i,o){for(var r=1,n=0,s=null;s=t[n];n++){var a=!1;switch(s.type){case"rect":a=pt_in_rect4(e,i,s.x,s.x+s.w,s.y,s.y+s.h);break;case"poly":a=Shape.HitTest(e,i,s.shape);break;case"ellipse":a=Shape.ellipse.HitTest(e,i,s.shape);break;case"rounded_rectangle":a=Shape.rounded_rectangle.HitTest(e,i,s.shape)}if(a){if(o==r)return s;r++}}return null},get_hit_area_index_:function(t){var e=arguments[1]?this.ext_hit_area_:this.hit_area_;if(null!=t.ctl_id){if(null==t.sub_id)return e.indexOfAtt(t.ctl_id,"ctl_id");if(null!=t.hdl_id){for(var i=0,o=null;o=e[i];i++)if(o.ctl_id==t.ctl_id&&o.sub_id==t.sub_id&&o.hdl_id==t.hdl_id)return i}else for(i=0,o=null;o=e[i];i++)if(o.ctl_id==t.ctl_id&&o.sub_id==t.sub_id)return i}return-1},getHitArea:function(t){var e=this.get_hit_area_index_(t);return 0<=e?this.hit_area_[e]:null},_applyDefaults:function(t){t.style.position="absolute",t.style.border="0px dotted red",t.style.padding="0",t.style.margin="0",t.style.filter="Alpha(opacity=15);",t.style.opacity="0.15",t.style.zIndex=1e3,t.style.overflow="hidden",t.style.fontSize="12pt",t.style.textColor="black",t.style.pointerEvents="none"},show_hit_areas_:function(){for(var t=1<HitManager.DEBUG,e=Canvas.Parent(),i=[this.hit_area_,this.ext_hit_area_],o=0;o<2;o++)for(var r=i[o],n=0,s=null;s=r[n];n++)if("rect"==s.type){var a="hitarea_"+s.ctl_id+"#"+s.sub_id+"#"+s.hdl_id;1===o&&(a="ex_"+a);var _=$(a);_||((_=$$("div")).id=a,this._applyDefaults(_),_.style.backgroundColor=0===o?"red":"green",t&&(_.innerHTML=s.sub_id+"#"+s.hdl_id),e.appendChild(_)),_.style.left=s.x+"px",_.style.top=s.y+"px",_.style.width=Math.max(0,s.w)+"px",_.style.height=Math.max(0,s.h)+"px"}},remove_hit_area_:function(t){if(t){var e="hitarea_"+t.ctl_id+"#"+t.sub_id+"#"+t.hdl_id,i=$(e);i&&i.parentNode&&i.parentNode.removeChild(i),(i=$(e="ex_hitarea_"+t.ctl_id+"#"+t.sub_id+"#"+t.hdl_id))&&i.parentNode&&i.parentNode.removeChild(i)}}};function Highlight(){RectControl.call(this),this._hdx={x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},w:{to_dom:set_w,clamp:clamp_w},h:{to_dom:set_h,clamp:clamp_h},z:{to_dom:set_z,clamp:clamp_z},border:{to_dom:set_border,clamp:clamp_border},color:{to_dom:set_border_color,clamp:clamp_color},color_correct:{to_dom:noop,clamp:clamp_color},show_effect:{to_dom:noop},flash_effect:{to_dom:noop},hl_type:{to_dom:noop},opacity:{to_dom:set_ctrl_opacity,clamp:clamp_ctrl_opacity}},this.created_=!1,this.visible_=!1,this.hl_pos_={x:0,y:0,w:1,h:1,z:0},this.cur_color_="#ff00ff",this.duration_=1,this.effect_="",this.hs_id_=null,this._reset_effect_info()}function Hotkey(){RectControl.call(this),this._hdx={x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},w:{to_dom:set_w,clamp:clamp_w},h:{to_dom:set_h,clamp:clamp_h},z:{to_dom:set_z,clamp:clamp_z},hotkey:{to_dom:Hotkey.set_hotkey,clamp:Hotkey.clamp_hotkey},disabled:{clamp:clamp_boolean},hidden:{to_dom:set_hidden}},this.should_listen_=!1,this.is_listening_=!1}function Quiz(){RectControl.call(this),this._hdx={hidden:{to_dom:Quiz.SetHidden,clamp:clamp_boolean},x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},w:{to_dom:Quiz.Set,clamp:clamp_w},h:{to_dom:Quiz.Set,clamp:clamp_h},z:{to_dom:set_z,clamp:clamp_z},font_family:{clamp:clamp_font_family},font_size:{clamp:clamp_font_size},text_color:{clamp:clamp_color},background_color:{to_dom:set_background_color,clamp:clamp_color},border_color:{to_dom:set_border_color,clamp:clamp_color},border:{to_dom:Quiz.Set,clamp:clamp_border},padding:{to_dom:Quiz.Set,clamp:clamp_padding},opacity:{to_dom:set_ctrl_opacity,clamp:clamp_ctrl_opacity},center_quiz_v:{to_dom:Quiz.Align,clamp:clamp_boolean},center_quiz_h:{to_dom:Quiz.Align,clamp:clamp_boolean},shadow_show:{to_dom:ImageControl.SetShadow},shadow_color:{to_dom:ImageControl.SetShadow,clamp:clamp_color},shadow_trans:{to_dom:ImageControl.SetShadow,clamp:clamp_trans},shadow_blur:{to_dom:ImageControl.SetShadow},shadow_spread:{to_dom:ImageControl.SetShadow},shadow_h:{to_dom:ImageControl.SetShadow},shadow_v:{to_dom:ImageControl.SetShadow},fade_in_time:{to_dom:set_fade_time,clamp:clamp_time},fade_out_time:{to_dom:set_fade_time,clamp:clamp_time},trigger_error_on_use:{to_dom:set_trigger_error_on_use},action_shadow_show:{clamp:clamp_boolean},action_background_color:{clamp:clamp_color},action_background_color2:{clamp:clamp_color},action_border_color:{clamp:clamp_color},action_shadow_color:{clamp:clamp_color},action_border_width:{clamp:clamp_border},action_shadow_trans:{clamp:clamp_trans},action_color_hover:{clamp:clamp_color},action_color_hover_mchoice:{clamp:clamp_color},action_color:{clamp:clamp_color},action_color_mchoice:{clamp:clamp_color},action_color_fibquiz:{clamp:clamp_color},action_color_matchquiz:{clamp:clamp_color},action_drop_background_color:{clamp:clamp_color},action_drop_background_color_matchquiz:{clamp:clamp_color},action_drop_background_color_fibquiz:{clamp:clamp_color},action_drop_background_color_highlight:{clamp:clamp_color},action_drop_background_color_highlight_fibquiz:{clamp:clamp_color},action_background_color_highlight:{clamp:clamp_color},action_background_color_highlight_connquiz:{clamp:clamp_color},action_color:{clamp:clamp_color},action_color_connquiz:{clamp:clamp_color},action_color_mixquiz:{clamp:clamp_color},action_color_gridquiz:{clamp:clamp_color},action_color_hover:{clamp:clamp_color},action_color_hover_gridquiz:{clamp:clamp_color},action_align:{clamp:clamp_align},action_align_scalequiz:{clamp:clamp_align},action_valign:{clamp:clamp_valign},action_valign_mchoice:{clamp:clamp_valign},action_valign_gridquiz:{clamp:clamp_valign},action_padding:{clamp:clamp_padding},action_padding_matchquiz:{clamp:clamp_padding},action_padding_sqmaquiz:{clamp:clamp_padding},action_dist_to_next:{clamp:Quiz.clamp_dist_to_next},action_dist_to_next_sqmaquiz:{clamp:Quiz.clamp_dist_to_next},action_dist_to_next_mchoice:{clamp:Quiz.clamp_dist_to_next},action_dist_to_next_matchquiz:{clamp:Quiz.clamp_dist_to_next},action_dist_to_next_mixquiz:{clamp:Quiz.clamp_dist_to_next},action_dist_to_next_scalequiz:{clamp:Quiz.clamp_dist_to_next},action_size:{clamp:Quiz.clamp_action_size},action_size_mchoice:{clamp:Quiz.clamp_action_size},action_size_gridquiz:{clamp:Quiz.clamp_action_size},action_w:{clamp:Quiz.ClampW},action_w_fibquiz:{clamp:Quiz.ClampW},action_w_matchquiz:{clamp:Quiz.ClampW},action_w_connquiz:{clamp:Quiz.ClampW}},this.type_=null,this.quiz_param_id_="#answer#",this.max_answers_=8,this.quiz_styles_={},this.student_answers_=[],this.correct_answers_=[],this.disabled_=!1,this.g_quiz_timeout_=!1,this.in_move_=!1,this.move_elem_=null,this.start_time_=null,this._fader=new Fader(this,"#main#dom"),this.resize_container_=!0,this.prevent_align_=!1,this.container_pos_={x:0,y:0},this._editFields={},this._defaultEdit=null}function Jumper(){StatusControl.call(this),this.icon_id_=8}function Notifier(){StatusControl.call(this),this.fired_=0,this.icon_id_=12}function Tracker(){StatusControl.apply(this),this.icon_id_=10,this.fired_=0,this.cur_=0,this.max_=0}function Waypoint(){RectControl.apply(this),this._hdx={x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},w:{to_dom:Waypoint.set_w},h:{to_dom:Waypoint.set_h},z:{to_dom:set_z,clamp:clamp_z},hidden:{to_dom:set_hidden},target:{to_dom:noop}}}function PoiControl(){RectControl.call(this),this._hdx={x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},w:{to_dom:set_w,clamp:clamp_w},h:{to_dom:set_h,clamp:clamp_h},z:{to_dom:set_z,clamp:clamp_z},hidden:{to_dom:set_hidden},target:{to_dom:noop}}}function ProgressControl(){RectControl.call(this),this._hdx={font_family:{to_dom:CanvasControl.UpdateTextControl,clamp:clamp_font_family},font_size:{to_dom:CanvasControl.UpdateTextControl,clamp:clamp_font_size},text_color:{to_dom:CanvasControl.UpdateTextControl,clamp:clamp_color},align:{to_dom:CanvasControl.UpdateTextControl},start:{to_dom:ProgressControl.UpdateTextControl},max:{to_dom:ProgressControl.UpdateTextControl},background_color:{to_dom:set_background_color,clamp:clamp_color},bar_empty_color:{to_dom:ProgressControl.UpdateBar,clamp:clamp_color},bar_filled_color:{to_dom:ProgressControl.UpdateBar,clamp:clamp_color},bar_border_color:{to_dom:ProgressControl.UpdateBar,clamp:clamp_color},bar_border:{to_dom:ProgressControl.UpdateBar,clamp:clamp_border},x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},w:{to_dom:ProgressControl.SetWH,clamp:clamp_w},h:{to_dom:ProgressControl.SetWH,clamp:clamp_h},z:{to_dom:set_z,clamp:clamp_z},hidden:{to_dom:set_hidden}},SlideControl.ExtendHdx(this._hdx),this.cur_=0,this.max_=10}function DragDrop(){SlideControl.call(this),this.cancel_hooked_mouseup_=!1,this.has_image_=!1,this.displace_={l:0,t:0}}function ImageButton(){RectControl.call(this),this._hdx={trigger_error_on_use:{to_dom:set_trigger_error_on_use},hidden:{to_dom:set_hidden,clamp:clamp_boolean},background_color:{to_dom:TextObject.UpdateFromControl,clamp:clamp_color},hide_scrollbars:{to_dom:TextObject.UpdateFromControl,clamp:clamp_boolean},font_family:{to_dom:TextObject.UpdateFromControl,clamp:clamp_font_family},font_size:{to_dom:TextObject.UpdateFromControl,clamp:clamp_font_size},text:{to_dom:TextObject.UpdateFromControl},bold:{to_dom:TextObject.UpdateFromControl,clamp:clamp_boolean},italic:{to_dom:TextObject.UpdateFromControl,clamp:clamp_boolean},underline:{to_dom:TextObject.UpdateFromControl,clamp:clamp_boolean},align:{to_dom:TextObject.UpdateFromControl},valign:{to_dom:TextObject.UpdateFromControl},padding:{to_dom:TextObject.UpdateFromControl,clamp:clamp_padding},padding_t:{to_dom:TextObject.UpdateFromControl,clamp:clamp_padding},padding_r:{to_dom:TextObject.UpdateFromControl,clamp:clamp_padding},padding_b:{to_dom:TextObject.UpdateFromControl,clamp:clamp_padding},padding_l:{to_dom:TextObject.UpdateFromControl,clamp:clamp_padding},line_height:{to_dom:TextObject.UpdateFromControl,clamp:clamp_font_size},white_space:{to_dom:TextObject.UpdateFromControl},overflow:{to_dom:TextObject.UpdateFromControl},autosize:{to_dom:TextControl.Autosize},max_w:{to_dom:TextObject.UpdateFromControl},max_h:{to_dom:TextObject.UpdateFromControl},text_color:{to_dom:TextObject.UpdateFromControl,clamp:clamp_color},text_color_h:{to_dom:noop,clamp:clamp_color},text_color_a:{to_dom:noop,clamp:clamp_color},shadow_blur:{to_dom:ImageControl.SetShadow},shadow_color:{to_dom:ImageButton.SetShadow,clamp:clamp_color},shadow_trans:{to_dom:ImageButton.SetShadow,clamp:clamp_trans},shadow_blur:{to_dom:ImageButton.SetShadow},shadow_spread:{to_dom:ImageButton.SetShadow},shadow_h:{to_dom:ImageButton.SetShadow},shadow_v:{to_dom:ImageButton.SetShadow},border_color:{to_dom:TextObject.UpdateFromControl,clamp:clamp_color},border:{to_dom:TextObject.UpdateFromControl,clamp:clamp_border},border_t:{to_dom:TextObject.UpdateFromControl,clamp:clamp_border},border_r:{to_dom:TextObject.UpdateFromControl,clamp:clamp_border},border_b:{to_dom:TextObject.UpdateFromControl,clamp:clamp_border},border_l:{to_dom:TextObject.UpdateFromControl,clamp:clamp_border},ctl_border_l:{to_dom:ImageButton.SetBorder,clamp:clamp_border},ctl_border_r:{to_dom:ImageButton.SetBorder,clamp:clamp_border},ctl_border_t:{to_dom:ImageButton.SetBorder,clamp:clamp_border},ctl_border_b:{to_dom:ImageButton.SetBorder,clamp:clamp_border},ctl_box_shadow:{to_dom:ImageButton.SetBoxShadow},border_style:{to_dom:BorderTextObject.SetControlBorderStyle},custom_style:{to_dom:BorderTextObject.SetControlCustomStyle},custom_style_mouseover:{to_dom:noop},custom_style_mousedown:{to_dom:noop},image:{to_dom:ImageButton.SetImage},image_align:{to_dom:ImageButton.SetImageAlign},image_padding:{to_dom:ImageButton.SetImagePadding,clamp:ImageButton.ClampImagePadding},image_padding_t:{to_dom:ImageButton.SetImagePadding,clamp:ImageButton.ClampImagePadding},image_padding_r:{to_dom:ImageButton.SetImagePadding,clamp:ImageButton.ClampImagePadding},image_padding_b:{to_dom:ImageButton.SetImagePadding,clamp:ImageButton.ClampImagePadding},image_padding_l:{to_dom:ImageButton.SetImagePadding,clamp:ImageButton.ClampImagePadding},tooltip:{to_dom:set_tooltip},href:{to_dom:RectControl.SetLink},x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},w:{to_dom:ImageButton.SetWH,clamp:BorderTextObject.ClampControlWH},h:{to_dom:ImageButton.SetWH,clamp:BorderTextObject.ClampControlWH},z:{to_dom:set_z,clamp:clamp_z},opacity:{to_dom:set_ctrl_opacity,clamp:clamp_ctrl_opacity},tabindex:{to_dom:setTabIndex,clamp:clampTabIndex}},SlideControl.ExtendHdx(this._hdx),this._fader=new Fader(this,"#main#dom")}function LinkListControl(){RectControl.call(this),this._hdx={items:{to_dom:LinkListControl.SetItems},border_color:{to_dom:TextObject.UpdateFromControl,clamp:clamp_color},border:{to_dom:TextObject.UpdateFromControl,clamp:clamp_border},border_t:{to_dom:TextObject.UpdateFromControl,clamp:clamp_border},border_r:{to_dom:TextObject.UpdateFromControl,clamp:clamp_border},border_b:{to_dom:TextObject.UpdateFromControl,clamp:clamp_border},border_l:{to_dom:TextObject.UpdateFromControl,clamp:clamp_border},padding:{to_dom:TextObject.UpdateFromControl,clamp:clamp_padding},padding_t:{to_dom:TextObject.UpdateFromControl,clamp:clamp_padding},padding_r:{to_dom:TextObject.UpdateFromControl,clamp:clamp_padding},padding_b:{to_dom:TextObject.UpdateFromControl,clamp:clamp_padding},padding_l:{to_dom:TextObject.UpdateFromControl,clamp:clamp_padding},item_padding:{to_dom:noop},font_family:{to_dom:TextObject.UpdateFromControl,clamp:clamp_font_family},font_size:{to_dom:noop,clamp:clamp_font_size},underline:{to_dom:noop},background_color:{to_dom:TextObject.UpdateFromControl,clamp:clamp_color},text_color:{to_dom:TextObject.UpdateFromControl,clamp:clamp_color},text_color_over:{to_dom:noop,clamp:clamp_color},text_color_down:{to_dom:noop,clamp:clamp_color},align:{to_dom:TextObject.UpdateFromControl,clamp:clamp_align},valign:{to_dom:TextObject.UpdateFromControl,clamp:clamp_valign},line_height:{to_dom:TextObject.UpdateFromControl,clamp:clamp_font_size},white_space:{to_dom:TextObject.UpdateFromControl},direction:{to_dom:TextControl.SetDirection},opacity:{to_dom:set_ctrl_opacity,clamp:clamp_opacity},hidden:{to_dom:set_hidden,clamp:clamp_boolean},arialabel:{to_dom:setAccessibility},tabindex:{to_dom:setTabIndex,clamp:clampTabIndex},role:{to_dom:setAccessibility},border_style:{to_dom:BorderTextObject.SetControlBorderStyle},custom_style:{to_dom:BorderTextObject.SetControlCustomStyle},x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},w:{to_dom:BorderTextObject.SetControlWH,clamp:BorderTextObject.ClampControlWH},h:{to_dom:BorderTextObject.SetControlWH,clamp:BorderTextObject.ClampControlWH},z:{to_dom:set_z,clamp:clamp_z}},SlideControl.ExtendHdx(this._hdx),this.items_=[],this.scroll_x_=0,this.scroll_y_=0}function ButtonAreaControl(){RectControl.call(this),this._hdx={border_color:{to_dom:set_border_color,clamp:clamp_color},border:{to_dom:set_border,clamp:clamp_border},border_t:{to_dom:set_border,clamp:clamp_border},border_r:{to_dom:set_border,clamp:clamp_border},border_b:{to_dom:set_border,clamp:clamp_border},border_l:{to_dom:set_border,clamp:clamp_border},padding:{to_dom:set_padding,clamp:clamp_padding},padding_t:{to_dom:set_padding,clamp:clamp_padding},padding_r:{to_dom:set_padding,clamp:clamp_padding},padding_b:{to_dom:set_padding,clamp:clamp_padding},padding_l:{to_dom:set_padding,clamp:clamp_padding},font_size:{to_dom:ButtonObject.UpdateFromControl,clamp:clamp_font_size},font_family:{to_dom:ButtonObject.UpdateFromControl,clamp:clamp_font_family},background_color:{to_dom:set_background_color,clamp:clamp_color},direction:{to_dom:TextControl.SetDirection},hidden:{to_dom:set_hidden,clamp:clamp_boolean},box_shadow:{to_dom:ButtonObject.UpdateFromControl},x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},w:{to_dom:set_w,clamp:clamp_w},h:{to_dom:noop},z:{to_dom:set_z,clamp:clamp_z},buttons:{to_dom:ButtonAreaControl.SetButtons},button_style:{to_dom:ButtonAreaControl.SetButtonStyle},button_style_over:{to_dom:noop},button_style_down:{to_dom:noop},button_border_color:{to_dom:ButtonObject.UpdateFromControl,clamp:clamp_color},button_border_style:{to_dom:ButtonObject.UpdateFromControl},button_border:{to_dom:ButtonObject.UpdateFromControl},button_border_t:{to_dom:ButtonObject.UpdateFromControl},button_border_r:{to_dom:ButtonObject.UpdateFromControl},button_border_b:{to_dom:ButtonObject.UpdateFromControl},button_border_l:{to_dom:ButtonObject.UpdateFromControl},button_padding_r:{to_dom:ButtonObject.UpdateFromControl},button_padding_b:{to_dom:ButtonObject.UpdateFromControl}},SlideControl.ExtendHdx(this._hdx),this.buttons_=[],this.bstore_=[],this.allow_hitareas_=!1,this.h_=0}function BreadcrumbTrailControl(){RectControl.apply(this),this._hdx={direction:{to_dom:BreadcrumbTrailControl.SetDirection},hidden:{to_dom:set_hidden,clamp:clamp_boolean},tabindex:{to_dom:setTabIndex,clamp:clampTabIndex},items:{to_dom:BreadcrumbTrailControl.SetItems},x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},w:{to_dom:BreadcrumbTrailControl.SetWH,clamp:clamp_w},h:{to_dom:BreadcrumbTrailControl.SetWH,clamp:clamp_h},z:{to_dom:set_z,clamp:clamp_z}},SlideControl.ExtendHdx(this._hdx),this.itm_=null,this.dir_=null,this.istore_=[],this.params_=[],this.tctls_=[],this.autosize_=[],this.vstate_=null,this.wait4set_=!1,this.w_=0,this.h_=0}function GroupControl(){RectControl.call(this),this._hdx={collection:{to_dom:GroupControl.SetCollection},opacity:{to_dom:GroupControl.SetVisibility,clamp:clamp_ctrl_opacity},hidden:{to_dom:GroupControl.SetVisibility},x:{to_dom:GroupControl.UpdatePosition},y:{to_dom:GroupControl.UpdatePosition}},this._gctl=null}function QRCodeControl(){RectControl.call(this),this._hdx={x:{to_dom:set_x,clamp:clamp_x},y:{to_dom:set_y,clamp:clamp_y},z:{to_dom:set_z,clamp:clamp_z},w:{to_dom:set_w,clamp:clamp_w},h:{to_dom:set_h,clamp:clamp_h},hidden:{to_dom:set_hidden},opacity:{to_dom:set_ctrl_opacity,clamp:clamp_ctrl_opacity},tabindex:{to_dom:setTabIndex,clamp:clampTabIndex},locked:{to_dom:set_locked},border:{to_dom:set_border,clamp:clamp_border},border_color:{to_dom:set_border_color,clamp:clamp_color},padding:{to_dom:set_padding,clamp:clamp_padding},shadow_show:{to_dom:ImageControl.SetShadow},shadow_color:{to_dom:ImageControl.SetShadow,clamp:clamp_color},shadow_trans:{to_dom:ImageControl.SetShadow,clamp:clamp_trans},shadow_blur:{to_dom:ImageControl.SetShadow},shadow_spread:{to_dom:ImageControl.SetShadow},shadow_h:{to_dom:ImageControl.SetShadow},shadow_v:{to_dom:ImageControl.SetShadow},tooltip:{to_dom:set_tooltip},trigger_error_on_use:{to_dom:set_trigger_error_on_use},fade_in_time:{to_dom:set_fade_time,clamp:clamp_time},fade_out_time:{to_dom:set_fade_time,clamp:clamp_time}},this._fader=new Fader(this,"#main#dom")}Highlight.prototype=new RectControl,Highlight.OVERLAY_DEFAULTS={color:"#000000",opacity:.4},Highlight.IsHighlight=function(t){return"string"==typeof t&&(t=Controls[t]),"highlight"==t._obj.type},WCT.ExtendObject(Highlight.prototype,function(){function _(t){var e=this._obj,i=e;if(!e.ignore_target){var o=Controls[e.target||""];if(!o)return EDIT_MODE&&Editor.RuntimeInfo("No target for highlight: "+e.name),null;if(!(i=o.GetBoundaryRect()))return EDIT_MODE&&Editor.RuntimeInfo("No boundary rect for target: "+e.target),null}var r=null;if(t)r=Shape.CalculateShapePos(e,i);else if("overlay"===e.hl_type){var n=e.offset||0;r={x:i.x-n,y:i.y-n,w:i.w+2*n,h:i.h+2*n,z:500+i.z}}else{var s=(n=e.offset||0)+(e.border||0),a=e.msie5&&BROWSER.VERSION<9?2*s:2*n;r={x:i.x-s,y:i.y-s,w:i.w+a,h:i.h+a,z:Math.max(1,i.z-1)}}return this.hl_pos_=r}function d(t){var e=this.hl_pos_,i=this._obj;return{dir:i.hl_type||"rect",border:i.border,thickness:30,duration:t&&this.visible_&&this.duration_||0,w:e.w,h:e.h}}function r(){if(this.hl_pos_&&this._cctl){var t=d.call(this,arguments[0]);this._cctl.SetParams("0",t)}}function h(){return this._cctl?this._cctl.GetDom():this._get_el("#main#hl")}function n(){if(this.visible_){this.visible_=!1,this.effect_="";var t=h.call(this);t&&(t.style.display="none"),this.playing_&&(Ticker.Unregister(this._id),this._reset_effect_info(),r.call(this));var e=this._obj;e.onhide&&Page.RTFireTrigger(e.onhide)}}function l(){this.playing_&&(Ticker.Unregister(this._id),this._reset_effect_info());var t=h.call(this);if(t){set_opacity(t,this._obj.opacity);var e=this.hl_pos_;t.style.display=this.visible_?"":"none",t.style.left=e.x+"px",t.style.top=e.y+"px",t.style.zIndex=e.z;var i=this._cctl;if(i){var o=arguments[0]||!1;r.call(this,o),i.SetDrawStyle("0",null,this.cur_color_),i[o?"RedrawAnimated":"Redraw"]("0")}else t.style.borderColor=this._obj.color,t.style.width=e.w+"px",t.style.height=e.h+"px"}}var s={standard:function(){var t=this._obj,e=arguments[0]?"_"+arguments[0]:"",i=arguments[1]||!1,o=arguments[2]||!1,r=arguments[3]||!1;this.cur_color_=t["color"+e]||t.color,this.visible_=!i,this.created_?l.call(this,o):t.msie5||BROWSER.IE&&!BROWSER.ACTIVE_X||"overlay"===t.hl_type?function n(){var t=_.call(this,!1);if(t){var e=$$("div");e.id=this._id+"#main#hl",e.style.position="absolute",e.style.display=this.visible_?"":"none",e.style.left=t.x+"px",e.style.top=t.y+"px",e.style.width=t.w+"px",e.style.height=t.h+"px",e.style.background="transparent";var i=this._obj;if("overlay"===i.hl_type){e.style.zIndex=900,e.className="highlight-focus-layer";var o=Highlight.OVERLAY_DEFAULTS,r=i.overlay_color||o.color;e.style.opacity=i.overlay_opacity?i.overlay_opacity/100:o.opacity,e.style.outline="4000px solid "+r,!1!==i.overlay_inset&&(e.style.boxShadow="inset 0 0 10px 7px "+r)}else e.style.zIndex=t.z,e.style.border=this._obj.border+"px solid "+this.cur_color_;Canvas.Parent().appendChild(e)}}.call(this):function a(t){var e=arguments[1]||!1,i=_.call(this,!0);if(i){var o=d.call(this,t),r=CanvasObject.CreateCanvas.call(this,Canvas.Parent(),o),n=e?0:this._obj.opacity,s=r.GetDom();s.style.left=i.x+"px",s.style.top=i.y+"px",s.style.zIndex=i.z,s.style.display=this.visible_?"block":"none",set_opacity(s,n),e||(r.SetDrawStyle("0",null,this.cur_color_),r[t?"DrawAnimated":"Draw"]("0"))}}.call(this,o,r),this.created_=!0,t.onshow&&Page.RTFireTrigger(t.onshow)},show:function(){s.standard.call(this,arguments[0])},animate:function(){s.standard.call(this,arguments[0],!1,!0)},flash:function(){s.standard.call(this,arguments[0]),this.playing_=!0,this.effect_="flash",Ticker.Register(this._id)},fade:function(){s.standard.call(this,arguments[0]),this.playing_=!0,this.effect_="fade",this.fade_info_.cur=this.visible_?100:25,Ticker.Register(this._id)},pulsate:function(){s.standard.call(this,arguments[0]),this.playing_=!0,this.effect_="pulsate";var t=this._obj.color.substr(1);this.pulse_info_.rgb={r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16)},Ticker.Register(this._id)},focuszoom:function(){s.standard.call(this,arguments[0]),this.playing_=!0,this.effect_="focuszoom",Ticker.Register(this._id)},hotspot:function(){s.standard.call(this,arguments[0],!1,!1,!0),this.playing_=!0,this.effect_="hotspot",Ticker.Register(this._id)}},i={flash:function(t){var e=t/2e3;if(!(e<.1)){var i="block";e<.25?i="none":e<.4?i="block":e<.55?i="none":e<.7?i="block":e<.85?i="none":Ticker.Unregister(this._id);var o=h.call(this);o&&(o.style.display=i)}},fade:function(){var t=this.fade_info_,e=this._obj.opacity;t.cur=t.cur+("out"==t.dir?-1:1)*t.step,t.cur<=t.min&&"out"==t.dir?(t.cur=t.min,t.dir="in"):t.cur>=e&&"in"==t.dir&&(t.cur=e,t.dir="out");var i=h.call(this);i&&set_opacity(i,t.cur)},pulsate:function(){var t=this.pulse_info_;t.cur=t.cur+("out"==t.dir?-1:1),t.cur<=0&&"out"==t.dir?(t.cur=0,t.dir="in"):t.cur>=t.step&&"in"==t.dir&&(t.cur=t.step,t.dir="out");var e=function s(){var t=this.pulse_info_,e=3*t.step,i=t.rgb.r,o=Math.round(2*(255-i)/e);for(i=Math.min(i+t.cur*o,255).toString(16);i.length<2;)i="0"+i;var r=t.rgb.g;for(o=Math.round(2*(255-r)/e),r=Math.min(r+t.cur*o,255).toString(16);r.length<2;)r="0"+r;var n=t.rgb.b;for(o=Math.round(2*(255-n)/e),n=Math.min(n+t.cur*o,255).toString(16);n.length<2;)n="0"+n;return"#"+i+r+n}.call(this),i=this._cctl;if(i)i.SetDrawStyle("0",null,e),i.Redraw("0");else{var o=h.call(this);o&&(o.style.borderColor=e)}},focuszoom:function(){var t=this.focuszoom_info_,e=this.hl_pos_,i=e.x-t.cur,o=e.y+("underline"==this._obj.hl_type?1:-1)*t.cur,r=e.w+2*t.cur,n=e.h+2*t.cur,s=h.call(this);s&&(s.style.left=i+"px",s.style.top=o+"px");var a=this._cctl;if(a){var _=d.call(this,!1);_.w=r,_.h=n,a.SetParams("0",_),a.SetDrawStyle("0",null,this.cur_color_),a.Redraw("0")}else s&&(s.style.width=r+"px",s.style.height=n+"px");t.cur-=t.step,t.cur<=0&&(t.cur=t.end,3==++t.count&&(t.count=0,l.call(this)))},hotspot:function(){var t=this.hotspot_info_,e=this.hl_pos_,i=e.x-t.cur,o=e.y-t.cur,r=Math.max(0,e.w+2*t.cur),n=Math.max(0,e.h+2*t.cur),s=h.call(this);s&&(s.style.left=i+"px",s.style.top=o+"px");var a=this._cctl;if(a){var _=d.call(this,!1);_.w=r,_.h=n,a.SetParams("0",_),a.SetDrawStyle("0",this.cur_color_,this.cur_color_),a.Redraw("0")}else s&&(s.style.width=r+"px",s.style.height=n+"px");var l=Math.pow(Math.sin((t.cur-t.start)/(t.end-t.start)*Math.PI),4)*t.max_opacity;s&&set_opacity(s,l),t.cur+=t.step,t.cur>=t.end&&(Ticker.Unregister(this._id),this._reset_effect_info(),s&&set_opacity(s,0))}};return{Terminate:function(){n.call(this),RectControl.prototype.Terminate.call(this)},InitEdit:function(){RectControl.prototype.InitEdit.call(this,{w:24,h:24,r:0,z:1e3})},Tick:function(t){var e=this.effect_;({fade:1,flash:1,pulsate:1,focuszoom:1,hotspot:1})[e]&&this.playing_||(Ticker.Unregister(this._id),this.playing_=!1,this.effect_=""),i[e].call(this,t)},RTFireTrigger:function(t,e){var i=this._obj;switch(t){case"show":(s[i.show_effect]||s.standard).call(this);break;case"show_correct":case"show_wrong":var o=t.substr(5),r="string"==typeof e?e:i.show_effect;(s[r]||s.standard).call(this,o);break;case"flash":if("overlay"===i.hl_type)break;if(this._cctl&&this._cctl.IsDrawing("0"))break;if(!(r="string"==typeof e?e:i.flash_effect||"pulsate")){this.RTFireTrigger("show",e);break}BROWSER.IE&&BROWSER.VERSION<9&&"fade"==r&&(r="pulsate"),(s[r]||s.pulsate).call(this);break;case"hide":n.call(this);break;default:EDIT_MODE&&Editor.RuntimeInfo("No Trigger "+t+" in "+this._obj.name)}},_create_dom:function(){var t=$$("div");t.id=this._id+"#main#dom",t.className="Highlight",t.style.position="absolute",t.style.overflow="hidden",t.style.padding="0px",t.style.fontSize="1px",t.style.backgroundColor="transparent",Canvas.Parent().appendChild(t)},_remove_dom:function(){if(!this._cctl){var t=h.call(this);t&&t.parentNode.removeChild(t)}RectControl.prototype._remove_dom.call(this)},_update_hit_areas:function(){},_on_set_preview:function(t){if(RectControl.prototype._on_set_preview.call(this,t),!t){if(this._cctl)this._cctl.Destructor(),this._cctl=null;else{var e=h.call(this);e&&e.parentNode.removeChild(e)}l.call(this),this.visible_=!1,this.created_=!1}},_reset_effect_info:function(){this.fade_info_={dir:"in",min:25,cur:25,step:7},this.pulse_info_={dir:"out",rgb:{r:0,g:0,b:0},cur:0,step:7},this.focuszoom_info_={cur:20,end:20,step:2,count:0},this.hotspot_info_={start:-10,cur:-10,end:20,step:1,max_opacity:80,count:0},this.playing_=!1}}}()),Hotkey.prototype=new RectControl,Hotkey.clamp_hotkey=function(t,e){e.res=e.val.toLowerCase()},Hotkey.set_hotkey=function(t,e,i){var o=this._get_el();o&&(o.innerHTML=i),this.should_listen_=!1,Hotkey.Observe.call(this,!0),this.should_listen_=!0},Hotkey.Observe=function(t){var e=this._obj;t?e.disabled&&!this.should_listen_||this.is_listening_||(this.is_listening_=!0,HotkeyMaster.Register(this._id,e.hotkey)):this.is_listening_&&(this.is_listening_=!1,HotkeyMaster.Unregister(this._id))},WCT.ExtendObject(Hotkey.prototype,{Terminate:function(){Hotkey.Observe.call(this,!1),RectControl.prototype.Terminate.call(this)},OnHotkey:function(t,e,i){var o=this._obj;o.oncorrectanswer&&Page.RTFireTrigger(o.oncorrectanswer,this._id),o.onkey&&Page.RTFireTrigger(o.onkey)},InitEdit:function(){RectControl.prototype.InitEdit.call(this,{w:100,h:24,r:0,z:1e3})},RTFireTrigger:function(t,e){switch(t){case"enable":case"disable":Hotkey.Observe.call(this,"enable"==t)}},_create_dom:function(){var t=this._obj;t.border=4,t.color="#800000";var e=$$("div");e.id=this._id+"#main#dom",e.className="Hotkey",e.style.position="absolute",e.style.overflow="hidden",e.style.padding="0px",e.style.textAlign="center",e.style.fontFamily="Courier New",e.style.color="#800000",e.style.fontSize="7pt",e.style.lineHeight="16px",e.style.backgroundColor="transparent",Canvas.Parent().appendChild(e)},_update_hit_areas:function(){}}),Quiz.getPos=function(t){if(!t)return{x:0,y:0,w:0,h:0};t.offsetWidth;return{x:t.offsetLeft,y:t.offsetTop,w:t.offsetWidth,h:t.offsetHeight}},Quiz.prototype=new RectControl,WCT.ExtendObject(Quiz,{DEFAULT_CHECKBOX_SIZE:17,ClampW:function(t,e){if(e.res||e.val){var i=t.w-2*((t.border||0)+(t.padding||0)+(t.action_border_width||1)+(t.action_padding||4));i&&(e.res=Math.min(i,e.val))}},Align:function(t,e,i){this.align_quiz_()},Set:function(t,e,i){var o=null;switch(e){case"border":o=set_border;break;case"padding":o=set_padding;break;case"w":o=set_w;break;case"h":o=set_h}o&&o.call(this,t,e,i),this.align_quiz_()},SetHidden:function(t,e,i){set_hidden.apply(this,arguments),i||(this._update_dom(),this._update_hit_areas())},DoDelayed:function(t,e){var i=Controls[t];i&&i[e]&&i[e](arguments[2],arguments[3])},clamp_action_size:function(t,e){e.res=Math.max(8,Math.min(48,e.val))},clamp_dist_to_next:function(t,e){e.res=Math.max(0,e.val)}}),WCT.ExtendObject(Quiz.prototype,{Terminate:function(){this.type_=null,this.quiz_param_id_=null,this.student_answers_=null,this.correct_answers_=null,this.disabled_=null,this.in_move_=null,this.move_elem_=null,this.start_time_=null,this.g_quiz_timeout_=null,this.quiz_styles_=null,RectControl.prototype.Terminate.call(this)},RTFireTrigger:function(t,e){if(RectControl.prototype.RTFireTrigger.apply(this,arguments))return!0;var i=this._obj;switch(t){case"show":case"hide":case"toggle":case"fade_in":case"fade_out":case"fade_toggle":this.hdl_show_hide_(t);break;case"enable":case"disable":case"reset":case"print":this[t+"_quiz_"]();break;case"check":var o=this.check_quiz_();"correct"==o?i.oncorrectanswer&&Page.RTFireTrigger(i.oncorrectanswer,this._id):"wrong"==o?(this.set_feedback_placeholder_(o),i.onwronganswer&&Page.RTFireTrigger(i.onwronganswer)):"skip"==o&&i.onskip&&Page.RTFireTrigger(i.onskip);break;case"g_timeout":this.g_quiz_timeout_=!0,ctx.globalQuizTimeout&&ctx.globalQuizTimeout();case"timeout":this.student_answers_=[],this.set_feedback_placeholder_("timeout"),!i.skip_allowed&&i.onwronganswer&&Page.RTFireTrigger(i.onwronganswer);break;case"track_correct":window.ctx&&ctx.setStore&&ctx.getStore&&ctx.setStore("quiz_cur_score",(ctx.getStore("quiz_cur_score")||0)+i.points);case"track_wrong":var r=this.get_track_event_(t.replace("track_",""));window.ctx&&ctx.track&&ctx.track(r);break;case"show_answer":this.ShowCorrectAnswers&&this.ShowCorrectAnswers();break;default:EDIT_MODE&&Editor.RuntimeInfo("no trigger: "+t)}},OnRTResize:function(t){this._update_hit_areas()},ShowAfterTransition:function(){this.handle_ready_trigger_()},_create_dom:function(){var t=$$("div");t.id=this._id+"#main#dom",t.className="Quiz "+this.type_+" dgo_text_container",t.style.position="absolute",t.style.overflow="auto",PLATFORM.IOS&&(t.style.WebkitOverflowScrolling="touch");var e=$$("div");e.id=this._id+"#main#container","template"===this.type_&&(e.className="wrapper"),t.appendChild(e),Canvas.Parent().appendChild(t),this.quiz_styles_=this._obj.skin_data||{},this.handle_maxscore_and_timeout_()},handle_maxscore_and_timeout_:function(){if(window.ctx&&ctx.setStore&&ctx.getStore){void 0===ctx.getStore("quiz_max_score")&&ctx.setStore("quiz_max_score",0);var t=ctx.getStore("g_quiz_timeout"),e=this._obj;0===t&&"quiz_eval"!==e.type?(e.hidden=!0,Page.RTFireTrigger((e.skip_allowed?"":e.onwronganswer||"")+";page.task_next")):"number"!=typeof t&&"number"==typeof e.g_timeout&&ctx.setStore("g_quiz_timeout",e.g_timeout)}},_unsetRTL:function(){if(this.IsRTL()){var t=this._get_el();t.style.direction="",t.dir="",(t=this._get_el("#main#container")).style.direction="",t.dir=""}},_update_dom:function(t){if(!this._disable_dom_update){var e=this._get_el();if(e){var i=this._obj,o=t||i,r=2*(i.border+i.padding);e.style.left=o.x+"px",e.style.top=o.y+"px",e.style.width=Math.max(0,o.w-r)+"px",e.style.height=Math.max(0,o.h-r)+"px",this.apply_obj_style_(e);var n=this._get_el("#main#container");n&&(this.IsRTL()&&(n.style.direction="rtl"),this.update_dom_current_(n,t)),this.align_quiz_(t),this.start_time_=(new Date).getTime()}}},highlight_:function(t,e){if(t){var i=this._obj,o=i.action_background_color_active||i.action_background_color_highlight;e&&o?WCT.dom.ApplyBackgroundStyle(t,{gradient:i.action_gradient,background_color:o,background_color2:i.action_background_color2}):WCT.dom.ApplyBackgroundStyle(t,this.get_conf_("background"))}},highlightDnd_:function(t,e){if(t){var i=this._obj,o=i.action_drop_background_color,r=i.action_drop_background_color_highlight;e&&r?(WCT.dom.ApplyBackgroundStyle(t,{background_color:r}),t.setAttribute("aria-dropeffect","move")):o&&(WCT.dom.ApplyBackgroundStyle(t,{background_color:o}),t.setAttribute("aria-dropeffect","none"))}},reset_container_:function(t){t.style.display="",t.style.top="",t.style.left="",t.style.width="",t.style.height="",t.style.position="",this.container_pos_={x:0,y:0}},align_quiz_:function(){var t=this._get_el("#main#container");if(t){this.reset_container_(t);var e=this._obj;if(e){var i=e.center_quiz_h,o=e.center_quiz_v,r=i&&o?"both":i?"horizontal":o?"vertical":"";if(r&&!this.prevent_align_){t.style.position="absolute",t.style.display="block";var n={x:0,y:0},s=arguments[0]||e,a=e.border||0,_=s.w-2*a,l=s.h-2*a,d={},h=this.type_,c="hotspot"===h;if("puzzle"===h){var p=this.data_;d={w:p.img_w,h:p.img_h};var u=p.two_fields,f=u&&e.two_place_side_by_side;u&&!f?d.h*=2:f&&(d.w*=2)}else if(c){if(!(d={w:this.img_data_.w,h:this.img_data_.h}).w||!d.h)return}else(d=this.get_pos_(t)).w&&d.h||(d=this.get_pos_(t.firstChild));if({both:1,vertical:1}[r]&&(n.y=Math.max(0,l-d.h>>1),t.style.top=n.y+"px"),{both:1,horizontal:1}[r]&&(n.x=Math.max(0,_-d.w>>1),t.style.left=n.x+"px"),this.resize_container_)t.style.width=d.w+"px",t.style.height=d.h+"px",n.w=d.w,n.h=d.h;else{var m=this._get_el(),g=WCT.dom.HasVerticalScrollbar(m)?WCT.dom.GetScrollbarWidth(m):0,y=WCT.dom.HasHorizontalScrollbar(m)?WCT.dom.GetScrollbarHeight(m):0,b=2*(e.padding+a);n.w="vertical"==r?s.w-b:0,n.h="horizontal"==r?s.h-b:0,t.style.width=n.w?n.w-g+"px":"",t.style.height=n.h?n.h-y+"px":""}this.container_pos_=n}}}},get_container_pos_:function(){return this.container_pos_},get_pos_:function(t){return Quiz.getPos(t)},do_on_hide_:function(){this.clear_move_elem_&&this.clear_move_elem_()},do_on_show_:function(){},hdl_show_hide_:function(t){-1!==t.search("toggle")&&(t=this._obj.hidden?"show":"hide"),{show:1,fade_in:1}[t]&&this.do_on_show_(),{hide:1,fade_out:1}[t]&&this.do_on_hide_()},clear_move_elem_:function(){if(this.in_move_){this.in_move_=!1,this.move_id_=null;var t=this.move_el_;t&&t.parentNode&&t.parentNode.removeChild(t),this.move_el_=null}},_update_hit_areas:function(){if(HitManager.clearHitControl(this._id),!this.isHidden()){var t=this._obj;HitManager.setHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"dom",x:t.x,y:t.y,w:t.w,h:t.h,z:t.z,type:"rect"})}},set_quiz_param_:function(t,e){for(var i=this.quiz_param_id_,o=0,r=this.max_answers_;o<=r;o++){var n=this._get_el(i+o);n&&(n[t]=e)}},disable_quiz_:function(){this.setDisableQuiz_(!0)},enable_quiz_:function(){this.setDisableQuiz_(!1)},setDisableQuiz_:function(t){this.disabled_=t,this.set_quiz_param_("disabled",t);var e=this._get_el();e&&e.setAttribute("aria-disabled",t),this._update_hit_areas&&this._update_hit_areas()},reset_quiz_:function(){this.student_answers_=[],this.correct_answers_=[],this._update_dom(),this._obj.onnotready&&Page.RTFireTrigger(this._obj.onnotready)},handle_ready_trigger_:function(){var t=this.is_ready_()?"onready":"onnotready";this._obj[t]&&Page.RTFireTrigger(this._obj[t])},is_ready_:function(){return 0<this.student_answers_.length},latency_to_string_:function(t){var e=WCT.TimestampToTimeString(t).split(":").top().split(".");return 2<e[1].length&&(e[1]=e[1].substr(0,2)),e.join(".")},get_track_event_:function(t){var e=this._id,i=Controls[e],o=Controls[e+"_quiz_question"],r=Controls[e+"_quiz_title"],n=i._obj,s=r&&r._obj.text||"",a=o&&o._obj.text||"";a=Context.ResolveHtmlString(a,this._src_ctx);var _=(new Date).getTime()-this.start_time_;_=this.latency_to_string_(_),window.ctx&&ctx.setStore&&ctx.getStore&&ctx.setStore("quiz_max_score",ctx.getStore("quiz_max_score")+n.points);for(var l=this.student_answers_,d=this.correct_answers_,h=this.questions_||[],c=h.length-1;0<=c;c--)"string"==typeof h[c]?h[c]=Context.ResolveHtmlString(h[c],this._src_ctx):h[c].text&&(h[c]=Context.ResolveHtmlString(h[c].text,this._src_ctx));var p="";for(c=l.length-1;0<=c;c--){var u=l[c]||"";p=u.isArray?u.join(" "):u,l[c]=(h[c]?h[c]+" -> ":"")+Context.ResolveHtmlString(WCT.PreventXSS(p),this._src_ctx)}for(c=d.length-1;0<=c;c--)p=d[c].isArray?d[c].join(" "):d[c],d[c]=(h[c]?h[c]+" -> ":"")+Context.ResolveHtmlString(WCT.PreventXSS(p),this._src_ctx);return{id:"quiz_information",uid:this._id,type:n.type,correct_responses:d,student_responses:l,weighting:n.points,result:this.g_quiz_timeout_?"timeout":t,description:a,title:s,latency:_,cur:Math.max(0,ctx.getStore("quiz_cur_score")),max:ctx.getStore("quiz_max_score"),caption:n.type}},get_font_style_:function(){var t=this._obj,e="";return t.font_family&&(e+="font-family:"+t.font_family+";"),t.font_size&&(e+="font-size:"+t.font_size+"pt;"),t.text_color&&(e+="color:"+t.text_color+";"),e},apply_obj_style_:function(t){var e=this._obj;e&&(e.font_family&&(t.style.fontFamily=e.font_family),e.font_size&&(t.style.fontSize=e.font_size+"pt"),e.text_color&&(t.style.color=e.text_color))},get_value_:function(){for(var t=0,e=arguments.length;t<e;t++){var i=arguments[t];if(void 0!==i)return i}return null},apply_styling_:function(t){var e=arguments[1],i=this.quiz_styles_[e]||{},o=this._obj,r=this.get_value_,n={ff:r(o.font_family,i.font_family),fs:r(o.font_size,i.font_size),w:r(o.action_w,i.w),h:r(o.action_h,i.h),c:r(o.action_color,o.text_color,i.text_color),p:r(o.action_padding,i.padding),bw:o.action_border_width,bc:r(o.action_border_color,o.border_color_dnd),bs:r(o.action_border_style),m:i.margin,fw:i.font_weight};n.ff&&(t.style.fontFamily=n.ff),n.fs&&(t.style.fontSize=n.fs+"pt"),n.fw&&(t.style.fontWeight=n.fw+";"),n.c&&(t.style.color=n.c),arguments[2]||(n.w&&(t.style.width=n.w+"px"),n.h&&(t.style.height=n.h+"px"),n.p&&(t.style.padding=n.p+"px"),n.m&&(t.style.margin=n.m+"px"),n.bw&&(t.style.borderWidth=n.bw+"px"),n.bc&&(t.style.borderColor=n.bc),n.bs&&(t.style.borderStyle=n.bw?n.bs:"none"),WCT.dom.ApplyBackgroundStyle(t,this.get_conf_("background"),e),WCT.dom.ApplyShadowStyle(t,this.get_conf_("shadow")))},get_conf_:function(t){var e=this._obj,i=this.get_value_;switch(t){case"background":return{gradient:e.action_gradient,background_color:i(e.background_color_dnd,e.action_background_color),background_color2:e.action_background_color2};case"shadow":return{shadow_show:e.action_shadow_show,shadow_color:e.action_shadow_color,shadow_trans:e.action_shadow_trans,shadow_blur:e.action_shadow_blur,shadow_spread:e.action_shadow_spread,shadow_h:e.action_shadow_h,shadow_v:e.action_shadow_v}}return{}},removeHTML:function(t){return t.replace(/\<(.*?)\>/g,"").replace(/\n/g," ").replace(/&nbsp;/g," ").trim()},compare_answers_:function(){var t=this.correct_answers_,e=this.student_answers_,i=arguments[0],o=arguments[1];if(t[0]&&t[0].isArray){for(var r=0,n=e.length;r<n;r++){for(var s=!1,a=0,_=t[r].length;a<_&&!(s=o?e[r].toLowerCase()==t[r][a].toLowerCase():e[r]==t[r][a]);a++);if(!s)return!1}return!0}var l=e.join(),d=t.join();return i&&(l=l.replace(/ /g,""),d=d.replace(/ /g,"")),o&&(l=l.toLowerCase(),d=d.toLowerCase()),l==d},get_user_result_:function(t,e){for(var i=this.student_answers_,o=this.correct_answers_,r=[],n=0,s=i.length;n<s;n++){var a=i[n],_=o[n],l=_==a?t:e;r[n]={icon:l,text:this.removeHTML(_)}}return r},check_quiz_:function(){var t=this.student_answers_,e=this.correct_answers_;return t.length?t.length!=e.length?"wrong":this.compare_answers_(!0,!1)?"correct":"wrong":"skip"},on_scroll_:function(t){var e=this.id&&this.id.split("#")[0]||"";e&&Controls[e]._update_hit_areas()},get_scroll_info_:function(){var t=this._get_el();return{l:t.scrollLeft||0,t:t.scrollTop||0}},limit_hit_area_to_control_:function(t,e){var i={},o=this._obj,r=o.border,n=o.padding,s=arguments[2]||{x:0,y:0},a=this._get_el(),_=a.offsetWidth-2*(r+n)<a.scrollWidth?WCT.dom.GetScrollbarHeight():0,l=a.offsetHeight-2*(r+n)-_<a.scrollHeight?WCT.dom.GetScrollbarWidth():0;if(i.x=s.x+t.x+o.x-e.l,i.y=s.y+t.y+o.y-e.t,i.x<o.x+o.w&&i.y<o.y+o.h){if(i.w=t.w,i.h=t.h,i.x+i.w>o.x+o.w-r-l&&(i.w=Math.max(0,o.w+o.x-i.x-r-l),0==i.w))return null;if(i.y+i.h>o.y+o.h-r-_&&(i.h=Math.max(0,o.h+o.y-i.y-r-_),0==i.h))return null;if(i.y<o.y+r&&(i.h=Math.max(0,i.y+i.h-o.y-r),i.y=o.y+r),i.x<o.x&&(i.w=Math.max(0,i.x+i.w-o.x-r),i.x=o.x+r),i.y+i.h>=o.y&&i.x+i.w>=o.x)return i}return null},update_hit_areas_delayed_:function(t){WCT.SetTimeout(Quiz.DoDelayed,t||0,Quiz,[this._id,"_update_hit_areas"])},hide_container_:function(t){var e=this._get_el("#main#container");e&&(e.style.visbility=t?"hidden":"")},do_for_while_:function(t,e){var i=arguments[3],o=arguments[4];this[t]&&this[t](i,o);for(var r=e||50;0<e;)WCT.SetTimeout(Quiz.DoDelayed,e||0,Quiz,[this._id,t,i,o]),e-=r},_on_set_preview:function(t){this.reset_quiz_();var e=this._obj;this[(e.disable_quiz||!t?"disable":"enable")+"_quiz_"]();({puzzle:1,mix:1,match:1,connection:1}[this.type_]||e.shuffle_solutions)&&this.update_dom_current_(this._get_el("#main#container")),this.set_quiz_preview_&&this.set_quiz_preview_(t)},format_feedback_result_:function(t){if(!t)return"";for(var e=['<table style="margin-top:16px;">'],i=0,o=t.length;i<o;i++){var r=t[i];e.push('<tr><td style="text-align:right;">',r.icon,'</td><td style="padding-left:5px;text-align:left;">',r.text,"</td></tr>")}return e.push("</table>"),e.join("")},set_feedback_placeholder_:function(t){var e=this._obj;if(e.feedback_info){var i=e.feedback_info.icons.correct_icon,o=e.feedback_info.icons.wrong_icon,r=['<div style="display:inline-block;background-position: ',i.x,"px ",i.y,"px;","width:",i.w,"px;","height:",i.h,"px;","font-size:1px;background-repeat:no-repeat;background-image: ","url('",encodeURIComponent(Context.ToAbsPath(i.id)),"');\"></div>"].join(""),n=['<div style="display:inline-block;background-position: ',o.x,"px ",o.y,"px;","width:",o.w,"px;","height:",o.h,"px;","font-size:1px;background-repeat:no-repeat;background-image: ","url('",encodeURIComponent(Context.ToAbsPath(o.id)),"');\"></div>"].join(""),s=this.get_user_result_(r,n),a=this.format_feedback_result_(s);Page.SetPlaceholderValue("quiz_correct_answers",a);var _=Controls[e.feedback_info[t+"_id"]];_&&_.RTFireTrigger("update_placeholder")}},print_quiz_:function(){},prepare_correct_answers_:function(){},EditFieldHitTest:function(t,e){var i,o,r=this._editFields||{};for(var n in r)if(r.hasOwnProperty(n)){var s=this._get_el(n);if(s){var a=getHtmlPosSize(s,!0);if(pt_in_rect4(t,e,a.x,a.x+a.w,a.y,a.y+a.h)){i=r[n],o=a;break}}}return{tid:i,tpos:o}},OnDefaultEdit:function(t){var e=Canvas.ToFrame(t.canvasX,t.canvasY),i=this.EditFieldHitTest(e.x,e.y),o=i.tid,r=i.tpos;return o||(o=this._defaultEdit,r=getHtmlPosSize(this._get_el(),!0)),o&&(r.x-=1,r.w-=2,r.y+=1,r.h-=2,Canvas.ApplyScaleToPos(r),r.x-=Page.scrollLeft,r.y-=Page.scrollTop,Env.edit({ctlId:this._id,paramName:o,posSize:r,extInfo:WCT.DeepCopy(this._obj)})),!0}}),Quiz.template=function(){Quiz.apply(this),this.type_="template"},Quiz.template.prototype=new Quiz,WCT.ExtendObject(Quiz.template.prototype,{update_dom_current_:function(t){if(EDIT_MODE){var e=to_producer_resource_("warning_overlay");t.innerHTML='<table class="se-frame-object"><tr><td>Type &nbsp; Quiz Template<br><br><ul><li>quiz_element &nbsp; <img src="'+e+'"/></li><li>next_enabled &nbsp; <img src="'+e+'"/></li><li>next_disabled</li><li>quiz_evaluation</li><li>title</li><li>task</li><li>number</li><li>points</li><li>countdown</li><li>countdown_global</li></ul></td><td><ul><br><br><li>feedback_correct / feedback_correct_popup</li><li>feedback_wrong / feedback_wrong_popup</li><li>feedback_timeout / feedback_timeout_popup</li><li>feedback_close_popup</li><li>feedback_correct_icon</li><li>feedback_wrong_icon</li><li>feedback_passed_icon</li><li>feedback_failed_icon</li><li>media</li><li>media_open</li><li>media_close</li><li>media_preview</li></ul></td></tr></table>'}},_on_set_preview:function(t){this._get_el().style.display=t?"none":""}}),Quiz.mchoice=function(){Quiz.apply(this),this.order_=[];for(var t=1,e=this.max_answers_;t<=e;t++)this._hdx["answer_"+t]={to_dom:Quiz.mchoice.UpdateAnswer},this._hdx["answer_"+t+"_correct"]={to_dom:Quiz.mchoice.UpdateAnswer},this.order_.push(t);this.type_="mchoice",this.resize_container_=!1,this.inputs_=[]},Quiz.mchoice.prototype=new Quiz,Quiz.mchoice.UpdateAnswer=function(t,e,i){var o=e.split("_");if(o[2]){var r=this.correct_answers_.length,n=this.prepare_correct_answers_();(1===r&&1<n||1===n&&1<r)&&this.update_dom_current_(this._get_el("#main#container"))}else{var s=this._get_el("#label#"+o[1]);s&&i?(s.innerHTML=WCT.CleanupHTMLString(i),this.do_for_while_("align_quiz_",500)):this.update_dom_current_(this._get_el("#main#container"))}},WCT.ExtendObject(Quiz.mchoice.prototype,{Terminate:function(){this.order_=null;for(var t=0,e=this.inputs_.length;t<e;t++){this.inputs_[t].Destructor()}this.inputs_=null,Quiz.prototype.Terminate.call(this)},OnRTMouseUp:function(t){if(!this.disabled_&&"label"==t.sub_id){for(var e=this._id+"#answer#"+t.hdl_id,i=0,o=this.inputs_.length;i<o;i++){var r=this.inputs_[i];if(r.uid_===e){var n=r.Checked();r.Checked(!n)}}this.on_control_(),this.handle_ready_trigger_()}},OnRTKeyUp:function(t){13!==t.button&&32!==t.button||this.disabled_||this.on_control_()},update_dom_current_:function(t){var e=this._obj,i=this.prepare_correct_answers_(),o=e.force_multiple_choice||1<i?"checkbox":"radio",r=0;for(i=this.inputs_.length;r<i;r++){this.inputs_[r].Destructor()}this.inputs_=[],this._editFields={};var n=this._get_el("#main#choices");n&&n.parentNode.removeChild(n),n=null;var s=!EDIT_MODE||Editor.Preview(),a=this.set_order_(s&&e.shuffle_solutions?"mix":"reset"),_=this._id;(n=$$("ul")).id=_+"#main#choices",n.style.padding="0",n.style.listStyleType="none",n.setAttribute("role",e.force_multiple_choice?"group":"radiogroup"),this.apply_obj_style_(n),t.appendChild(n);for(var l={type:o,name:_,handle_events:!(PLATFORM.IOS||PLATFORM.ANDROID),disabled:e.disable_quiz},d={callback_f:this.on_control_,callback_s:this},h=this.quiz_styles_[o]||{},c=Math.max(h.w||0,h.h||0)||e.action_size||Quiz.DEFAULT_CHECKBOX_SIZE,p=e.action_valign,u={size:c,margin:1,border_width:e.action_border_width,border_color:e.action_border_color,border_style:e.action_border_style,color:e.action_color,color_hover:e.action_color_hover,background_color:e.action_background_color,gradient:e.action_gradient,background_color2:e.action_background_color2,shadow_show:e.action_shadow_show,shadow_color:e.action_shadow_color,shadow_trans:e.action_shadow_trans,shadow_blur:e.action_shadow_blur,shadow_spread:e.action_shadow_spread,shadow_h:e.action_shadow_h,shadow_v:e.action_shadow_v,checkbox:{border_radius:3,vertical_align:p},radio:{border_radius:c,vertical_align:p}},f=e.action_dist_to_next||0,m=!0,g=(r=1,this.max_answers_);r<=g;r++){var y=a[r-1],b=e["answer_"+y];if(b){var v=$$("li");f&&!m&&(v.style.marginTop=f+"px"),n.appendChild(v),m=!1;var x=_+"#answer#"+y,w=_+"#label#"+y;l.ariaLabel=w,l.tabindex=e.tabindex,l.keysInUse=RT&&RT.keysInUse||{};var C=new WCT.InputElement(x,l,d,u);C.Create(v),this.inputs_.push(C);var T=$$("span"),S=parseInt(e.action_size/3),k=S+e.action_size+2*e.action_border_width+2;T.id=w,T.style.marginLeft=S+"px",T.style.verticalAlign="middle",T.style.display="inline-block",T.style.maxWidth="calc(100% - "+k+"px)",T.innerHTML=WCT.CleanupHTMLString(b),v.appendChild(T),EDIT_MODE&&(this._editFields["#label#"+y]="answer_"+y),(PLATFORM.IOS||PLATFORM.ANDROID)&&WCT.event.Observe("click",function(){},T)}}EDIT_MODE&&!Editor.Preview()&&this.disable_quiz_(),this.do_for_while_("_update_hit_areas",1e3)},on_control_:function(){for(var t=[],e=this._obj,i=0,o=this.inputs_.length;i<o;i++){var r=this.inputs_[i];if(r.Checked()){var n=r.GetUID().split("#")[2];t.push(e["answer_"+n])}}this.student_answers_=t,this.handle_ready_trigger_()},reset_quiz_:function(){this.set_quiz_param_("checked",!1),Quiz.prototype.reset_quiz_.call(this)},get_user_result_:function(t,e){for(var i=this._obj,o=[],r=0;r<=this.max_answers_;r++){var n=i["answer_"+(r+1)];if(n){var s=i["answer_"+(r+1)+"_correct"];o.push({text:n,icon:s?t:e})}}return o},check_quiz_:function(){var t=this.student_answers_,e=this.correct_answers_;return t.length?t.length!=e.length?"wrong":WCT.DeepEquals(t.sort(),e.sort())?"correct":"wrong":"skip"},set_order_:function(t){if("mix"===t)this.order_.mix();else{for(var e=[],i=1,o=this.max_answers_;i<=o;i++)e.push(i);this.order_=e}return this.order_},prepare_correct_answers_:function(){for(var t=this._obj,e=[],i="answer_",o=1,r=this.max_answers_;o<=r;o++)t[i+o]&&t[i+o+"_correct"]&&e.push(t[i+o]);return(this.correct_answers_=e).length},_update_hit_areas:function(){var t=this._obj,e=this._id;if(RT&&RT.UnregisterResizeControl(e),HitManager.clearHitControl(e),!(this.isHidden()||EDIT_MODE&&!Editor.Preview()||(RT&&RT.RegisterResizeControl(e),HitManager.setHitArea({ctl_id:e,sub_id:"main",hdl_id:"dom",cursor:"",type:"rect",x:t.x,y:t.y,w:t.w,h:t.h,z:t.z}),this.disabled_)))for(var i=HitManager.GetExtHitareaHeight(),o=this._get_el("#main#container"),r=this.get_pos_(o),n=t.border,s=t.padding,a=1,_=this.max_answers_;a<=_;a++){var l=this._get_el("#label#"+a);if(l){var d=this.get_pos_(l);(PLATFORM.IOS||PLATFORM.ANDROID)&&(d.x=0,d.w=t.center_quiz_h?r.w:t.w-2*(n+s)),HitManager.setHitArea({ctl_id:e,sub_id:"label",hdl_id:a+"",cursor:"pointer",type:"rect",x:d.x+t.x+r.x+n,y:d.y+t.y+r.y+n,w:d.w,h:d.h,ext_min_h_:Math.min(d.h,i),z:t.z+.5})}}},disable_quiz_:function(){this.set_inputs_disabled_(!0),Quiz.prototype.disable_quiz_.call(this)},enable_quiz_:function(){this.set_inputs_disabled_(!1),Quiz.prototype.enable_quiz_.call(this)},set_inputs_disabled_:function(t){for(var e=0,i=this.inputs_.length;e<i;e++){this.inputs_[e].Disabled(t)}}}),Quiz.sqma=function(){Quiz.apply(this),this.type_="sqma";for(var t=1,e=this.max_answers_;t<=e;t++)this._hdx["answer_"+t]={to_dom:Quiz.sqma.UpdateAnswer};this.resize_container_=!1},Quiz.sqma.prototype=new Quiz,Quiz.sqma.UpdateAnswer=function(t,e,i){var o=this._get_el("#main#container");o.getAttribute("role")||o.setAttribute("role","group");var r=e.split("_")[1];this._get_el("#answer#"+r)&&i?this.prepare_correct_answers_():this.update_dom_current_(o)},WCT.ExtendObject(Quiz.sqma.prototype,{prepare_correct_answers_:function(){for(var t=[],e=this._obj,i=e.answer_type,o=1,r=this.max_answers_;o<=r;o++){var n=e["answer_"+o];if(n){if("at_regexp"!==i){var s=!1;!{at_cs_comma_list:1,at_comma_list:1}[i]||-1===n.search(",")||(n=n.replace(/\\,/g,"%2C"),s=!0);for(var a=0,_=(n=n.split(",")).length;a<_;a++)n[a]=n[a].trim(),s&&(n[a]=n[a].replace(/%2C/g,",")),"at_float"===i&&"."==n[a].charAt(0)&&(n="0"+n)}else n=[n];t.push(n)}}this.correct_answers_=t},update_dom_current_:function(t){for(var e=this._obj,i=arguments[1]||e,o=this.max_answers_,r=1;r<=o;r++){var n=this._get_el("#answer#"+r);n&&n.parentNode.removeChild(n)}this._editFields={},this.prepare_correct_answers_();var s=this._id,a=WCT.dom.CreateInputElement("text",s+"#sqma");a.className="Quiz "+this.type_,a.id=s+"#answer#";var _=i.w,l=e.border,d=e.padding,h=e.action_padding||0;_-=2*(l+d+(e.action_border_width||0)+h),a.style.width=_+"px",a.style.display="block",a.style.font="inherit",a.tabIndex=e.tabindex,this.apply_obj_style_(a),this.apply_styling_(a,"input");r=1;for(var c=2;r<=o;r++,c++)if(e["answer_"+r]){var p=a.cloneNode(!0);p.id+=r,EDIT_MODE&&(this._editFields["#answer#"+r]="answer_"+r,Editor.Preview()||(p.value=e["answer_"+r])),"undefined"!=typeof e.action_dist_to_next&&e["answer_"+c]&&(p.style.marginBottom=e.action_dist_to_next+"px"),t.appendChild(p)}},reset_quiz_:function(){this.set_quiz_param_("value",""),Quiz.prototype.reset_quiz_.call(this)},get_user_result_:function(t,e){var i=this.student_answers_,o=this.correct_answers_,r=[],n=null;if("at_regexp"===this._obj.answer_type)for(var s=this.check_reg_exp_(!0),a=0,_=i.length;a<_;a++){var l=o[a];r[a]={icon:s[a]?t:e,text:l.isArray?l.join(", "):this.removeHTML(l)}}else for(a=0,_=i.length;a<_;a++){var d=i[a];if(n=null,(l=o[a]).isArray){var h=!1;n=e;for(var c=0,p=l.length;c<p;c++)h||d===l[c]&&(n=t,h=!0)}else n=d===l?t:e;r[a]={icon:n,text:l.isArray?l.join(", "):this.removeHTML(l)}}return r},check_quiz_:function(){var t=this.student_answers_,e=this.correct_answers_;if(!t.length)return"skip";if(t.length!==e.length)return"wrong";switch(this._obj.answer_type){case"at_cs_text":return e.join()===t.join()?"correct":"wrong";case"at_text":return e.join().toLowerCase()==t.join().toLowerCase()?"correct":"wrong";case"at_integer":case"at_float":return this.check_float_int_();case"at_regexp":return this.check_reg_exp_();case"at_cs_comma_list":case"at_comma_list":return this.check_comma_list_();default:return"wrong"}},check_float_int_:function(){for(var sa=this.student_answers_,ca=this.correct_answers_,i=0,l=ca.length;i<l;i++){var sv=parseFloat(sa[i].replace(",",".")),v=ca[i][0],m=v.match(/[<|>|-]/),h=m&&"-"!=v.charAt(0);if(h)switch(m[0]){case"<":case">":var pv=parseFloat(v.substr(m.index+1));if(!eval(sv+m[0]+pv))return"wrong";break;case"-":var pv=v.split("-"),pv0=parseFloat(pv[0]),pv1=parseFloat(pv[1]);if(sv<pv0||pv1<sv)return"wrong"}else if(parseFloat(v)!=sv)return"wrong"}return"correct"},check_reg_exp_:function(){for(var t=this.student_answers_,i=this.correct_answers_,o=!!arguments[0],r=[],n=0,s=i.length;n<s;n++){var a=null,_=i[n][0];if(_){if("/"===_.charAt(0)){var l=_.lastIndexOf("/");if(0<l){var d=_.substr(l+1),h=_.substring(1,l);try{a=new RegExp(h,d)}catch(e){if(o){r[n]=!1;continue}return"wrong"}}}if(null===a)try{a=new RegExp(_,"i")}catch(e){if(o){r[n]=!1;continue}return"wrong"}if("undefined"==typeof t[n]){if(o){r[n]=!1;continue}return"wrong"}var c=t[n].search(a);if(-1===c){if(o){r[n]=!1;continue}return"wrong"}if(0!==c){if(o){r[n]=!1;continue}return"wrong"}o&&(r[n]=!0)}}return o?r:"correct"},check_comma_list_:function(){for(var t=this.student_answers_,e=this.correct_answers_,i="at_cs_comma_list"===this._obj.answer_type,o="",r="",n=e.length-1;0<=n;n--)if(o=e[n],r=t[n],o&&r){if(o&&!r)return"wrong";var s=r.trim();i||(s=s.toLowerCase());for(var a=!1,_=o.length-1;0<=_;_--){var l=o[_].trim();if(i||(l=l.toLowerCase()),s===l){a=!0;break}}if(!a)return"wrong"}return"correct"},is_ready_:function(){for(var t=[],e=this._obj,i="at_float"==e.answer_type,o=!0,r=1,n=0,s=this.max_answers_;r<=s;r++,n++)if(e["answer_"+r]){var a=this._get_el("#answer#"+r);if(a&&a.value){var _=i&&"."===a.value.charAt(0);t[n]=(_?"0":"")+a.value}else o=!1,t[n]=""}return this.student_answers_=t,o},set_quiz_preview_:function(t){if(BROWSER.MOBILE)for(var e=t?"Observe":"StopObserving",i=1,o=this.correct_answers_.length;i<=o;i++){var r=this._get_el("#answer#"+i);r&&WCT.event[e]("blur",function(t){window.parent&&window.parent.scrollTo(0,0)},r)}if(!this.disabled_&&t){var n=this._get_el("#answer#1");if(n)try{n.focus(),BROWSER.IE&&(n.blur(),n.focus())}catch(s){}}},OnRTKeyUp:function(t){var e=!1;switch(this._obj.answer_type){case"at_float":e=!0;case"at_integer":var i=this._get_el("#"+t.sub_id+"#"+t.hdl_id),o=i.value||"",r=o.replace(",",".","g").split("."),n="";!{8:1,35:1,36:1,37:1,39:1,46:1}[t.keyCode]&&(e&&2<=r.length?(n=o.match(/^-?[0-9]*[.][0-9]+/),i.value=n&&n[0]||r[0]+"."):(n=o.match(/^-?[0-9]*/),i.value=n&&n[0]||""))}this.handle_ready_trigger_()}}),Quiz.fib=function(){Quiz.apply(this),this._hdx.quiz_type={to_dom:this.UpdateType},this._hdx.quiz_options={to_dom:noop},this.type_="fib",this.is_dnd_=!1,this.is_dd_=!1,this.is_txt_=!1,this.all_answers_=[],this.do_call_resize_=!1,this.resize_container_=!1,this.max_=[],this._defaultEdit="text"},Quiz.fib.SPLITTER="___",Quiz.fib.MIN_HEIGHT=30,Quiz.fib.prototype=new Quiz,WCT.ExtendObject(Quiz.fib.prototype,{Terminate:function(){var t=this._get_el();t&&(t.onscroll=null),this.max_=null,this.clear_move_elem_(),Quiz.prototype.Terminate.call(this)},UpdateType:function(t,e,i){this.update_dom_current_(this._get_el("#main#container")),Quiz.Align.call(this)},prepare_correct_answers_:function(){var t=this._obj,e=Context.ResolveHtmlString(t.text||"",this._src_ctx).split(Quiz.fib.SPLITTER).length-1;if(t.one_for_all)this.prepare_one_for_all_(e);else{for(var i=[],o=[],r=1,n=this.max_answers_;r<=n;r++){var s=null,a=null,_=!1,l=t["answer_"+r]||null;if(l){var d=!1;-1!==l.search(",")&&(l=l.replace(/\\,/g,"%2C"),d=!0);var h=l.split(","),c=h.length;if(c){s=[],a=[];for(var p=0;p<c;p++){var u=h[p].trim();d&&(u=u.replace(/%2C/g,","));var f=!1;"*"===u.charAt(0)&&(f=!0),u=u.replace(/^\*/,""),f&&a.push(u),s.push(u),_=_||f}}else d&&(l=l.replace(/%2C/g,",")),a=s=l;o.push(s),i.push(_?a:s)}}this.all_answers_=o,this.correct_answers_=i}},prepare_one_for_all_:function(t){for(var e="",i=this._obj,o=1,r=this.max_answers_;o<=r&&!e;o++)e=i["answer_"+o];var n=!1;-1!==e.search(",")&&(e=e.replace(/\\,/g,"%2C"),n=!0);var s=e.split(","),a=s.length,_=[],l=[];for(o=0;o<a;o++){var d=(s[o]||"").trim();n&&(d=d.replace(/%2C/g,",")),"*"===d.charAt(0)&&(d=d.substr(1),_.push(d)),l.push(d)}var h=[],c=[];for(o=0;o<t;o++)h.push(l),c.push(_[o]);this.all_answers_=h,this.correct_answers_=c},update_dom_current_:function(t){var e=this._get_el("#main#quiz");e&&e.parentNode.removeChild(e),this._editFields={},this.prepare_correct_answers_();var i=this._id;(e=$$("div")).id=i+"#main#quiz",t.appendChild(e);var o=this._obj,r=o.quiz_type,n=this.is_txt_="qt_text"===r||"qt_cs_text"===r,s=this.is_dnd_="qt_drag_drop"===r;this.is_dd_="qt_drop_down"===r;var a=[],_=null;n?((_=$$("INPUT")).type="text",_.tabIndex=o.tabindex):s&&((_=$$("SPAN")).innerHTML="&nbsp;",_.setAttribute("role","button"),_.setAttribute("aria-selected","false"),_.setAttribute("aria-dropeffect","none"),_.style.display="inline-block",_.style.fontSize="0",_.style.borderColor=o.action_border_color||"#666",_.style.verticalAlign="middle",_.style.backgroundColor=o.action_drop_background_color||"#fff"),_&&(_.style.border="1px solid "+(o.action_border_color||"#666"),n&&this.apply_styling_(_,"input"));for(var l=Context.ResolveHtmlString(o.text||"",this._src_ctx).split(Quiz.fib.SPLITTER),d=0,h=l.length-1;d<=h;d++)if(a.push(l[d]),"undefined"!=typeof l[d+1])if(n||s){var c=_.cloneNode(!0);EDIT_MODE&&(this._editFields["#answer#"+d]="answer_"+(d+1)),c.id=i+"#answer#"+d,a.push(c.outerHTML),c=null}else a.push(this.add_select_field_(d));if(a.unshift('<div id="'+i+'#main#text#" role="group" tabIndex="'+o.tabindex+'">'),a.push("</div>"),e.innerHTML=a.join(""),EDIT_MODE&&!Editor.Preview())if(n){var p=this._editFields;for(var u in p)p.hasOwnProperty(u)&&(this._get_el(u).value=o[p[u]])}else if(this.is_dd_)for(var f,m=this.correct_answers_,g=0;f=m[g];g++)for(var y,b=this._get_el("#answer#"+g),v=0;y=b&&b.options[v++];)y.selected=y.value===f[0];s&&(this.append_dnd_answers_(e),this.do_for_while_("set_correct_answer_size_",500),this.align_quiz_())},align_quiz_:function(){Quiz.prototype.align_quiz_.call(this);var t=this._get_el("#main#choices");if(t){var e=this._obj;t.style.textAlign=e.center_quiz_h?"center":""}},add_select_field_:function(t){var e=this._obj,i=this.all_answers_[t]||"",o=$$("SELECT");o.id=this._id+"#answer#"+t,o.tabIndex=e.tabindex,o.style.font="inherit";var r=$$("OPTION");r.id=this._id+"#option"+t+"#",o.appendChild(r),i&&e.shuffle_solutions&&(!EDIT_MODE||Editor.Preview())&&i.mix();for(var n=0,s=i.length;n<s;n++){var a=i[n].trim();"*"==a.charAt(0)&&(a=a.substr(1)),(r=$$("OPTION")).id=this._id+"#option"+t+"#"+n,r.innerHTML=this.removeHTML(a),o.appendChild(r)}return this.apply_styling_(o,"select"),o.outerHTML},append_dnd_answers_:function(t){var e=this._get_el("#main#quiz"),i=this._obj,o=this._id,r=Context.ResolveHtmlString(i.text||"",this._src_ctx).split(Quiz.fib.SPLITTER),n=this.all_answers_,s=$$("ul");s.id=o+"#main#choices",s.setAttribute("role","group"),s.style.padding="0",s.style.listStyleType="none",s.style.marginTop="30px",i.center_quiz_h&&(s.style.textAlign="center");for(var a=0,_=r.length-1;a<_;a++){var l=WCT.DeepCopy(n[a]||"");l&&i.shuffle_solutions&&(!EDIT_MODE||Editor.Preview())&&l.mix();var d=$$("li");d.style.display="inline-block",d.style.verticalAlign="top";for(var h=0,c=l.length;h<c;h++)if(l[h]){var p=$$("DIV");p.style.margin=i.action_dist_to_next+"px"||"0";var u=a+":"+n[a].indexOf(l[h]),f=$$("button");f.id=o+"#possibility#"+u,f.tabIndex=i.tabindex,f.setAttribute("draggable",!0),EDIT_MODE&&(this._editFields["#possibility#"+u]="answer_"+(a+1)),f.style.backgroundColor="#fff",f.style.padding="0 2px",f.style.border="1px solid #666",f.style.boxSizing="content-box",this.apply_styling_(f),f.innerHTML=WCT.CleanupHTMLString(l[h]),p.appendChild(f),d.appendChild(p)}s.appendChild(d)}e.appendChild(s)},prepareAnswerClone_:function(t){var e=this._get_el("#possibility#"+t.hdl_id);if(e){var i=2*parseInt(e.style.borderWidth),o=parseInt(e.style.paddingLeft)+parseInt(e.style.paddingRight),r=parseInt(e.style.paddingTop)+parseInt(e.style.paddingBottom),n=e.cloneNode(!0);return n.id+="_move",n.parentNode&&n.parentNode.removeChild(n),n.style.width=e.offsetWidth-o-i+1+"px",n.style.height=e.offsetHeight-r-i+"px",e.style.visibility="hidden",e.id+="_h",n}},set_correct_answer_size_:function(){for(var t=this._obj,e=t.w-2*(t.padding+t.border),i=this.all_answers_,o=0,r=i.length;o<r;o++){var n=this._get_el("#answer#"+o);if(n){for(var s=0,a=0,_=i[o]||"",l=Quiz.fib.MIN_HEIGHT,d=0,h=_.length;d<h;d++)if(_[d]){var c=this._get_el("#possibility#"+o+":"+d);c&&(s=Math.max(c.offsetWidth,s),a=Math.max(c.offsetHeight,a),l=Math.min(c.offsetHeight,l))}e<s&&(s=e),this.max_[o]={w:s,h:a};var p=Math.max(p,s);n.style.width=s+"px",n.style.height=a+"px",n.style.lineHeight=l+2+"px"}}this.do_call_resize_=0===p,this.do_for_while_("_update_hit_areas",1e3)},is_ready_:function(){if(this.is_dnd_){for(var t=0,e=this.student_answers_,i=0,o=this.max_answers_;i<o;i++)e[i]&&t++;return t===this.correct_answers_.length}e=[];for(var r=this.is_txt_,n=BROWSER.IE?"innerText":"textContent",s=!0,a=(i=0,this.correct_answers_.length);i<a;i++){var _=this._get_el("#answer#"+i);if(_){var l=(r?_.value:_[_.selectedIndex][n])||"";""===l&&(s=!1),e.push(l)}}return this.student_answers_=e,s},highlight_answer_:function(){for(var t=parseInt(arguments[0]),e=this.correct_answers_.length,i=0;i<e;i++){var o=this._get_el("#answer#"+i);o&&this.highlight_(o,i===t)}},highlight_:function(t,e){this.highlightDnd_(t,e)},OnRTResize:function(t){this.set_correct_answer_size_(),this.do_call_resize_||RT.UnregisterResizeControl(this._id)},OnRTMouseDown:function(t){if(!this.disabled_&&this.is_dnd_&&(this.f_=document.onselectstart,document.onselectstart=function(){return!1},"answer"===t.sub_id&&this.student_answers_[t.hdl_id]&&(this.clear_answer_(t.hdl_id),this.handle_ready_trigger_()),"possibility"===t.sub_id)){var e=t.hdl_id&&t.hdl_id.split(":")[0];this.highlight_answer_(e),this.in_move_=!0,this.move_id_=t.hdl_id;var i=this.prepareAnswerClone_(t);if(i){var o=this._get_el();o.appendChild(i),o.style.overflow="hidden";var r=o.scrollLeft||0,n=o.scrollTop||0,s=HitManager.getHitArea(t),a=this._obj,_=a.border||0;this.offset_x=t.canvasX-s.x,this.offset_y=t.canvasY-s.y,i.style.zIndex=this._obj.z+1,i.style.position="absolute",i.style.left=t.canvasX-a.x-this.offset_x+r-_+"px",i.style.top=t.canvasY-a.y-this.offset_y+n-_+"px",this.move_el_=i,RT.AddHook("mouseup",this.OnRTMouseUp,this._id),RT.SetDrag(this._id),t.hasToBeCancelled=!0}}},OnRTMouseMove:function(t){if(!this.disabled_&&this.is_dnd_&&this.in_move_){var e=this._get_el(),i=e.scrollLeft||0,o=e.scrollTop||0,r=this.move_el_,n=this._obj,s=n.border||0;r.style.left=t.canvasX-n.x-this.offset_x+i-s+"px",r.style.top=t.canvasY-n.y-this.offset_y+o-s+"px",t.hasToBeCancelled=!0}},OnRTMouseUp:function(t){if(!this.disabled_&&this.is_dnd_&&this.in_move_){t.hasToBeCancelled=!0,document.onselectstart=this.f_,this.f_=null;var e=this.student_answers_,i=this.all_answers_,o=this._get_el("#possibility#"+this.move_id_+"_h"),r=this.move_el_,n=this.move_id_.split(":");if("answer"==t.sub_id&&t.hdl_id==n[0]){var s=t.hdl_id;e[s]&&this.clear_answer_(s),e[s]=i[s][n[1]];var a=this._get_el("#answer#"+s);a&&(a.setAttribute("aria-selected",!0),a.innerText=e[parseInt(s)]);var _=this._obj,l=this.max_[parseInt(s)],d=2*(_.action_border_width||0),h=this.get_answer_position_(s),c=r.cloneNode(!0);c.parentNode&&c.parentNode.removeChild(c),c.id=c.id.replace(/_move$/,"")+"_a",c.setAttribute("aria-pressed",!0),c.style.position="absolute",c.style.visibility="",c.style.left=h.x+"px",c.style.top=h.y+"px",c.style.width=l.w-d-2+"px",c.style.height=l.h-d+2+"px",this._get_el("#main#quiz").appendChild(c)}else o.style.visibility="",o.id=o.id.replace(/_h$/,"");this.clear_move_elem_(),this._get_el().style.overflow="auto",this.highlight_answer_(),this._update_hit_areas(),this.handle_ready_trigger_(),RT.RemoveHook("mouseup",this.OnRTMouseUp,this._id),RT.SetDrag(null)}},OnRTKeyUp:function(t){if(!this.is_dnd_||13!==t.button&&32!==t.button)this.handle_ready_trigger_();else{var e=t.hdl_id.split(":")[0];if("a"===t.hdl_id.split("_")[1])return this.clear_answer_(e),void this.handle_ready_trigger_();this.move_el_=this.prepareAnswerClone_(t),this.is_dnd_=!0,this.in_move_=!0,this.move_id_=t.hdl_id,t.type="mouseup",t.target+="_move",t.sub_id="answer",t.hdl_id=e,t.hasToBeCancelled="true",this.OnRTMouseUp(t)}},OnRTChange:function(t){this.handle_ready_trigger_()},get_possibility_position_:function(t){var e=this._get_el("#possibility#"+t);return e?{x:e.offsetLeft||0+e.parentNode.offsetLeft||0,y:e.offsetTop||0+e.parentNode.offsetTop||0,w:e.offsetWidth||0,h:e.offsetHeight||0}:{x:0,y:0,w:0,h:0}},get_answer_position_:function(t){var e=this._get_el("#answer#"+t);return e?{x:e.offsetLeft||0,y:e.offsetTop||0,w:e.offsetWidth||0,h:e.offsetHeight||0}:{x:0,y:0,w:0,h:0}},get_id_for_student_answer_:function(t){for(var e=this.all_answers_[t],i=this.student_answers_,o=0,r=e.length;o<=r;o++)if(e[o]===i[t])return o},reset_quiz_:function(){for(var t=0,e=this.all_answers_.length;t<e;t++)this.clear_answer_(t);Quiz.prototype.reset_quiz_.call(this)},clear_answer_:function(t){var e=t+":"+this.get_id_for_student_answer_(t),i=this._get_el("#possibility#"+e+"_h");i&&(i.style.visibility="",i.id=i.id.replace(/_h$/,""));var o=this._get_el("#possibility#"+e+"_a");o&&o.parentNode.removeChild(o);var r=this._get_el("#answer#"+t);r&&(r.setAttribute("aria-selected",!1),r.innerText="&nbsp;"),this.student_answers_[parseInt(t)]="",this._update_hit_areas()},set_quiz_preview_:function(t){var e=this.correct_answers_.length;if(this.update_dom_current_(this._get_el("#main#container")),this.is_dd_)for(var i=0;i<=e;i++){var o=this._get_el("#answer#"+i);t?(WCT.event.Observe("change",rt_hdl_change,o),this.have_event_handler_=!0):this.have_event_handler_&&(WCT.event.StopObserving("change",rt_hdl_change,o),this.have_event_handler_=!1)}else if(BROWSER.MOBILE&&this.is_txt_){var r=t?"Observe":"StopObserving";for(i=0;i<=e;i++){(o=this._get_el("#answer#"+i))&&WCT.event[r]("blur",function(t){window.parent&&window.parent.scrollTo(0,0)},o)}}if(e&&t&&this.is_txt_&&!this.disabled_){var n=this._get_el("#answer#0");if(n)try{n.focus(),BROWSER.IE&&(n.blur(),n.focus())}catch(s){}}this[(this.disabled_?"disable":"enable")+"_quiz_"](),!t&&this.is_dnd_&&(this.clear_move_elem_(),this.highlight_answer_())},get_user_result_:Quiz.sqma.prototype.get_user_result_,check_quiz_:function(){var t=this.student_answers_,e=this.correct_answers_;if(!t.length)return"skip";if(t.length!=e.length)return"wrong";var i=this.is_txt_&&"qt_text"==this._obj.quiz_type;return this.compare_answers_(!0,i)?"correct":"wrong"},_update_hit_areas:function(){if(RT&&this.do_call_resize_&&RT.UnregisterResizeControl(this._id),HitManager.clearHitControl(this._id),!this.isHidden()){var t=this._obj,e=this.get_scroll_info_();if(HitManager.setHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"dom",type:"rect",cursor:"",x:t.x,y:t.y,w:t.w,h:t.h,z:t.z}),this.is_dnd_&&!this.disabled_){RT&&this.do_call_resize_&&RT.RegisterResizeControl(this._id);for(var i=0,o=this.all_answers_.length;i<o;i++)this.set_answer_hitareas_(i,e),this.set_possibility_hitareas_(i,e)}}},set_possibility_hitareas_:function(t,e){var i=this._obj,o=this.disabled_?"":"move",r=this.all_answers_[t]||"",n=i.center_quiz_h||i.center_quiz_v,s=this.container_pos_,a=n?s.x||i.padding:0,_=n?s.y||i.padding:0;a+=i.border,_+=i.border;var l=0;for(n=r.length;l<n;l++)if(r[l]){var d=t+":"+l;if(this._get_el("#possibility#"+d)){var h=this.get_possibility_position_(d);h.x+=a,h.y+=_;var c=this.limit_hit_area_to_control_(h,e);if(!c)continue;HitManager.setHitArea({ctl_id:this._id,sub_id:"possibility",hdl_id:d,type:"rect",cursor:o,x:c.x,y:c.y,w:c.w,h:c.h,z:i.z+1})}}},set_answer_hitareas_:function(t,e){var i=this._obj,o=this.student_answers_[t]?"move":"default",r=i.center_quiz_h||i.center_quiz_v,n=this.container_pos_,s=r?n.x||i.padding:0,a=r?n.y||i.padding:0;if(s+=i.border,a+=i.border,this._get_el("#answer#"+t)){var _=this.get_answer_position_(t);_.x+=s,_.y+=a;var l=this.limit_hit_area_to_control_(_,e);l&&HitManager.setHitArea({ctl_id:this._id,sub_id:"answer",hdl_id:t+"",type:"rect",cursor:o,x:l.x,y:l.y,w:l.w,h:l.h,z:i.z+1})}}}),Quiz.puzzle=function(){Quiz.apply(this),this._hdx.qp_pieces_x={clamp:Quiz.puzzle.clamp_pieces},this._hdx.qp_pieces_y={clamp:Quiz.puzzle.clamp_pieces},this.type_="puzzle",this.data_={},this.positions_=[],this.resize_container_=!1},Quiz.puzzle.prototype=new Quiz,Quiz.puzzle.clamp_pieces=function(t,e){e.res=Math.min(20,Math.max(1,e.val))},WCT.ExtendObject(Quiz.puzzle.prototype,{Terminate:function(){this.clear_move_elem_(),delete this.data_,Quiz.prototype.Terminate.call(this)},update_dom_current_:function(t){var e=this._obj;if(e.image&&e.image.id){this._unsetRTL();var i=e.image.w,o=e.image.h;i&&o?(t.innerHTML="",t.style.overflow="visible",t.parentNode.style.overflow="hidden",this.prepare_quiz_data_(arguments[1]),this.add_puzzle_field_(t,arguments[1]),this._update_hit_areas(),this.handle_ready_trigger_()):preload_image.call(this)}},prepare_quiz_data_:function(){var t=this._obj,e=arguments[0]||t,i=t.image.w,o=t.image.h,r=t.padding+t.border,n=Math.max(0,e.w-2*r-2),s=Math.max(0,e.h-2*r-2),a=n,_=s,l=t.qp_pieces_x,d=t.qp_pieces_y,h=t.two_place_side_by_side,c=t.action_dist_to_next||0,p="qt_twoplace_puzzle"==t.quiz_type;if(p){var u=h?(n-c)/2:n,f=h?s:(s-c)/2;_=u*o<i*f?(a=u)*o/i:(a=f*i/o,f)}else _=n*o<i*s?(a=n)*o/i:(a=s*i/o,s);for(var m=parseInt(a/l),g=parseInt(_/d),y=[],b=0,v=0;v<d;v++)for(var x=0;x<l;x++)y.push({id:b,x:x*m,y:v*g}),b++;EDIT_MODE&&!Editor.Preview()||y.mix(),this.data_={img_pos:y,img_url:Context.ToAbsPath(t.image.id,this._src_ctx),img_w:a,img_h:_,pce_w:m,pce_h:g,two_fields:p}},create_templates_:function(){var t=this.data_,e=t.img_w,i=t.img_h,o=t.pce_w,r=t.pce_h,n=$$("div");n.style.position="absolute",n.style.width=o+"px",n.style.height=r+"px";var s=this._obj.border_color_dnd,a=$$("div");a.style.overflow="hidden",a.style.position="absolute",a.style.width=o-1+"px",a.style.height=r-1+"px",a.style.border="1px solid transparent",a.style.borderLeftColor=s,a.style.borderTopColor=s;var _=$$("img");return _.src=t.two_fields?to_producer_resource_("1"):t.img_url,_.style.position="absolute",_.style.width=e+"px",_.style.height=i+"px",_.width=e,_.height=i,a.appendChild(_),n.appendChild(a),n},add_puzzle_field_:function(t){var e=this._obj,i=arguments[1]||e,o=this._id,r=$$("div");r.id=o+"#main#puzzle",r.setAttribute("aria-label",e.alt_txt),r.style.position="absolute",r.style.border="0",r.style.width=i.w+"px",r.style.height=i.h+"px",t.appendChild(r);var n=e.center_quiz_h,s=e.center_quiz_v,a=0,_=e.two_place_side_by_side,l=this.data_,d=l.pce_w,h=l.pce_h,c=l.two_fields,p=c&&e.action_dist_to_next||0,u=this.create_templates_();if(c)for(var f=e.action_border_color,m=0;m<e.qp_pieces_y;m++)for(var g=0;g<e.qp_pieces_x;g++){var y=g*d,b=m*h;(C=u.cloneNode(!0)).id=o+"#drop#"+a,C.setAttribute("aria-dropeffect","none"),C.style.left=(n&&_?y-p/2:y)+"px",C.style.top=(s&&!_?b-p/2:b)+"px",(T=C.firstChild).style.borderLeftColor=f,T.style.borderTopColor=f,m===e.qp_pieces_y-1&&(T.style.borderBottomColor=f),g===e.qp_pieces_x-1&&(T.style.borderRightColor=f),r.appendChild(C),a++}u.firstChild.firstChild.src=l.img_url,a=0;var v=l.img_pos,x=l.img_w,w=l.img_h;for(f=this._obj.border_color_dnd,m=0;m<e.qp_pieces_y;m++)for(g=0;g<e.qp_pieces_x;g++){y=g*d,b=m*h;var C,T,S=a;c&&(y+=_?x+p:0,b+=_?0:w+p,S=v[a].id),(C=u.cloneNode(!0)).id=o+"#field#"+S,C.tabIndex=e.tabindex,C.setAttribute("draggable",!0),C.setAttribute("role","button"),C.setAttribute("aria-dropeffect","none"),C.setAttribute("aria-label",S),C.setAttribute("aria-describedby",o+"#main#puzzle"),C.style.left=(n&&_?y-p/2:y)+"px",C.style.top=(s&&!_?b-p/2:b)+"px",(T=C.firstChild).id=o+"#piece#"+v[a].id,m===e.qp_pieces_y-1&&(T.style.borderBottomColor=f),g===e.qp_pieces_x-1&&(T.style.borderRightColor=f);var k=T.firstChild;k.style.left=-v[a].x+"px",k.style.top=-v[a].y+"px",r.appendChild(C),a++}},_update_hit_areas:function(){var t=this._id;if(RT&&RT.UnregisterResizeControl(t),HitManager.clearHitControl(t),!this.isHidden()){RT&&RT.RegisterResizeControl(t);for(var e=this._obj,i=0,o=this.data_,r=o.pce_w||0,n=o.pce_h||0,s=o.img_w||0,a=o.img_h||0,_=o.two_fields,l=_&&e.action_dist_to_next||0,d=e.two_place_side_by_side,h=this.disabled_,c=0,p=0,u=e.center_quiz_h,f=e.center_quiz_v,m=e.padding,g=u||f?this.get_container_pos_():{x:0,y:0},y=m+e.border,b=0,v=e.qp_pieces_y;b<v;b++)for(var x=0,w=e.qp_pieces_x;x<w;x++){c=x*r+y,p=b*n+y;var C=g.x+e.x+c,T=g.y+e.y+p;C=u&&d?C-l/2:C,T=f&&!d?T-l/2:T;var S={ctl_id:t,hdl_id:i+"",x:u?C-m:C,y:f?T-m:T,w:r,h:n,z:e.z+.4,type:"rect",cursor:h?"":"move"};if(_)(k=WCT.DeepCopy(S)).sub_id="drop",k.cursor="default",HitManager.setHitArea(k),(k=WCT.DeepCopy(S)).sub_id="answer",k.z-=.1,HitManager.setHitArea(k),(k=WCT.DeepCopy(S)).sub_id="field",k.z+=.1,k.hdl_id=this.data_.img_pos[i].id+"",k.x+=d?s+l:0,k.y+=d?0:a+l,HitManager.setHitArea(k);else{var k=WCT.DeepCopy(S);k.sub_id="field",HitManager.setHitArea(k)}i++}}},get_user_result_:function(t,e){return{}},check_quiz_:function(){var t=this.data_,e=t.two_fields,i=t.img_pos.length,o=e?this.positions_:t.img_pos;if(e&&!o.length)return"skip";for(var r=i-1;0<=r;r--){if((e?o[r]:o[r].id)!=r)return"wrong"}return"correct"},is_ready_:function(){if("qt_twoplace_puzzle"==this._obj.quiz_type)for(var t=this.data_.img_pos.length,e=0;e<t;e++)if(!this.positions_[e])return!1;return!0},switch_image_pos_:function(t,e){var i=this.data_.img_pos,o={id:i[t].id,x:i[t].x,y:i[t].y},r={id:i[e].id,x:i[e].x,y:i[e].y};this.data_.img_pos[t]=r,this.data_.img_pos[e]=o},handleHighlight_:function(t,e){if(!this.disabled_&&this.in_move_&&this.data_.two_fields&&"drop"===t.sub_id){var i=this._get_el("#"+t.sub_id+"#"+t.hdl_id);i.setAttribute("aria-dropeffect",e?"move":"none"),this.highlight_(i,e)}},OnRTMouseEnter:function(t){this.handleHighlight_(t,!0)},OnRTMouseLeave:function(t){this.handleHighlight_(t,!1)},OnRTMouseDown:function(t){if(!this.disabled_&&!this.in_move_&&(this.f_=document.onselectstart,document.onselectstart=function(){return!1},"field"==t.sub_id)){this._get_el().style.overflow="visible",this.in_move_=!0,this.move_id_=t.hdl_id;var e=t.canvasX-(this.data_.pce_w>>1),i=t.canvasY-(this.data_.pce_h>>1),o=t.hdl_id,r=0;this.data_.two_fields||(o=this.data_.img_pos[t.hdl_id].id,r=50);var n=Canvas.ToFrame(e,i),s=this._get_el("#piece#"+o),a=s.cloneNode(!0);a.id=this._id+"#piece#moving",Canvas.Frame().appendChild(a),a.style.left=n.x+"px",a.style.top=n.y+"px",a.style.zIndex=1e3,set_opacity(s,r),set_opacity(a,75),RT.SetDrag(this._id),t.hasToBeCancelled=!0}},OnRTMouseMove:function(t){if(this.in_move_){var e=t.canvasX-(this.data_.pce_w>>1),i=t.canvasY-(this.data_.pce_h>>1),o=Canvas.ToFrame(e,i),r=this._get_el("#piece#moving");if(r.style.left=o.x+"px",r.style.top=o.y+"px",!this.data_.two_fields){var n=this.data_.img_pos,s=this._get_el("#piece#"+n[this.move_id_].id),a=t.hdl_id;if(n[a]){var _=s.firstChild;_.style.left=-n[a].x+"px",_.style.top=-n[a].y+"px"}set_opacity(s,50)}t.hasToBeCancelled=!0}},on_rt_mouse_up_one_field_:function(t){if("field"==t.sub_id){var e=this.data_.img_pos,i=t.hdl_id,o=this._get_el("#piece#"+e[i].id),r=this.move_id_,n=o.firstChild;n.style.left=-e[r].x+"px",n.style.top=-e[r].y+"px",n.style.display="";var s=this._get_el("#piece#"+e[r].id);set_opacity(s,100),s.style.visibility="";var a=s.firstChild;a.style.left=-e[i].x+"px",a.style.top=-e[i].y+"px";var _=s.id;s.id=o.id,o.id=_,this.switch_image_pos_(t.hdl_id,r)}},on_rt_mouse_up_two_field_:function(t){var e=!1;if("field"==t.sub_id){var i=this.move_id_;set_opacity(f=this._get_el("#piece#"+i),100),f.style.visibility="",e=t.hdl_id!=i}if("drop"==t.sub_id||e){i=this.move_id_;var o=HitManager.getHitArea(t),r=HitManager.getHitArea({ctl_id:this._id,sub_id:"field",hdl_id:this.move_id_}),n=this._obj,s=n.center_quiz_v||n.center_quiz_h?this.get_pos_(this._get_el("#main#container")):{x:n.padding,y:n.padding},a=n.border,_=this._get_el("#field#"+i);_.style.left=o.x-n.x-a-s.x+"px",_.style.top=o.y-n.y-a-s.y+"px";var l=this._get_el("#"+t.sub_id+"#"+t.hdl_id);l.style.left=r.x-n.x-a-s.x+"px",l.style.top=r.y-n.y-a-s.y+"px",l.setAttribute("aria-dropeffect","none"),!this.data_.two_fields&&"drop"!==t.sub_id||this.highlight_(l,!1);var d=l.firstChild,h=n.border_color_dnd,c=d.style,p="transparent",u={t:c.borderTopColor===p?p:h,r:c.borderRightColor===p?p:h,b:c.borderBottomColor===p?p:h,l:c.borderLeftColor===p?p:h},f=this._get_el("#piece#"+i),m=n.action_border_color,g=f.style;c.borderTopColor=g.borderTopColor===p?p:"field"===t.sub_id?h:m,c.borderRightColor=g.borderRightColor===p?p:"field"===t.sub_id?h:m,c.borderBottomColor=g.borderBottomColor===p?p:"field"===t.sub_id?h:m,c.borderLeftColor=g.borderLeftColor===p?p:"field"===t.sub_id?h:m,g.borderTopColor=u.t,g.borderRightColor=u.r,g.borderBottomColor=u.b,g.borderLeftColor=u.l,set_opacity(_,100),set_opacity(f,100);var y=o.x,b=o.y;o.x=r.x,o.y=r.y,r.x=y,r.y=b,HitManager.setHitArea(o),HitManager.setHitArea(r),this.set_answers_()}},set_answers_:function(){this.positions_=[];for(var t=0,e=this.data_.img_pos.length;t<e;t++){var i=HitManager.getHitArea({ctl_id:this._id,sub_id:"answer",hdl_id:t}),o=HitManager.getHitObjectAt(i.x,i.y);o&&"field"==o.sub_id&&(this.positions_[t]=o.hdl_id)}},OnRTMouseUp:function(t){this.in_move_&&(document.onselectstart=this.f_,this.f_=null,this["on_rt_mouse_up_"+(this.data_.two_fields?"two":"one")+"_field_"](t),this.clear_move_elem_(),RT.SetDrag(null),t.hasToBeCancelled=!0,this.handle_ready_trigger_())},OnDefaultEdit:function(){return Env.edit({ctlId:this._id,paramName:"image",posSize:this.GetHtmlPosSize(0)}),!0},set_quiz_param_:function(t,e){},reset_quiz_:function(){this.positions_=[],Quiz.prototype.reset_quiz_.call(this)},clear_move_elem_:function(){var t=this._get_el("#piece#moving");t&&t.parentNode.removeChild(t),t=null,this.move_id_=null,this.in_move_=!1,this._get_el().style.overflow="hidden"},set_quiz_preview_:function(t){!t&&this.in_move_&&this.clear_move_elem_()}}),Quiz.match=function(){Quiz.apply(this),this.type_="match",this.is_dnd_=!1,this.is_dd_=!1,this.max_w_=0,this.max_h_=0,this.provided_answers_={},this.mixed_answers_=[],this.resize_container_=!1},Quiz.match.ANSWER_BORDER_WIDTH=1,Quiz.match.prototype=new Quiz,WCT.ExtendObject(Quiz.match.prototype,{Terminate:function(){this._get_el().onscroll=null,this.clear_move_elem_(),Quiz.prototype.Terminate.call(this)},prepare_answers_:function(){for(var t=[],e=[],i=this._obj,o=this.is_dnd_,r=1,n=this.max_answers_;r<=n;r++){var s=i["question_"+r],a=i["answer_"+r];s&&a&&(o||(a=this.removeHTML(a)),t.push(a),e.push(s))}this.correct_answers_=t,this.questions_=e},update_dom_current_:function(t){var e=this._get_el("#main#quiz"),i=this._id;e?(EDIT_MODE||WCT.image_watcher.RemoveImagesInside(e),e.innerHTML=""):((e=$$("div")).id=i+"#main#quiz",e.className="Quiz "+this.type_,t.appendChild(e)),this._editFields={};var o=this._obj;this.is_dnd_="qt_drag_drop"===o.quiz_type,this.is_dd_=!this.is_dnd_,this.apply_obj_style_(e),this.prepare_answers_();var r=WCT.DeepCopy(this.correct_answers_);EDIT_MODE&&!Editor.Preview()||r.mix();var n=this.questions_,s=o.action_dist_to_next||0,a=s?s/2:0,_=BROWSER.IE||BROWSER.EDGE&&BROWSER.VERSION<15?"-ms-":"",l=_?"msGridColumns":"gridTemplateColumns",d=_?"msGridColumn":"gridColumn",h=_?"msGridRows":"gridTemplateRows",c=_?"msGridRow":"gridRow",p=o.w/3<o.action_w,u=p?o.action_w+s+"px":2*o.action_w+2*s+"px",f=$$("div");f.id=i+"#main#wrapper",f.tabIndex=o.tabindex,f.setAttribute("role","group"),f.style.display=_?_+"grid":"inline-grid",f.style[l]=p?"auto "+u:"max-content "+u,f.style[h]="auto",this.apply_obj_style_(f);for(var m=0,g=r.length;m<g;m++){var y=n[m],b=r[m],v=$$("DIV");v.className="dgo_text_container",this.apply_styling_(v,null,!0),v.style[d]=1,v.style[c]=m+1,m&&(v.style.marginTop=s+"px");var x=$$("DIV");x.id=i+"#question#"+(m+1),x.style.position="relative",x.style.top=m?"calc(50% - "+s/2+"px)":"50%",x.style.transform="translateY(-50%)",x.innerHTML=Context.ResolveHtmlString(y,this._src_ctx),v.appendChild(x),f.appendChild(v),EDIT_MODE&&(this._editFields["#question#"+(m+1)]="question_"+(m+1));var w=$$("DIV");if(w.style[d]=2,w.style[c]=m+1,m&&(w.style.marginTop=s+"px"),s&&(w.style[this.IsRTL()?"marginRight":"marginLeft"]=a+"px"),f.appendChild(w),this.is_dnd_){var C=$$("div");C.id=i+"#answer#"+(m+1),EDIT_MODE&&(this._editFields["#answer#"+(m+1)]="answer_"+(m+1)),C.tabIndex=o.tabindex,C.setAttribute("role","button"),C.setAttribute("draggable",!0),C.setAttribute("aria-describedby",x.id),C.className="dgo_text_container",C.style.backgroundColor=o.action_drop_background_color||"#eee",C.style["float"]="left",C.style.border=Quiz.match.ANSWER_BORDER_WIDTH+"px solid #999",this.apply_obj_style_(C),C.style.marginRight=p?0:a+"px",C.style.marginBottom=p?a+"px":0,C.style.overflow="hidden",w.appendChild(C),(C=C.cloneNode(!0)).id=i+"#possibility#"+(m+1),EDIT_MODE&&(this._editFields["#possibility#"+(m+1)]="answer_"+(m+1)),C.removeAttribute("aria-describedby"),C.style.margin=0,this.apply_styling_(C);var T=2*(o.action_border_style&&"none"!==o.action_border_style?o.action_border_width:0)+2*(o.action_padding||0);o.action_w&&(C.style.width=o.action_w-T+"px"),o.action_h&&(C.style.height=o.action_h-T+"px");var S=$$("DIV");S.style.position="relative",S.style.top="50%",S.style.transform="translateY(-50%)",S.innerHTML=Context.ResolveHtmlString(b,this._src_ctx),C.appendChild(S),w.appendChild(C)}else{var k=$$("SELECT");k.id=i+"#answer#"+(m+1),EDIT_MODE&&(this._editFields["#answer#"+(m+1)]="answer_"+(m+1)),k.tabIndex=o.tabindex,k.setAttribute("aria-describedby",x.id),k.style.font="inherit",this.apply_obj_style_(k),this.apply_styling_(k,this.is_dd_?"select":null);var E=$$("OPTION");E.innerHTML=PLATFORM.ANDROID?"...":"",k.appendChild(E);for(var R=0;R<g;R++)(E=$$("OPTION")).innerHTML=this.removeHTML(r[R]),k.appendChild(E);w.appendChild(k)}}e.appendChild(f),this.mixed_answers_=r,this.is_dnd_&&(t&&(t.style.visibility="hidden"),EDIT_MODE?WCT.SetTimeout(this.correct_size_,10,this):(WCT.image_watcher.AddImagesInside(e),WCT.image_watcher.Observe(this.correct_size_,this)),this._get_el().onscroll=this.on_scroll_),this.do_for_while_("_update_hit_areas",1e3)},correct_size_:function(){var t=this._obj;if(t){var e=this.correct_answers_.length,i=BROWSER.MOBILE,o=i?HitManager.GetExtHitareaWidth():0,r=i?HitManager.GetExtHitareaHeight():0,n=null;this._get_el("#main#quiz").style.width="";for(var s="undefined"!=typeof t.action_w?t.action_w:0,a="undefined"!=typeof t.action_h?t.action_h:0,_=1;_<=e;_++)(n=this._get_el("#possibility#"+_))&&(s||(n.style.width=""),a||(n.style.height=""),o=Math.max(n.offsetWidth,o),r=Math.max(n.offsetHeight,r));var l=2*(t.action_border_style&&"none"!==t.action_border_style?t.action_border_width:0)+2*(t.action_padding||0);o-=l,r-=l;var d=2*Quiz.match.ANSWER_BORDER_WIDTH,h=BROWSER.FIREFOX?1:0;for(_=1;_<=e;_++)(n=this._get_el("#answer#"+_))&&(n.style.width=o+l-d+"px",n.style.height=r+l-d+"px",(n=this._get_el("#possibility#"+_))&&(n.style.width=o+h+"px",n.style.height=r+"px"));this.max_w_=o,this.max_h_=r,this._get_el("#main#container").style.visibility="visible",this.align_quiz_()}},highlight_:function(t,e){this.highlightDnd_(t,e)},OnRTChange:function(t){var e=this._get_el("#answer#"+t.hdl_id).selectedIndex,i=this.mixed_answers_[e-1];this.student_answers_[t.hdl_id-1]=i,this.handle_ready_trigger_()},OnRTMouseDown:function(t){if(!this.disabled_&&"possibility"===t.sub_id){this.f_=document.onselectstart,document.onselectstart=function(){return!1},this.in_move_=!0,this.move_id_=t.hdl_id;var e=this._get_el("#possibility#"+t.hdl_id+"_h"),i=null,o=null;e?(i=e,o=this._get_el("#possibility#"+t.hdl_id)):(o=(i=this._get_el("#possibility#"+t.hdl_id)).cloneNode(!0),i.style.visibility="hidden",i.id+="_h"),o.parentNode&&o.parentNode.removeChild(o),o.style.direction=this.IsRTL()?"rtl":"",Canvas.Parent().appendChild(o);var r=HitManager.getHitArea({ctl_id:this._id,sub_id:"possibility",hdl_id:t.hdl_id});this.offset_x=t.canvasX-r.x,this.offset_y=t.canvasY-r.y,o.style.position="absolute",o.style.left=t.canvasX-this.offset_x+"px",o.style.top=t.canvasY-this.offset_y+"px",o.style.zIndex=this._obj.z+1,this.move_el_=o,RT.AddHook("mouseup",this.OnRTMouseUp,this._id),RT.SetDrag(this._id),t.hasToBeCancelled=!0}},OnRTMouseEnter:function(t){if(this.in_move_&&"main"!==t.sub_id){var e=HitManager.getHitObjectAt(t.canvasX,t.canvasY,1);e&&"answer"!==e.sub_id&&(e=HitManager.getHitObjectAt(t.canvasX,t.canvasY,2)),e&&"answer"===e.sub_id&&this.highlight_(this._get_el("#answer#"+e.hdl_id),!0),t.hasToBeCancelled=!0}},OnRTMouseLeave:function(t){this.in_move_&&"answer"===t.sub_id&&(this.highlight_(this._get_el("#answer#"+t.hdl_id),!1),t.hasToBeCancelled=!0)},OnRTMouseMove:function(t){if(this.in_move_){var e=this.move_el_;e.style.top=t.canvasY-this.offset_y+"px",e.style.left=t.canvasX-this.offset_x+"px",t.hasToBeCancelled=!0}},OnRTMouseUp:function(t){if(this.in_move_){document.onselectstart=this.f_,this.f_=null;var e=this._get_el("#possibility#"+this.move_id_+"_h"),i=this.provided_answers_,o=this.student_answers_,r=this.correct_answers_,n=this.mixed_answers_,s=null,a=!1;switch(t.sub_id){case"possibility":if(!(s=HitManager.getHitObjectAt(t.canvasX,t.canvasY,2))||"answer"!==s.sub_id){this._restoreOrig(e);break}var _=s.hdl_id,l="a_"+_;if(i[l]&&i[l]!==this.move_id_){var d=this._get_el("#possibility#"+i[l]);d&&d.parentNode.removeChild(d);var h=this._get_el("#possibility#"+i[l]+"_h");for(var c in h&&(h.style.visibility="",h.id=h.id.replace("_h","")),i)r[i[c]-1]===r[this.move_id_-1]&&(this.clear_answer_(this.move_id_),delete i[c]);i[l]=this.move_id_,o[_-1]=n[this.move_id_-1],a=!0}case"answer":var p=s?s.hdl_id:t.hdl_id,u=this.get_pos_for_answer_(p);if(u){var f=this._obj.border,m=BROWSER.IE&&this.IsRTL()?-1:0,g=e.cloneNode(!0);g.parentNode&&g.parentNode.removeChild(g),g.id=g.id.replace(/_h$/,""),g.style.position="absolute",g.style.visibility="",g.style.left=u.x-f+m+"px",g.style.top=u.y-f+"px",g.style.width=this.max_w_+"px",g.style.height=this.max_h_+"px",this._get_el("#main#quiz").appendChild(g),(b=this._get_el("#answer#"+p)).setAttribute("aria-labelledby",g.id),this.highlight_(b,!1),a||(i["a_"+t.hdl_id]=this.move_id_),o[p-1]=n[this.move_id_-1],this.remove_dup_(this.move_id_,p);break}default:var y=e.id.split("#").slice(-1)[0][0];for(c in i)if(i.hasOwnProperty(c)&&i[c]===y){var b;(b=this._get_el("#answer#"+c[2])).removeAttribute("aria-labelledby");break}this._restoreOrig(e)}this.clear_move_elem_(),t.hasToBeCancelled=!0,this._update_hit_areas(),this.handle_ready_trigger_(),RT.RemoveHook("mouseup",this.OnRTMouseUp,this._id),RT.SetDrag(null)}},is_ready_:function(){for(var t=this.student_answers_,e=t.length,i=0,o=0;o<e;o++)t[o]&&i++;return i===this.correct_answers_.length},remove_dup_:function(t,e){var i=this.provided_answers_,o=this.student_answers_;for(var r in i){if(r!=="a_"+e)if(i[r]==t)o[parseInt(r.split("_")[1])-1]=null,delete i[r]}},clear_answer_:function(t){var e=this.provided_answers_,i=this.student_answers_;for(var o in e){if(e[o]==t)i[parseInt(o.split("_")[1])-1]=null,delete e[o]}},_restoreOrig:function(t){t.style.visibility="",t.id=t.id.replace("_h",""),this.clear_answer_(this.move_id_)},add_observer_:function(t){for(var e=1,i=this.correct_answers_.length;e<=i;e++){var o=this._get_el("#answer#"+e),r=t?"Observe":"StopObserving";WCT.event[r]("change",rt_hdl_change,o)}this.have_event_handler_=t},reset_quiz_:function(){Quiz.prototype.reset_quiz_.call(this),this.is_dd_&&this.add_observer_(!EDIT_MODE||Editor.Preview())},set_quiz_preview_:function(t){this.is_dd_?this.add_observer_(t):!t&&this.in_move_&&(this.in_move_=!1,this.move_id_=null,this.move_el_.parentNode.removeChild(this.move_el_),this.move_el_=null),this[this.disabled_?"disable_quiz_":"enable_quiz_"]()},_update_hit_areas:function(){if(RT&&RT.UnregisterResizeControl(this._id),HitManager.clearHitControl(this._id),!(this.isHidden()||EDIT_MODE&&!Editor.Preview())){RT&&RT.RegisterResizeControl(this._id);var t=this._obj,e=this.get_scroll_info_();if(HitManager.setHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"dom",type:"rect",cursor:"",x:t.x,y:t.y,w:t.w,h:t.h,z:t.z}),this.is_dnd_&&!this.disabled_)for(var i=1,o=this.correct_answers_.length;i<=o;i++)this.set_possibility_hitareas_(i,e),this.set_answer_hitareas_(i,e)}},set_possibility_hitareas_:function(t,e){var i=this._get_el("#possibility#"+t);if(i){var o={x:i.offsetLeft||0,y:i.offsetTop||0,w:i.offsetWidth||0,h:i.offsetHeight||0},r=this._obj,n=r.border,s={x:o.x+n,y:o.y+n,w:Math.max(0,o.w),h:Math.max(0,o.h)},a=r.center_quiz_v||r.center_quiz_h?this.get_pos_(this._get_el("#main#container")):{x:0,y:0},_=this.limit_hit_area_to_control_(s,e);_&&HitManager.setHitArea({ctl_id:this._id,sub_id:"possibility",hdl_id:t+"",type:"rect",cursor:this.disabled_?"":"move",x:_.x+a.x,y:_.y+a.y,w:_.w,h:_.h,z:r.z+2})}},set_answer_hitareas_:function(t,e){var i=this._obj,o=this.get_pos_for_answer_(t),r=i.center_quiz_v||i.center_quiz_h?this.get_pos_(this._get_el("#main#container")):{x:0,y:0};if(o){var n=this.limit_hit_area_to_control_(o,e);n&&HitManager.setHitArea({ctl_id:this._id,sub_id:"answer",hdl_id:t+"",type:"rect",cursor:"",x:r.x+n.x+2,y:r.y+n.y+2,w:n.w-4,h:n.h-4,z:i.z+1})}},get_pos_for_answer_:function(t){var e=this._get_el("#answer#"+t),i={x:e.offsetLeft||0,y:e.offsetTop||0,w:e.offsetWidth||0,h:e.offsetHeight||0},o=this._obj.border;return e?{x:i.x+o,y:i.y+o,w:i.w,h:i.h}:undefined}}),Quiz.grid=function(){Quiz.apply(this),this.type_="grid",this.order_=[1,2,3,4,5,6,7,8],this.questions_=[],this.answers_=[],this.inputs_=[]},Quiz.grid.prototype=new Quiz,WCT.ExtendObject(Quiz.grid.prototype,{Terminate:Quiz.mchoice.prototype.Terminate,update_dom_current_:function(t){var e=this._obj;if(e.grid_list){t.innerHTML="";for(var i=this.inputs_,o=0,r=i.length;o<r;o++)i[o].Destructor();this.inputs_=[];var n=!(this._editFields={}),s=e.grid_list;-1!==s.search(",")&&(s=s.replace(/\\,/g,"%2C"),n=!0);var a=s.split(",");for(o=a.length-1;0<=o;o--)a[o]=a[o].trim(),n&&(a[o]=a[o].replace(/%2C/g,",")),a[o]||a.splice(o,1);this.answers_=a;var _=[],l=[];for(o=1,r=this.max_answers_;o<=r;o++){var d=e["question_"+o],h=e["answer_"+o];d&&h&&(_.push({text:d,answer:a[h-1]}),l.push(a[h-1]))}this.questions_=_,this.correct_answers_=l,EDIT_MODE&&!Editor.Preview()||!e.shuffle_solutions||(this.answers_=a.mix(),a=this.answers_);var c=$$("table");c.cellPadding=0,c.cellSpacing=0,c.style.borderWidth=0;var p=$$("tbody"),u=$$("tr"),f=this.create_cell_("th"),m=this.create_cell_("td");c.appendChild(p);for(var g=_.length,y=a.length,b=this.quiz_styles_.radio||{},v=this._id,x='<p style="padding:4px;',w=this.IsRTL()?x+'text-align:right;">':x+'text-align:left;">',C={callback_f:this.on_event_,callback_s:this},T=Math.max(b.w||0,b.h||0)||e.action_size||Quiz.DEFAULT_CHECKBOX_SIZE,S={size:T,margin:e.action_dist_to_next,border_width:e.action_border_width,border_color:e.action_border_color,border_style:e.action_border_style,color:e.action_color,color_hover:e.action_color_hover,background_color:e.action_background_color,gradient:e.action_gradient,background_color2:e.action_background_color2,shadow_show:e.action_shadow_show,shadow_color:e.action_shadow_color,shadow_trans:e.action_shadow_trans,shadow_blur:e.action_shadow_blur,shadow_spread:e.action_shadow_spread,shadow_h:e.action_shadow_h,shadow_v:e.action_shadow_v,checkbox:{border_radius:3},radio:{border_radius:T>>1}},k=(e.action_align||"center").toLowerCase(),E=!!e.disable_quiz,R=-1,O=e.tabindex,I=null;R<g;R++){for(var M=u.cloneNode(!0),D=-1;D<y;D++)if(-1!==D||-1!==R){if(-1===R&&a[D])(I=f.cloneNode(!0)).innerHTML='<p style="padding:4px;">'+WCT.CleanupHTMLString(a[D])+"</p>",I.id=v+"#col#"+R+":"+(D+1),I.setAttribute("scope","col"),I.style.textAlign=e.action_align,EDIT_MODE&&(this._editFields["#possibleAnswers#"+D]="grid_list");else if(-1===D&&_[R])(I=f.cloneNode(!0)).style.textAlign="",I.innerHTML=w+WCT.CleanupHTMLString(_[R].text)+"</p>",I.id=v+"#row#"+R+":"+(D+1),I.setAttribute("scope","row"),EDIT_MODE&&(this._editFields["#questionLine#"+R]="question_"+(R+1));else if(_[R]){(I=m.cloneNode(!0)).style.textAlign=k;var P=v+"#answer#"+R+":"+(D+1),A={type:"radio",name:v+"#"+R,disabled:E,tabindex:O,ariaLabel:v+"#col#-1:"+(D+1),ariaDescribe:v+"#row#"+R+":0",keysInUse:RT&&RT.keysInUse||{}},W=new WCT.InputElement(P,A,C,S);W.Create(I),this.inputs_.push(W),"undefined"!=typeof e.action_valign&&(I.style.verticalAlign=e.action_valign)}M.appendChild(I)}else(I=m.cloneNode(!0)).innerHTML="<p></p>",M.appendChild(I);p.appendChild(M)}this.apply_obj_style_(c),t.appendChild(c)}},create_cell_:function(t){var e=$$(t),i=this.IsRTL()?"borderLeftWidth":"borderRightWidth";return e.style.border="0 solid #999",e.style[i]="1px","th"!==t||this._obj.bold||(e.style.fontWeight="normal"),e},disable_quiz_:function(){Quiz.mchoice.prototype.set_inputs_disabled_.call(this,!0),Quiz.prototype.disable_quiz_.call(this)},enable_quiz_:function(){Quiz.mchoice.prototype.set_inputs_disabled_.call(this,!1),Quiz.prototype.enable_quiz_.call(this)},check_quiz_:function(){var t=this.student_answers_,e=this.correct_answers_;if(!t.length)return"skip";if(t.length!=e.length)return"wrong";for(var i=this.questions_,o=this.get_selected_items_(),r=0,n=i.length;r<n;r++)if(!o[r]||i[r].answer!=o[r][1])return"wrong";return"correct"},on_event_:function(){this.handle_ready_trigger_()},is_ready_:function(){for(var t=this.get_selected_items_(),e=[],i=0,o=t.length;i<o;i++)e.push(t[i][1]);return this.student_answers_=e,o==this.questions_.length},OnRTMouseClick:function(t){this.handle_ready_trigger_()},OnRTMouseDblClick:function(t){this.OnRTMouseClick(t)},get_selected_items_:function(){for(var t=this.answers_,e=[],i=0,o=this.inputs_.length;i<o;i++){var r=this.inputs_[i];if(r.Checked()){var n=r.GetUID().split("#")[2].split(":"),s=n[0],a=n[1];e.push([s,t[a-1]])}}return e},set_quiz_param_:function(t,e){for(var i=this.questions_.length,o=this.answers_.length,r=0;r<=i;r++)for(var n=0;n<=o;n++){var s=this._get_el("#answer#"+r+":"+n);s&&(s[t]=e)}},_update_hit_areas:function(){if(HitManager.clearHitControl(this._id),!this.isHidden()){var t=this._obj,e=PLATFORM.ANDROID?10:0;HitManager.setHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"dom",x:t.x,y:t.y,w:t.w,h:t.h+e,z:t.z,type:"rect"})}}}),Quiz.connection=function(){Quiz.apply(this),this._hdx.line_color={clamp:clamp_color},this.type_="connection",this.quiz_param_id_="#question#",this.answer_map_=[],this.answer_pool_=[],this.in_move_=!1,this.answers_={},this.start_={},this.end_={},this.lines_={},this.colors_="",this.last_selected_id_=null,this.resize_container_=!1},Quiz.connection.prototype=new Quiz,WCT.ExtendObject(Quiz.connection.prototype,{Terminate:function(){delete this.answer_map_,delete this.answer_pool_,delete this.answers_,delete this.start_,delete this.end_,this._get_el().onscroll=null,Quiz.prototype.Terminate.call(this)},prepare_answers_:function(t){for(var e=[],i=[],o=[],r=[],n=0,s=this.max_answers_;n<s;n++){var a=t["question_"+(n+1)],_=t["answer_"+(n+1)];a&&_&&(e.push({question:a,answer:_}),i.push(_),r.push(a),o.push(_))}this.answer_map_=e,this.answer_pool_=i,this.correct_answers_=o,this.questions_=r,EDIT_MODE&&!Editor.Preview()||this.answer_pool_.mix()},clear_quiz_field_:function(t){var e=this._get_el("#main#quiz");return EDIT_MODE||WCT.image_watcher.RemoveImagesInside(t),e&&e.parentNode.removeChild(e),(e=$$("div")).id=this._id+"#main#quiz",t.appendChild(e)},update_dom_current_:function(t){var e=this._obj,i=arguments[1]||e,o=this.clear_quiz_field_(t);this._editFields={},this.prepare_answers_(e);var r=parseInt(i.w/3),n=$$("div");n.style.clear="both",n.style.height=e.action_dist_to_next+"px";var s=$$("div");s.tabIndex=e.tabindex,s.setAttribute("role","button"),s.style.width=r+"px",s.style.padding="4px",s.style.border="1px solid #ddd",this.apply_styling_(s);for(var a=this.answer_map_,_=this.answer_pool_,l=0,d=a.length;l<d;l++){var h=s.cloneNode(!0);h.id=this._id+"#question#"+l,EDIT_MODE&&(this._editFields["#question#"+l]="question_"+(l+1)),h.innerHTML=Context.ResolveHtmlString(a[l].question,this._src_ctx),h.style.cssFloat="left",h.style.overflow="hidden",o.appendChild(h);var c=s.cloneNode(!0);c.id=this._id+"#answer#"+l,EDIT_MODE&&(this._editFields["#answer#"+l]="answer_"+(l+1)),c.innerHTML=Context.ResolveHtmlString(_[l],this._src_ctx),c.style.cssFloat="right",c.style.overflow="hidden",o.appendChild(c),o.appendChild(n.cloneNode(!0))}var p=o.lastChild;p&&(p.style.padding="0",p.style.height="0"),this._get_el().onscroll=this.on_scroll_,EDIT_MODE?Quiz.prototype.update_hit_areas_delayed_.call(this):(WCT.image_watcher.Observe(Quiz.prototype.update_hit_areas_delayed_,this),WCT.image_watcher.AddImagesInside(o)),this._obj.disable_quiz?this.disable_quiz_():this.enable_quiz_()},_update_hit_areas:function(){if(RT&&RT.UnregisterResizeControl(this._id),HitManager.clearHitControl(this._id),!this.isHidden()){RT&&RT.RegisterResizeControl(this._id);for(var t=this._id,e=null,i=this._get_el(),o=i.scrollLeft||0,r=i.scrollTop||0,n=this._obj,s=n.border,a=n.center_quiz_v||n.center_quiz_h?this.get_pos_(this._get_el("#main#container")):{x:0,y:0},_=0,l=this.answer_map_.length;_<l;_++)(e=this._get_el("#question#"+_))&&(HitManager.setHitArea({ctl_id:t,sub_id:"question",hdl_id:_+"",x:a.x+n.x+e.offsetLeft-o+s,y:a.y+n.y+e.offsetTop-r+s,w:e.offsetWidth,h:e.offsetHeight,z:n.z+.1,type:"rect",cursor:"pointer"}),e=this._get_el("#answer#"+_),HitManager.setHitArea({ctl_id:t,sub_id:"answer",hdl_id:_+"",x:a.x+n.x+e.offsetLeft-o+s,y:a.y+n.y+e.offsetTop-r+s,w:e.offsetWidth,h:e.offsetHeight,z:n.z+.1,type:"rect",cursor:"pointer"}))}},OnRTMouseEnter:function(t){!this.disabled_&&{question:1,answer:1}[t.sub_id]&&this.highlight_(this._get_el("#"+t.sub_id+"#"+t.hdl_id),!0)},OnRTMouseLeave:function(t){this.disabled_||!{question:1,answer:1}[t.sub_id]||this.end_.id===t.hdl_id&&this.end_.sub_id===t.sub_id||this.start_.id===t.hdl_id&&this.start_.sub_id===t.sub_id||this.highlight_(this._get_el("#"+t.sub_id+"#"+t.hdl_id),!1)},OnRTMouseUp:function(t){if(!this.disabled_&&{question:1,answer:1}[t.sub_id]){var e=this._get_el(),i=e.scrollLeft||0,o=e.scrollTop||0,r=this._obj,n=r.border,s=t.sub_id,a=t.hdl_id,_=HitManager.getHitArea({ctl_id:this._id,sub_id:s,hdl_id:a});"question"==s?this.start_={id:a,sub_id:s,x:_.x+_.w+1-r.x+i-n+4,y:_.y+(_.h>>1)-r.y+o-n}:"answer"==s&&(this.end_={id:a,sub_id:s,x:_.x-1-r.x+i-n-4,y:_.y+(_.h>>1)-r.y+o-n}),this.last_selected_id_&&this.highlight_(this._get_el(this.last_selected_id_),!1);var l="#"+s+"#"+a,d=this._get_el(l);d.setAttribute("aria-selected",!0),this.highlight_(d,!0),this.last_selected_id_=l;var h=this.start_,c=this.end_;this.connectPairs(r,h,c)&&(this.answers_[h.id]=c.id,this.checkPairing(),this.start_={},this.end_={},this.last_selected_id_&&this.highlight_(this._get_el(this.last_selected_id_),!1),this.handle_ready_trigger_())}},OnRTKeyUp:function(t){13!==t.button&&32!==t.button||this.OnRTMouseUp(t)},connectPairs:function(t,e,i){if(!(e.x&&e.y&&i.x&&i.y))return!1;var o=t.line_color||"#f00";if(t.random_line_color){for(;o="#"+Math.floor(16777215*Math.random()/100*100).toString(16),-1!==this.colors_.indexOf(o););this.colors_+=o}this.create_line_obj_(e,i,o),this.draw_lines_();var r=this._id,n="#"+e.sub_id+"#"+e.id,s="#"+i.sub_id+"#"+i.id,a=this._get_el(n),_=this._get_el(s);return a.setAttribute("aria-describedby",r+s),_.setAttribute("aria-describedby",r+n),!0},checkPairing:function(){for(var t=this.answer_pool_,e=this.answers_,i={},o=0,r=t.length;o<r;o++)e[o]&&(i["q"+o]=o,i["a"+e[o]]=e[o]);for(o=0,r=t.length;o<r;o++){if("undefined"==typeof i["q"+o]){var n="#question#"+o,s=this._get_el(n);s.removeAttribute("aria-describedby"),s.removeAttribute("aria-selected")}if("undefined"==typeof i["a"+o]){var a="#answer#"+o,_=this._get_el(a);_.removeAttribute("aria-describedby"),_.removeAttribute("aria-selected")}}},create_line_obj_:function(t,e,i){this.remove_all_lines_();var o=this.answers_,r=this.lines_;for(var n in o)o[n]==e.id&&(delete o[n],delete r["line_from_"+n]);var s={x:Math.min(t.x,e.x),y:Math.min(t.y,e.y)};s.w=Math.max(t.x,e.x,1)-s.x,s.h=Math.max(t.y,e.y,1)-s.y;var a={type:"arrow",id:"#answer_line#"+t.id,name:"",head0:"none",head1:"none",color:i,thickness:5,hidden:0,x0:t.x,y0:t.y,x1:e.x,y1:e.y,z:this._obj.z+1,locked:0,l0:6,w0:4,l1:6,w1:4},_={x:t.x,y:t.y},l={x:e.x,y:e.y},d={len:a.thickness*a.l0,width:a.thickness*a.w0,thickness:a.thickness,type:a.head0},h={len:a.thickness*a.l1,width:a.thickness*a.w1,thickness:a.thickness,type:a.head1};r["line_from_"+t.id]={div_id:"#cdiv#"+t.id+"_"+e.id,description:a,heads:[d,h],dragger:[_,l],rect:s,start:t,end:e}},draw_lines_:function(){var t=this._get_el(),e=this._obj;for(var i in this.lines_){var o=this.lines_[i],r=o.description,n=o.rect,s=o.start,a=o.end,_=$$("div");_.setAttribute("role","presentation"),_.style.position="absolute",_.style.overflow="visible",_.id=this._id+"#cdiv#"+s.id+"_"+a.id,_.style.backgroundColor="transparent",_.style.top="0px",_.style.left=n.x+"px",_.style.width=n.w+"px",_.style.height=e.h-(2*e.border+e.padding)+"px";var l=$$("canvas");l.id=this._id+r.id,l.style.position="absolute",l.style.overflow="hidden",l.width=n.w,l.height=e.h-(2*e.border+e.padding),_.appendChild(l),t.appendChild(_),this._cctx=l.getContext("2d");var d=o.dragger[0],h=o.dragger[1],c=o.heads[0],p=o.heads[1];CanvasArrow.draw.call(this,[d,h],c,p,r,"#cdiv#"+s.id+"_"+a.id,r.id)}},remove_all_lines_:function(){var t=this.lines_;for(var e in t){var i=t[e],o=i.start,r=i.end,n=this._get_el("#cdiv#"+o.id+"_"+r.id);n&&n.parentNode.removeChild(n)}},reset_quiz_:function(){this.remove_all_lines_(),this.answers_={},this.lines_={},this.last_selected_id_=null,Quiz.prototype.reset_quiz_.call(this)},get_user_result_:function(t,e){for(var i=this.student_answers_,o=this.answer_map_,r=[],n=0,s=i.length;n<s;n++){var a=i[n],_=o[n],l=_.answer==a?t:e;r[n]={icon:l,text:this.removeHTML(_.answer)}}return r},check_quiz_:function(){var t=this.student_answers_,e=this.correct_answers_;if(!t.length)return"skip";if(t.length!=e.length)return"wrong";var i=this.answer_map_,o=this.answers_,r=this.answer_pool_;for(var n in o)if(r[o[n]]!=i[n].answer)return"wrong";return"correct"},is_ready_:function(){var t=this.answer_pool_,e=this.answers_,i=[];for(var o in e)i.push(t[e[o]]);return(this.student_answers_=i).length==t.length}}),Quiz.mix=function(){Quiz.apply(this),this.type_="mix",this.ori_=null,this.is_dnd_=!1,this.resize_container_=!1,this.answer_pool_=[]},Quiz.mix.prototype=new Quiz,WCT.ExtendObject(Quiz.mix.prototype,{_remove_dom:function(){this._get_el().onscroll=null,this.in_move_&&(this.in_move_=!1,this.move_id_=null,this.move_el_&&this.move_el_.parentNode&&this.move_el_.parentNode.removeChild(this.move_el_),this.move_el_=null),Quiz.prototype._remove_dom.call(this)},prepare_answers_:function(){for(var t=[],e=[],i=this._obj,o=0,r=this.max_answers_;o<r;o++){var n=i["answer_"+(o+1)];n&&(t.push(n),e.push(n))}this.answer_pool_=t,this.correct_answers_=e,this.ori_="qa_horizontal"==i.quiz_alignment?"h":"v",this.is_dnd_="qt_drag_drop"==i.quiz_type,(EDIT_MODE&&Editor.Preview()||!EDIT_MODE)&&this.answer_pool_.mix()},OnRTChange:function(t){this.handle_ready_trigger_()},update_dom_current_:function(t){this.prepare_answers_();for(var e=this._obj,i=arguments[1]||e,o=0,r=this.max_answers_;o<r;o++){var n=this._get_el("#answer#"+o);n&&n.parentNode.removeChild(n)}this._editFields={};var s="h"===this.ori_,a=this.answer_pool_,_=a.length,l=2*(e.border+e.padding),d=2*(e.action_border_width||0),h=i.w-l,c=i.h-l,p=e.action_dist_to_next||0;s?(h=(h-(_-1)*p)/_,h-=d,c-=d):(c=(c-(_-1)*p)/_,c-=d,h-=d),this._get_el().style.overflow=this.is_dnd_?"visible":"auto";for(o=0;o<_;o++){if(b=a[o])if(this.is_dnd_){this.prevent_align_=!0;var u=$$("DIV");u.id=this._id+"#answer#"+o,u.tabIndex=e.tabindex,u.setAttribute("role","button"),EDIT_MODE&&(this._editFields["#answer#"+o]="answer_"+(o+1));var f=$$("p");f.style.position="relative",f.style.left=0,f.style.top="50%",f.style.transform="translateY(-50%)",f.innerHTML=WCT.CleanupHTMLString(b),u.appendChild(f),u.style.textAlign="center",u.style.display=s?"inline-block":"",u.style.verticalAlign="middle",o+1!==_&&(u.style["margin"+(s?"Right":"Bottom")]=p+"px"),this.apply_styling_(u),u.style.width=h+"px",u.style.height=c+"px",t.appendChild(u)}else{this.prevent_align_=!1,t.style.textAlign="center";var m=$$("SELECT");m.id=this._id+"#answer#"+o,EDIT_MODE&&(this._editFields["#answer#"+o]="answer_"+(o+1)),m.style.font="inherit",m.style.display=s?"inline":"block",o+1!==_&&(m.style["margin"+(s?"Right":"Bottom")]=p+"px"),this.apply_styling_(m,"select"),m.style.maxWidth=h+"px",t.appendChild(m);var g=$$("OPTION");g.innerHTML=PLATFORM.ANDROID?"...":"",m.appendChild(g);for(var y=0;y<=r;y++){var b;(b=a[y])&&((g=$$("OPTION")).innerHTML=this.removeHTML(b),m.appendChild(g))}}}this.is_dnd_&&(this._get_el().onscroll=this.on_scroll_),this._update_hit_areas(),this[(this.disabled_?"disable":"enable")+"_quiz_"]()},OnRTMouseDown:function(t){if(!this.in_move_&&this.is_dnd_&&"answer"===t.sub_id&&!this.disabled_){this.f_=document.onselectstart,document.onselectstart=function(){return!1},this.in_move_=!0,this.move_id_=t.hdl_id;var e=this._get_el("#answer#"+t.hdl_id),i=e.cloneNode(!0);i.className+=" dgo_text_container",i.id+="_move",i.style.zIndex=1e3;var o=parseInt(e.style.borderWidth||0),r=parseInt(e.style.padding||0);e.style.visibility="hidden";for(var n=0,s=this.answer_pool_.length;n<s;n++)this._get_el("#answer#"+n).setAttribute("aria-dropeffect","move");var a=HitManager.getHitArea({ctl_id:this._id,sub_id:"answer",hdl_id:t.hdl_id});i.style.position="absolute";var _=e.offsetWidth-2*(o+r),l=e.offsetHeight-2*(o+r);"v"==this.ori_?(i.style.width=_+"px",i.style.height=l+"px",this.offset_y=t.canvasY-a.y,i.style.left=a.x-2+"px",i.style.top=t.canvasY-this.offset_y-2+"px"):(this.offset_x=t.canvasX-a.x,i.style.top=a.y-2+"px",i.style.left=t.canvasX-this.offset_x-2+"px",i.style.height=l+"px"),Canvas.Parent().appendChild(i),this.move_el_=i,t.hasToBeCancelled=!0,RT.AddHook("mouseup",this.OnRTMouseUp,this._id),RT.SetDrag(this._id)}},OnRTMouseMove:function(t){if(this.in_move_){if("answer"===t.sub_id&&this.move_id_!==t.hdl_id){var e=this._get_el("#answer#"+this.move_id_),i=this._get_el("#answer#"+t.hdl_id);WCT.dom.SwapNode(i,e)}e=this.move_el_;"v"===this.ori_?e.style.top=t.canvasY-this.offset_y+"px":e.style.left=t.canvasX-this.offset_x+"px",t.hasToBeCancelled=!0,this._update_hit_areas()}},OnRTMouseUp:function(t){if(this.in_move_){document.onselectstart=this.f_,this.f_=null,(r=this._get_el("#answer#"+this.move_id_)).style.visibility="",this.move_el_.parentNode.removeChild(this.move_el_),this.move_el_=null;for(var e=0,i=this.answer_pool_.length;e<i;e++)this._get_el("#answer#"+e).setAttribute("aria-dropeffect","none");this._update_hit_areas();for(var o=[],r=this._get_el("#main#container"),n=this._obj.action_dist_to_next||0,s="h"===this.ori_?"Right":"Bottom",a=(e=0,this.correct_answers_.length);e<a;e++){var _=r.children[e];_&&_.id&&(o.push(BROWSER.IE?_.innerText:_.textContent),_.style["margin"+s]=(e+1!==a?n:0)+"px")}this.student_answers_=o,this.in_move_=!1,t.hasToBeCancelled=!0,RT.RemoveHook("mouseup",this.OnRTMouseUp,this._id),RT.SetDrag(null),this.handle_ready_trigger_()}},is_ready_:function(){this.student_answers_=[];var t=this.correct_answers_.length;if(this.is_dnd_){for(var e=[],i=this._get_el("#main#container"),o=0,r=this.correct_answers_.length;o<r;o++){var n=i.children[o];n&&n.id&&e.push(BROWSER.IE?n.innerText:n.textContent)}this.student_answers_=e}else for(o=0;o<t;o++){var s=this._get_el("#answer#"+o);if(s){var a;if(0==s.selectedIndex)return!1;a=s.options[s.selectedIndex].innerText||s.value,this.student_answers_.push(a)}}return!0},set_quiz_preview_:function(t){for(var e=this.correct_answers_.length,i=0;i<=e;i++){var o=this._get_el("#answer#"+i);o&&(t?this.is_dnd_?this.handle_ready_trigger_():(WCT.event.Observe("change",rt_hdl_change,o),this.have_event_handler_=!0):this.is_dnd_||this.have_event_handler_&&(WCT.event.StopObserving("change",rt_hdl_change,o),this.have_event_handler_=!1))}!t&&this.in_move_&&(this.in_move_=!1,this.move_id_=null,this.move_el_&&this.move_el_.parentNode&&this.move_el_.parentNode.removeChild(this.move_el_),this.move_el_=null),t&&this[(this.disabled_?"disable":"enable")+"_quiz_"]()},_update_hit_areas:function(){if(RT&&RT.UnregisterResizeControl(this._id),HitManager.clearHitControl(this._id),!this.isHidden()){var t=this._obj,e=t.border;if(HitManager.setHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"dom",type:"rect",cursor:"",x:t.x,y:t.y,w:t.w,h:t.h,z:t.z}),this.is_dnd_&&!this.disabled_){RT&&RT.RegisterResizeControl(this._id);var i=this.answer_pool_;if(i)for(var o=this.get_scroll_info_(),r=this.disabled_?"":"move",n=0,s=i.length-1;n<=s;n++){var a=this._get_el("#answer#"+n);if(a){var _={x:a.offsetLeft||0,y:a.offsetTop||0,w:a.offsetWidth||0,h:a.offsetHeight||0},l=this.limit_hit_area_to_control_(_,o);l&&HitManager.setHitArea({ctl_id:this._id,sub_id:"answer",hdl_id:n+"",type:"rect",cursor:r,x:l.x+e,y:l.y+e,w:l.w,h:l.h,z:t.z+1})}}}}}}),Quiz.scale=function(){Quiz.apply(this),WCT.ExtendObject(this._hdx,{range:{clamp:this.clamp_range},answer:{clamp:this.clamp_answer},init:{clamp:this.clamp_answer},slider_w:{clamp:this.clamp_scale_slider_value},slider_h:{clamp:this.clamp_scale_slider_value},scale_thickness:{clamp:this.clamp_scale_slider_value}}),this.type_="scale",this.marker_distance_=0,this.answer_positions_={},this.slider_border_radius_=2,this.slider_border_width_=1,this._defaultEdit="range"},Quiz.scale.prototype=new Quiz,WCT.ExtendObject(Quiz.scale.prototype,{clamp_scale_slider_value:function(t,e){e.res=Math.max("scale_thickness"==e.name?0:1,e.val)},clamp_range:function(t,e){var i=e.val,o=-1!=i.search(";")?";":"-";e.val=i.trim();var r=i.split(o),n=parseInt(r[0]),s=parseInt(r[1]);isNaN(n)&&(n=0),(isNaN(s)||s<n)&&(s=n+1),n<0&&(o=";"),e.res=n+o+s},clamp_answer:function(t,e){var i=e.val;if(""!=i&&isNaN(parseInt(i)))e.res="";else{var o=Controls[t.id].get_range_();parseInt(i)<o[0]?e.res=o[0].toString():parseInt(i)>o[1]&&(e.res=o[1].toString())}},get_range_:function(){for(var t=this._obj,e=-1!=t.range.search(";")?";":"-",i=t.range.split(e),o=i.length-1;0<=o;o--){var r=parseInt(i[o]);i[o]=isNaN(r)?0:r}return i},prepare_answers_:function(t){var e={},i=this.get_range_(),o=((arguments[1]?arguments[1].w:t.w)-2*(t.padding+t.border+(t.action_slider_border_width||0))-t.slider_w)/(i[1]-i[0]);if(this.IsRTL())for(var r=i[1],n=0;r>=i[0];r--,n++)e[r]=n*o;else for(r=i[0],n=0;r<=i[1];r++,n++)e[r]=n*o;this.marker_distance_=o,this.correct_answers_=[t.answer],this.answer_positions_=e},update_dom_current_:function(t){this._unsetRTL();var e=this._obj;if(t.innerHTML="",e.range&&e.answer&&""!=e.range&&""!=e.answer){var i=this.get_range_(),o=parseInt(e.answer);(o<i[0]||o>i[1])&&(Env.onPropChange(this._id,"answer",i[0]),o=i[0]);var r=arguments[1]||e;this.prepare_answers_(e,r);var n=e.center_quiz_v?0:e.padding,s="undefined"!=typeof e.init&&""!=e.init?parseInt(e.init):i[0],a=Math.max(0,r.w-2*e.border-2*e.padding-e.slider_w),_=e.action_slider_border_width||this.slider_border_width_,l=$$("DIV");l.id=this._id+"#main#scale",l.style.position="absolute",l.style.top=n+(e.slider_h+2*_-e.scale_thickness>>1)+"px",l.style.left=n+(e.slider_w>>1)+"px",l.style.width=a+"px",l.style.height=e.scale_thickness+"px",l.style.backgroundColor=e.scale_color,t.appendChild(l);var d=this.IsRTL(),h=this.answer_positions_[s]||0,c=e.action_slider_border_radius||this.slider_border_radius_,p=$$("DIV");BROWSER.MOBILE&&(p.onclick=function(){}),p.id=this._id+"#main#slider",p.tabIndex=e.tabindex,p.setAttribute("role","slider"),p.setAttribute("draggable",!0),p.setAttribute("aria-valuemin",i[0]),p.setAttribute("aria-valuemax",i[1]),p.setAttribute("aria-valuenow",e.init||i[0]),p.style.position="absolute",p.style.left=n+h+"px",p.style.top=n+"px",p.style.height=e.slider_h+"px",p.style.width=e.slider_w+"px",p.style.borderRadius=c+"px",p.style.backgroundColor=e.slider_color,p.style.border=_+"px solid "+e.slider_border_color,t.appendChild(p);var u=e.slider_h+n+2*_,f="undefined"!=typeof e.action_dist_to_next?e.action_dist_to_next:10,m="undefined"!=typeof e.action_align?e.action_align.toLowerCase():"left",g=e.center_quiz_v?e.padding:0,y=e.action_border_width||0;e.action_border_style&&"none"===e.action_border_style&&(y=0);var b=null;switch(m){case"center":b=(e.w-100>>1)-e.border-g;break;case"right":b=e.w-g-2*e.border-e.padding-100,d&&(b=n);break;case"left":default:b=n,d&&(b=e.w-g-2*e.border-e.padding-100-2*y)}var v=this._get_el("#main#info");v&&v.parentNode.removeChild(v),(v=$$("DIV")).id=this._id+"#main#info",v.setAttribute("role","presentation"),v.style.position="absolute",v.style.top=u+f+"px",v.style.minWidth="100px",v.style.textAlign="center",v.innerHTML=""!=s?s:i[0],v.style.left=b+"px",this.apply_obj_style_(v),this.apply_styling_(v),t.appendChild(v),EDIT_MODE&&(this._editFields["#main#info"]="range"),this._update_hit_areas(),this.handle_ready_trigger_()}},align_quiz_:function(){var t=this._obj;if(t){var e=t.center_quiz_v||!1,i=this._get_el("#main#info"),o=this._get_el("#main#container");if(o&&i){var r="undefined"!=typeof t.action_dist_to_next?t.action_dist_to_next:10,n=arguments[0]||t,s=t.border||0,a=n.h-2*s,_=t.slider_h+r+(i.offsetHeight||0);e?(o.style.position="absolute",o.style.top=Math.max(0,a-_>>1)+"px"):(o.style.position="",o.style.top=""),this._update_hit_areas()}}},check_quiz_:function(){return this.student_answers_.length?this.student_answers_[0]==this._obj.answer?"correct":"wrong":"skip"},is_ready_:function(){var t=this._get_el("#main#info");return!!t&&(this.student_answers_=[],this.student_answers_.push(t.innerHTML),""!=t.innerHTML)},get_nearest_position_:function(t){var e=this._obj,i=this.get_range_(),o=Math.max(0,Math.min(t,e.w-2*e.border)-(e.slider_w>>1)),r=this.answer_positions_;if(this.IsRTL())for(var n=parseInt(i[0]),s=parseInt(i[1]);n<=s;n++){var a=r[n],_=r[n+1];if(!(o<a&&void 0!==_))return n;if(o===_)return n+1;if(_<o)return o-a<=_-o?n+1:n}else for(n=parseInt(i[0]),s=parseInt(i[1]);n<=s;n++){a=r[n],_=r[n+1];if(!(a<o&&void 0!==_))return n;if(o===_)return n+1;if(o<_)return o-a<=_-o?n:n+1}},_update_hit_areas:function(){if(RT&&RT.UnregisterResizeControl(this._id),HitManager.clearHitControl(this._id),!this.isHidden()){var t=this._obj,e=this.get_pos_(this._get_el("#main#container")),i=t.center_quiz_v?e.y-t.padding:0;BROWSER.FIREFOX&&(i+=t.border);var o=this._get_el("#main#info");if(o){RT&&RT.RegisterResizeControl(this._id);var r=this.get_range_(),n=""!=o.innerHTML?o.innerHTML:r[0],s=t.padding+t.border,a=this.disabled_?"":"pointer",_=2*(t.action_slider_border_width||this.slider_border_width_),l=this.answer_positions_;HitManager.setHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"slider",type:"rect",cursor:a,x:t.x+s+l[n],y:t.y+s+i,w:t.slider_w+_,h:t.slider_h+_,z:t.z+.2}),HitManager.setHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"scale",type:"rect",cursor:a,x:t.x+s,y:t.y+s+i,w:t.w-2*s,h:t.slider_h+_,z:t.z+.1})}}},disable_quiz_:function(){this.disabled_=!0,this._update_hit_areas()},enable_quiz_:function(){this.disabled_=!1,this._update_hit_areas()},Terminate:function(){delete this.answer_positions_,Quiz.prototype.Terminate.call(this)},updateSlider:function(t,e){var i=this._obj,o=i.center_quiz_v?0:i.padding,r=this._get_el("#main#slider");r.style.left=e+o+"px",r.setAttribute("aria-valuenow",t),this._get_el("#main#info").innerHTML=t},OnRTKeyDown:function(t){if(!(37!==t.button&&39!==t.button||this.disabled_)){var e=this.get_range_(),i=parseInt(this.student_answers_[0]),o=39===t.button?Math.min(i+1,e[1]):Math.max(i-1,e[0]);this.updateSlider(o,this.answer_positions_[o]),this._update_hit_areas(),this.handle_ready_trigger_()}},OnRTMouseDown:function(t){if(!this.disabled_){var e=t.hdl_id;"slider"!==e&&"scale"!==e||(this.moving=!0,t.hasToBeCancelled=!0,RT.setCapture(this._id),RT.SetDrag(this._id),this.OnRTMouseMove(t))}},OnRTMouseMove:function(t){if(!this.disabled_&&this.moving){var e=this._obj,i=t.canvasX-e.x-e.padding-e.border,o=this.get_nearest_position_(i);this.updateSlider(o,this.answer_positions_[o]),t.hasToBeCancelled=!0}},OnRTMouseUp:function(t){if(!this.disabled_&&this.moving){this.moving=!1,t.hasToBeCancelled=!0,RT.releaseCapture(),RT.SetDrag(null);var e=this._obj,i=t.canvasX-e.x-e.padding-e.border,o=this.get_nearest_position_(i);this.updateSlider(o,this.answer_positions_[o]),this._update_hit_areas(),this.handle_ready_trigger_()}}}),Quiz.hotspot=function(){Quiz.apply(this),WCT.ExtendObject(this._hdx,{x:{to_dom:this.set_xy_,clamp:clamp_x},y:{to_dom:this.set_xy_,clamp:clamp_y},hotspot_x:{to_dom:this.set_hotspot_pos_,clamp:this.clamp_hotspot_x_},hotspot_y:{to_dom:this.set_hotspot_pos_,clamp:this.clamp_hotspot_y_},hotspot_w:{to_dom:this.set_hotspot_pos_,clamp:this.clamp_hotspot_w_},hotspot_h:{to_dom:this.set_hotspot_pos_,clamp:this.clamp_hotspot_h_},pin_sprite_x:{to_dom:noop,clamp:this.clamp_pin_},pin_sprite_y:{to_dom:noop,clamp:this.clamp_pin_},pin_sprite_w:{to_dom:noop,clamp:this.clamp_pin_},pin_sprite_h:{to_dom:noop,clamp:this.clamp_pin_},pinpos_x:{to_dom:noop,clamp:this.clamp_pin_},pinpos_y:{to_dom:noop,clamp:this.clamp_pin_},center_quiz_v:{to_dom:this.do_align_hotspot_,clamp:clamp_boolean},center_quiz_h:{to_dom:this.do_align_hotspot_,clamp:clamp_boolean}}),this.type_="hotspot",this.hotspot_={set:!1,found:null,x:undefined,y:undefined,pin:{url:"hotspot.png",sprite:!0,x:0,y:0,w:27,h:29,pinpos_x:0,pinpos_y:29}},this.img_data_={w:0,h:0,scale:1},this.container_info_={x:0,y:0,w:0,h:0},this._hotspotPreviewVisible=!0,this.resize_container_=!1},Quiz.hotspot.prototype=new Quiz,WCT.ExtendObject(Quiz.hotspot.prototype,{_rd_get_min_rect:function(t){if("hotspot"==t)return{w:10,h:10};var e=this._obj,i=2*(e.padding+e.border);return{w:Math.max(10,i),h:Math.max(10,i)}},_rd_update_dom_pos:function(t,e,i){var o=null;"hotspot"==t?(o=this._get_el("#main#hotspot"),e=this.hotspot_pos_(e)):"main"==t&&(o=this._get_el(),e=e||this._obj),o&&(o.style.left=e.x+"px",o.style.top=e.y+"px")},_rd_update_dom_rect:function(t,e){"hotspot"==t?this.update_dom_hotspot_(e):this._update_dom(e)},clamp_hotspot_x_:function(t,e){t.image&&t.image.id&&(e.val<0&&(e.res=0),e.val>t.image.w&&(e.res=t.image.w))},clamp_hotspot_y_:function(t,e){t.image&&t.image.id&&(e.val<0&&(e.res=0),e.val>t.image.h&&(e.res=t.image.h))},clamp_hotspot_w_:function(t,e){if(t.image&&t.image.id){e.val<10&&(e.res=10),e.val>t.image.w&&(e.res=t.image.w)}},clamp_hotspot_h_:function(t,e){if(t.image&&t.image.id){e.val<10&&(e.res=10),e.val>t.image.h&&(e.res=t.image.h)}},clamp_pin_:function(t,e){if(e.val<0&&(e.res=-e.val),t.pin_image&&t.pin_image.id)switch(e.name){case"pin_sprite_x":case"pin_sprite_w":case"pinpos_x":e.res=Math.min(e.res,t.pin_image.w);break;case"pin_sprite_y":case"pin_sprite_h":case"pinpos_y":e.res=Math.min(e.res,t.pin_image.h)}},hotspot_pos_:function(){var t=this._obj,e=this.img_data_.scale,i=arguments[0]||{x:t.hotspot_x,y:t.hotspot_y};return{x:parseInt(i.x*e),y:parseInt(i.y*e)}},InitEdit:function(){var t=new HotSpotDragger(this,this._id,"main");t.Init({x:"x",y:"y",w:"w",h:"h",z:"z"}),this.container_info_=this.get_pos_(this._get_el("#main#container")),t.UpdatePos(),this._draggers.main=t;var e=this._obj;e.image&&e.image.id&&this.InitEditHotSpot()},InitEditHotSpot:function(){if(!this._draggers.hotspot){var t=new HotSpotDragger(this,this._id,"hotspot");t.setHandle(Dragger.HdlHotspotquiz),t.Init({x:"hotspot_x",y:"hotspot_y",w:"hotspot_w",h:"hotspot_h"}),t.UpdatePos(),t.SetVisible(!0),this._draggers.hotspot=t}},Terminate:function(){var t=this._get_el("#main#pin");t&&t.parentNode.removeChild(t),BROWSER.MOBILE&&(this._get_el("#main#image").ontouchmove=null);Quiz.prototype.Terminate.call(this)},setHotspotPreview:function(t){var e=this._get_el("#main#hotspot");e&&(this._hotspotPreviewVisible=t,e.style.display=t?"":"none")},get_pos_:function(t){return Quiz.getPos(t)},do_align_hotspot_:function(t,e,i){Quiz.Align.apply(this,arguments),this.update_dom_hotspot_(),this.container_info_=this.get_pos_(this._get_el("#main#container"));var o=this._draggers;o&&o.hotspot&&o.hotspot.UpdatePos()},set_hotspot_pos_:function(t,e,i){if(EDIT_MODE){this.update_dom_hotspot_();var o=this._draggers;o&&o.hotspot&&o.hotspot.UpdatePos()}},set_xy_:function(t,e,i){this._get_el().style["x"==e?"left":"top"]=i+"px";var o=this._draggers;o&&(this.container_info_=this.get_pos_(this._get_el("#main#container")),o.main.UpdatePos(),o.hotspot&&o.hotspot.UpdatePos()),this._update_hit_areas&&this._update_hit_areas()},update_dom_hotspot_:function(t){var e=this._get_el("#main#hotspot");if(e){var i=this._obj,o=t||{w:i.hotspot_w,h:i.hotspot_h},r=this.hotspot_pos_(t),n=i.center_quiz_v||i.center_quiz_h?0:i.padding,s=this.img_data_.scale;e.style.left=r.x+n+"px",e.style.top=r.y+n+"px",e.style.width=o.w*s+"px",e.style.height=o.h*s+"px"}},calculate_image_data_:function(){var t=this._obj,e=arguments[0]||t,i=2*(t.padding+t.border),o=e.w-i,r=e.h-i,n=t.image.w,s=t.image.h,a=o,_=r;n<o&&s<r?this.store_img_data_(n,s,1):(o*s<n*r?_=o*s/n:a=r*n/s,this.store_img_data_(a,_,a/n))},store_img_data_:function(t,e,i){this.img_data_={w:t,h:e,scale:i}},update_dom_current_:function(t){this._unsetRTL(),this.remove_image_and_hotspot_();var e=this._draggers&&this._draggers.hotspot||!1,i=this._obj,o=this._get_el("#main#dom");if(o.setAttribute("role","button"),o.setAttribute("aria-label",i.alt_txt||""),o.tabIndex=i.tabindex,t.style.overflow="visible",t.parentNode.style.overflow="hidden",i.image&&i.image.id)if(i.image.w&&i.image.h){this.calculate_image_data_(arguments[1]);var r=$$("img");if(r.id=this._id+"#main#image",r.alt=i.alt_txt||"",r.style.position="absolute",r.style.border="0",r.style.width=this.img_data_.w+"px",r.style.height=this.img_data_.h+"px",BROWSER.MOBILE&&(r.ontouchmove=function(t){t.stopPropagation()}),t.appendChild(r),r.src=Context.ToAbsPath(i.image.id,this._src_ctx),EDIT_MODE){var n=$$("div");n.id=this._id+"#main#hotspot",n.style.position="absolute",n.style.border="1px dashed red",n.style.overflow="hidden",n.style.backgroundColor="white",n.style.display=this._hotspotPreviewVisible?"":"none",t.appendChild(n),set_opacity(n,45),this.update_dom_hotspot_()}var s=this._draggers;s&&(this.InitEditHotSpot(),this.container_info_=this.get_pos_(this._get_el("#main#container")),s.hotspot.UpdatePos()),this.do_for_while_("_update_hit_areas",1e3)}else preload_image.call(this);else e&&e.SetVisible(!1)},remove_image_and_hotspot_:function(){var t=this._get_el("#main#image");t&&(BROWSER.MOBILE&&(t.ontouchmove=null),t.parentNode&&t.parentNode.removeChild(t));var e=this._get_el("#main#hotspot");e&&e.parentNode&&e.parentNode.removeChild(e)},reset_quiz_:function(){this.destroy_canvas_();var t=this._get_el("#main#pin");t&&t.parentNode.removeChild(t),Quiz.prototype.reset_quiz_.call(this)},destroy_canvas_:function(){var t=this._get_el("#main#canvas");t&&t.parentNode.removeChild(t),this.shape_&&(this.shape_.Destructor(),this.shape_=null)},get_user_result_:function(t,e){return{}},check_quiz_:function(){return null==this.hotspot_.found?"skip":this.hotspot_.found?"correct":"wrong"},is_ready_:function(){return this.hotspot_.set},do_on_hide_:function(){var t=this._get_el("#main#pin");t&&(t.style.display="none")},do_on_show_:function(){var t=this._get_el("#main#pin");t&&(t.style.display="")},show_pin_:function(t){var e=this._get_el("#main#pin");e&&e.parentNode.removeChild(e);var i=this._obj,o=this._id;(e=$$("div")).id=o+"#main#pin",e.tabIndex=i.tabindex,e.setAttribute("role","button"),e.setAttribute("aria-pressed",!0),e.setAttribute("aria-describedby",o+"#main#dom"),e.style.position="absolute",this._get_el("#main#dom").setAttribute("aria-selected",!0);var r=this.hotspot_.pin,n=r.x,s=r.y,a=r.w,_=r.h,l=r.pinpos_x,d=r.pinpos_y,h=to_producer_resource_("hotspot");i.pin_image&&""!==i.pin_image.id&&(h=Context.ToAbsPath(i.pin_image.id,this._src_ctx),n=i.pin_sprite_x||0,s=i.pin_sprite_y||0,a=i.pin_sprite_w,_=i.pin_sprite_h,l=i.pinpos_x||0,d=i.pinpos_y||0);var c=t.canvasX-l,p=t.canvasY-d;e.style.left=c+"px",e.style.top=p+"px",a&&(e.style.width=a+"px"),_&&(e.style.height=_+"px"),a&&_&&(e.style.overflow="hidden");var u=$$("img");u.src=h,u.style.position="absolute",u.style.left=-n+"px",u.style.top=-s+"px",e.appendChild(u),e.style.zIndex=i.z+1,Canvas.Parent().appendChild(e)},OnRTMouseUp:function(t){this.disabled_||"main"==t.sub_id&&(this.hotspot_.set=!0,this.hotspot_.found="hotspot"==t.hdl_id,this.show_pin_(t),this.handle_ready_trigger_(),t.hasToBeCancelled=!0)},OnDefaultEdit:function(){return Env.edit({ctlId:this._id,paramName:"image",posSize:this.GetHtmlPosSize(0)})},set_quiz_param_:function(t,e){},set_quiz_preview_:function(t){if(this.hotspot_.set=!1,this.hotspot_.found=!1,this.setHotspotPreview(!t),!t){var e=this._get_el("#main#pin");e&&e.parentNode.removeChild(e)}},disable_quiz_:function(){this.disabled_=!0,this._update_hit_areas()},enable_quiz_:function(){this.disabled_=!1,this._update_hit_areas()},_update_hit_areas:function(){RT&&RT.UnregisterResizeControl(this._id),HitManager.clearHitControl(this._id);var t=this._obj;if(t.image&&!this.isHidden()){var e=t.center_quiz_v||t.center_quiz_h,i=this.disabled_?"":"crosshair",o=t.border,r=e?0:t.padding,n=e?this.get_pos_(this._get_el("#main#container")):{x:0,y:0},s=this.img_data_,a=t.x+o+r+n.x,_=t.y+n.y+o+r;HitManager.setHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"image",cursor:i,type:"rect",x:a,y:_,w:s.w,h:s.h,z:t.z});var l=this.hotspot_pos_(),d=1/s.scale,h=parseInt(t.hotspot_w/d),c=parseInt(t.hotspot_h/d),p=a+l.x;HitManager.setHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"hotspot",cursor:i,type:"rect",x:p,y:_+l.y,w:h,h:c,z:t.z+.5})}}}),Quiz.eval=function(){Quiz.apply(this),this.type_="quiz_eval",this.is_dom_set_=!1,this._hdx.track_completion={to_dom:this.track_completion_}},Quiz.eval.prototype=new Quiz,Quiz.eval.CheckSB=function(t){var e=Controls[t],i=e?e._obj:null;if(i){var o=e._get_el();if(o&&o.clientHeight<o.scrollHeight)for(var r=WCT.dom.GetScrollbarWidth(),n=o.childNodes,s=i.w-r,a=0,_=null;_=n[a++];)_.style.width=s+"px"}},WCT.ExtendObject(Quiz.eval.prototype,{track_completion_:function(t,e,i){i&&ctx.track_completion&&ctx.track_completion()},update_dom_current_:function(t){if(window.ctx&&ctx.getQuizTrackingHtml&&!this.is_dom_set_){this.is_dom_set_=!0;var e=this._obj,i=e.feedback;i.pass=Context.ResolveHtmlString(i.pass,this._src_ctx),i.fail=Context.ResolveHtmlString(i.fail,this._src_ctx);var o=new TextObject(this._id);o.Create(t),o.SetStyle({x:0,y:0,w:e.w,h:e.h,valign:"top"}),o.SetText(ctx.getQuizTrackingHtml(e.req_percent,e.eval_type,i)),this._tctl=o;for(var r=!0,n=1;r;){var s=$("row#exp#"+n);if(s){function a(t){var e=RT.normalize_evt(t);if("keyup"!==e.type||13===e.button||32===e.button){var i=$("row#details#"+this.id.split("#")[2]),o=""===i.style.display;i.style.display=o?"none":"",this.innerHTML=o?l:_}}var _=PLATFORM.ANDROID?"&#8744;":"&#x2c4;",l=PLATFORM.ANDROID?"&#8743;":"&#x2c5;";s.onclick=a,s.onkeyup=a}else r=!1;n++}BROWSER.IE&&WCT.SetTimeout(Quiz.eval.CheckSB,1,Quiz.eval,[this._id])}},check_quiz_:function(){return"skip"},print_quiz_:function(){var t=$(this._tctl.uid_+"#text"),e=$$("DIV"),i=get_computed_style(t);e.style.fontSize=i.fontSize||"",e.style.fontFamily=i.fontFamily||"",e.style.color=i.color||"",e.innerHTML=t.innerHTML,Env.Print(e,!0)}}),Jumper.prototype=new StatusControl,Jumper.Jump=function(t){var e=arguments[1];if(t.match(/^page\./))return Page.RTFireTrigger(t,e),!0;var i,o,r=t.indexOf("!");if(0<r)if(i=t.substr(0,r),o=t.substr(r+1),"taskset"==i)i="task";else{if("t2_config"==i){if((r=o.indexOf(":"))<=0)return;var n=o.substr(r+1);return o=o.substr(0,r),Page.RTFireTrigger("page.t2_config",{cfg:o,value:n}),!0}if("slide"!=i&&"tourstop"!=i)return!1}else{var s=t.substr(0,3);if("SL_"==s)i="slide";else{if("TS_"!=s)return!1;i="tourstop"}o=t}return Page.RTFireTrigger("page."+i+"_jump",o),!0},Jumper.prototype.RTFireTrigger=function(t,e){if("jump"==t){var i=this._obj;i.target&&Jumper.Jump(i.target)&&i.onjump&&Page.RTFireTrigger(i.onjump)}else EDIT_MODE&&Editor.RuntimeInfo("no trigger: "+t)},Notifier.prototype=new StatusControl,Notifier.resolveVar=function(t){if(2<t.length&&'"'==t[0]&&'"'==t[t.length-1])return t.substr(1,t.length-2);if(0===t.lastIndexOf("context.",0)){var i=t.substr("context.".length);return Context.Get(i)}var o=Page.GetVariable(t);if(!o)try{var r=window&&window.parent;if(r){var n=r.location&&r.location.hash;"#"==n[0]&&(n=n.substr(1));for(var s=n.split("&"),a=0;a<s.length;a++){var _=s[a].split("=");if(_[0]==t){o=_[1];break}}}}catch(e){}return o},Notifier.build_param_string=function(t){var e="";if(t){for(var i=(t=t.replace(/,|;|\r|\n/g," ")).split(" "),o=0;o<i.length;o++){var r=i[o],n=r;if(r.length){var s=r.split(":");2==s.length&&(n=s[0],r=s[1]),e.length&&(e+="&");var a=this.resolveVar(r);e+=n+"="+(a||"")}}return e}return null},WCT.ExtendObject(Notifier.prototype,{RTFireTrigger:function(t,e){"notify"==t?this.notify_(e):EDIT_MODE&&Editor.RuntimeInfo("no trigger: "+t)},notify_:function(t){var e=this._obj;if(!(e.once&&0<this.fired_)){var i=e.url;if(e.hostvar){var o=Notifier.resolveVar(e.hostvar);i=(e.protocol||"http")+"://"+o+i}var r=Notifier.build_param_string(e.values);if(r&&(i+=-1==i.search("[?]")?"?":"&",i+=r),EDIT_MODE&&Editor.RuntimeInfo("load url "+i),"NAVIGATE"==e.method)window&&window.parent&&(window.parent.location=i);else null==("GET"==e.method?XHR.GetS(i):XHR.PostS(i))?(e.on_notify_error&&Page.RTFireTrigger(e.on_notify_error),this.set_message_("error")):(this.fired_++,e.on_notify&&Page.RTFireTrigger(e.on_notify),this.set_message_(e.once?"[x]":"["+this.fired_+"]"))}},_on_set_preview:function(t){StatusControl.prototype._on_set_preview.call(this,t),t&&(this.fired_=0)}}),Tracker.prototype=new StatusControl,WCT.ExtendObject(Tracker.prototype,{RTFireTrigger:function(t,e){"track"==t?this.track_(e):EDIT_MODE&&Editor.RuntimeInfo("no trigger: "+t)},send_track_:function(){if(window.ctx&&ctx.track){var t=this._obj,e={id:"user_action_correct_action",uid:t.id,caption:"synth",cur:t.cur,max:t.max};ctx.track(e),this.fired_++}},track_:function(t){var e=this._obj;e.once&&0!=this.fired_||(this.send_track_(),this.set_message_(e.once?"[x]":"["+this.fired_+"]"))},_on_set_preview:function(t){StatusControl.prototype._on_set_preview.call(this,t),t&&(this.fired_=0)}}),Waypoint.prototype=new RectControl,Waypoint.set_w=function(t,e,i){var o=this._get_el(),r=Math.min(.75*i,this._obj.h);o.style.fontSize=.8*r+"px",set_w.call(this,t,e,i)},Waypoint.set_h=function(t,e,i){var o=this._get_el(),r=Math.min(.75*this._obj.w,i);o.style.fontSize=.8*r+"px",set_h.call(this,t,e,i)},Waypoint.prototype._update_dom=function(t){if(!this._disable_dom_update){var e=this._get_el();if(e){var i=this.is_visited_()?"visited":"unvisited",o=this._obj;if(t=t||o,!o.image||o.image.w&&o.image.h){e.style.left=t.x+"px",e.style.top=t.y+"px",e.style.width=t.w+"px",e.style.height=t.h+"px";var r=o["img_"+i],n=this._get_el("#main#img");if(r&&r.w&&r.h){var s,a,_=r.w,l=r.h;t.w*l<_*t.h?(s=t.w,a=t.w*l/_):(a=t.h,s=t.h*_/l),this.img_rect_={x:Math.floor((t.w-s)/2),y:Math.floor((t.h-a)/2),w:Math.floor(s),h:Math.floor(a)},n.style.left=this.img_rect_.x+"px",n.style.top=this.img_rect_.y+"px",n.style.width=this.img_rect_.w+"px",n.style.height=this.img_rect_.h+"px",n.src=Context.ToAbsPath(r.id,this._src_ctx),n.style.display="block"}else n.style.display="none";this._update_hit_areas()}else preload_image.call(this)}}},Waypoint.prototype._rd_update_dom_rect=function(t,e){var i=this._get_el(),o=e||this._obj,r=Math.min(.75*o.w,o.h);i.style.fontSize=.8*r+"px",RectControl.prototype._rd_update_dom_rect.call(this,t,e)},Waypoint.prototype.is_visited_=function(){return WayPoint[this._obj.waypoint_name]||!1},Waypoint.prototype.set_visited_=function(t){t?WayPoint[this._obj.waypoint_name]=!0:delete WayPoint[this._obj.waypoint_name],this._update_dom()},Waypoint.prototype.visit_=function(t){this.is_visited_()||(this.set_visited_(!0),this._obj.on_visited&&Page.RTFireTrigger(this._obj.on_visited,t))},Waypoint.prototype.unvisit_=function(t){this.is_visited_()&&(this.set_visited_(!1),this._obj.on_unvisited&&Page.RTFireTrigger(this._obj.on_unvisited,t))},Waypoint.prototype.RTFireTrigger=function(t,e){"check"==t||("visit"==t?this.visit_(e):"unvisit"==t?this.unvisit_(e):EDIT_MODE&&Editor.RuntimeInfo("no trigger: "+t))},Waypoint.prototype._create_dom=function(){var t=$$("div");t.id=this._id+"#main#dom",t.className="Waypoint",t.style.position="absolute",t.style.overflow="hidden",t.style.padding="0px",t.style.textAlign="center",t.style.fontFamily="Courier New",t.style.fontSize="9pt",t.style.backgroundColor="transparent";var e=$$("img");e.id=this._id+"#main#img",e.style.position="absolute",t.appendChild(e),Canvas.Parent().appendChild(t),Canvas.Parent().appendChild(t)},Waypoint.prototype._rd_get_min_rect=TimerControl.prototype._rd_get_min_rect,Waypoint.prototype._on_set_preview=function(t){},Waypoint.prototype.OnRTMouseClick=function(t){this._obj.onclick&&Page.RTFireTrigger(this._obj.onclick,t),this.is_visited_()?this.unvisit_():this.visit_(),this.handle_sim_actions_&&this.handle_sim_actions_(t)},PoiControl.prototype=new RectControl,PoiControl.DEF_ANIM_TIME=500,PoiControl.DEF_FOCUS_TYPE="simple",WCT.ExtendObject(PoiControl.prototype,{_rd_get_min_rect:function(t){return{w:90,h:18}},Terminate:function(){WCT.POI.StopAnimation(this.aid_),RectControl.prototype.Terminate.call(this)},RTFireTrigger:function(t,e){if("focus"==t){var i=Controls.page;if(i){var o=Page.clientWidth,r=Page.clientHeight,n=i.x(),s=i.y(),a=i.w(),_=i.h(),l=o<a+n,d=r<_+s,h=Page.scrollLeft||0,c=Page.scrollTop||0,p=this._obj,u=p.focus_type||PoiControl.DEF_FOCUS_TYPE;if(u="centered"==u?"Centered":"Simple",!l&&!d)return this.ctx_poi_(h,c,u),void(p.onfinish&&Page.RTFireTrigger(p.onfinish));var f={x:(2*p.x+p.w>>1)+n,y:(2*p.y+p.h>>1)+s,w:p.w>>1,h:p.h>>1},m={x:h,y:c,w:o,h:r},g=$("frame"),y=WCT.dom.HasVerticalScrollbar(g)?WCT.dom.GetScrollbarWidth():0,b=WCT.dom.HasHorizontalScrollbar(g)?WCT.dom.GetScrollbarHeight():0,v=WCT.POI.Focus[u](f,m);null!=v.x&&(v.x=Math.min(Math.max(0,v.x),a+n-o+y)),null!=v.y&&(v.y=Math.min(Math.max(0,v.y),_+s-r+b));var x={x:null!=v.x?v.x:h,y:null!=v.y?v.y:c};this.ctx_poi_(x.x,x.y,u),this.aid_=WCT.POI.Animate(g,m,x,"SineInOut",p.time||PoiControl.DEF_ANIM_TIME,10,PoiControl.prototype.after_ani_,this)}}else EDIT_MODE&&Editor.RuntimeInfo("no trigger: "+t)},ctx_poi_:function(t,e,i){var o=this._obj;if(window.ctx&&ctx.scrollToPOI){var r={x:o.x-t,y:o.y-e,w:o.w,h:o.h};ctx.scrollToPOI(r,i,o.time||PoiControl.DEF_ANIM_TIME,o)}},after_ani_:function(){this._obj.onfinish&&Page.RTFireTrigger(this._obj.onfinish)},_create_dom:function(){var t=$$("div");t.id=this._id+"#main#dom",t.className="PoiControl",t.style.position="absolute",t.style.overflow="hidden",t.style.padding="0px",t.style.textAlign="center",t.style.fontFamily="Courier New",t.style.fontSize="9pt",Canvas.Parent().appendChild(t)},_update_hit_areas:function(){}}),ProgressControl.prototype=new RectControl,WCT.ExtendObject(ProgressControl,{UpdateTextControl:function(t,e,i){"start"==e?this.cur_=Math.max(0,i):this.max_=Math.max(0,i),CanvasControl.UpdateTextControl.call(this,t,"text",this.cur_+" / "+this.max_)},UpdateBar:function(t,e,i){var o=this._get_el("#main#bar");switch(e){case"bar_border":o.style.borderWidth=i+"px";break;case"bar_border_color":o.style.borderColor=i;break;case"bar_empty_color":o.style.backgroundColor=i;break;case"bar_filled_color":this._get_el("#main#bar#act").style.backgroundColor=i}},SetWH:function(t,e,i){CanvasControl.SetWH.apply(this,arguments);var o=this._get_el("#main#bar"),r=2*t.bar_border;if("w"==e)o.style.width=Math.max(0,i-r)+"px",this._tctl.SetStyle({w:i});else{var n=Math.max(0,i/3-r);o.style.height=n+"px";var s=Math.ceil(i/3),a=Math.floor(2*s);this._tctl.SetStyle({y:s,h:a})}}}),WCT.ExtendObject(ProgressControl.prototype,{RTFireTrigger:function(t,e){if(RectControl.prototype.RTFireTrigger.apply(this,arguments))return!0;switch(t){case"count_up":++this.cur_>this.max_&&(this.cur_=this.max_),this.set_progress_();break;case"count_down":--this.cur_<0&&(this.cur_=0),this.set_progress_();break;case"set_cur":this.cur_=Math.max(0,Math.min(e,this.max_)),this.set_progress_();break;case"set_max":this.max_=Math.max(0,e),this.set_progress_();break;case"set_progress":if(2!=e.length)return;this.max_=Math.max(0,e[1]),this.cur_=Math.max(0,Math.min(e[0],this.max_)),this.set_progress_();break;case"reset":this.cur_=0,this.set_progress_();break;default:EDIT_MODE&&Editor.RuntimeInfo("no trigger: "+t)}},HandlesBookProgress:function(){return 1==this._obj.book_progress},set_progress_:function(){var t=this._obj,e=this._get_el("#main#bar#act"),i=Math.round(this.cur_/this.max_*(t.w-t.bar_border));e.style.width=Math.max(0,i)+"px",this._tctl.SetText(this.cur_+" / "+this.max_),t.onprogress&&Page.RTFireTrigger(t.onprogress)},_create_dom:function(){var t=this._id,e=this._obj,i=$$("div");i.id=t+"#main#dom",i.className="ProgressControl",i.style.position="absolute",i.style.overflow="hidden";var o=$$("div");o.id=t+"#main#bar",o.style.position="absolute",o.style.overflow="hidden",o.style.borderStyle="solid",o.style.top="0px",o.style.left="0px",i.appendChild(o);var r=$$("div");r.id=t+"#main#bar#act",r.style.position="absolute",r.style.left="0px",r.style.top="0px",r.style.height="100%",r.style.width="0px",o.appendChild(r),Canvas.Parent().appendChild(i);var n=new TextObject(this._id);n.Create(i),n.HideScrollbars(!0),n.SetStyle({x:0,y:0,w:e.w,h:e.h,valign:"middle"}),this._tctl=n},_update_dom:function(t){if(!this._disable_dom_update){var e=this._obj,i=t||e;set_x.call(this,e,"x",i.x,!1),set_y.call(this,e,"y",i.y,!1),ProgressControl.SetWH.call(this,e,"w",i.w,!1),ProgressControl.SetWH.call(this,e,"h",i.h,!1),this._update_hit_areas()}},_on_set_preview:function(t){t||this.RTFireTrigger("reset")}}),DragDrop.prototype=new SlideControl,WCT.ExtendObject(DragDrop.prototype,{_update_dom:function(){var t=this._obj;if(!this._disable_dom_update){var e={};if(t.image&&t.image.id&&(!t.image.w||!t.image.h))return(e=$$("div")).id=this._id+"#main#dom",e.style.position="absolute",e.style.visibility="hidden",Canvas.Parent().appendChild(e),this._src_ctx=createSourceContext({_this:"macro",macro:this._id}),void preload_image.call(this);this.has_image_=t.image&&t.image.id,(e=this._get_el())&&e.parentNode.removeChild(e),this._update_hit_areas()}},OnRTMouseDown:function(t){var e=this._obj;if("main"!=t.sub_id)return!(t.hasToBeCancelled=!0);if(this.f_=document.onselectstart,document.onselectstart=function(){return!1},this.has_image_){this.displace_={l:t.canvasX-this._obj.drag_x,t:t.canvasY-this._obj.drag_y};var i=Context.ToAbsPath(e.image.id,this._src_ctx),o=this._get_el("#drag#img");o||((o=$$("IMG")).id=e.id+"#drag#img",o.src=i,o.style.position="absolute",o.style.zIndex=e.z+1),o.style.left=t.canvasX-this.displace_.l+"px",o.style.top=t.canvasY-this.displace_.t+"px",Canvas.Parent().appendChild(o),set_opacity(o,75)}this.in_move_=!0,RT.AddHook("mousemove",this.OnRTMouseMove,this._id),RT.AddHook("mouseup",this.OnRTMouseUp,this._id),HitManager.setHitArea({ctl_id:this._id,sub_id:"drop",hdl_id:"dom",type:"rect",cursor:"default",x:e.drop_x,y:e.drop_y,w:e.drop_w,h:e.drop_h,z:e.z+1})},OnRTMouseClick:function(t){this.fire_wrong_()},OnRTMouseUp:function(t){if(this.in_move_){var e=this._obj;if(this.has_image_){var i=this._get_el("#drag#img");i.parentNode.removeChild(i)}this.in_move_=!1,e.oncorrectanswer&&t.ctl_id==this._id&&"drop"==t.sub_id&&(t.button==(e.right?3:1)&&t.altKey==e.alt_key&&t.ctrlKey==e.ctrl_key&&t.shiftKey==e.shift_key?Page.RTFireTrigger(e.oncorrectanswer,this._id):this.fire_wrong_()),HitManager.clearHitArea({ctl_id:this._id,sub_id:"drop",hdl_id:"dom"}),RT.RemoveHook("mousemove",this.OnRTMouseMove,this._id),RT.RemoveHook("mouseup",this.OnRTMouseUp,this._id),this.cancel_hooked_mouseup_=!0,document.onselectstart=this.f_,this.f_=null}else{if(this.cancel_hooked_mouseup_)return this.cancel_hooked_mouseup_=!1,!(t.hasToBeCancelled=!0);this.fire_wrong_()}},fire_wrong_:function(){var t=this._obj;if(t.onwronganswer){var e=Dict_get("EXER_FAILDROP"),i=[];t.ctrl_key&&i.push(Dict_get("CTRLKEY")),t.alt_key&&i.push(Dict_get("ALTKEY")),t.shift_key&&i.push(Dict_get("SHIFTKEY")),e=e.replace(/@1_keys_/,i.join(", ")),Page.RTFireTrigger(t.onwronganswer,e,this._id)}},OnRTMouseMove:function(t){if(this.in_move_&&this.has_image_){var e=this._get_el("#drag#img");e.style.left=t.canvasX-this.displace_.l+"px",e.style.top=t.canvasY-this.displace_.t+"px",t.hasToBeCancelled=!0}},GetBoundaryRect:function(){var t=this._obj;return{x:t.drop_x,y:t.drop_y,w:t.drop_w,h:t.drop_h,z:t.z}},_update_hit_areas:function(){if(HitManager.clearHitControl(this._id),!this.isHidden()){var t=this._obj;HitManager.setHitArea({ctl_id:this._id,sub_id:"main",hdl_id:"dom",type:"rect",cursor:"default",x:t.drag_x,y:t.drag_y,w:t.drag_w,h:t.drag_h,z:t.z})}}}),ImageButton.prototype=new RectControl,WCT.ExtendObject(ImageButton,{SetBoxShadow:function(t,e,i){var o=this._get_el();o&&(o.style.boxShadow=i||"")},SetShadow:function(t,e,i){this.CalcShadow()&&ImageButton.SetBoxShadow.call(this,this._obj,"ctl_box_shadow",this._shadow)},SetBorder:function(t,e,i){var o=this._get_el();if(o){var r="border"+{l:"Left",r:"Right",t:"Top",b:"Bottom"}[e.split("_")[2]];o.style[r+"Style"]="solid",o.style[r+"Color"]=t.border_color||"#000000",o.style[r+"Width"]=i+"px"}},SetWH:function(t,e,i){var o=(t.ctl_border_l||0)+(t.ctl_border_r||0),r=(t.ctl_border_t||0)+(t.ctl_border_b||0);i-="w"==e?o:r,BorderTextObject.SetControlWH.call(this,t,e,i,arguments[3])},SetImage:function(t,e,i){this._tctl&&this._tctl.SetImage(i)},SetImagePadding:function(t,e,i){if(this._tctl){var o=get_padding(t,"image_");this._tctl.SetImagePadding(o)}},SetImageAlign:function(t,e,i){this._tctl&&this._tctl.SetImageAlign(i)},ClampImagePadding:function(t,e){e.res="number"!=typeof e.val||e.val<0?0:e.val}}),WCT.ExtendObject(ImageButton.prototype,{ImagesLoaded:TextControl.prototype.ImagesLoaded,OnDefaultEdit:TextControl.prototype.OnDefaultEdit,SetDirection:TextControl.prototype.SetDirection,GetHtmlPosSize:TextControl.prototype.GetHtmlPosSize,_update_dom:TextControl.prototype._update_dom,_rd_get_min_rect:TextControl.prototype._rd_get_min_rect,OnRTMouseClick:function(t){this._exec_link()},OnRTMouseEnter:function(t){this.set_style_("mouseover")},OnRTMouseLeave:function(t){this.set_style_("mouseout")},OnRTMouseUp:function(t){this.set_style_("mouseup")},OnRTMouseDown:function(t){this.set_style_("mousedown")},_create_dom:function(){var t=$$("div");t.id=this._id+"#main#dom",t.className="ImageButton",t.style.position="absolute",t.style.overflow="hidden",t.setAttribute("role","button"),Canvas.Parent().appendChild(t),ImageBorderTextObject.Create.call(this,t)},_on_set_preview:function(t){TextObject.UpdateFromControl.call(this,this._obj,"text",this._obj.text)},set_style_:function(t){var e,o=this._obj;tc="text_color"+(e="mouseover"==t||"mouseup"==t?"_h":"mousedown"==t?"_a":""),o[tc]||(tc="text_color"),o[tc]&&TextObject.UpdateFromControl.call(this,o,"text_color",o[tc]),i="image"+e,o[i]||(i="image"),o[i]&&ImageButton.SetImage.call(this,o,"image",o[i]),o[e="mouseup"==t?"custom_style_mouseover":"custom_style_"+t]||(e="custom_style"),o[e]&&BorderTextObject.SetControlCustomStyle.call(this,o,"custom_style",o[e])}}),LinkListControl.prototype=new RectControl,LinkListControl.SetItems=function(t,i,o){var r=null;try{r=JSON.parse(o)}catch(e){r=null}r=r||[],this.items_=r;for(var n=this._id+"#itm#",s="rtl"==t.direction,a=t.line_height,_=[],l=0,d=null;d=r[l];l++){var h=['<div id="',n,l,'" title="',d.text,'" role="link" tabindex="',t.tabindex||0,'" style="',"font-size:1px;","position:relative;","height:",a,"px;","margin:1px; margin-bottom:",t.item_padding||1,'px;">'],c=d.icon;c&&h.push('<div style="',"background-image:url('",c.id,"');","background-repeat:no-repeat;","background-position:",c.off_x+"px ",c.off_y+"px;","position:absolute;","font-size:1px;",s?"right:":"left:",c.x,"px;","top:",c.y,"px;","width:",c.w,"px;","height:",c.h,'px;">',"</div>"),h.push('<div style="',"position:absolute;","top:0;",s?"right:":"left:",c.x+c.w+3,"px;","height:",a,"px;","font-size:",t.font_size,"px;","text-overflow:ellipsis;","text-decoration:",t.underline?"underline":"none",';">',d.text,"</div>"),h.push("</div>"),_.push(h.join(""))}if(TextObject.UpdateFromControl.call(this,t,"text",_.join("")),this._tctl){var p=this._tctl.GetScrollPos();this._on_scroll(p.x,p.y)}},WCT.ExtendObject(LinkListControl.prototype,{SetDirection:TextControl.prototype.SetDirection,Terminate:function(){this.items_=null,RectControl.prototype.Terminate.call(this)},OnRTMouseDown:function(t){this._update_visual("down",t)},OnRTMouseUp:function(t){this._update_visual("over",t)},OnRTMouseEnter:function(t){this._update_visual("over",t)},OnRTMouseLeave:function(t){this._update_visual(null,t)},OnRTMouseClick:function(t){var e=Number(t.hdl_id),i=this.items_[e],o=i&&i.link||null;o&&Page.RTFireTrigger(o)},_create_dom:function(){var t=$$("div");t.id=this._id+"#main#dom",t.className="LinkListControl",t.style.position="absolute",Canvas.Parent().appendChild(t),BorderTextObject.Create.call(this,t).ObserveOnScroll(this._on_scroll,this)},_update_dom:function(t){if(!this._disable_dom_update){var e=this._obj,i=t||e;set_x.call(this,e,"x",i.x,!1),set_y.call(this,e,"y",i.y,!1),BorderTextObject.SetControlWH.call(this,e,"w",i.w,!1),BorderTextObject.SetControlWH.call(this,e,"h",i.h,!1),this._update_hit_areas()}},_update_hit_areas:function(){if(HitManager.clearHitControl(this._id),!this.isHidden()){var t=this._id,e=this._obj;if(!e.hidden)for(var i=WCT.dom.GetScrollbarWidth(),o=e.x-this.scroll_x_,r=e.y-this.scroll_y_,n=e.line_height,s=e.y-n,a=e.y+e.h+n,_=this.items_,l=0,d=null;d=_[l];l++)d.link&&s<=r&&r<=a&&HitManager.setHitArea({ctl_id:t,sub_id:"itm",hdl_id:l+"",type:"rect",cursor:"pointer",x:o,y:r,w:e.w-i,h:n,z:e.z}),r+=n+(e.item_padding||1)}},_update_visual:function(t,e){var i="#"+e.sub_id+"#"+e.hdl_id,o=this._get_el(i);if(o){var r=this._obj,n=r.text_color||"#000000",s=r.text_color_over||n,a=r.text_color_down||n;o.style.color="over"==t?s:"down"==t?a:n}},_on_set_preview:function(t){var e=this._get_el();t||(e.scrollTop=0)},_on_scroll:function(t,e,i){this.scroll_x_=t,this.scroll_y_=e,this._update_hit_areas(),RT&&BROWSER.MOBILE&&(RT.touch_moved_=!0)}}),ButtonAreaControl.prototype=new RectControl,WCT.ExtendObject(ButtonAreaControl,{SetButtons:function(t,i,o){this._cleanup_buttons();var r=null;try{r=JSON.parse(o)}catch(e){r=null}r=r||[],this.bstore_=r;for(var n=this._src_ctx,s=this._get_el(),a=this.buttons_,_=this._id+"#",l=0,d=null;d=r[l];l++){var h=_+l,c=new ButtonObject(h),p=WCT.DeepCopy(t);c.SetSrcCtx(n),c.SetBorderStyle(t.button_style),c.SetImage(d.icon),c.SetText(d.text),c.Create(s,p),a.push(c),WCT.event.Observe("keydown",this.onKeyDown.bind(this),$(h))}WCT.SetTimeout(this._update_hit_areas,1,this,[!0])},SetButtonStyle:function(t,e,i){for(var o=0,r=null,n=this.buttons_;r=n[o++];)r.SetBorderStyle(i)}}),WCT.ExtendObject(ButtonAreaControl.prototype,{Terminate:function(){this._cleanup_buttons(),this.buttons_=null,this.bstore_=null,RectControl.prototype.Terminate.call(this)},onKeyDown:function(t){var e=RT.normalize_evt(t);if(13===e.button||32===e.button){var i=Number(e.target.split("#").top());this._fireEvent(i),WCT.event.Cancel(t)}},OnRTMouseDown:function(t){this._update_visual("down",t)},OnRTMouseUp:function(t){this._update_visual("over",t)},OnRTMouseEnter:function(t){this._update_visual("over",t)},OnRTMouseLeave:function(t){this._update_visual(null,t)},OnRTMouseClick:function(t){this._fireEvent(Number(t.hdl_id))},SetDirection:function(t){var e=this._obj.direction||(WCT.IsLanguageRTL(t)?"rtl":"");this._direction=e;for(var i=this.buttons_,o=0,r=null;r=i[o++];)r.SetStyle({direction:e})},_fireEvent:function(t){var e=this.bstore_[t],i=e&&e.href||null;i&&Page.RTFireTrigger(i)},_create_dom:function(){var t=$$("div");t.id=this._id+"#main#dom",t.setAttribute("role","region"),t.setAttribute("aria-label",ctx.cfg_tr("SLIDE_BUTTONAREA")),t.tabIndex=0,t.className="ButtonAreaControl",t.style.position="absolute",Canvas.Parent().appendChild(t)},_update_dom:function(t){if(!this._disable_dom_update){var e=this._obj,i=t||e;set_x.call(this,e,"x",i.x,!1),set_y.call(this,e,"y",i.y,!1),set_w.call(this,e,"w",i.w,!1),this._update_hit_areas()}},_update_hit_areas:function(){var t=this._id;if(HitManager.clearHitControl(t),arguments[0]&&(this.allow_hitareas_=!0),!this.isHidden()&&this.allow_hitareas_){for(var e=this._obj,i=this.buttons_,o=this.bstore_,r=0,n=null;n=i[r];r++){var s=n.GetPosSize();s&&HitManager.setHitArea({ctl_id:t,sub_id:"btn",hdl_id:r+"",type:"rect",cursor:o[r].href?"pointer":"default",x:e.x+s.x,y:e.y+s.y,w:s.w,h:s.h,z:e.z})}var a=this._get_el().offsetHeight;a!=this.h_&&(this.h_=a,Env.onPropChange(t,"h",a))}},_update_visual:function(t,e){var i=Number(e.hdl_id),o=this.buttons_[i];if(o){var r=this._obj,n=this.bstore_[i],s="over"==t||"down"==t?t:"",a=r["button_style_"+s]||r.button_style||null,_=n["icon_"+s]||n.icon||null;o.SetBorderStyle(a),o.SetImage(_)}},_on_set_preview:function(){},_cleanup_buttons:function(){this.allow_hitareas_=!1;for(var t=0,e=null,i=this.buttons_;e=i[t++];)WCT.event.StopObserving("keydown",this.onKeyDown.bind(this),$(e.getId())),e.Destructor();this.buttons_=[],this.bstore_=[]}}),BreadcrumbTrailControl.prototype=new RectControl,WCT.ExtendObject(BreadcrumbTrailControl,{SetWH:function(t,e,i){this[e+"_"]!=i&&(this[e+"_"]=i,this._get_el().style["w"==e?"width":"height"]=Math.max(0,i)+"px",BreadcrumbTrailControl.ResizeItems.call(this,"resize"),!1!==arguments[3]&&(this._rd_update_dom_rect&&this._rd_update_dom_rect(),this._draggers&&this._draggers.main.UpdatePos(),this._update_hit_areas&&this._update_hit_areas()))},SetDirection:function(t,e,i){this.SetDirection(null)},SetItem:function(t,e){var i=this._id,o=this._obj,r=i+"#"+t,n={dir:e.dir,border:e.border,thickness:1,x:0,y:o.h-e.h>>1,w:100,h:e.h},s={white_space:"nowrap",align:"Start",valign:"middle",overflow:"hidden",hide_scrollbars:1,font_family:"Arial",title:e.text,direction:o.direction};e.font_size&&(s.font_size=e.font_size),e.padding_l&&(s.padding_l=e.padding_l),e.padding_r&&(s.padding_r=e.padding_r),e.text_color&&(s.text_color=e.text_color);var a=this._cctl,_=this.params_,l=this.tctls_;if(_[t]&&_[t].dir==n.dir&&_[t].border==n.border)a.SetDrawStyle(r,e.background_color||"#FFFFFF",e.border_color||"#FFFFFF"),l[t].SetStyle(s),l[t].SetText(e.text),l[t].SetAccessibility(e);else{a.AddShape(r,n),a.SetDrawStyle(r,e.background_color||"#FFFFFF",e.border_color||"#FFFFFF");var d=this._get_el(),h=new TextObject(i,r);s.visibility="hidden",h.Create(d,o),h.SetStyle(s),h.HideScrollbars(!0),h.SetText(e.text),h.SetAccessibility(e),WCT.event.Observe("keydown",this.onKeyDown.bind(this),$(r)),_.push(n),l.push(h)}},SetItems:function(t,i,o){if(this.itm_!=o||this.dir_!=t.direction){this.itm_=o,this.dir_=t.direction;var r=null;try{r=JSON.parse(o)}catch(e){r=null}r=r||[];var n=this._cctl,s=this.istore_.length,a=s-r.length;if(0<a){for(var _=s-a,l=this.tctls_,d=_,h=this._id,c=null;c=l[d];d++)WCT.event.StopObserving("keydown",this.onKeyDown.bind(this),$(h+"#"+d)),c.Destructor(),l[d]=null,n.RemoveShape(h+"#"+d);this.params_.splice(_,a),l.splice(_,a)}this.istore_=r;d=0;for(var p=null;p=r[d];d++)BreadcrumbTrailControl.SetItem.call(this,d,p);var u=this.vstate_;u&&this._update_visual(u.s,u.e),this.autosize_=[],this.wait4set_=!0,WCT.SetTimeout(BreadcrumbTrailControl.ResizeItems,1,this,["set"])}},ResizeItems:function(t){if(this.wait4set_){if("set"!=t)return;this.wait4set_=!1}var e=this._cctl,i=this.tctls_;if(e&&i){for(var o=this._obj,r=this._id,n=this.params_,s=o.spacing||0,a="rtl"==o.direction,_=arguments[1]||0,l=[],d=0;d<_;d++)i[d].SetStyle({visibility:"hidden"}),e.HideShape(r+"#"+d,!0);d=_;for(var h=0,c=this.autosize_,p=null;p=i[d];d++){var u=r+"#"+d,f=n[d];if(e.HideShape(u,!1),!c[d]||c[d]<5){var m=p.GetAutoSize("w");c[d]=c[d]?c[d]+1:1;var g=e.GetTextRect(u),y=g.w-m;f.w-=y}f.w=2*Math.round(f.w/2),f.x=a?o.w-f.w-h:h,e.SetParams(u,f),l.push(f.w),g=e.GetTextRect(u),g=WCT.DeepCopy(g,{line_height:g.h,visibility:"visible"}),p.SetStyle(g),h=(a?o.w-g.x:g.w+g.x)+s}if(!_){for(var b=l.sum();b>o.w;)b-=l.shift();if(0<(_=i.length-l.length))return void BreadcrumbTrailControl.ResizeItems.call(this,"resize",_)}e.Redraw(),this._update_hit_areas()}}}),WCT.ExtendObject(BreadcrumbTrailControl.prototype,{Terminate:function(){if(this.istore_=null,this.params_=null,this.vstate_=null,this.autosize_=null,this.tctls_){for(var t=0,e=this._id,i=null;i=this.tctls_[t];t++)WCT.event.StopObserving("keydown",this.onKeyDown.bind(this),$(e+"#"+t)),i.Destructor(),this.tctls_[t]=null;this.tctls_=null}RectControl.prototype.Terminate.call(this)},onKeyDown:function(t){var e=RT.normalize_evt(t);if(13===e.button||32===e.button){var i=Number(e.target.split("#").top());this._fireEvent(i),WCT.event.Cancel(t)}},OnRTMouseDown:function(t){this._update_visual("down",t)},OnRTMouseUp:function(t){this._update_visual("over",t)},OnRTMouseEnter:function(t){this._update_visual("over",t)},OnRTMouseLeave:function(t){this._update_visual(null,t)},OnRTMouseClick:function(t){var e=Number(t.hdl_id.split("#").top());this._fireEvent(e)},SetDirection:function(t){var e=this._obj,i=e.direction||(WCT.IsLanguageRTL(t)?"rtl":"");this._direction=i,BreadcrumbTrailControl.SetItems.call(this,e,"items",e.items)},_fireEvent:function(t){var e=this.istore_[t],i=e&&e.href||null;i&&Page.RTFireTrigger(i)},_create_dom:function(){var t=$$("nav");t.id=this._id+"#main#dom",t.setAttribute("role","navigation"),t.className="BreadcrumbTrailControl",t.style.position="absolute",Canvas.Parent().appendChild(t);var e=new CanvasObject(this._id+"#main#canvas");e.Create(t),this._cctl=e},_update_dom:function(){},_update_hit_areas:function(){if(HitManager.clearHitControl(this._id),!this.isHidden()){var t=this._obj,e=this._cctl.GetHitarea({x:t.x,y:t.y}),i=this._id,o=this.istore_;for(var r in e)if(e[r]){var n=Number(r.split("#").top()),s=o[n]&&o[n].href||"";HitManager.setHitArea({type:"poly",ctl_id:i,sub_id:"canvas",hdl_id:r,shape:e[r],cursor:s?"pointer":"default",z:t.z})}}},_update_visual:function(t,e){var i=Number(e.hdl_id.split("#").top()),o=this.istore_[i],r=this.tctls_[i],n=this._cctl;if(o&&r&&n){this.vstate_={s:t,e:e};var s=o.background_color||null,a=o.background_color_over||s,_=o.background_color_down||s,l=o.border_color||null,d=o.border_color_over||l,h=o.border_color_down||l,c=o.text_color||null,p=o.text_color_over||c,u=o.text_color_down||c;"over"==t?(n.SetDrawStyle(e.hdl_id,a,d),r.SetStyle({text_color:p})):"down"==t?(n.SetDrawStyle(e.hdl_id,_,h),r.SetStyle({text_color:u})):(n.SetDrawStyle(e.hdl_id,s,l),r.SetStyle({text_color:c})),n.Draw()}},_on_set_preview:function(){}}),GroupControl.prototype=new RectControl,WCT.ExtendObject(GroupControl,{SetCollection:function(t,e,i){if(!Page.IsInCreate()){var o=this._gctl;o?o.RemoveAll():o=GroupObject.CreateGroup.call(this),i&&""!=i&&o.Add(i.split(";")),this._update_dom(),GroupControl.SetVisibility.call(this,t,"opacity",t.opacity),GroupControl.SetVisibility.call(this,t,"hidden",t.hidden)}},UpdatePosition:function(t,e,i){var o=i-this.cur_rect_[e],r=this.GetGroup();for(var n in r){var s=Controls[n]._obj,a=s.type;if("arrow"===a)Page.UpdateControl(n,e+"0",s[e+"0"]+o),Env.onPropChange(n,e+"0",s[e+"0"]),Page.UpdateControl(n,e+"1",s[e+"1"]+o),Env.onPropChange(n,e+"1",s[e+"1"]);else if("connector"===a){for(var _="x"===e?0:1,l=s.points?s.points.split(","):[],d=l.length;_<d;_+=2)l[_]=parseFloat(l[_])+o;var h=l.join(",");Page.UpdateControl(n,"points",h),Env.onPropChange(n,"points",h)}else Page.UpdateControl(n,e,s[e]+o),Env.onPropChange(n,e,s[e])}if(this._update_dom(),Env.onPropChange(this._id,e,i),this.IsGrouped()){var c=this.GetGroupId();Controls[c].Refresh()}},SetVisibility:function(t,e,i){var o=this.GetGroup();for(var r in o){var n=Controls[r];if(n){var s=n._obj||{};"opacity"===e&&n instanceof TextBox&&(Page.UpdateControl(r,"popup_opacity",s.popup_opacity),Env.onPropChange(r,"popup_opacity",s.popup_opacity)),Page.UpdateControl(r,e,s[e]),Env.onPropChange(r,e,s[e])}}},FadeInOut:function(t,e){var i=this.GetGroup();for(var o in i){var r=Controls[o];r&&!r.isHidden(!0)&&("group_fade_in_force"===e&&(r._fader&&r._fader.SetDomVis(0),r.IsGroupControl()&&(e="group_fade_in")),r.RTFireTrigger(e))}}}),WCT.ExtendObject(GroupControl.prototype,{_create_dom:function(){var t=$$("div"),e=this._id;t.id=e+"#main#dom",t.style.position="absolute",t.style.overflow="hidden",t.style.backgroundColor="transparent",t.setAttribute("role","presentation"),t.setAttribute("aria-hidden","true"),Canvas.Parent().appendChild(t);var i=this._obj;t.style.left=i.x+"px",t.style.top=i.y+"px",t.style.width=i.w+"px",t.style.height=i.h+"px",t.style.zIndex=i.z,this.cur_rect_={x:i.x,y:i.y,w:i.w,h:i.h},Page.IsInCreate()||GroupObject.CreateGroup.call(this)},_update_dom:function(){var t=arguments[0]||this._obj,e=this._get_el();e.style.left=t.x+"px",e.style.top=t.y+"px",e.style.width=t.w+"px",e.style.height=t.h+"px",this.cur_rect_={x:t.x,y:t.y,w:t.w,h:t.h};var i=this._draggers;i&&i.main&&i.main.UpdatePos()},_update_hit_areas:function(){},GetOpacity:function(){var t=1;if(this.IsGrouped()){var e=this.GetGroupId(),i=Controls[e].GetOpacity();"number"==typeof i&&(t=i/100)}return this._obj.opacity*t},GetDelta:function(t){var e=this._obj;return{x:t.x-e.x,y:t.y-e.y}},Refresh:function(){var t=this._draggers;t&&t.main&&t.main.UpdatePos()},Terminate:function(){this.Remove(),EDIT_MODE&&Editor.GroupName(this._obj.name,!1),RectControl.prototype.Terminate.call(this)},Remove:function(){var t=$(this._id+"#main#dom");t&&t.parentNode.removeChild(t);var e=this._gctl;e&&e.Destructor(),this._gctl=null,this._draggers&&this._draggers.main.Destroy()},InitEdit:function(){var t=this._obj,e=new GroupDragger(this,this._id,"main");e.Init({x:"x",y:"y",r:"r",z:"z"},{w:t.w,h:t.h,r:0,z:t.z}),e.UpdatePos(),this._draggers.main=e},TMAP:{fade_in:"distribute_fade_in",fade_out:"distribute_fade_out",fade_toggle:"distribute_fade_toggle",nondistribute_fade_out:"fade_out",nondistribute_fade_toggle:"fade_toggle"},DistributeTrigger:function(t){var e=this.GetGroup();for(var i in e){var o=Controls[i];if(o){var r=(o.IsGroupControl()?"nondistribute_":"")+t;o.RTFireTrigger(r)}}},RTFireTrigger:function(t,e){this.TMAP[t]&&(t=this.TMAP[t]);var i=this._obj,o="distribute_";if(0===t.search(o))return t=t.replace(o,""),this.DistributeTrigger(t),t;switch(t){case"show":i.hidden=!1,GroupControl.SetVisibility.call(this,i,"hidden",!1);break;case"hide":i.hidden=!0,GroupControl.SetVisibility.call(this,i,"hidden",!0);break;case"toggle":this.RTFireTrigger(i.hidden?"show":"hide",e);break;case"nondistribute_fade_in":i.hidden=!1,GroupControl.FadeInOut.call(this,i,"group_fade_in_force");break;case"fade_in":i.hidden=!1;case"group_fade_in":GroupControl.FadeInOut.call(this,i,"group_fade_in");break;case"fade_out":i.hidden=!0;case"group_fade_out":GroupControl.FadeInOut.call(this,i,"group_fade_out");break;case"fade_toggle":this.RTFireTrigger(i.hidden?"nondistribute_fade_in":"nondistribute_fade_out",e);break;default:EDIT_MODE&&Editor.RuntimeInfo("no trigger: "+t)}},GetGroup:function(){var t=arguments[0]||!1,e=arguments[1]||!1,i=t?[]:{},o=this._gctl;if(!o)return i;var r=WCT.DeepCopy(o.Get());if(e){var n={};for(var s in r){var a=Controls[s];a.IsGroupControl()&&WCT.ExtendObject(n,a.GetGroup(!1,!0))}WCT.ExtendObject(r,n)}if(t){for(var s in r)i.push(s);return i}return r},UpdateDom:function(){this._update_dom(arguments[0])},InitGroup:function(){this._gctl||(this._gctl=GroupObject.CreateGroup.call(this));var t=this._draggers;t&&t.main&&t.main.UpdatePos();var e=this._obj;return GroupControl.SetVisibility.call(this,e,"opacity",e.opacity),GroupControl.SetVisibility.call(this,e,"hidden",e.hidden),this._gctl},RemoveCtlFromGroup:function(t){if(EDIT_MODE&&t){t.isArray||(t=[t]);var e=this.GetGroup(!0);e=e.sort(),t=t.sort();var i=this._id;if(WCT.DeepEquals(e,t)){if(this.IsGrouped()){var o=this.GetGroupId();Controls[o]&&Controls[o].RemoveCtlFromGroup(i)}delete Controls[i],Env.ControlDeleted(i),this.Terminate()}else{this._gctl.Remove(t);var r=this.GetGroup(!0),n=GetRectForControls(r);if(!n)return;this._update_dom(n),r=r.join(";");var s=this._obj;if(s.collection=r,Page.IsInCreate()||(Env.onPropChange(i,"x",n.x),Env.onPropChange(i,"y",n.y),Env.onPropChange(i,"w",n.w),Env.onPropChange(i,"h",n.h),Env.onPropChange(i,"collection",r)),s.hidden)for(var a=null,_=0;a=t[_++];){var l=Controls[a]._obj||{};Page.UpdateControl(a,"hidden",l.hidden)}}}},addCtlToGroup:function(t){if(EDIT_MODE&&t){t.isArray||(t=[t]),this._gctl.Add(t);var e=this.GetGroup(!0),i=GetRectForControls(e);if(i){this._update_dom(i),e=e.join(";");var o=this._obj;if(o.collection=e,!Page.IsInCreate()){var r=this._id;Env.onPropChange(r,"x",i.x),Env.onPropChange(r,"y",i.y),Env.onPropChange(r,"w",i.w),Env.onPropChange(r,"h",i.h),Env.onPropChange(r,"collection",e)}o.hidden&&GroupControl.SetVisibility.call(this,o,"hidden",!0)}}}}),QRCodeControl.prototype=new RectControl,WCT.ExtendObject(QRCodeControl.prototype,{OnRTMouseClick:TextControl.prototype.OnRTMouseClick,_create_dom:function(){var t=this._obj,e=$$("div");e.id=this._id+"#main#dom",e.setAttribute("aria-label",t.data),e.style.position="absolute",e.style.overflow="hidden",e.setAttribute("role",t.onclick||t.onleave||t.onenter?"button":"img"),Canvas.Parent().appendChild(e),this._update_hit_areas()},_update_dom:function(t){RectControl.prototype._update_dom.call(this,t);var e=this._obj,i=t||e,o=2*(e.padding||0),r=2*(e.border||0),n=i.w-r-o,s=i.h-r-o,a=this._get_el(),_=[e.text_color||"#000",e.background_color||"transparent"],l=replace_placeholder(e.data||"");a.innerHTML=WCT.QrCode.GenerateHtml(l,Math.min(n,s),null,_),a.style.width=n+"px",a.style.height=s+"px",this._link_to=l&&e.is_link?l:"",this._update_hit_areas()},_on_set_preview:function(t){}});